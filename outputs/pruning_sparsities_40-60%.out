



----------------------------------------------------
----------------------------------------------------
Pruning started for sparsity ratio 0.4!
----------------------------------------------------
----------------------------------------------------
{'train_runtime': 17859.053, 'train_samples_per_second': 0.014, 'train_steps_per_second': 0.014, 'train_loss': 0.7839699387550354, 'epoch': 2.0}
***** train metrics *****
  epoch                    =        2.0
  train_loss               =      0.784
  train_runtime            = 4:57:39.05
  train_samples_per_second =      0.014
  train_steps_per_second   =      0.014
----------------------------------------------------
----------------------------------------------------
Pruning finished for sparsity ratio 0.4!
----------------------------------------------------
----------------------------------------------------




----------------------------------------------------
----------------------------------------------------
Pruning started for sparsity ratio 0.5!
----------------------------------------------------
----------------------------------------------------
{'train_runtime': 17740.4574, 'train_samples_per_second': 0.014, 'train_steps_per_second': 0.014, 'train_loss': 0.9192610383033752, 'epoch': 2.0}
***** train metrics *****
  epoch                    =        2.0
  train_loss               =     0.9193
  train_runtime            = 4:55:40.45
  train_samples_per_second =      0.014
  train_steps_per_second   =      0.014
----------------------------------------------------
----------------------------------------------------
Pruning finished for sparsity ratio 0.5!
----------------------------------------------------
----------------------------------------------------




----------------------------------------------------
----------------------------------------------------
Pruning started for sparsity ratio 0.6!
----------------------------------------------------
----------------------------------------------------
{'train_runtime': 17532.811, 'train_samples_per_second': 0.015, 'train_steps_per_second': 0.015, 'train_loss': 1.1873774528503418, 'epoch': 2.0}
***** train metrics *****
  epoch                    =        2.0
  train_loss               =     1.1874
  train_runtime            = 4:52:12.81
  train_samples_per_second =      0.015
  train_steps_per_second   =      0.015
----------------------------------------------------
----------------------------------------------------
Pruning finished for sparsity ratio 0.6!
----------------------------------------------------
----------------------------------------------------




----------------------------------------------------
----------------------------------------------------
Pruning started for sparsity ratio 0.7!
----------------------------------------------------
----------------------------------------------------
{'train_runtime': 17447.0867, 'train_samples_per_second': 0.015, 'train_steps_per_second': 0.015, 'train_loss': 1.73875892162323, 'epoch': 2.0}
***** train metrics *****
  epoch                    =        2.0
  train_loss               =     1.7388
  train_runtime            = 4:50:47.08
  train_samples_per_second =      0.015
  train_steps_per_second   =      0.015
----------------------------------------------------
----------------------------------------------------
Pruning finished for sparsity ratio 0.7!
----------------------------------------------------
----------------------------------------------------




----------------------------------------------------
----------------------------------------------------
Pruning started for sparsity ratio 0.8!
----------------------------------------------------
----------------------------------------------------
    | 10/256 [12:59<4:39:18, 68.12s/it]  4%|▍         | 11/256 [14:05<4:35:55, 67.57s/it]  5%|▍         | 12/256 [15:12<4:33:51, 67.34s/it]  5%|▌         | 13/256 [16:18<4:31:57, 67.15s/it]  5%|▌         | 14/256 [17:28<4:33:45, 67.88s/it]  6%|▌         | 15/256 [18:36<4:33:09, 68.01s/it]  6%|▋         | 16/256 [19:44<4:31:29, 67.87s/it]  7%|▋         | 17/256 [21:03<4:43:23, 71.14s/it]  7%|▋         | 18/256 [22:12<4:40:24, 70.69s/it]  7%|▋         | 19/256 [23:19<4:34:39, 69.53s/it]  8%|▊         | 20/256 [24:28<4:32:20, 69.24s/it]  8%|▊         | 21/256 [25:42<4:37:42, 70.90s/it]  9%|▊         | 22/256 [26:57<4:41:06, 72.08s/it]  9%|▉         | 23/256 [28:05<4:35:01, 70.82s/it]  9%|▉         | 24/256 [29:16<4:33:22, 70.70s/it] 10%|▉         | 25/256 [30:22<4:27:40, 69.53s/it] 10%|█         | 26/256 [31:29<4:23:03, 68.62s/it] 11%|█         | 27/256 [32:36<4:20:09, 68.16s/it] 11%|█         | 28/256 [33:43<4:17:53, 67.86s/it] 11%|█▏        | 29/256 [34:50<4:15:45, 67.60s/it] 12%|█▏        | 30/256 [35:56<4:13:17, 67.24s/it] 12%|█▏        | 31/256 [37:03<4:11:18, 67.02s/it] 12%|█▎        | 32/256 [38:09<4:09:36, 66.86s/it] 13%|█▎        | 33/256 [39:16<4:08:39, 66.90s/it] 13%|█▎        | 34/256 [40:23<4:07:28, 66.88s/it] 14%|█▎        | 35/256 [41:30<4:06:19, 66.87s/it] 14%|█▍        | 36/256 [42:37<4:04:57, 66.81s/it] 14%|█▍        | 37/256 [43:44<4:04:06, 66.88s/it] 15%|█▍        | 38/256 [44:51<4:03:37, 67.05s/it] 15%|█▌        | 39/256 [46:02<4:06:56, 68.28s/it] 16%|█▌        | 40/256 [47:09<4:04:15, 67.85s/it] 16%|█▌        | 41/256 [48:16<4:01:51, 67.49s/it] 16%|█▋        | 42/256 [49:23<3:59:49, 67.24s/it] 17%|█▋        | 43/256 [50:29<3:57:44, 66.97s/it] 17%|█▋        | 44/256 [51:36<3:56:18, 66.88s/it] 18%|█▊        | 45/256 [52:46<3:58:44, 67.89s/it] 18%|█▊        | 46/256 [53:57<4:01:08, 68.90s/it] 18%|█▊        | 47/256 [55:06<3:59:36, 68.79s/it] 19%|█▉        | 48/256 [56:12<3:56:06, 68.11s/it] 19%|█▉        | 49/256 [57:19<3:53:47, 67.77s/it] 20%|█▉        | 50/256 [58:27<3:52:22, 67.68s/it] 20%|█▉        | 51/256 [59:33<3:50:21, 67.42s/it] 20%|██        | 52/256 [1:00:40<3:48:45, 67.28s/it] 21%|██        | 53/256 [1:01:49<3:49:23, 67.80s/it] 21%|██        | 54/256 [1:03:05<3:55:45, 70.03s/it] 21%|██▏       | 55/256 [1:04:12<3:51:34, 69.13s/it] 22%|██▏       | 56/256 [1:05:19<3:48:17, 68.49s/it] 22%|██▏       | 57/256 [1:06:26<3:46:00, 68.14s/it] 23%|██▎       | 58/256 [1:07:42<3:52:38, 70.50s/it] 23%|██▎       | 59/256 [1:08:53<3:52:19, 70.76s/it] 23%|██▎       | 60/256 [1:10:00<3:47:11, 69.55s/it] 24%|██▍       | 61/256 [1:11:07<3:43:00, 68.62s/it] 24%|██▍       | 62/256 [1:12:13<3:40:14, 68.12s/it] 25%|██▍       | 63/256 [1:13:20<3:37:42, 67.68s/it] 25%|██▌       | 64/256 [1:14:27<3:35:49, 67.45s/it] 25%|██▌       | 65/256 [1:15:34<3:34:05, 67.25s/it] 26%|██▌       | 66/256 [1:16:41<3:32:46, 67.19s/it] 26%|██▌       | 67/256 [1:17:48<3:31:12, 67.05s/it] 27%|██▋       | 68/256 [1:18:54<3:29:36, 66.89s/it] 27%|██▋       | 69/256 [1:20:01<3:28:18, 66.84s/it] 27%|██▋       | 70/256 [1:21:08<3:27:11, 66.84s/it] 28%|██▊       | 71/256 [1:22:14<3:25:34, 66.67s/it] 28%|██▊       | 72/256 [1:23:21<3:24:45, 66.77s/it] 29%|██▊       | 73/256 [1:24:28<3:24:04, 66.91s/it] 29%|██▉       | 74/256 [1:25:35<3:23:00, 66.93s/it] 29%|██▉       | 75/256 [1:26:42<3:21:47, 66.89s/it] 30%|██▉       | 76/256 [1:27:49<3:20:41, 66.90s/it] 30%|███       | 77/256 [1:28:56<3:19:20, 66.82s/it] 30%|███       | 78/256 [1:30:02<3:18:17, 66.84s/it] 31%|███       | 79/256 [1:31:14<3:21:40, 68.36s/it] 31%|███▏      | 80/256 [1:32:29<3:26:26, 70.38s/it] 32%|███▏      | 81/256 [1:33:36<3:21:53, 69.22s/it] 32%|███▏      | 82/256 [1:34:43<3:18:54, 68.59s/it] 32%|███▏      | 83/256 [1:35:50<3:16:07, 68.02s/it] 33%|███▎      | 84/256 [1:36:56<3:13:51, 67.63s/it] 33%|███▎      | 85/256 [1:38:03<3:12:02, 67.38s/it] 34%|███▎      | 86/256 [1:39:24<3:22:14, 71.38s/it] 34%|███▍      | 87/256 [1:40:39<3:23:44, 72.34s/it] 34%|███▍      | 88/256 [1:41:45<3:17:42, 70.61s/it] 35%|███▍      | 89/256 [1:42:52<3:13:13, 69.42s/it] 35%|███▌      | 90/256 [1:44:05<3:15:31, 70.67s/it] 36%|███▌      | 91/256 [1:45:19<3:16:53, 71.60s/it] 36%|███▌      | 92/256 [1:46:28<3:13:44, 70.88s/it] 36%|███▋      | 93/256 [1:47:35<3:09:16, 69.67s/it] 37%|███▋      | 94/256 [1:48:42<3:05:49, 68.83s/it] 37%|███▋      | 95/256 [1:49:49<3:02:49, 68.14s/it] 38%|███▊      | 96/256 [1:50:55<3:00:25, 67.66s/it] 38%|███▊      | 97/256 [1:52:02<2:58:18, 67.29s/it] 38%|███▊      | 98/256 [1:53:13<3:00:44, 68.64s/it] 39%|███▊      | 99/256 [1:54:20<2:58:05, 68.06s/it] 39%|███▉      | 100/256 [1:55:27<2:56:14, 67.79s/it] 39%|███▉      | 101/256 [1:56:34<2:54:06, 67.40s/it] 40%|███▉      | 102/256 [1:57:40<2:52:16, 67.12s/it] 40%|████      | 103/256 [1:58:48<2:51:42, 67.34s/it] 41%|████      | 104/256 [2:00:02<2:55:37, 69.33s/it] 41%|████      | 105/256 [2:01:18<2:59:43, 71.41s/it] 41%|████▏     | 106/256 [2:02:28<2:57:35, 71.04s/it] 42%|████▏     | 107/256 [2:03:35<2:53:04, 69.70s/it] 42%|████▏     | 108/256 [2:04:42<2:49:40, 68.79s/it] 43%|████▎     | 109/256 [2:05:49<2:47:41, 68.45s/it] 43%|████▎     | 110/256 [2:06:56<2:45:21, 67.96s/it] 43%|████▎     | 111/256 [2:08:03<2:43:18, 67.57s/it] 44%|████▍     | 112/256 [2:09:09<2:41:20, 67.22s/it] 44%|████▍     | 113/256 [2:10:16<2:39:59, 67.13s/it] 45%|████▍     | 114/256 [2:11:23<2:39:04, 67.21s/it] 45%|████▍     | 115/256 [2:12:31<2:37:51, 67.17s/it] 45%|████▌     | 116/256 [2:13:38<2:36:35, 67.11s/it] 46%|████▌     | 117/256 [2:14:44<2:34:50, 66.84s/it] 46%|████▌     | 118/256 [2:15:51<2:33:43, 66.84s/it] 46%|████▋     | 119/256 [2:16:58<2:32:43, 66.88s/it] 47%|████▋     | 120/256 [2:18:04<2:31:20, 66.77s/it] 47%|████▋     | 121/256 [2:19:11<2:30:06, 66.71s/it] 48%|████▊     | 122/256 [2:20:17<2:28:44, 66.60s/it] 48%|████▊     | 123/256 [2:21:24<2:27:43, 66.64s/it] 48%|████▊     | 124/256 [2:22:30<2:26:40, 66.67s/it] 49%|████▉     | 125/256 [2:23:37<2:25:33, 66.67s/it] 49%|████▉     | 126/256 [2:24:44<2:24:28, 66.68s/it] 50%|████▉     | 127/256 [2:25:51<2:23:46, 66.87s/it] 50%|█████     | 128/256 [2:26:58<2:22:45, 66.92s/it]2023-05-18 21:22:28 [INFO]                                    Name  ... Sparsity(%)
0                transformer.wte.weight  ...       20.00
1                transformer.wpe.weight  ...       20.00
2             transformer.h.0.attn.bias  ...       49.95
3    transformer.h.0.attn.c_attn.weight  ...       20.00
4    transformer.h.0.attn.c_proj.weight  ...       20.00
..                                  ...  ...         ...
59  transformer.h.11.attn.c_proj.weight  ...       20.00
60     transformer.h.11.mlp.c_fc.weight  ...       20.00
61   transformer.h.11.mlp.c_proj.weight  ...       20.00
62                       lm_head.weight  ...       20.00
63                      Total sparsity:  ...       22.15

[64 rows x 5 columns]
2023-05-18 21:22:28 [INFO] 22.15228021117505
/home/dsochirca/.conda/envs/test/lib/python3.7/site-packages/neural_compressor/experimental/pruner_legacy/group_lasso.py:51: RuntimeWarning: divide by zero encountered in true_divide
  coeff = self.alpha / np.linalg.norm(reshaped_weight, 2, axis=(1,3))
 50%|█████     | 129/256 [2:29:30<3:15:37, 92.42s/it] 51%|█████     | 130/256 [2:30:42<3:01:04, 86.23s/it] 51%|█████     | 131/256 [2:31:51<2:49:12, 81.22s/it] 52%|█████▏    | 132/256 [2:33:03<2:42:04, 78.43s/it] 52%|█████▏    | 133/256 [2:34:19<2:39:09, 77.64s/it] 52%|█████▏    | 134/256 [2:35:27<2:31:58, 74.74s/it] 53%|█████▎    | 135/256 [2:36:37<2:27:59, 73.39s/it] 53%|█████▎    | 136/256 [2:37:45<2:23:04, 71.54s/it] 54%|█████▎    | 137/256 [2:38:52<2:19:35, 70.39s/it] 54%|█████▍    | 138/256 [2:40:00<2:16:40, 69.49s/it] 54%|█████▍    | 139/256 [2:41:07<2:14:24, 68.93s/it] 55%|█████▍    | 140/256 [2:42:15<2:12:16, 68.42s/it] 55%|█████▌    | 141/256 [2:43:22<2:10:41, 68.19s/it] 55%|█████▌    | 142/256 [2:44:34<2:11:52, 69.41s/it] 56%|█████▌    | 143/256 [2:45:45<2:11:28, 69.81s/it] 56%|█████▋    | 144/256 [2:46:55<2:10:28, 69.90s/it] 57%|█████▋    | 145/256 [2:48:03<2:07:57, 69.17s/it] 57%|█████▋    | 146/256 [2:49:10<2:05:58, 68.71s/it] 57%|█████▋    | 147/256 [2:50:22<2:06:27, 69.61s/it] 58%|█████▊    | 148/256 [2:51:29<2:03:58, 68.88s/it] 58%|█████▊    | 149/256 [2:52:42<2:04:39, 69.90s/it] 59%|█████▊    | 150/256 [2:53:49<2:02:15, 69.20s/it] 59%|█████▉    | 151/256 [2:54:56<1:59:57, 68.55s/it] 59%|█████▉    | 152/256 [2:56:08<2:00:26, 69.49s/it] 60%|█████▉    | 153/256 [2:57:15<1:58:08, 68.82s/it] 60%|██████    | 154/256 [2:58:23<1:56:22, 68.45s/it] 61%|██████    | 155/256 [2:59:30<1:54:45, 68.17s/it] 61%|██████    | 156/256 [3:00:38<1:53:30, 68.11s/it] 61%|██████▏   | 157/256 [3:01:46<1:52:10, 67.98s/it] 62%|██████▏   | 158/256 [3:02:53<1:50:38, 67.74s/it] 62%|██████▏   | 159/256 [3:04:01<1:49:31, 67.74s/it] 62%|██████▎   | 160/256 [3:05:09<1:48:48, 68.00s/it] 63%|██████▎   | 161/256 [3:06:17<1:47:23, 67.83s/it] 63%|██████▎   | 162/256 [3:07:24<1:46:08, 67.75s/it] 64%|██████▎   | 163/256 [3:08:32<1:44:47, 67.61s/it] 64%|██████▍   | 164/256 [3:09:39<1:43:27, 67.47s/it] 64%|██████▍   | 165/256 [3:10:46<1:42:07, 67.33s/it] 65%|██████▍   | 166/256 [3:11:53<1:41:06, 67.40s/it] 65%|██████▌   | 167/256 [3:13:01<1:40:01, 67.43s/it] 66%|██████▌   | 168/256 [3:14:08<1:38:39, 67.27s/it] 66%|██████▌   | 169/256 [3:15:15<1:37:31, 67.26s/it] 66%|██████▋   | 170/256 [3:16:23<1:36:32, 67.36s/it] 67%|██████▋   | 171/256 [3:17:31<1:35:59, 67.76s/it] 67%|██████▋   | 172/256 [3:18:38<1:34:35, 67.56s/it] 68%|██████▊   | 173/256 [3:19:45<1:33:14, 67.40s/it] 68%|██████▊   | 174/256 [3:20:53<1:32:05, 67.39s/it] 68%|██████▊   | 175/256 [3:22:00<1:31:00, 67.41s/it] 69%|██████▉   | 176/256 [3:23:07<1:29:48, 67.36s/it] 69%|██████▉   | 177/256 [3:24:17<1:29:32, 68.01s/it] 70%|██████▉   | 178/256 [3:25:25<1:28:19, 67.94s/it] 70%|██████▉   | 179/256 [3:26:37<1:28:44, 69.15s/it] 70%|███████   | 180/256 [3:27:48<1:28:30, 69.88s/it] 71%|███████   | 181/256 [3:28:56<1:26:20, 69.08s/it] 71%|███████   | 182/256 [3:30:08<1:26:31, 70.15s/it] 71%|███████▏  | 183/256 [3:31:21<1:26:28, 71.07s/it] 72%|███████▏  | 184/256 [3:32:36<1:26:23, 71.99s/it] 72%|███████▏  | 185/256 [3:33:46<1:24:39, 71.54s/it] 73%|███████▎  | 186/256 [3:34:54<1:22:14, 70.49s/it] 73%|███████▎  | 187/256 [3:36:02<1:20:06, 69.67s/it] 73%|███████▎  | 188/256 [3:37:09<1:18:14, 69.04s/it] 74%|███████▍  | 189/256 [3:38:18<1:16:50, 68.81s/it] 74%|███████▍  | 190/256 [3:39:25<1:15:15, 68.42s/it] 75%|███████▍  | 191/256 [3:40:33<1:13:47, 68.12s/it] 75%|███████▌  | 192/256 [3:41:40<1:12:26, 67.91s/it] 75%|███████▌  | 193/256 [3:42:47<1:11:07, 67.75s/it] 76%|███████▌  | 194/256 [3:43:54<1:09:48, 67.56s/it] 76%|███████▌  | 195/256 [3:45:02<1:08:40, 67.55s/it] 77%|███████▋  | 196/256 [3:46:09<1:07:29, 67.49s/it] 77%|███████▋  | 197/256 [3:47:17<1:06:23, 67.51s/it] 77%|███████▋  | 198/256 [3:48:24<1:05:15, 67.51s/it] 78%|███████▊  | 199/256 [3:49:33<1:04:20, 67.72s/it] 78%|███████▊  | 200/256 [3:50:40<1:03:01, 67.53s/it] 79%|███████▊  | 201/256 [3:51:48<1:01:57, 67.60s/it] 79%|███████▉  | 202/256 [3:52:55<1:00:50, 67.60s/it] 79%|███████▉  | 203/256 [3:54:06<1:00:35, 68.60s/it] 80%|███████▉  | 204/256 [3:55:19<1:00:40, 70.01s/it] 80%|████████  | 205/256 [3:56:27<58:57, 69.36s/it]   80%|████████  | 206/256 [3:57:35<57:27, 68.95s/it] 81%|████████  | 207/256 [3:58:43<56:02, 68.63s/it] 81%|████████▏ | 208/256 [3:59:50<54:30, 68.13s/it] 82%|████████▏ | 209/256 [4:00:58<53:17, 68.03s/it] 82%|████████▏ | 210/256 [4:02:09<52:50, 68.93s/it] 82%|████████▏ | 211/256 [4:03:23<52:54, 70.54s/it] 83%|████████▎ | 212/256 [4:04:32<51:20, 70.02s/it] 83%|████████▎ | 213/256 [4:05:44<50:35, 70.59s/it] 84%|████████▎ | 214/256 [4:06:52<48:51, 69.80s/it] 84%|████████▍ | 215/256 [4:07:59<47:13, 69.11s/it] 84%|████████▍ | 216/256 [4:09:11<46:39, 70.00s/it] 85%|████████▍ | 217/256 [4:10:22<45:33, 70.10s/it] 85%|████████▌ | 218/256 [4:11:38<45:31, 71.87s/it] 86%|████████▌ | 219/256 [4:12:52<44:42, 72.49s/it] 86%|████████▌ | 220/256 [4:14:10<44:29, 74.15s/it] 86%|████████▋ | 221/256 [4:15:19<42:21, 72.62s/it] 87%|████████▋ | 222/256 [4:16:27<40:26, 71.37s/it] 87%|████████▋ | 223/256 [4:17:36<38:48, 70.55s/it] 88%|████████▊ | 224/256 [4:18:43<37:07, 69.60s/it] 88%|████████▊ | 225/256 [4:19:50<35:31, 68.77s/it] 88%|████████▊ | 226/256 [4:20:59<34:26, 68.89s/it] 89%|████████▊ | 227/256 [4:22:18<34:40, 71.75s/it] 89%|████████▉ | 228/256 [4:23:35<34:19, 73.54s/it] 89%|████████▉ | 229/256 [4:24:46<32:42, 72.67s/it] 90%|████████▉ | 230/256 [4:25:59<31:30, 72.73s/it] 90%|█████████ | 231/256 [4:27:14<30:34, 73.37s/it] 91%|█████████ | 232/256 [4:28:21<28:38, 71.62s/it] 91%|█████████ | 233/256 [4:29:31<27:13, 71.03s/it] 91%|█████████▏| 234/256 [4:30:39<25:46, 70.28s/it] 92%|█████████▏| 235/256 [4:31:47<24:20, 69.53s/it] 92%|█████████▏| 236/256 [4:32:57<23:10, 69.51s/it] 93%|█████████▎| 237/256 [4:34:13<22:40, 71.60s/it] 93%|█████████▎| 238/256 [4:35:36<22:29, 74.98s/it] 93%|█████████▎| 239/256 [4:36:52<21:20, 75.33s/it] 94%|█████████▍| 240/256 [4:38:10<20:15, 75.98s/it] 94%|█████████▍| 241/256 [4:39:27<19:05, 76.39s/it] 95%|█████████▍| 242/256 [4:40:39<17:31, 75.13s/it] 95%|█████████▍| 243/256 [4:41:52<16:07, 74.44s/it] 95%|█████████▌| 244/256 [4:43:09<15:01, 75.14s/it] 96%|█████████▌| 245/256 [4:44:22<13:38, 74.43s/it] 96%|█████████▌| 246/256 [4:45:36<12:25, 74.53s/it] 96%|█████████▋| 247/256 [4:46:55<11:21, 75.75s/it] 97%|█████████▋| 248/256 [4:48:03<09:48, 73.57s/it] 97%|█████████▋| 249/256 [4:49:15<08:29, 72.83s/it] 98%|█████████▊| 250/256 [4:50:25<07:13, 72.25s/it] 98%|█████████▊| 251/256 [4:51:33<05:54, 70.86s/it] 98%|█████████▊| 252/256 [4:52:45<04:45, 71.30s/it] 99%|█████████▉| 253/256 [4:54:03<03:39, 73.23s/it] 99%|█████████▉| 254/256 [4:55:17<02:27, 73.54s/it]100%|█████████▉| 255/256 [4:56:26<01:12, 72.13s/it]100%|██████████| 256/256 [4:57:37<00:00, 71.72s/it]2023-05-18 23:53:07 [INFO] Set transformer.wte.weight sparsity with mask 38400768 23040459 0.40000004687406254.
2023-05-18 23:53:07 [INFO] Set transformer.wpe.weight sparsity with mask 786432 471859 0.400000254313151.
2023-05-18 23:53:07 [INFO] Set transformer.h.0.attn.c_attn.weight sparsity with mask 1769472 1061683 0.40000011302806715.
2023-05-18 23:53:07 [INFO] Set transformer.h.0.attn.c_proj.weight sparsity with mask 589824 353894 0.4000006781684028.
2023-05-18 23:53:07 [INFO] Set transformer.h.0.mlp.c_fc.weight sparsity with mask 2359296 1415577 0.400000254313151.
2023-05-18 23:53:07 [INFO] Set transformer.h.0.mlp.c_proj.weight sparsity with mask 2359296 1415577 0.400000254313151.
2023-05-18 23:53:07 [INFO] Set transformer.h.1.attn.c_attn.weight sparsity with mask 1769472 1061682 0.4000006781684028.
2023-05-18 23:53:07 [INFO] Set transformer.h.1.attn.c_proj.weight sparsity with mask 589824 353894 0.4000006781684028.
2023-05-18 23:53:07 [INFO] Set transformer.h.1.mlp.c_fc.weight sparsity with mask 2359296 1415577 0.400000254313151.
2023-05-18 23:53:07 [INFO] Set transformer.h.1.mlp.c_proj.weight sparsity with mask 2359296 1415577 0.400000254313151.
2023-05-18 23:53:07 [INFO] Set transformer.h.2.attn.c_attn.weight sparsity with mask 1769472 1061683 0.40000011302806715.
2023-05-18 23:53:07 [INFO] Set transformer.h.2.attn.c_proj.weight sparsity with mask 589824 353894 0.4000006781684028.
2023-05-18 23:53:07 [INFO] Set transformer.h.2.mlp.c_fc.weight sparsity with mask 2359296 1415577 0.400000254313151.
2023-05-18 23:53:07 [INFO] Set transformer.h.2.mlp.c_proj.weight sparsity with mask 2359296 1415577 0.400000254313151.
2023-05-18 23:53:07 [INFO] Set transformer.h.3.attn.c_attn.weight sparsity with mask 1769472 1061683 0.40000011302806715.
2023-05-18 23:53:07 [INFO] Set transformer.h.3.attn.c_proj.weight sparsity with mask 589824 353894 0.4000006781684028.
2023-05-18 23:53:07 [INFO] Set transformer.h.3.mlp.c_fc.weight sparsity with mask 2359296 1415577 0.400000254313151.
2023-05-18 23:53:07 [INFO] Set transformer.h.3.mlp.c_proj.weight sparsity with mask 2359296 1415577 0.400000254313151.
2023-05-18 23:53:07 [INFO] Set transformer.h.4.attn.c_attn.weight sparsity with mask 1769472 1061683 0.40000011302806715.
2023-05-18 23:53:07 [INFO] Set transformer.h.4.attn.c_proj.weight sparsity with mask 589824 353894 0.4000006781684028.
2023-05-18 23:53:07 [INFO] Set transformer.h.4.mlp.c_fc.weight sparsity with mask 2359296 1415577 0.400000254313151.
2023-05-18 23:53:07 [INFO] Set transformer.h.4.mlp.c_proj.weight sparsity with mask 2359296 1415577 0.400000254313151.
2023-05-18 23:53:07 [INFO] Set transformer.h.5.attn.c_attn.weight sparsity with mask 1769472 1061683 0.40000011302806715.
2023-05-18 23:53:07 [INFO] Set transformer.h.5.attn.c_proj.weight sparsity with mask 589824 353894 0.4000006781684028.
2023-05-18 23:53:07 [INFO] Set transformer.h.5.mlp.c_fc.weight sparsity with mask 2359296 1415577 0.400000254313151.
2023-05-18 23:53:07 [INFO] Set transformer.h.5.mlp.c_proj.weight sparsity with mask 2359296 1415575 0.40000110202365446.
2023-05-18 23:53:07 [INFO] Set transformer.h.6.attn.c_attn.weight sparsity with mask 1769472 1061683 0.40000011302806715.
2023-05-18 23:53:07 [INFO] Set transformer.h.6.attn.c_proj.weight sparsity with mask 589824 353894 0.4000006781684028.
2023-05-18 23:53:07 [INFO] Set transformer.h.6.mlp.c_fc.weight sparsity with mask 2359296 1415576 0.4000006781684028.
2023-05-18 23:53:07 [INFO] Set transformer.h.6.mlp.c_proj.weight sparsity with mask 2359296 1415577 0.400000254313151.
2023-05-18 23:53:07 [INFO] Set transformer.h.7.attn.c_attn.weight sparsity with mask 1769472 1061683 0.40000011302806715.
2023-05-18 23:53:07 [INFO] Set transformer.h.7.attn.c_proj.weight sparsity with mask 589824 353894 0.4000006781684028.
2023-05-18 23:53:07 [INFO] Set transformer.h.7.mlp.c_fc.weight sparsity with mask 2359296 1415577 0.400000254313151.
2023-05-18 23:53:07 [INFO] Set transformer.h.7.mlp.c_proj.weight sparsity with mask 2359296 1415577 0.400000254313151.
2023-05-18 23:53:07 [INFO] Set transformer.h.8.attn.c_attn.weight sparsity with mask 1769472 1061683 0.40000011302806715.
2023-05-18 23:53:07 [INFO] Set transformer.h.8.attn.c_proj.weight sparsity with mask 589824 353894 0.4000006781684028.
2023-05-18 23:53:07 [INFO] Set transformer.h.8.mlp.c_fc.weight sparsity with mask 2359296 1415577 0.400000254313151.
2023-05-18 23:53:07 [INFO] Set transformer.h.8.mlp.c_proj.weight sparsity with mask 2359296 1415577 0.400000254313151.
2023-05-18 23:53:07 [INFO] Set transformer.h.9.attn.c_attn.weight sparsity with mask 1769472 1061683 0.40000011302806715.
2023-05-18 23:53:07 [INFO] Set transformer.h.9.attn.c_proj.weight sparsity with mask 589824 353894 0.4000006781684028.
2023-05-18 23:53:07 [INFO] Set transformer.h.9.mlp.c_fc.weight sparsity with mask 2359296 1415577 0.400000254313151.
2023-05-18 23:53:07 [INFO] Set transformer.h.9.mlp.c_proj.weight sparsity with mask 2359296 1415577 0.400000254313151.
2023-05-18 23:53:07 [INFO] Set transformer.h.10.attn.c_attn.weight sparsity with mask 1769472 1061683 0.40000011302806715.
2023-05-18 23:53:07 [INFO] Set transformer.h.10.attn.c_proj.weight sparsity with mask 589824 353894 0.4000006781684028.
2023-05-18 23:53:07 [INFO] Set transformer.h.10.mlp.c_fc.weight sparsity with mask 2359296 1415577 0.400000254313151.
2023-05-18 23:53:07 [INFO] Set transformer.h.10.mlp.c_proj.weight sparsity with mask 2359296 1415577 0.400000254313151.
2023-05-18 23:53:07 [INFO] Set transformer.h.11.attn.c_attn.weight sparsity with mask 1769472 1061683 0.40000011302806715.
2023-05-18 23:53:07 [INFO] Set transformer.h.11.attn.c_proj.weight sparsity with mask 589824 353894 0.4000006781684028.
2023-05-18 23:53:07 [INFO] Set transformer.h.11.mlp.c_fc.weight sparsity with mask 2359296 1415577 0.400000254313151.
2023-05-18 23:53:07 [INFO] Set transformer.h.11.mlp.c_proj.weight sparsity with mask 2359296 1415577 0.400000254313151.
2023-05-18 23:53:08 [INFO]                                    Name  ... Sparsity(%)
0                transformer.wte.weight  ...       40.00
1                transformer.wpe.weight  ...       40.00
2             transformer.h.0.attn.bias  ...       49.95
3    transformer.h.0.attn.c_attn.weight  ...       40.00
4    transformer.h.0.attn.c_proj.weight  ...       40.00
..                                  ...  ...         ...
59  transformer.h.11.attn.c_proj.weight  ...       40.00
60     transformer.h.11.mlp.c_fc.weight  ...       40.00
61   transformer.h.11.mlp.c_proj.weight  ...       40.00
62                       lm_head.weight  ...       40.00
63                      Total sparsity:  ...       40.72

[64 rows x 5 columns]
2023-05-18 23:53:08 [INFO] 40.71509823652863
2023-05-18 23:53:08 [INFO] 

Training completed. Do not forget to share your model on huggingface.co/models =)


                                                   100%|██████████| 256/256 [4:57:39<00:00, 71.72s/it]100%|██████████| 256/256 [4:57:39<00:00, 69.76s/it]
2023-05-18 23:53:08 [INFO] Saving model checkpoint to ./test_epoch
2023-05-18 23:53:10 [INFO] Model pruning is done. Start to evaluate the pruned model.
2023-05-18 23:53:10 [INFO] Pruned model score is [].
2023-05-18 23:53:11 [INFO]                                    Name  ... Sparsity(%)
0                transformer.wte.weight  ...       40.00
1                transformer.wpe.weight  ...       40.00
2             transformer.h.0.attn.bias  ...       49.95
3    transformer.h.0.attn.c_attn.weight  ...       40.00
4    transformer.h.0.attn.c_proj.weight  ...       40.00
..                                  ...  ...         ...
59  transformer.h.11.attn.c_proj.weight  ...       40.00
60     transformer.h.11.mlp.c_fc.weight  ...       40.00
61   transformer.h.11.mlp.c_proj.weight  ...       40.00
62                       lm_head.weight  ...       40.00
63                      Total sparsity:  ...       40.72

[64 rows x 5 columns]
2023-05-18 23:53:11 [INFO] 40.71509823652863
2023-05-18 23:53:11 [INFO] Saving model checkpoint to ./CodeGPT-Py150_pruned_40.0%_sparsity
2023-05-18 23:53:13 [WARNING] Force convert framework model to neural_compressor model.
2023-05-18 23:53:13 [INFO] Start to get the baseline model's score before pruning.
2023-05-18 23:53:13 [INFO] Baseline model's score is [].
2023-05-18 23:53:13 [INFO] Model pruning begins.
2023-05-18 23:53:13 [INFO] The following columns in the training set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: output, code, input.
/home/dsochirca/.conda/envs/test/lib/python3.7/site-packages/transformers/optimization.py:395: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  FutureWarning,
2023-05-18 23:53:13 [INFO] ***** Running training *****
2023-05-18 23:53:13 [INFO]   Num examples = 128
2023-05-18 23:53:13 [INFO]   Num Epochs = 2
2023-05-18 23:53:13 [INFO]   Instantaneous batch size per device = 1
2023-05-18 23:53:13 [INFO]   Total train batch size (w. parallel, distributed & accumulation) = 1
2023-05-18 23:53:13 [INFO]   Gradient Accumulation steps = 1
2023-05-18 23:53:13 [INFO]   Total optimization steps = 256
  0%|          | 0/256 [00:00<?, ?it/s]/home/dsochirca/.conda/envs/test/lib/python3.7/site-packages/neural_compressor/experimental/pruner_legacy/group_lasso.py:51: RuntimeWarning: divide by zero encountered in true_divide
  coeff = self.alpha / np.linalg.norm(reshaped_weight, 2, axis=(1,3))
  0%|          | 1/256 [02:26<10:24:31, 146.95s/it]  1%|          | 2/256 [03:39<7:15:47, 102.94s/it]   1%|          | 3/256 [04:51<6:15:52, 89.14s/it]   2%|▏         | 4/256 [06:04<5:47:45, 82.80s/it]  2%|▏         | 5/256 [07:19<5:33:37, 79.75s/it]  2%|▏         | 6/256 [08:29<5:19:09, 76.60s/it]  3%|▎         | 7/256 [09:40<5:09:34, 74.60s/it]  3%|▎         | 8/256 [10:59<5:14:13, 76.02s/it]  4%|▎         | 9/256 [12:06<5:02:17, 73.43s/it]  4%|▍         | 10/256 [13:13<4:52:50, 71.43s/it]  4%|▍         | 11/256 [14:26<4:53:14, 71.82s/it]  5%|▍         | 12/256 [15:41<4:56:24, 72.89s/it]  5%|▌         | 13/256 [16:58<4:59:50, 74.03s/it]  5%|▌         | 14/256 [18:12<4:58:15, 73.95s/it]  6%|▌         | 15/256 [19:29<5:00:29, 74.81s/it]  6%|▋         | 16/256 [20:48<5:04:59, 76.25s/it]  7%|▋         | 17/256 [21:58<4:55:46, 74.25s/it]  7%|▋         | 18/256 [23:12<4:53:46, 74.06s/it]  7%|▋         | 19/256 [24:21<4:47:10, 72.70s/it]  8%|▊         | 20/256 [25:31<4:42:29, 71.82s/it]  8%|▊         | 21/256 [26:41<4:39:50, 71.45s/it]  9%|▊         | 22/256 [27:53<4:38:44, 71.47s/it]  9%|▉         | 23/256 [29:07<4:40:14, 72.17s/it]  9%|▉         | 24/256 [30:17<4:36:52, 71.60s/it] 10%|▉         | 25/256 [31:28<4:35:05, 71.45s/it] 10%|█         | 26/256 [32:36<4:29:25, 70.29s/it] 11%|█         | 27/256 [33:43<4:25:07, 69.46s/it] 11%|█         | 28/256 [34:51<4:22:10, 69.00s/it] 11%|█▏        | 29/256 [35:59<4:19:42, 68.64s/it] 12%|█▏        | 30/256 [37:07<4:17:53, 68.47s/it] 12%|█▏        | 31/256 [38:15<4:15:58, 68.26s/it] 12%|█▎        | 32/256 [39:23<4:14:38, 68.21s/it] 13%|█▎        | 33/256 [40:31<4:13:17, 68.15s/it] 13%|█▎        | 34/256 [41:41<4:14:00, 68.65s/it] 14%|█▎        | 35/256 [42:54<4:17:55, 70.02s/it] 14%|█▍        | 36/256 [44:04<4:16:54, 70.06s/it] 14%|█▍        | 37/256 [45:13<4:14:14, 69.66s/it] 15%|█▍        | 38/256 [46:21<4:11:01, 69.09s/it] 15%|█▌        | 39/256 [47:29<4:08:40, 68.76s/it] 16%|█▌        | 40/256 [48:40<4:10:52, 69.69s/it] 16%|█▌        | 41/256 [50:02<4:22:25, 73.24s/it] 16%|█▋        | 42/256 [51:19<4:25:41, 74.50s/it] 17%|█▋        | 43/256 [52:34<4:24:59, 74.64s/it] 17%|█▋        | 44/256 [53:42<4:16:33, 72.61s/it] 18%|█▊        | 45/256 [54:50<4:10:46, 71.31s/it] 18%|█▊        | 46/256 [55:58<4:06:02, 70.30s/it] 18%|█▊        | 47/256 [57:06<4:02:26, 69.60s/it] 19%|█▉        | 48/256 [58:14<3:58:59, 68.94s/it] 19%|█▉        | 49/256 [59:21<3:56:10, 68.46s/it] 20%|█▉        | 50/256 [1:00:29<3:54:04, 68.18s/it] 20%|█▉        | 51/256 [1:01:37<3:52:39, 68.10s/it] 20%|██        | 52/256 [1:02:44<3:50:50, 67.89s/it] 21%|██        | 53/256 [1:03:52<3:50:16, 68.06s/it] 21%|██        | 54/256 [1:05:00<3:48:21, 67.83s/it] 21%|██▏       | 55/256 [1:06:12<3:51:31, 69.11s/it] 22%|██▏       | 56/256 [1:07:27<3:56:30, 70.95s/it] 22%|██▏       | 57/256 [1:08:35<3:52:13, 70.02s/it] 23%|██▎       | 58/256 [1:09:42<3:48:31, 69.25s/it] 23%|██▎       | 59/256 [1:10:50<3:45:42, 68.74s/it] 23%|██▎       | 60/256 [1:11:57<3:43:19, 68.36s/it] 24%|██▍       | 61/256 [1:13:05<3:41:32, 68.17s/it] 24%|██▍       | 62/256 [1:14:12<3:39:33, 67.90s/it] 25%|██▍       | 63/256 [1:15:20<3:37:56, 67.76s/it] 25%|██▌       | 64/256 [1:16:28<3:36:47, 67.75s/it] 25%|██▌       | 65/256 [1:17:35<3:35:34, 67.72s/it] 26%|██▌       | 66/256 [1:18:42<3:33:52, 67.54s/it] 26%|██▌       | 67/256 [1:19:50<3:32:58, 67.61s/it] 27%|██▋       | 68/256 [1:20:59<3:33:13, 68.05s/it] 27%|██▋       | 69/256 [1:22:09<3:33:53, 68.63s/it] 27%|██▋       | 70/256 [1:23:17<3:31:42, 68.29s/it] 28%|██▊       | 71/256 [1:24:24<3:29:55, 68.09s/it] 28%|██▊       | 72/256 [1:25:33<3:29:08, 68.20s/it] 29%|██▊       | 73/256 [1:26:41<3:27:59, 68.19s/it] 29%|██▉       | 74/256 [1:27:48<3:26:18, 68.02s/it] 29%|██▉       | 75/256 [1:28:56<3:24:41, 67.85s/it] 30%|██▉       | 76/256 [1:30:04<3:23:26, 67.81s/it] 30%|███       | 77/256 [1:31:12<3:22:31, 67.88s/it] 30%|███       | 78/256 [1:32:19<3:21:17, 67.85s/it] 31%|███       | 79/256 [1:33:28<3:21:03, 68.15s/it] 31%|███▏      | 80/256 [1:34:40<3:22:42, 69.10s/it] 32%|███▏      | 81/256 [1:35:47<3:20:01, 68.58s/it] 32%|███▏      | 82/256 [1:36:55<3:18:03, 68.30s/it] 32%|███▏      | 83/256 [1:38:02<3:16:18, 68.08s/it] 33%|███▎      | 84/256 [1:39:10<3:14:33, 67.87s/it] 33%|███▎      | 85/256 [1:40:18<3:13:37, 67.94s/it] 34%|███▎      | 86/256 [1:41:26<3:12:42, 68.01s/it] 34%|███▍      | 87/256 [1:42:34<3:11:42, 68.06s/it] 34%|███▍      | 88/256 [1:43:44<3:11:46, 68.49s/it] 35%|███▍      | 89/256 [1:44:51<3:09:33, 68.10s/it] 35%|███▌      | 90/256 [1:45:58<3:08:06, 67.99s/it] 36%|███▌      | 91/256 [1:47:09<3:09:04, 68.76s/it] 36%|███▌      | 92/256 [1:48:21<3:10:24, 69.66s/it] 36%|███▋      | 93/256 [1:49:29<3:07:47, 69.13s/it] 37%|███▋      | 94/256 [1:50:36<3:05:15, 68.61s/it] 37%|███▋      | 95/256 [1:51:44<3:03:39, 68.44s/it] 38%|███▊      | 96/256 [1:52:52<3:01:44, 68.15s/it] 38%|███▊      | 97/256 [1:53:59<3:00:14, 68.02s/it] 38%|███▊      | 98/256 [1:55:07<2:59:03, 68.00s/it] 39%|███▊      | 99/256 [1:56:15<2:57:52, 67.98s/it] 39%|███▉      | 100/256 [1:57:23<2:56:41, 67.96s/it] 39%|███▉      | 101/256 [1:58:31<2:55:31, 67.95s/it] 40%|███▉      | 102/256 [1:59:38<2:53:59, 67.79s/it] 40%|████      | 103/256 [2:00:46<2:52:48, 67.77s/it] 41%|████      | 104/256 [2:01:54<2:51:21, 67.64s/it] 41%|████      | 105/256 [2:03:01<2:50:24, 67.71s/it] 41%|████▏     | 106/256 [2:04:09<2:49:08, 67.66s/it] 42%|████▏     | 107/256 [2:05:17<2:48:10, 67.72s/it] 42%|████▏     | 108/256 [2:06:25<2:47:29, 67.90s/it] 43%|████▎     | 109/256 [2:07:33<2:46:24, 67.92s/it] 43%|████▎     | 110/256 [2:08:41<2:45:14, 67.91s/it] 43%|████▎     | 111/256 [2:09:49<2:44:02, 67.88s/it] 44%|████▍     | 112/256 [2:10:56<2:42:47, 67.83s/it] 44%|████▍     | 113/256 [2:12:05<2:41:54, 67.94s/it] 45%|████▍     | 114/256 [2:13:12<2:40:31, 67.83s/it] 45%|████▍     | 115/256 [2:14:20<2:39:07, 67.71s/it] 45%|████▌     | 116/256 [2:15:28<2:38:09, 67.78s/it] 46%|████▌     | 117/256 [2:16:35<2:36:50, 67.70s/it] 46%|████▌     | 118/256 [2:17:43<2:35:28, 67.60s/it] 46%|████▋     | 119/256 [2:18:50<2:34:09, 67.51s/it] 47%|████▋     | 120/256 [2:19:57<2:33:03, 67.52s/it] 47%|████▋     | 121/256 [2:21:05<2:31:56, 67.53s/it] 48%|████▊     | 122/256 [2:22:13<2:30:52, 67.55s/it] 48%|████▊     | 123/256 [2:23:20<2:29:50, 67.60s/it] 48%|████▊     | 124/256 [2:24:28<2:28:43, 67.60s/it] 49%|████▉     | 125/256 [2:25:36<2:27:47, 67.69s/it] 49%|████▉     | 126/256 [2:26:44<2:26:48, 67.76s/it] 50%|████▉     | 127/256 [2:27:52<2:25:48, 67.82s/it] 50%|█████     | 128/256 [2:29:01<2:25:32, 68.22s/it]2023-05-19 02:22:15 [INFO]                                    Name  ... Sparsity(%)
0                transformer.wte.weight  ...       40.00
1                transformer.wpe.weight  ...       40.00
2             transformer.h.0.attn.bias  ...       49.95
3    transformer.h.0.attn.c_attn.weight  ...       40.00
4    transformer.h.0.attn.c_proj.weight  ...       40.00
..                                  ...  ...         ...
59  transformer.h.11.attn.c_proj.weight  ...       40.00
60     transformer.h.11.mlp.c_fc.weight  ...       40.00
61   transformer.h.11.mlp.c_proj.weight  ...       40.00
62                       lm_head.weight  ...       40.00
63                      Total sparsity:  ...       40.72

[64 rows x 5 columns]
2023-05-19 02:22:15 [INFO] 40.71509823652863
/home/dsochirca/.conda/envs/test/lib/python3.7/site-packages/neural_compressor/experimental/pruner_legacy/group_lasso.py:51: RuntimeWarning: divide by zero encountered in true_divide
  coeff = self.alpha / np.linalg.norm(reshaped_weight, 2, axis=(1,3))
 50%|█████     | 129/256 [2:31:19<3:08:46, 89.19s/it] 51%|█████     | 130/256 [2:32:27<2:53:45, 82.74s/it] 51%|█████     | 131/256 [2:33:35<2:43:13, 78.35s/it] 52%|█████▏    | 132/256 [2:34:43<2:35:34, 75.28s/it] 52%|█████▏    | 133/256 [2:35:52<2:30:27, 73.39s/it] 52%|█████▏    | 134/256 [2:37:00<2:25:58, 71.79s/it] 53%|█████▎    | 135/256 [2:38:08<2:22:31, 70.67s/it] 53%|█████▎    | 136/256 [2:39:16<2:19:41, 69.84s/it] 54%|█████▎    | 137/256 [2:40:24<2:17:21, 69.26s/it] 54%|█████▍    | 138/256 [2:41:32<2:15:35, 68.94s/it] 54%|█████▍    | 139/256 [2:42:40<2:13:53, 68.66s/it] 55%|█████▍    | 140/256 [2:43:48<2:12:09, 68.35s/it] 55%|█████▌    | 141/256 [2:44:56<2:10:53, 68.29s/it] 55%|█████▌    | 142/256 [2:46:03<2:09:19, 68.06s/it] 56%|█████▌    | 143/256 [2:47:11<2:08:09, 68.05s/it] 56%|█████▋    | 144/256 [2:48:19<2:06:52, 67.97s/it] 57%|█████▋    | 145/256 [2:49:27<2:05:38, 67.92s/it] 57%|█████▋    | 146/256 [2:50:35<2:04:23, 67.85s/it] 57%|█████▋    | 147/256 [2:51:42<2:03:13, 67.83s/it] 58%|█████▊    | 148/256 [2:52:50<2:02:06, 67.84s/it] 58%|█████▊    | 149/256 [2:53:58<2:01:04, 67.90s/it] 59%|█████▊    | 150/256 [2:55:06<2:00:05, 67.98s/it] 59%|█████▉    | 151/256 [2:56:14<1:58:39, 67.81s/it] 59%|█████▉    | 152/256 [2:57:22<1:57:34, 67.83s/it] 60%|█████▉    | 153/256 [2:58:30<1:56:27, 67.84s/it] 60%|██████    | 154/256 [2:59:37<1:55:22, 67.87s/it] 61%|██████    | 155/256 [3:00:51<1:56:54, 69.45s/it] 61%|██████    | 156/256 [3:02:01<1:56:22, 69.82s/it] 61%|██████▏   | 157/256 [3:03:09<1:54:22, 69.32s/it] 62%|██████▏   | 158/256 [3:04:17<1:52:21, 68.79s/it] 62%|██████▏   | 159/256 [3:05:25<1:50:38, 68.44s/it] 62%|██████▎   | 160/256 [3:06:33<1:49:18, 68.31s/it] 63%|██████▎   | 161/256 [3:07:40<1:47:50, 68.12s/it] 63%|██████▎   | 162/256 [3:08:49<1:46:54, 68.24s/it] 64%|██████▎   | 163/256 [3:09:56<1:45:16, 67.92s/it] 64%|██████▍   | 164/256 [3:11:04<1:44:08, 67.92s/it] 64%|██████▍   | 165/256 [3:12:12<1:43:02, 67.94s/it] 65%|██████▍   | 166/256 [3:13:20<1:41:49, 67.88s/it] 65%|██████▌   | 167/256 [3:14:27<1:40:31, 67.76s/it] 66%|██████▌   | 168/256 [3:15:35<1:39:29, 67.84s/it] 66%|██████▌   | 169/256 [3:16:42<1:38:02, 67.62s/it] 66%|██████▋   | 170/256 [3:17:50<1:36:54, 67.61s/it] 67%|██████▋   | 171/256 [3:18:57<1:35:45, 67.59s/it] 67%|██████▋   | 172/256 [3:20:04<1:34:24, 67.43s/it] 68%|██████▊   | 173/256 [3:21:12<1:33:14, 67.40s/it] 68%|██████▊   | 174/256 [3:22:19<1:32:10, 67.44s/it] 68%|██████▊   | 175/256 [3:23:27<1:31:03, 67.45s/it] 69%|██████▉   | 176/256 [3:24:35<1:30:03, 67.54s/it] 69%|██████▉   | 177/256 [3:25:42<1:28:47, 67.43s/it] 70%|██████▉   | 178/256 [3:26:52<1:28:57, 68.43s/it] 70%|██████▉   | 179/256 [3:28:01<1:27:41, 68.33s/it] 70%|███████   | 180/256 [3:29:08<1:26:17, 68.13s/it] 71%|███████   | 181/256 [3:30:16<1:25:04, 68.06s/it] 71%|███████   | 182/256 [3:31:24<1:23:41, 67.86s/it] 71%|███████▏  | 183/256 [3:32:31<1:22:26, 67.76s/it] 72%|███████▏  | 184/256 [3:33:39<1:21:14, 67.70s/it] 72%|███████▏  | 185/256 [3:34:46<1:20:02, 67.64s/it] 73%|███████▎  | 186/256 [3:35:54<1:19:01, 67.73s/it] 73%|███████▎  | 187/256 [3:37:02<1:17:54, 67.75s/it] 73%|███████▎  | 188/256 [3:38:09<1:16:31, 67.52s/it] 74%|███████▍  | 189/256 [3:39:17<1:15:28, 67.59s/it] 74%|███████▍  | 190/256 [3:40:24<1:14:13, 67.48s/it] 75%|███████▍  | 191/256 [3:41:32<1:13:10, 67.55s/it] 75%|███████▌  | 192/256 [3:42:39<1:11:58, 67.47s/it] 75%|███████▌  | 193/256 [3:43:46<1:10:52, 67.49s/it] 76%|███████▌  | 194/256 [3:44:54<1:09:43, 67.47s/it] 76%|███████▌  | 195/256 [3:46:01<1:08:32, 67.42s/it] 77%|███████▋  | 196/256 [3:47:09<1:07:29, 67.49s/it] 77%|███████▋  | 197/256 [3:48:16<1:06:17, 67.41s/it] 77%|███████▋  | 198/256 [3:49:23<1:05:05, 67.33s/it] 78%|███████▊  | 199/256 [3:50:31<1:04:01, 67.39s/it] 78%|███████▊  | 200/256 [3:51:39<1:03:02, 67.55s/it] 79%|███████▊  | 201/256 [3:52:47<1:02:10, 67.83s/it] 79%|███████▉  | 202/256 [3:53:58<1:01:53, 68.76s/it] 79%|███████▉  | 203/256 [3:55:07<1:00:53, 68.93s/it] 80%|███████▉  | 204/256 [3:56:15<59:22, 68.51s/it]   80%|████████  | 205/256 [3:57:23<58:02, 68.29s/it] 80%|████████  | 206/256 [3:58:31<56:51, 68.23s/it] 81%|████████  | 207/256 [3:59:39<55:41, 68.19s/it] 81%|████████▏ | 208/256 [4:00:47<54:27, 68.06s/it] 82%|████████▏ | 209/256 [4:01:54<53:13, 67.95s/it] 82%|████████▏ | 210/256 [4:03:02<52:06, 67.98s/it] 82%|████████▏ | 211/256 [4:04:14<51:49, 69.09s/it] 83%|████████▎ | 212/256 [4:05:22<50:28, 68.83s/it] 83%|████████▎ | 213/256 [4:06:30<49:06, 68.52s/it] 84%|████████▎ | 214/256 [4:07:41<48:29, 69.28s/it] 84%|████████▍ | 215/256 [4:08:59<49:02, 71.78s/it] 84%|████████▍ | 216/256 [4:10:06<47:00, 70.51s/it] 85%|████████▍ | 217/256 [4:11:14<45:23, 69.83s/it] 85%|████████▌ | 218/256 [4:12:22<43:48, 69.16s/it] 86%|████████▌ | 219/256 [4:13:30<42:20, 68.67s/it] 86%|████████▌ | 220/256 [4:14:38<41:04, 68.45s/it] 86%|████████▋ | 221/256 [4:15:45<39:48, 68.25s/it] 87%|████████▋ | 222/256 [4:16:53<38:32, 68.01s/it] 87%|████████▋ | 223/256 [4:18:01<37:22, 67.97s/it] 88%|████████▊ | 224/256 [4:19:08<36:11, 67.85s/it] 88%|████████▊ | 225/256 [4:20:16<35:00, 67.76s/it] 88%|████████▊ | 226/256 [4:21:24<33:54, 67.80s/it] 89%|████████▊ | 227/256 [4:22:31<32:45, 67.79s/it] 89%|████████▉ | 228/256 [4:23:39<31:39, 67.83s/it] 89%|████████▉ | 229/256 [4:24:48<30:38, 68.10s/it] 90%|████████▉ | 230/256 [4:25:56<29:31, 68.15s/it] 90%|█████████ | 231/256 [4:27:04<28:19, 67.98s/it] 91%|█████████ | 232/256 [4:28:12<27:12, 68.03s/it] 91%|█████████ | 233/256 [4:29:24<26:34, 69.30s/it] 91%|█████████▏| 234/256 [4:30:32<25:15, 68.90s/it] 92%|█████████▏| 235/256 [4:31:40<24:01, 68.62s/it] 92%|█████████▏| 236/256 [4:32:52<23:11, 69.58s/it] 93%|█████████▎| 237/256 [4:34:00<21:51, 69.01s/it] 93%|█████████▎| 238/256 [4:35:08<20:37, 68.73s/it] 93%|█████████▎| 239/256 [4:36:16<19:24, 68.49s/it] 94%|█████████▍| 240/256 [4:37:23<18:11, 68.24s/it] 94%|█████████▍| 241/256 [4:38:32<17:03, 68.22s/it] 95%|█████████▍| 242/256 [4:39:39<15:52, 68.03s/it] 95%|█████████▍| 243/256 [4:40:47<14:44, 68.00s/it] 95%|█████████▌| 244/256 [4:42:01<13:55, 69.65s/it] 96%|█████████▌| 245/256 [4:43:08<12:39, 69.09s/it] 96%|█████████▌| 246/256 [4:44:19<11:34, 69.43s/it] 96%|█████████▋| 247/256 [4:45:27<10:21, 69.05s/it] 97%|█████████▋| 248/256 [4:46:35<09:09, 68.74s/it] 97%|█████████▋| 249/256 [4:47:43<07:59, 68.49s/it] 98%|█████████▊| 250/256 [4:48:51<06:49, 68.32s/it] 98%|█████████▊| 251/256 [4:49:58<05:40, 68.19s/it] 98%|█████████▊| 252/256 [4:51:06<04:32, 68.09s/it] 99%|█████████▉| 253/256 [4:52:14<03:24, 68.07s/it] 99%|█████████▉| 254/256 [4:53:23<02:16, 68.18s/it]100%|█████████▉| 255/256 [4:54:31<01:08, 68.12s/it]100%|██████████| 256/256 [4:55:39<00:00, 68.04s/it]2023-05-19 04:48:53 [INFO] Set transformer.wte.weight sparsity with mask 38400768 19200383 0.5000000260411459.
2023-05-19 04:48:53 [INFO] Set transformer.wpe.weight sparsity with mask 786432 393215 0.5000012715657551.
2023-05-19 04:48:53 [INFO] Set transformer.h.0.attn.c_attn.weight sparsity with mask 1769472 884735 0.5000005651403356.
2023-05-19 04:48:53 [INFO] Set transformer.h.0.attn.c_proj.weight sparsity with mask 589824 294911 0.5000016954210069.
2023-05-19 04:48:53 [INFO] Set transformer.h.0.mlp.c_fc.weight sparsity with mask 2359296 1179647 0.5000004238552518.
2023-05-19 04:48:53 [INFO] Set transformer.h.0.mlp.c_proj.weight sparsity with mask 2359296 1179647 0.5000004238552518.
2023-05-19 04:48:53 [INFO] Set transformer.h.1.attn.c_attn.weight sparsity with mask 1769472 884735 0.5000005651403356.
2023-05-19 04:48:53 [INFO] Set transformer.h.1.attn.c_proj.weight sparsity with mask 589824 294911 0.5000016954210069.
2023-05-19 04:48:53 [INFO] Set transformer.h.1.mlp.c_fc.weight sparsity with mask 2359296 1179647 0.5000004238552518.
2023-05-19 04:48:53 [INFO] Set transformer.h.1.mlp.c_proj.weight sparsity with mask 2359296 1179647 0.5000004238552518.
2023-05-19 04:48:53 [INFO] Set transformer.h.2.attn.c_attn.weight sparsity with mask 1769472 884735 0.5000005651403356.
2023-05-19 04:48:53 [INFO] Set transformer.h.2.attn.c_proj.weight sparsity with mask 589824 294911 0.5000016954210069.
2023-05-19 04:48:53 [INFO] Set transformer.h.2.mlp.c_fc.weight sparsity with mask 2359296 1179647 0.5000004238552518.
2023-05-19 04:48:53 [INFO] Set transformer.h.2.mlp.c_proj.weight sparsity with mask 2359296 1179647 0.5000004238552518.
2023-05-19 04:48:53 [INFO] Set transformer.h.3.attn.c_attn.weight sparsity with mask 1769472 884735 0.5000005651403356.
2023-05-19 04:48:53 [INFO] Set transformer.h.3.attn.c_proj.weight sparsity with mask 589824 294911 0.5000016954210069.
2023-05-19 04:48:53 [INFO] Set transformer.h.3.mlp.c_fc.weight sparsity with mask 2359296 1179647 0.5000004238552518.
2023-05-19 04:48:53 [INFO] Set transformer.h.3.mlp.c_proj.weight sparsity with mask 2359296 1179647 0.5000004238552518.
2023-05-19 04:48:53 [INFO] Set transformer.h.4.attn.c_attn.weight sparsity with mask 1769472 884734 0.5000011302806713.
2023-05-19 04:48:53 [INFO] Set transformer.h.4.attn.c_proj.weight sparsity with mask 589824 294911 0.5000016954210069.
2023-05-19 04:48:53 [INFO] Set transformer.h.4.mlp.c_fc.weight sparsity with mask 2359296 1179647 0.5000004238552518.
2023-05-19 04:48:53 [INFO] Set transformer.h.4.mlp.c_proj.weight sparsity with mask 2359296 1179647 0.5000004238552518.
2023-05-19 04:48:53 [INFO] Set transformer.h.5.attn.c_attn.weight sparsity with mask 1769472 884735 0.5000005651403356.
2023-05-19 04:48:53 [INFO] Set transformer.h.5.attn.c_proj.weight sparsity with mask 589824 294911 0.5000016954210069.
2023-05-19 04:48:53 [INFO] Set transformer.h.5.mlp.c_fc.weight sparsity with mask 2359296 1179647 0.5000004238552518.
2023-05-19 04:48:53 [INFO] Set transformer.h.5.mlp.c_proj.weight sparsity with mask 2359296 1179647 0.5000004238552518.
2023-05-19 04:48:53 [INFO] Set transformer.h.6.attn.c_attn.weight sparsity with mask 1769472 884735 0.5000005651403356.
2023-05-19 04:48:53 [INFO] Set transformer.h.6.attn.c_proj.weight sparsity with mask 589824 294911 0.5000016954210069.
2023-05-19 04:48:53 [INFO] Set transformer.h.6.mlp.c_fc.weight sparsity with mask 2359296 1179647 0.5000004238552518.
2023-05-19 04:48:53 [INFO] Set transformer.h.6.mlp.c_proj.weight sparsity with mask 2359296 1179647 0.5000004238552518.
2023-05-19 04:48:53 [INFO] Set transformer.h.7.attn.c_attn.weight sparsity with mask 1769472 884735 0.5000005651403356.
2023-05-19 04:48:53 [INFO] Set transformer.h.7.attn.c_proj.weight sparsity with mask 589824 294911 0.5000016954210069.
2023-05-19 04:48:53 [INFO] Set transformer.h.7.mlp.c_fc.weight sparsity with mask 2359296 1179647 0.5000004238552518.
2023-05-19 04:48:53 [INFO] Set transformer.h.7.mlp.c_proj.weight sparsity with mask 2359296 1179647 0.5000004238552518.
2023-05-19 04:48:53 [INFO] Set transformer.h.8.attn.c_attn.weight sparsity with mask 1769472 884735 0.5000005651403356.
2023-05-19 04:48:53 [INFO] Set transformer.h.8.attn.c_proj.weight sparsity with mask 589824 294911 0.5000016954210069.
2023-05-19 04:48:53 [INFO] Set transformer.h.8.mlp.c_fc.weight sparsity with mask 2359296 1179647 0.5000004238552518.
2023-05-19 04:48:53 [INFO] Set transformer.h.8.mlp.c_proj.weight sparsity with mask 2359296 1179647 0.5000004238552518.
2023-05-19 04:48:53 [INFO] Set transformer.h.9.attn.c_attn.weight sparsity with mask 1769472 884735 0.5000005651403356.
2023-05-19 04:48:53 [INFO] Set transformer.h.9.attn.c_proj.weight sparsity with mask 589824 294911 0.5000016954210069.
2023-05-19 04:48:53 [INFO] Set transformer.h.9.mlp.c_fc.weight sparsity with mask 2359296 1179647 0.5000004238552518.
2023-05-19 04:48:53 [INFO] Set transformer.h.9.mlp.c_proj.weight sparsity with mask 2359296 1179647 0.5000004238552518.
2023-05-19 04:48:53 [INFO] Set transformer.h.10.attn.c_attn.weight sparsity with mask 1769472 884735 0.5000005651403356.
2023-05-19 04:48:53 [INFO] Set transformer.h.10.attn.c_proj.weight sparsity with mask 589824 294911 0.5000016954210069.
2023-05-19 04:48:53 [INFO] Set transformer.h.10.mlp.c_fc.weight sparsity with mask 2359296 1179647 0.5000004238552518.
2023-05-19 04:48:53 [INFO] Set transformer.h.10.mlp.c_proj.weight sparsity with mask 2359296 1179647 0.5000004238552518.
2023-05-19 04:48:53 [INFO] Set transformer.h.11.attn.c_attn.weight sparsity with mask 1769472 884735 0.5000005651403356.
2023-05-19 04:48:53 [INFO] Set transformer.h.11.attn.c_proj.weight sparsity with mask 589824 294911 0.5000016954210069.
2023-05-19 04:48:53 [INFO] Set transformer.h.11.mlp.c_fc.weight sparsity with mask 2359296 1179647 0.5000004238552518.
2023-05-19 04:48:53 [INFO] Set transformer.h.11.mlp.c_proj.weight sparsity with mask 2359296 1179647 0.5000004238552518.
2023-05-19 04:48:54 [INFO]                                    Name  ... Sparsity(%)
0                transformer.wte.weight  ...       50.00
1                transformer.wpe.weight  ...       50.00
2             transformer.h.0.attn.bias  ...       49.95
3    transformer.h.0.attn.c_attn.weight  ...       50.00
4    transformer.h.0.attn.c_proj.weight  ...       50.00
..                                  ...  ...         ...
59  transformer.h.11.attn.c_proj.weight  ...       50.00
60     transformer.h.11.mlp.c_fc.weight  ...       50.00
61   transformer.h.11.mlp.c_proj.weight  ...       50.00
62                       lm_head.weight  ...       50.00
63                      Total sparsity:  ...       50.00

[64 rows x 5 columns]
2023-05-19 04:48:54 [INFO] 49.996520955225535
2023-05-19 04:48:54 [INFO] 

Training completed. Do not forget to share your model on huggingface.co/models =)


                                                   100%|██████████| 256/256 [4:55:40<00:00, 68.04s/it]100%|██████████| 256/256 [4:55:40<00:00, 69.30s/it]
2023-05-19 04:48:54 [INFO] Saving model checkpoint to ./test_epoch
2023-05-19 04:48:59 [INFO] Model pruning is done. Start to evaluate the pruned model.
2023-05-19 04:48:59 [INFO] Pruned model score is [].
2023-05-19 04:49:00 [INFO]                                    Name  ... Sparsity(%)
0                transformer.wte.weight  ...       50.00
1                transformer.wpe.weight  ...       50.00
2             transformer.h.0.attn.bias  ...       49.95
3    transformer.h.0.attn.c_attn.weight  ...       50.00
4    transformer.h.0.attn.c_proj.weight  ...       50.00
..                                  ...  ...         ...
59  transformer.h.11.attn.c_proj.weight  ...       50.00
60     transformer.h.11.mlp.c_fc.weight  ...       50.00
61   transformer.h.11.mlp.c_proj.weight  ...       50.00
62                       lm_head.weight  ...       50.00
63                      Total sparsity:  ...       50.00

[64 rows x 5 columns]
2023-05-19 04:49:00 [INFO] 49.996520955225535
2023-05-19 04:49:00 [INFO] Saving model checkpoint to ./CodeGPT-Py150_pruned_50.0%_sparsity
2023-05-19 04:49:03 [WARNING] Force convert framework model to neural_compressor model.
2023-05-19 04:49:03 [INFO] Start to get the baseline model's score before pruning.
2023-05-19 04:49:03 [INFO] Baseline model's score is [].
2023-05-19 04:49:03 [INFO] Model pruning begins.
2023-05-19 04:49:03 [INFO] The following columns in the training set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: output, code, input.
/home/dsochirca/.conda/envs/test/lib/python3.7/site-packages/transformers/optimization.py:395: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  FutureWarning,
2023-05-19 04:49:03 [INFO] ***** Running training *****
2023-05-19 04:49:03 [INFO]   Num examples = 128
2023-05-19 04:49:03 [INFO]   Num Epochs = 2
2023-05-19 04:49:03 [INFO]   Instantaneous batch size per device = 1
2023-05-19 04:49:03 [INFO]   Total train batch size (w. parallel, distributed & accumulation) = 1
2023-05-19 04:49:03 [INFO]   Gradient Accumulation steps = 1
2023-05-19 04:49:03 [INFO]   Total optimization steps = 256
  0%|          | 0/256 [00:00<?, ?it/s]/home/dsochirca/.conda/envs/test/lib/python3.7/site-packages/neural_compressor/experimental/pruner_legacy/group_lasso.py:51: RuntimeWarning: divide by zero encountered in true_divide
  coeff = self.alpha / np.linalg.norm(reshaped_weight, 2, axis=(1,3))
  0%|          | 1/256 [02:10<9:12:31, 130.00s/it]  1%|          | 2/256 [03:18<6:35:57, 93.53s/it]   1%|          | 3/256 [04:25<5:45:01, 81.82s/it]  2%|▏         | 4/256 [05:33<5:20:01, 76.20s/it]  2%|▏         | 5/256 [06:40<5:05:33, 73.04s/it]  2%|▏         | 6/256 [07:48<4:57:09, 71.32s/it]  3%|▎         | 7/256 [08:57<4:52:04, 70.38s/it]  3%|▎         | 8/256 [10:05<4:47:25, 69.54s/it]  4%|▎         | 9/256 [11:14<4:46:01, 69.48s/it]  4%|▍         | 10/256 [12:22<4:42:58, 69.02s/it]  4%|▍         | 11/256 [13:30<4:40:03, 68.59s/it]  5%|▍         | 12/256 [14:37<4:37:57, 68.35s/it]  5%|▌         | 13/256 [15:45<4:36:14, 68.21s/it]  5%|▌         | 14/256 [16:53<4:34:14, 67.99s/it]  6%|▌         | 15/256 [18:01<4:33:12, 68.02s/it]  6%|▋         | 16/256 [19:09<4:32:10, 68.04s/it]  7%|▋         | 17/256 [20:19<4:33:54, 68.76s/it]  7%|▋         | 18/256 [21:27<4:31:42, 68.50s/it]  7%|▋         | 19/256 [22:36<4:30:43, 68.54s/it]  8%|▊         | 20/256 [23:44<4:28:37, 68.30s/it]  8%|▊         | 21/256 [24:51<4:26:51, 68.13s/it]  9%|▊         | 22/256 [25:59<4:25:30, 68.08s/it]  9%|▉         | 23/256 [27:07<4:24:15, 68.05s/it]  9%|▉         | 24/256 [28:20<4:28:48, 69.52s/it] 10%|▉         | 25/256 [29:38<4:37:21, 72.04s/it] 10%|█         | 26/256 [30:46<4:31:41, 70.88s/it] 11%|█         | 27/256 [31:54<4:26:51, 69.92s/it] 11%|█         | 28/256 [33:02<4:23:05, 69.23s/it] 11%|█▏        | 29/256 [34:10<4:20:32, 68.87s/it] 12%|█▏        | 30/256 [35:21<4:22:15, 69.63s/it] 12%|█▏        | 31/256 [36:33<4:23:27, 70.26s/it] 12%|█▎        | 32/256 [37:41<4:19:35, 69.53s/it] 13%|█▎        | 33/256 [38:48<4:16:09, 68.92s/it] 13%|█▎        | 34/256 [39:56<4:14:12, 68.71s/it] 14%|█▎        | 35/256 [41:04<4:11:54, 68.39s/it] 14%|█▍        | 36/256 [42:11<4:09:40, 68.09s/it] 14%|█▍        | 37/256 [43:19<4:08:04, 67.96s/it] 15%|█▍        | 38/256 [44:27<4:06:34, 67.87s/it] 15%|█▌        | 39/256 [45:34<4:05:12, 67.80s/it] 16%|█▌        | 40/256 [46:42<4:04:01, 67.78s/it] 16%|█▌        | 41/256 [47:50<4:02:43, 67.74s/it] 16%|█▋        | 42/256 [48:57<4:01:40, 67.76s/it] 17%|█▋        | 43/256 [50:05<4:00:11, 67.66s/it] 17%|█▋        | 44/256 [51:13<3:59:16, 67.72s/it] 18%|█▊        | 45/256 [52:21<3:58:15, 67.75s/it] 18%|█▊        | 46/256 [53:31<4:00:17, 68.66s/it] 18%|█▊        | 47/256 [54:39<3:58:19, 68.42s/it] 19%|█▉        | 48/256 [55:47<3:56:27, 68.21s/it] 19%|█▉        | 49/256 [56:55<3:55:11, 68.17s/it] 20%|█▉        | 50/256 [58:05<3:56:19, 68.83s/it] 20%|█▉        | 51/256 [59:13<3:54:00, 68.49s/it] 20%|██        | 52/256 [1:00:21<3:52:19, 68.33s/it] 21%|██        | 53/256 [1:01:29<3:50:18, 68.07s/it] 21%|██        | 54/256 [1:02:37<3:49:47, 68.25s/it] 21%|██▏       | 55/256 [1:03:44<3:47:39, 67.96s/it] 22%|██▏       | 56/256 [1:04:52<3:46:21, 67.91s/it] 22%|██▏       | 57/256 [1:06:00<3:45:02, 67.85s/it] 23%|██▎       | 58/256 [1:07:09<3:44:45, 68.11s/it] 23%|██▎       | 59/256 [1:08:17<3:43:29, 68.07s/it] 23%|██▎       | 60/256 [1:09:24<3:42:04, 67.98s/it] 24%|██▍       | 61/256 [1:10:32<3:40:58, 67.99s/it] 24%|██▍       | 62/256 [1:11:40<3:39:46, 67.97s/it] 25%|██▍       | 63/256 [1:12:48<3:38:30, 67.93s/it] 25%|██▌       | 64/256 [1:13:56<3:37:06, 67.85s/it] 25%|██▌       | 65/256 [1:15:03<3:35:36, 67.73s/it] 26%|██▌       | 66/256 [1:16:11<3:34:29, 67.73s/it] 26%|██▌       | 67/256 [1:17:19<3:33:33, 67.79s/it] 27%|██▋       | 68/256 [1:18:27<3:32:17, 67.75s/it] 27%|██▋       | 69/256 [1:19:35<3:31:33, 67.88s/it] 27%|██▋       | 70/256 [1:20:42<3:30:08, 67.79s/it] 28%|██▊       | 71/256 [1:21:50<3:29:15, 67.87s/it] 28%|██▊       | 72/256 [1:22:58<3:27:49, 67.77s/it] 29%|██▊       | 73/256 [1:24:06<3:26:39, 67.75s/it] 29%|██▉       | 74/256 [1:25:14<3:26:07, 67.95s/it] 29%|██▉       | 75/256 [1:26:22<3:25:06, 67.99s/it] 30%|██▉       | 76/256 [1:27:30<3:23:45, 67.92s/it] 30%|███       | 77/256 [1:28:38<3:22:31, 67.89s/it] 30%|███       | 78/256 [1:29:46<3:21:24, 67.89s/it] 31%|███       | 79/256 [1:30:53<3:19:58, 67.79s/it] 31%|███▏      | 80/256 [1:32:02<3:19:20, 67.96s/it] 32%|███▏      | 81/256 [1:33:10<3:18:15, 67.97s/it] 32%|███▏      | 82/256 [1:34:17<3:17:03, 67.95s/it] 32%|███▏      | 83/256 [1:35:26<3:16:01, 67.98s/it] 33%|███▎      | 84/256 [1:36:33<3:14:29, 67.85s/it] 33%|███▎      | 85/256 [1:37:41<3:13:06, 67.76s/it] 34%|███▎      | 86/256 [1:38:48<3:12:03, 67.79s/it] 34%|███▍      | 87/256 [1:39:58<3:12:21, 68.29s/it] 34%|███▍      | 88/256 [1:41:09<3:13:39, 69.16s/it] 35%|███▍      | 89/256 [1:42:17<3:11:26, 68.78s/it] 35%|███▌      | 90/256 [1:43:25<3:09:44, 68.58s/it] 36%|███▌      | 91/256 [1:44:33<3:08:09, 68.42s/it] 36%|███▌      | 92/256 [1:45:41<3:06:49, 68.35s/it] 36%|███▋      | 93/256 [1:46:49<3:05:20, 68.23s/it] 37%|███▋      | 94/256 [1:47:57<3:03:42, 68.04s/it] 37%|███▋      | 95/256 [1:49:05<3:02:20, 67.96s/it] 38%|███▊      | 96/256 [1:50:13<3:01:14, 67.97s/it] 38%|███▊      | 97/256 [1:51:21<3:00:12, 68.00s/it] 38%|███▊      | 98/256 [1:52:29<2:59:08, 68.03s/it] 39%|███▊      | 99/256 [1:53:37<2:58:17, 68.13s/it] 39%|███▉      | 100/256 [1:54:45<2:57:03, 68.10s/it] 39%|███▉      | 101/256 [1:55:53<2:55:46, 68.04s/it] 40%|███▉      | 102/256 [1:57:02<2:55:13, 68.27s/it] 40%|████      | 103/256 [1:58:10<2:53:57, 68.22s/it] 41%|████      | 104/256 [1:59:17<2:52:10, 67.97s/it] 41%|████      | 105/256 [2:00:25<2:51:05, 67.98s/it] 41%|████▏     | 106/256 [2:01:33<2:49:53, 67.96s/it] 42%|████▏     | 107/256 [2:02:41<2:48:53, 68.01s/it] 42%|████▏     | 108/256 [2:03:49<2:47:42, 67.99s/it] 43%|████▎     | 109/256 [2:04:57<2:46:33, 67.98s/it] 43%|████▎     | 110/256 [2:06:06<2:45:32, 68.03s/it] 43%|████▎     | 111/256 [2:07:13<2:44:21, 68.01s/it] 44%|████▍     | 112/256 [2:08:21<2:42:48, 67.84s/it] 44%|████▍     | 113/256 [2:09:29<2:41:35, 67.80s/it] 45%|████▍     | 114/256 [2:10:40<2:43:09, 68.94s/it] 45%|████▍     | 115/256 [2:11:48<2:41:16, 68.63s/it] 45%|████▌     | 116/256 [2:12:57<2:40:15, 68.68s/it] 46%|████▌     | 117/256 [2:14:06<2:39:10, 68.71s/it] 46%|████▌     | 118/256 [2:15:14<2:37:49, 68.62s/it] 46%|████▋     | 119/256 [2:16:22<2:36:13, 68.42s/it] 47%|████▋     | 120/256 [2:17:30<2:34:28, 68.15s/it] 47%|████▋     | 121/256 [2:18:37<2:33:03, 68.03s/it] 48%|████▊     | 122/256 [2:19:45<2:31:39, 67.90s/it] 48%|████▊     | 123/256 [2:20:53<2:30:17, 67.80s/it] 48%|████▊     | 124/256 [2:22:00<2:29:11, 67.82s/it] 49%|████▉     | 125/256 [2:23:09<2:28:16, 67.91s/it] 49%|████▉     | 126/256 [2:24:16<2:27:09, 67.92s/it] 50%|████▉     | 127/256 [2:25:24<2:25:49, 67.83s/it] 50%|█████     | 128/256 [2:26:34<2:25:58, 68.43s/it]2023-05-19 07:15:39 [INFO]                                    Name  ... Sparsity(%)
0                transformer.wte.weight  ...       50.00
1                transformer.wpe.weight  ...       50.00
2             transformer.h.0.attn.bias  ...       49.95
3    transformer.h.0.attn.c_attn.weight  ...       50.00
4    transformer.h.0.attn.c_proj.weight  ...       50.00
..                                  ...  ...         ...
59  transformer.h.11.attn.c_proj.weight  ...       50.00
60     transformer.h.11.mlp.c_fc.weight  ...       50.00
61   transformer.h.11.mlp.c_proj.weight  ...       50.00
62                       lm_head.weight  ...       50.00
63                      Total sparsity:  ...       50.00

[64 rows x 5 columns]
2023-05-19 07:15:39 [INFO] 49.996520955225535
/home/dsochirca/.conda/envs/test/lib/python3.7/site-packages/neural_compressor/experimental/pruner_legacy/group_lasso.py:51: RuntimeWarning: divide by zero encountered in true_divide
  coeff = self.alpha / np.linalg.norm(reshaped_weight, 2, axis=(1,3))
 50%|█████     | 129/256 [2:28:44<3:04:06, 86.98s/it] 51%|█████     | 130/256 [2:29:52<2:50:19, 81.10s/it] 51%|█████     | 131/256 [2:30:59<2:40:25, 77.01s/it] 52%|█████▏    | 132/256 [2:32:07<2:33:24, 74.23s/it] 52%|█████▏    | 133/256 [2:33:14<2:27:58, 72.18s/it] 52%|█████▏    | 134/256 [2:34:23<2:24:34, 71.10s/it] 53%|█████▎    | 135/256 [2:35:31<2:21:23, 70.11s/it] 53%|█████▎    | 136/256 [2:36:38<2:18:33, 69.28s/it] 54%|█████▎    | 137/256 [2:37:45<2:16:18, 68.73s/it] 54%|█████▍    | 138/256 [2:38:53<2:14:30, 68.40s/it] 54%|█████▍    | 139/256 [2:40:03<2:14:04, 68.75s/it] 55%|█████▍    | 140/256 [2:41:10<2:12:16, 68.42s/it] 55%|█████▌    | 141/256 [2:42:17<2:10:28, 68.08s/it] 55%|█████▌    | 142/256 [2:43:25<2:09:06, 67.95s/it] 56%|█████▌    | 143/256 [2:44:33<2:07:48, 67.86s/it] 56%|█████▋    | 144/256 [2:45:40<2:06:15, 67.64s/it] 57%|█████▋    | 145/256 [2:46:47<2:04:57, 67.55s/it] 57%|█████▋    | 146/256 [2:47:55<2:03:44, 67.50s/it] 57%|█████▋    | 147/256 [2:49:03<2:02:53, 67.65s/it] 58%|█████▊    | 148/256 [2:50:13<2:03:29, 68.61s/it] 58%|█████▊    | 149/256 [2:51:22<2:02:22, 68.62s/it] 59%|█████▊    | 150/256 [2:52:33<2:02:18, 69.23s/it] 59%|█████▉    | 151/256 [2:53:41<2:00:47, 69.02s/it] 59%|█████▉    | 152/256 [2:54:49<1:58:58, 68.64s/it] 60%|█████▉    | 153/256 [2:55:56<1:57:06, 68.22s/it] 60%|██████    | 154/256 [2:57:03<1:55:25, 67.90s/it] 61%|██████    | 155/256 [2:58:11<1:54:04, 67.77s/it] 61%|██████    | 156/256 [2:59:18<1:52:45, 67.65s/it] 61%|██████▏   | 157/256 [3:00:25<1:51:18, 67.46s/it] 62%|██████▏   | 158/256 [3:01:32<1:49:57, 67.32s/it] 62%|██████▏   | 159/256 [3:02:39<1:48:45, 67.28s/it] 62%|██████▎   | 160/256 [3:03:51<1:49:48, 68.63s/it] 63%|██████▎   | 161/256 [3:05:05<1:50:56, 70.07s/it] 63%|██████▎   | 162/256 [3:06:12<1:48:31, 69.27s/it] 64%|██████▎   | 163/256 [3:07:20<1:46:48, 68.91s/it] 64%|██████▍   | 164/256 [3:08:28<1:44:59, 68.47s/it] 64%|██████▍   | 165/256 [3:09:36<1:43:38, 68.34s/it] 65%|██████▍   | 166/256 [3:10:44<1:42:39, 68.44s/it] 65%|██████▌   | 167/256 [3:11:51<1:40:51, 67.99s/it] 66%|██████▌   | 168/256 [3:12:58<1:39:22, 67.75s/it] 66%|██████▌   | 169/256 [3:14:05<1:37:45, 67.42s/it] 66%|██████▋   | 170/256 [3:15:12<1:36:30, 67.34s/it] 67%|██████▋   | 171/256 [3:16:20<1:35:24, 67.34s/it] 67%|██████▋   | 172/256 [3:17:27<1:34:22, 67.41s/it] 68%|██████▊   | 173/256 [3:18:34<1:33:08, 67.33s/it] 68%|██████▊   | 174/256 [3:19:42<1:32:00, 67.32s/it] 68%|██████▊   | 175/256 [3:20:49<1:30:58, 67.38s/it] 69%|██████▉   | 176/256 [3:21:57<1:30:03, 67.55s/it] 69%|██████▉   | 177/256 [3:23:04<1:28:53, 67.52s/it] 70%|██████▉   | 178/256 [3:24:12<1:27:46, 67.52s/it] 70%|██████▉   | 179/256 [3:25:19<1:26:35, 67.47s/it] 70%|███████   | 180/256 [3:26:27<1:25:33, 67.54s/it] 71%|███████   | 181/256 [3:27:36<1:24:50, 67.87s/it] 71%|███████   | 182/256 [3:28:44<1:24:03, 68.16s/it] 71%|███████▏  | 183/256 [3:29:52<1:22:34, 67.87s/it] 72%|███████▏  | 184/256 [3:30:59<1:21:22, 67.82s/it] 72%|███████▏  | 185/256 [3:32:07<1:20:06, 67.70s/it] 73%|███████▎  | 186/256 [3:33:14<1:18:52, 67.61s/it] 73%|███████▎  | 187/256 [3:34:22<1:17:47, 67.64s/it] 73%|███████▎  | 188/256 [3:35:30<1:16:56, 67.90s/it] 74%|███████▍  | 189/256 [3:36:38<1:15:45, 67.84s/it] 74%|███████▍  | 190/256 [3:37:46<1:14:35, 67.80s/it] 75%|███████▍  | 191/256 [3:38:54<1:13:28, 67.83s/it] 75%|███████▌  | 192/256 [3:40:02<1:12:35, 68.06s/it] 75%|███████▌  | 193/256 [3:41:09<1:11:09, 67.78s/it] 76%|███████▌  | 194/256 [3:42:17<1:09:57, 67.70s/it] 76%|███████▌  | 195/256 [3:43:25<1:08:54, 67.78s/it] 77%|███████▋  | 196/256 [3:44:33<1:07:45, 67.76s/it] 77%|███████▋  | 197/256 [3:45:41<1:06:42, 67.83s/it] 77%|███████▋  | 198/256 [3:46:48<1:05:34, 67.84s/it] 78%|███████▊  | 199/256 [3:47:56<1:04:20, 67.73s/it] 78%|███████▊  | 200/256 [3:49:04<1:03:11, 67.71s/it] 79%|███████▊  | 201/256 [3:50:11<1:02:01, 67.66s/it] 79%|███████▉  | 202/256 [3:51:18<1:00:45, 67.52s/it] 79%|███████▉  | 203/256 [3:52:26<59:41, 67.57s/it]   80%|███████▉  | 204/256 [3:53:34<58:36, 67.63s/it] 80%|████████  | 205/256 [3:54:41<57:28, 67.61s/it] 80%|████████  | 206/256 [3:55:49<56:23, 67.67s/it] 81%|████████  | 207/256 [3:56:58<55:30, 67.98s/it] 81%|████████▏ | 208/256 [3:58:06<54:19, 67.91s/it] 82%|████████▏ | 209/256 [3:59:13<53:08, 67.83s/it] 82%|████████▏ | 210/256 [4:00:21<51:55, 67.72s/it] 82%|████████▏ | 211/256 [4:01:28<50:44, 67.66s/it] 83%|████████▎ | 212/256 [4:02:36<49:33, 67.57s/it] 83%|████████▎ | 213/256 [4:03:43<48:22, 67.50s/it] 84%|████████▎ | 214/256 [4:04:50<47:10, 67.40s/it] 84%|████████▍ | 215/256 [4:05:57<46:00, 67.33s/it] 84%|████████▍ | 216/256 [4:07:05<45:01, 67.54s/it] 85%|████████▍ | 217/256 [4:08:13<43:53, 67.52s/it] 85%|████████▌ | 218/256 [4:09:20<42:43, 67.46s/it] 86%|████████▌ | 219/256 [4:10:28<41:37, 67.49s/it] 86%|████████▌ | 220/256 [4:11:36<40:34, 67.61s/it] 86%|████████▋ | 221/256 [4:12:43<39:26, 67.61s/it] 87%|████████▋ | 222/256 [4:13:50<38:15, 67.52s/it] 87%|████████▋ | 223/256 [4:14:58<37:12, 67.64s/it] 88%|████████▊ | 224/256 [4:16:06<36:03, 67.60s/it] 88%|████████▊ | 225/256 [4:17:13<34:51, 67.47s/it] 88%|████████▊ | 226/256 [4:18:20<33:43, 67.45s/it] 89%|████████▊ | 227/256 [4:19:28<32:38, 67.54s/it] 89%|████████▉ | 228/256 [4:20:35<31:27, 67.43s/it] 89%|████████▉ | 229/256 [4:21:43<30:22, 67.50s/it] 90%|████████▉ | 230/256 [4:22:51<29:15, 67.54s/it] 90%|█████████ | 231/256 [4:23:58<28:07, 67.48s/it] 91%|█████████ | 232/256 [4:25:06<27:01, 67.57s/it] 91%|█████████ | 233/256 [4:26:14<25:56, 67.65s/it] 91%|█████████▏| 234/256 [4:27:23<25:00, 68.21s/it] 92%|█████████▏| 235/256 [4:28:31<23:48, 68.04s/it] 92%|█████████▏| 236/256 [4:29:39<22:38, 67.94s/it] 93%|█████████▎| 237/256 [4:30:46<21:29, 67.85s/it] 93%|█████████▎| 238/256 [4:31:54<20:19, 67.76s/it] 93%|█████████▎| 239/256 [4:33:01<19:10, 67.67s/it] 94%|█████████▍| 240/256 [4:34:09<18:01, 67.57s/it] 94%|█████████▍| 241/256 [4:35:16<16:54, 67.64s/it] 95%|█████████▍| 242/256 [4:36:24<15:47, 67.66s/it] 95%|█████████▍| 243/256 [4:37:31<14:38, 67.56s/it] 95%|█████████▌| 244/256 [4:38:39<13:32, 67.67s/it] 96%|█████████▌| 245/256 [4:39:47<12:24, 67.64s/it] 96%|█████████▌| 246/256 [4:40:54<11:16, 67.63s/it] 96%|█████████▋| 247/256 [4:42:03<10:10, 67.82s/it] 97%|█████████▋| 248/256 [4:43:10<09:01, 67.67s/it] 97%|█████████▋| 249/256 [4:44:17<07:52, 67.57s/it] 98%|█████████▊| 250/256 [4:45:25<06:45, 67.55s/it] 98%|█████████▊| 251/256 [4:46:32<05:37, 67.56s/it] 98%|█████████▊| 252/256 [4:47:41<04:30, 67.70s/it] 99%|█████████▉| 253/256 [4:48:48<03:22, 67.54s/it] 99%|█████████▉| 254/256 [4:49:56<02:15, 67.65s/it]100%|█████████▉| 255/256 [4:51:03<01:07, 67.69s/it]100%|██████████| 256/256 [4:52:11<00:00, 67.67s/it]2023-05-19 09:41:15 [INFO] Set transformer.wte.weight sparsity with mask 38400768 15360307 0.6000000052082292.
2023-05-19 09:41:15 [INFO] Set transformer.wpe.weight sparsity with mask 786432 314572 0.6000010172526042.
2023-05-19 09:41:15 [INFO] Set transformer.h.0.attn.c_attn.weight sparsity with mask 1769472 707788 0.6000004521122686.
2023-05-19 09:41:15 [INFO] Set transformer.h.0.attn.c_proj.weight sparsity with mask 589824 235929 0.6000010172526042.
2023-05-19 09:41:15 [INFO] Set transformer.h.0.mlp.c_fc.weight sparsity with mask 2359296 943718 0.6000001695421007.
2023-05-19 09:41:15 [INFO] Set transformer.h.0.mlp.c_proj.weight sparsity with mask 2359296 943718 0.6000001695421007.
2023-05-19 09:41:16 [INFO] Set transformer.h.1.attn.c_attn.weight sparsity with mask 1769472 707788 0.6000004521122686.
2023-05-19 09:41:16 [INFO] Set transformer.h.1.attn.c_proj.weight sparsity with mask 589824 235929 0.6000010172526042.
2023-05-19 09:41:16 [INFO] Set transformer.h.1.mlp.c_fc.weight sparsity with mask 2359296 943718 0.6000001695421007.
2023-05-19 09:41:16 [INFO] Set transformer.h.1.mlp.c_proj.weight sparsity with mask 2359296 943718 0.6000001695421007.
2023-05-19 09:41:16 [INFO] Set transformer.h.2.attn.c_attn.weight sparsity with mask 1769472 707788 0.6000004521122686.
2023-05-19 09:41:16 [INFO] Set transformer.h.2.attn.c_proj.weight sparsity with mask 589824 235929 0.6000010172526042.
2023-05-19 09:41:16 [INFO] Set transformer.h.2.mlp.c_fc.weight sparsity with mask 2359296 943718 0.6000001695421007.
2023-05-19 09:41:16 [INFO] Set transformer.h.2.mlp.c_proj.weight sparsity with mask 2359296 943718 0.6000001695421007.
2023-05-19 09:41:16 [INFO] Set transformer.h.3.attn.c_attn.weight sparsity with mask 1769472 707788 0.6000004521122686.
2023-05-19 09:41:16 [INFO] Set transformer.h.3.attn.c_proj.weight sparsity with mask 589824 235929 0.6000010172526042.
2023-05-19 09:41:16 [INFO] Set transformer.h.3.mlp.c_fc.weight sparsity with mask 2359296 943718 0.6000001695421007.
2023-05-19 09:41:16 [INFO] Set transformer.h.3.mlp.c_proj.weight sparsity with mask 2359296 943718 0.6000001695421007.
2023-05-19 09:41:16 [INFO] Set transformer.h.4.attn.c_attn.weight sparsity with mask 1769472 707788 0.6000004521122686.
2023-05-19 09:41:16 [INFO] Set transformer.h.4.attn.c_proj.weight sparsity with mask 589824 235929 0.6000010172526042.
2023-05-19 09:41:16 [INFO] Set transformer.h.4.mlp.c_fc.weight sparsity with mask 2359296 943718 0.6000001695421007.
2023-05-19 09:41:16 [INFO] Set transformer.h.4.mlp.c_proj.weight sparsity with mask 2359296 943718 0.6000001695421007.
2023-05-19 09:41:16 [INFO] Set transformer.h.5.attn.c_attn.weight sparsity with mask 1769472 707788 0.6000004521122686.
2023-05-19 09:41:16 [INFO] Set transformer.h.5.attn.c_proj.weight sparsity with mask 589824 235929 0.6000010172526042.
2023-05-19 09:41:16 [INFO] Set transformer.h.5.mlp.c_fc.weight sparsity with mask 2359296 943718 0.6000001695421007.
2023-05-19 09:41:16 [INFO] Set transformer.h.5.mlp.c_proj.weight sparsity with mask 2359296 943718 0.6000001695421007.
2023-05-19 09:41:16 [INFO] Set transformer.h.6.attn.c_attn.weight sparsity with mask 1769472 707788 0.6000004521122686.
2023-05-19 09:41:16 [INFO] Set transformer.h.6.attn.c_proj.weight sparsity with mask 589824 235929 0.6000010172526042.
2023-05-19 09:41:16 [INFO] Set transformer.h.6.mlp.c_fc.weight sparsity with mask 2359296 943718 0.6000001695421007.
2023-05-19 09:41:16 [INFO] Set transformer.h.6.mlp.c_proj.weight sparsity with mask 2359296 943718 0.6000001695421007.
2023-05-19 09:41:16 [INFO] Set transformer.h.7.attn.c_attn.weight sparsity with mask 1769472 707788 0.6000004521122686.
2023-05-19 09:41:16 [INFO] Set transformer.h.7.attn.c_proj.weight sparsity with mask 589824 235929 0.6000010172526042.
2023-05-19 09:41:16 [INFO] Set transformer.h.7.mlp.c_fc.weight sparsity with mask 2359296 943718 0.6000001695421007.
2023-05-19 09:41:16 [INFO] Set transformer.h.7.mlp.c_proj.weight sparsity with mask 2359296 943718 0.6000001695421007.
2023-05-19 09:41:16 [INFO] Set transformer.h.8.attn.c_attn.weight sparsity with mask 1769472 707788 0.6000004521122686.
2023-05-19 09:41:16 [INFO] Set transformer.h.8.attn.c_proj.weight sparsity with mask 589824 235929 0.6000010172526042.
2023-05-19 09:41:16 [INFO] Set transformer.h.8.mlp.c_fc.weight sparsity with mask 2359296 943718 0.6000001695421007.
2023-05-19 09:41:16 [INFO] Set transformer.h.8.mlp.c_proj.weight sparsity with mask 2359296 943718 0.6000001695421007.
2023-05-19 09:41:16 [INFO] Set transformer.h.9.attn.c_attn.weight sparsity with mask 1769472 707788 0.6000004521122686.
2023-05-19 09:41:16 [INFO] Set transformer.h.9.attn.c_proj.weight sparsity with mask 589824 235929 0.6000010172526042.
2023-05-19 09:41:16 [INFO] Set transformer.h.9.mlp.c_fc.weight sparsity with mask 2359296 943718 0.6000001695421007.
2023-05-19 09:41:16 [INFO] Set transformer.h.9.mlp.c_proj.weight sparsity with mask 2359296 943718 0.6000001695421007.
2023-05-19 09:41:16 [INFO] Set transformer.h.10.attn.c_attn.weight sparsity with mask 1769472 707788 0.6000004521122686.
2023-05-19 09:41:16 [INFO] Set transformer.h.10.attn.c_proj.weight sparsity with mask 589824 235929 0.6000010172526042.
2023-05-19 09:41:16 [INFO] Set transformer.h.10.mlp.c_fc.weight sparsity with mask 2359296 943718 0.6000001695421007.
2023-05-19 09:41:16 [INFO] Set transformer.h.10.mlp.c_proj.weight sparsity with mask 2359296 943718 0.6000001695421007.
2023-05-19 09:41:16 [INFO] Set transformer.h.11.attn.c_attn.weight sparsity with mask 1769472 707788 0.6000004521122686.
2023-05-19 09:41:16 [INFO] Set transformer.h.11.attn.c_proj.weight sparsity with mask 589824 235929 0.6000010172526042.
2023-05-19 09:41:16 [INFO] Set transformer.h.11.mlp.c_fc.weight sparsity with mask 2359296 943718 0.6000001695421007.
2023-05-19 09:41:16 [INFO] Set transformer.h.11.mlp.c_proj.weight sparsity with mask 2359296 943718 0.6000001695421007.
2023-05-19 09:41:16 [INFO]                                    Name  ... Sparsity(%)
0                transformer.wte.weight  ...       60.00
1                transformer.wpe.weight  ...       60.00
2             transformer.h.0.attn.bias  ...       49.95
3    transformer.h.0.attn.c_attn.weight  ...       60.00
4    transformer.h.0.attn.c_proj.weight  ...       60.00
..                                  ...  ...         ...
59  transformer.h.11.attn.c_proj.weight  ...       60.00
60     transformer.h.11.mlp.c_fc.weight  ...       60.00
61   transformer.h.11.mlp.c_proj.weight  ...       60.00
62                       lm_head.weight  ...       60.00
63                      Total sparsity:  ...       59.28

[64 rows x 5 columns]
2023-05-19 09:41:16 [INFO] 59.27791683296638
2023-05-19 09:41:16 [INFO] 

Training completed. Do not forget to share your model on huggingface.co/models =)


                                                   100%|██████████| 256/256 [4:52:12<00:00, 67.67s/it]100%|██████████| 256/256 [4:52:12<00:00, 68.49s/it]
2023-05-19 09:41:16 [INFO] Saving model checkpoint to ./test_epoch
2023-05-19 09:41:22 [INFO] Model pruning is done. Start to evaluate the pruned model.
2023-05-19 09:41:22 [INFO] Pruned model score is [].
2023-05-19 09:41:22 [INFO]                                    Name  ... Sparsity(%)
0                transformer.wte.weight  ...       60.00
1                transformer.wpe.weight  ...       60.00
2             transformer.h.0.attn.bias  ...       49.95
3    transformer.h.0.attn.c_attn.weight  ...       60.00
4    transformer.h.0.attn.c_proj.weight  ...       60.00
..                                  ...  ...         ...
59  transformer.h.11.attn.c_proj.weight  ...       60.00
60     transformer.h.11.mlp.c_fc.weight  ...       60.00
61   transformer.h.11.mlp.c_proj.weight  ...       60.00
62                       lm_head.weight  ...       60.00
63                      Total sparsity:  ...       59.28

[64 rows x 5 columns]
2023-05-19 09:41:22 [INFO] 59.27791683296638
2023-05-19 09:41:22 [INFO] Saving model checkpoint to ./CodeGPT-Py150_pruned_60.0%_sparsity
2023-05-19 09:41:28 [WARNING] Force convert framework model to neural_compressor model.
2023-05-19 09:41:28 [INFO] Start to get the baseline model's score before pruning.
2023-05-19 09:41:28 [INFO] Baseline model's score is [].
2023-05-19 09:41:28 [INFO] Model pruning begins.
2023-05-19 09:41:28 [INFO] The following columns in the training set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: output, code, input.
/home/dsochirca/.conda/envs/test/lib/python3.7/site-packages/transformers/optimization.py:395: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  FutureWarning,
2023-05-19 09:41:28 [INFO] ***** Running training *****
2023-05-19 09:41:28 [INFO]   Num examples = 128
2023-05-19 09:41:28 [INFO]   Num Epochs = 2
2023-05-19 09:41:28 [INFO]   Instantaneous batch size per device = 1
2023-05-19 09:41:28 [INFO]   Total train batch size (w. parallel, distributed & accumulation) = 1
2023-05-19 09:41:28 [INFO]   Gradient Accumulation steps = 1
2023-05-19 09:41:28 [INFO]   Total optimization steps = 256
  0%|          | 0/256 [00:00<?, ?it/s]/home/dsochirca/.conda/envs/test/lib/python3.7/site-packages/neural_compressor/experimental/pruner_legacy/group_lasso.py:51: RuntimeWarning: divide by zero encountered in true_divide
  coeff = self.alpha / np.linalg.norm(reshaped_weight, 2, axis=(1,3))
  0%|          | 1/256 [02:00<8:33:43, 120.88s/it]  1%|          | 2/256 [03:08<6:19:18, 89.60s/it]   1%|          | 3/256 [04:16<5:35:52, 79.65s/it]  2%|▏         | 4/256 [05:23<5:14:21, 74.85s/it]  2%|▏         | 5/256 [06:31<5:02:05, 72.21s/it]  2%|▏         | 6/256 [07:43<5:00:05, 72.02s/it]  3%|▎         | 7/256 [08:50<4:52:45, 70.55s/it]  3%|▎         | 8/256 [09:57<4:47:28, 69.55s/it]  4%|▎         | 9/256 [11:05<4:43:14, 68.81s/it]  4%|▍         | 10/256 [12:12<4:40:31, 68.42s/it]  4%|▍         | 11/256 [13:20<4:38:29, 68.20s/it]  5%|▍         | 12/256 [14:27<4:36:32, 68.00s/it]  5%|▌         | 13/256 [15:35<4:34:39, 67.82s/it]  5%|▌         | 14/256 [16:42<4:33:16, 67.76s/it]  6%|▌         | 15/256 [17:50<4:32:23, 67.82s/it]  6%|▋         | 16/256 [18:58<4:30:48, 67.70s/it]  7%|▋         | 17/256 [20:05<4:29:20, 67.62s/it]  7%|▋         | 18/256 [21:18<4:34:36, 69.23s/it]  7%|▋         | 19/256 [22:26<4:31:40, 68.78s/it]  8%|▊         | 20/256 [23:34<4:29:21, 68.48s/it]  8%|▊         | 21/256 [24:41<4:26:49, 68.12s/it]  9%|▊         | 22/256 [25:49<4:25:20, 68.04s/it]  9%|▉         | 23/256 [26:56<4:23:16, 67.80s/it]  9%|▉         | 24/256 [28:04<4:22:04, 67.78s/it] 10%|▉         | 25/256 [29:13<4:22:00, 68.05s/it] 10%|█         | 26/256 [30:20<4:20:19, 67.91s/it] 11%|█         | 27/256 [31:29<4:19:50, 68.08s/it] 11%|█         | 28/256 [32:36<4:18:20, 67.98s/it] 11%|█▏        | 29/256 [33:44<4:16:52, 67.89s/it] 12%|█▏        | 30/256 [34:51<4:15:04, 67.72s/it] 12%|█▏        | 31/256 [36:03<4:17:55, 68.78s/it] 12%|█▎        | 32/256 [37:10<4:15:36, 68.47s/it] 13%|█▎        | 33/256 [38:18<4:13:03, 68.09s/it] 13%|█▎        | 34/256 [39:25<4:10:51, 67.80s/it] 14%|█▎        | 35/256 [40:36<4:13:22, 68.79s/it] 14%|█▍        | 36/256 [41:43<4:10:56, 68.44s/it] 14%|█▍        | 37/256 [42:53<4:11:18, 68.85s/it] 15%|█▍        | 38/256 [44:01<4:08:59, 68.53s/it] 15%|█▌        | 39/256 [45:08<4:06:28, 68.15s/it] 16%|█▌        | 40/256 [46:15<4:04:16, 67.86s/it] 16%|█▌        | 41/256 [47:23<4:02:26, 67.66s/it] 16%|█▋        | 42/256 [48:30<4:01:07, 67.60s/it] 17%|█▋        | 43/256 [49:39<4:00:59, 67.88s/it] 17%|█▋        | 44/256 [50:46<3:59:45, 67.86s/it] 18%|█▊        | 45/256 [51:55<3:58:52, 67.93s/it] 18%|█▊        | 46/256 [53:02<3:56:50, 67.67s/it] 18%|█▊        | 47/256 [54:08<3:54:32, 67.33s/it] 19%|█▉        | 48/256 [55:16<3:53:36, 67.39s/it] 19%|█▉        | 49/256 [56:23<3:52:42, 67.45s/it] 20%|█▉        | 50/256 [57:31<3:51:57, 67.56s/it] 20%|█▉        | 51/256 [58:39<3:50:54, 67.58s/it] 20%|██        | 52/256 [59:46<3:49:37, 67.54s/it] 21%|██        | 53/256 [1:00:53<3:48:06, 67.42s/it] 21%|██        | 54/256 [1:02:01<3:47:14, 67.50s/it] 21%|██▏       | 55/256 [1:03:08<3:45:39, 67.36s/it] 22%|██▏       | 56/256 [1:04:16<3:45:11, 67.56s/it] 22%|██▏       | 57/256 [1:05:24<3:44:11, 67.59s/it] 23%|██▎       | 58/256 [1:06:35<3:46:42, 68.70s/it] 23%|██▎       | 59/256 [1:07:43<3:44:38, 68.42s/it] 23%|██▎       | 60/256 [1:08:50<3:42:37, 68.15s/it] 24%|██▍       | 61/256 [1:09:57<3:40:32, 67.86s/it] 24%|██▍       | 62/256 [1:11:05<3:38:47, 67.67s/it] 25%|██▍       | 63/256 [1:12:12<3:37:38, 67.66s/it] 25%|██▌       | 64/256 [1:13:20<3:36:15, 67.58s/it] 25%|██▌       | 65/256 [1:14:27<3:34:53, 67.50s/it] 26%|██▌       | 66/256 [1:15:35<3:33:56, 67.56s/it] 26%|██▌       | 67/256 [1:16:42<3:32:56, 67.60s/it] 27%|██▋       | 68/256 [1:17:50<3:31:40, 67.56s/it] 27%|██▋       | 69/256 [1:18:57<3:30:25, 67.52s/it] 27%|██▋       | 70/256 [1:20:05<3:29:30, 67.59s/it] 28%|██▊       | 71/256 [1:21:13<3:28:36, 67.65s/it] 28%|██▊       | 72/256 [1:22:21<3:27:30, 67.66s/it] 29%|██▊       | 73/256 [1:23:28<3:26:04, 67.57s/it] 29%|██▉       | 74/256 [1:24:35<3:24:44, 67.49s/it] 29%|██▉       | 75/256 [1:25:43<3:23:37, 67.50s/it] 30%|██▉       | 76/256 [1:26:50<3:22:31, 67.51s/it] 30%|███       | 77/256 [1:27:58<3:21:17, 67.47s/it] 30%|███       | 78/256 [1:29:05<3:20:26, 67.56s/it] 31%|███       | 79/256 [1:30:13<3:19:00, 67.46s/it] 31%|███▏      | 80/256 [1:31:20<3:18:05, 67.53s/it] 32%|███▏      | 81/256 [1:32:28<3:17:14, 67.62s/it] 32%|███▏      | 82/256 [1:33:36<3:16:24, 67.73s/it] 32%|███▏      | 83/256 [1:34:44<3:15:12, 67.70s/it] 33%|███▎      | 84/256 [1:35:52<3:14:06, 67.71s/it] 33%|███▎      | 85/256 [1:36:59<3:12:48, 67.65s/it] 34%|███▎      | 86/256 [1:38:07<3:11:38, 67.64s/it] 34%|███▍      | 87/256 [1:39:14<3:10:08, 67.50s/it] 34%|███▍      | 88/256 [1:40:21<3:09:01, 67.51s/it] 35%|███▍      | 89/256 [1:41:31<3:09:47, 68.19s/it] 35%|███▌      | 90/256 [1:42:39<3:08:17, 68.06s/it] 36%|███▌      | 91/256 [1:43:46<3:06:41, 67.89s/it] 36%|███▌      | 92/256 [1:44:54<3:05:20, 67.81s/it] 36%|███▋      | 93/256 [1:46:02<3:04:03, 67.75s/it] 37%|███▋      | 94/256 [1:47:09<3:02:59, 67.77s/it] 37%|███▋      | 95/256 [1:48:17<3:01:52, 67.78s/it] 38%|███▊      | 96/256 [1:49:25<3:00:29, 67.68s/it] 38%|███▊      | 97/256 [1:50:33<2:59:27, 67.72s/it] 38%|███▊      | 98/256 [1:51:43<3:00:35, 68.58s/it] 39%|███▊      | 99/256 [1:52:54<3:01:10, 69.24s/it] 39%|███▉      | 100/256 [1:54:02<2:58:46, 68.76s/it] 39%|███▉      | 101/256 [1:55:09<2:56:26, 68.30s/it] 40%|███▉      | 102/256 [1:56:16<2:54:47, 68.10s/it] 40%|████      | 103/256 [1:57:27<2:55:39, 68.89s/it] 41%|████      | 104/256 [1:58:35<2:53:22, 68.44s/it] 41%|████      | 105/256 [1:59:42<2:51:28, 68.13s/it] 41%|████▏     | 106/256 [2:00:50<2:49:56, 67.98s/it] 42%|████▏     | 107/256 [2:01:57<2:48:36, 67.90s/it] 42%|████▏     | 108/256 [2:03:04<2:46:58, 67.69s/it] 43%|████▎     | 109/256 [2:04:12<2:45:51, 67.70s/it] 43%|████▎     | 110/256 [2:05:19<2:44:26, 67.58s/it] 43%|████▎     | 111/256 [2:06:27<2:43:09, 67.51s/it] 44%|████▍     | 112/256 [2:07:34<2:42:00, 67.51s/it] 44%|████▍     | 113/256 [2:08:42<2:40:56, 67.53s/it] 45%|████▍     | 114/256 [2:09:50<2:39:53, 67.56s/it] 45%|████▍     | 115/256 [2:10:57<2:38:49, 67.58s/it] 45%|████▌     | 116/256 [2:12:05<2:37:34, 67.53s/it] 46%|████▌     | 117/256 [2:13:12<2:36:36, 67.60s/it] 46%|████▌     | 118/256 [2:14:20<2:35:31, 67.62s/it] 46%|████▋     | 119/256 [2:15:28<2:34:18, 67.58s/it] 47%|████▋     | 120/256 [2:16:39<2:36:07, 68.88s/it] 47%|████▋     | 121/256 [2:17:58<2:41:49, 71.92s/it] 48%|████▊     | 122/256 [2:19:06<2:37:48, 70.66s/it] 48%|████▊     | 123/256 [2:20:14<2:34:41, 69.78s/it] 48%|████▊     | 124/256 [2:21:21<2:31:45, 68.98s/it] 49%|████▉     | 125/256 [2:22:29<2:30:09, 68.77s/it] 49%|████▉     | 126/256 [2:23:36<2:27:50, 68.24s/it] 50%|████▉     | 127/256 [2:24:47<2:28:22, 69.01s/it] 50%|█████     | 128/256 [2:25:59<2:28:53, 69.79s/it]2023-05-19 12:07:28 [INFO]                                    Name  ... Sparsity(%)
0                transformer.wte.weight  ...       60.00
1                transformer.wpe.weight  ...       60.00
2             transformer.h.0.attn.bias  ...       49.95
3    transformer.h.0.attn.c_attn.weight  ...       60.00
4    transformer.h.0.attn.c_proj.weight  ...       60.00
..                                  ...  ...         ...
59  transformer.h.11.attn.c_proj.weight  ...       60.00
60     transformer.h.11.mlp.c_fc.weight  ...       60.00
61   transformer.h.11.mlp.c_proj.weight  ...       60.00
62                       lm_head.weight  ...       60.00
63                      Total sparsity:  ...       59.28

[64 rows x 5 columns]
2023-05-19 12:07:28 [INFO] 59.27791683296638
/home/dsochirca/.conda/envs/test/lib/python3.7/site-packages/neural_compressor/experimental/pruner_legacy/group_lasso.py:51: RuntimeWarning: divide by zero encountered in true_divide
  coeff = self.alpha / np.linalg.norm(reshaped_weight, 2, axis=(1,3))
 50%|█████     | 129/256 [2:27:58<2:59:27, 84.79s/it] 51%|█████     | 130/256 [2:29:06<2:47:06, 79.58s/it] 51%|█████     | 131/256 [2:30:13<2:37:41, 75.69s/it] 52%|█████▏    | 132/256 [2:31:20<2:31:01, 73.08s/it] 52%|█████▏    | 133/256 [2:32:27<2:26:04, 71.25s/it] 52%|█████▏    | 134/256 [2:33:33<2:22:10, 69.92s/it] 53%|█████▎    | 135/256 [2:34:40<2:19:03, 68.95s/it] 53%|█████▎    | 136/256 [2:35:47<2:16:41, 68.34s/it] 54%|█████▎    | 137/256 [2:36:53<2:14:25, 67.78s/it] 54%|█████▍    | 138/256 [2:38:02<2:13:51, 68.06s/it] 54%|█████▍    | 139/256 [2:39:10<2:12:44, 68.07s/it] 55%|█████▍    | 140/256 [2:40:17<2:11:08, 67.83s/it] 55%|█████▌    | 141/256 [2:41:24<2:09:15, 67.44s/it] 55%|█████▌    | 142/256 [2:42:30<2:07:33, 67.14s/it] 56%|█████▌    | 143/256 [2:43:37<2:06:22, 67.10s/it] 56%|█████▋    | 144/256 [2:44:44<2:05:04, 67.00s/it] 57%|█████▋    | 145/256 [2:45:51<2:03:36, 66.82s/it] 57%|█████▋    | 146/256 [2:46:57<2:02:14, 66.67s/it] 57%|█████▋    | 147/256 [2:48:04<2:01:18, 66.77s/it] 58%|█████▊    | 148/256 [2:49:11<2:00:17, 66.83s/it] 58%|█████▊    | 149/256 [2:50:18<1:59:14, 66.86s/it] 59%|█████▊    | 150/256 [2:51:25<1:58:17, 66.96s/it] 59%|█████▉    | 151/256 [2:52:32<1:57:18, 67.03s/it] 59%|█████▉    | 152/256 [2:53:39<1:55:53, 66.86s/it] 60%|█████▉    | 153/256 [2:54:47<1:55:25, 67.24s/it] 60%|██████    | 154/256 [2:56:00<1:57:04, 68.87s/it] 61%|██████    | 155/256 [2:57:07<1:55:27, 68.58s/it] 61%|██████    | 156/256 [2:58:14<1:53:32, 68.12s/it] 61%|██████▏   | 157/256 [2:59:21<1:51:44, 67.72s/it] 62%|██████▏   | 158/256 [3:00:29<1:50:45, 67.81s/it] 62%|██████▏   | 159/256 [3:01:43<1:52:39, 69.68s/it] 62%|██████▎   | 160/256 [3:02:59<1:54:35, 71.62s/it] 63%|██████▎   | 161/256 [3:04:20<1:57:32, 74.24s/it] 63%|██████▎   | 162/256 [3:05:27<1:53:00, 72.13s/it] 64%|██████▎   | 163/256 [3:06:35<1:49:41, 70.77s/it] 64%|██████▍   | 164/256 [3:07:43<1:47:17, 69.97s/it] 64%|██████▍   | 165/256 [3:08:50<1:44:42, 69.04s/it] 65%|██████▍   | 166/256 [3:09:57<1:42:45, 68.51s/it] 65%|██████▌   | 167/256 [3:11:04<1:40:58, 68.07s/it] 66%|██████▌   | 168/256 [3:12:11<1:39:23, 67.77s/it] 66%|██████▌   | 169/256 [3:13:18<1:37:51, 67.49s/it] 66%|██████▋   | 170/256 [3:14:25<1:36:32, 67.36s/it] 67%|██████▋   | 171/256 [3:15:32<1:35:20, 67.30s/it] 67%|██████▋   | 172/256 [3:16:39<1:33:58, 67.13s/it] 68%|██████▊   | 173/256 [3:17:46<1:32:51, 67.12s/it] 68%|██████▊   | 174/256 [3:18:53<1:31:42, 67.11s/it] 68%|██████▊   | 175/256 [3:20:00<1:30:37, 67.13s/it] 69%|██████▉   | 176/256 [3:21:07<1:29:27, 67.10s/it] 69%|██████▉   | 177/256 [3:22:14<1:28:16, 67.05s/it] 70%|██████▉   | 178/256 [3:23:21<1:27:15, 67.13s/it] 70%|██████▉   | 179/256 [3:24:28<1:26:05, 67.09s/it] 70%|███████   | 180/256 [3:25:36<1:25:01, 67.13s/it] 71%|███████   | 181/256 [3:26:42<1:23:44, 67.00s/it] 71%|███████   | 182/256 [3:27:49<1:22:31, 66.92s/it] 71%|███████▏  | 183/256 [3:28:56<1:21:31, 67.01s/it] 72%|███████▏  | 184/256 [3:30:04<1:20:31, 67.11s/it] 72%|███████▏  | 185/256 [3:31:11<1:19:27, 67.14s/it] 73%|███████▎  | 186/256 [3:32:18<1:18:14, 67.07s/it] 73%|███████▎  | 187/256 [3:33:25<1:17:04, 67.02s/it] 73%|███████▎  | 188/256 [3:34:33<1:16:24, 67.41s/it] 74%|███████▍  | 189/256 [3:35:40<1:15:15, 67.40s/it] 74%|███████▍  | 190/256 [3:36:47<1:14:01, 67.30s/it] 75%|███████▍  | 191/256 [3:37:54<1:12:45, 67.16s/it] 75%|███████▌  | 192/256 [3:39:01<1:11:35, 67.12s/it] 75%|███████▌  | 193/256 [3:40:08<1:10:23, 67.04s/it] 76%|███████▌  | 194/256 [3:41:16<1:09:24, 67.17s/it] 76%|███████▌  | 195/256 [3:42:23<1:08:14, 67.12s/it] 77%|███████▋  | 196/256 [3:43:30<1:07:08, 67.13s/it] 77%|███████▋  | 197/256 [3:44:37<1:06:02, 67.16s/it] 77%|███████▋  | 198/256 [3:45:44<1:04:46, 67.00s/it] 78%|███████▊  | 199/256 [3:46:51<1:03:44, 67.10s/it] 78%|███████▊  | 200/256 [3:47:58<1:02:34, 67.04s/it] 79%|███████▊  | 201/256 [3:49:05<1:01:33, 67.15s/it] 79%|███████▉  | 202/256 [3:50:14<1:00:58, 67.76s/it] 79%|███████▉  | 203/256 [3:51:22<59:44, 67.63s/it]   80%|███████▉  | 204/256 [3:52:29<58:32, 67.55s/it] 80%|████████  | 205/256 [3:53:36<57:20, 67.46s/it] 80%|████████  | 206/256 [3:54:43<56:00, 67.22s/it] 81%|████████  | 207/256 [3:55:50<54:54, 67.24s/it] 81%|████████▏ | 208/256 [3:56:57<53:41, 67.12s/it] 82%|████████▏ | 209/256 [3:58:05<52:50, 67.47s/it] 82%|████████▏ | 210/256 [3:59:13<51:49, 67.60s/it] 82%|████████▏ | 211/256 [4:00:21<50:39, 67.54s/it] 83%|████████▎ | 212/256 [4:01:28<49:26, 67.42s/it] 83%|████████▎ | 213/256 [4:02:35<48:18, 67.41s/it] 84%|████████▎ | 214/256 [4:03:42<47:08, 67.35s/it] 84%|████████▍ | 215/256 [4:04:50<46:09, 67.55s/it] 84%|████████▍ | 216/256 [4:05:58<44:59, 67.48s/it] 85%|████████▍ | 217/256 [4:07:05<43:49, 67.42s/it] 85%|████████▌ | 218/256 [4:08:12<42:39, 67.35s/it] 86%|████████▌ | 219/256 [4:09:20<41:31, 67.33s/it] 86%|████████▌ | 220/256 [4:10:26<40:18, 67.18s/it] 86%|████████▋ | 221/256 [4:11:34<39:12, 67.22s/it] 87%|████████▋ | 222/256 [4:12:41<38:03, 67.16s/it] 87%|████████▋ | 223/256 [4:13:48<36:55, 67.13s/it] 88%|████████▊ | 224/256 [4:14:55<35:47, 67.10s/it] 88%|████████▊ | 225/256 [4:16:02<34:37, 67.02s/it] 88%|████████▊ | 226/256 [4:17:09<33:32, 67.07s/it] 89%|████████▊ | 227/256 [4:18:16<32:25, 67.08s/it] 89%|████████▉ | 228/256 [4:19:23<31:17, 67.06s/it] 89%|████████▉ | 229/256 [4:20:30<30:08, 66.98s/it] 90%|████████▉ | 230/256 [4:21:37<29:00, 66.94s/it] 90%|█████████ | 231/256 [4:22:43<27:52, 66.91s/it] 91%|█████████ | 232/256 [4:23:50<26:46, 66.94s/it] 91%|█████████ | 233/256 [4:24:58<25:41, 67.04s/it] 91%|█████████▏| 234/256 [4:26:05<24:35, 67.05s/it] 92%|█████████▏| 235/256 [4:27:12<23:28, 67.05s/it] 92%|█████████▏| 236/256 [4:28:18<22:18, 66.92s/it] 93%|█████████▎| 237/256 [4:29:25<21:10, 66.86s/it] 93%|█████████▎| 238/256 [4:30:32<20:06, 67.01s/it] 93%|█████████▎| 239/256 [4:31:39<18:58, 66.97s/it] 94%|█████████▍| 240/256 [4:32:46<17:49, 66.86s/it] 94%|█████████▍| 241/256 [4:33:53<16:43, 66.90s/it] 95%|█████████▍| 242/256 [4:35:00<15:35, 66.84s/it] 95%|█████████▍| 243/256 [4:36:07<14:30, 66.93s/it] 95%|█████████▌| 244/256 [4:37:14<13:24, 67.05s/it] 96%|█████████▌| 245/256 [4:38:21<12:16, 66.95s/it] 96%|█████████▌| 246/256 [4:39:28<11:10, 67.01s/it] 96%|█████████▋| 247/256 [4:40:35<10:02, 66.92s/it] 97%|█████████▋| 248/256 [4:41:42<08:55, 66.91s/it] 97%|█████████▋| 249/256 [4:42:49<07:49, 67.13s/it] 98%|█████████▊| 250/256 [4:43:57<06:43, 67.19s/it] 98%|█████████▊| 251/256 [4:45:04<05:36, 67.24s/it] 98%|█████████▊| 252/256 [4:46:11<04:28, 67.25s/it] 99%|█████████▉| 253/256 [4:47:18<03:21, 67.22s/it] 99%|█████████▉| 254/256 [4:48:31<02:17, 68.71s/it]100%|█████████▉| 255/256 [4:49:38<01:08, 68.28s/it]100%|██████████| 256/256 [4:50:45<00:00, 68.04s/it]2023-05-19 14:32:14 [INFO] Set transformer.wte.weight sparsity with mask 38400768 11520230 0.7000000104164583.
2023-05-19 14:32:14 [INFO] Set transformer.wpe.weight sparsity with mask 786432 235929 0.7000007629394531.
2023-05-19 14:32:14 [INFO] Set transformer.h.0.attn.c_attn.weight sparsity with mask 1769472 530841 0.7000003390842013.
2023-05-19 14:32:14 [INFO] Set transformer.h.0.attn.c_proj.weight sparsity with mask 589824 176947 0.7000003390842013.
2023-05-19 14:32:14 [INFO] Set transformer.h.0.mlp.c_fc.weight sparsity with mask 2359296 707788 0.7000003390842013.
2023-05-19 14:32:14 [INFO] Set transformer.h.0.mlp.c_proj.weight sparsity with mask 2359296 707788 0.7000003390842013.
2023-05-19 14:32:14 [INFO] Set transformer.h.1.attn.c_attn.weight sparsity with mask 1769472 530841 0.7000003390842013.
2023-05-19 14:32:14 [INFO] Set transformer.h.1.attn.c_proj.weight sparsity with mask 589824 176947 0.7000003390842013.
2023-05-19 14:32:14 [INFO] Set transformer.h.1.mlp.c_fc.weight sparsity with mask 2359296 707788 0.7000003390842013.
2023-05-19 14:32:14 [INFO] Set transformer.h.1.mlp.c_proj.weight sparsity with mask 2359296 707788 0.7000003390842013.
2023-05-19 14:32:14 [INFO] Set transformer.h.2.attn.c_attn.weight sparsity with mask 1769472 530841 0.7000003390842013.
2023-05-19 14:32:14 [INFO] Set transformer.h.2.attn.c_proj.weight sparsity with mask 589824 176947 0.7000003390842013.
2023-05-19 14:32:14 [INFO] Set transformer.h.2.mlp.c_fc.weight sparsity with mask 2359296 707788 0.7000003390842013.
2023-05-19 14:32:14 [INFO] Set transformer.h.2.mlp.c_proj.weight sparsity with mask 2359296 707788 0.7000003390842013.
2023-05-19 14:32:14 [INFO] Set transformer.h.3.attn.c_attn.weight sparsity with mask 1769472 530841 0.7000003390842013.
2023-05-19 14:32:14 [INFO] Set transformer.h.3.attn.c_proj.weight sparsity with mask 589824 176947 0.7000003390842013.
2023-05-19 14:32:14 [INFO] Set transformer.h.3.mlp.c_fc.weight sparsity with mask 2359296 707788 0.7000003390842013.
2023-05-19 14:32:14 [INFO] Set transformer.h.3.mlp.c_proj.weight sparsity with mask 2359296 707788 0.7000003390842013.
2023-05-19 14:32:14 [INFO] Set transformer.h.4.attn.c_attn.weight sparsity with mask 1769472 530841 0.7000003390842013.
2023-05-19 14:32:14 [INFO] Set transformer.h.4.attn.c_proj.weight sparsity with mask 589824 176947 0.7000003390842013.
2023-05-19 14:32:14 [INFO] Set transformer.h.4.mlp.c_fc.weight sparsity with mask 2359296 707788 0.7000003390842013.
2023-05-19 14:32:14 [INFO] Set transformer.h.4.mlp.c_proj.weight sparsity with mask 2359296 707788 0.7000003390842013.
2023-05-19 14:32:14 [INFO] Set transformer.h.5.attn.c_attn.weight sparsity with mask 1769472 530841 0.7000003390842013.
2023-05-19 14:32:14 [INFO] Set transformer.h.5.attn.c_proj.weight sparsity with mask 589824 176947 0.7000003390842013.
2023-05-19 14:32:14 [INFO] Set transformer.h.5.mlp.c_fc.weight sparsity with mask 2359296 707788 0.7000003390842013.
2023-05-19 14:32:14 [INFO] Set transformer.h.5.mlp.c_proj.weight sparsity with mask 2359296 707788 0.7000003390842013.
2023-05-19 14:32:14 [INFO] Set transformer.h.6.attn.c_attn.weight sparsity with mask 1769472 530841 0.7000003390842013.
2023-05-19 14:32:14 [INFO] Set transformer.h.6.attn.c_proj.weight sparsity with mask 589824 176947 0.7000003390842013.
2023-05-19 14:32:14 [INFO] Set transformer.h.6.mlp.c_fc.weight sparsity with mask 2359296 707788 0.7000003390842013.
2023-05-19 14:32:14 [INFO] Set transformer.h.6.mlp.c_proj.weight sparsity with mask 2359296 707788 0.7000003390842013.
2023-05-19 14:32:14 [INFO] Set transformer.h.7.attn.c_attn.weight sparsity with mask 1769472 530841 0.7000003390842013.
2023-05-19 14:32:14 [INFO] Set transformer.h.7.attn.c_proj.weight sparsity with mask 589824 176947 0.7000003390842013.
2023-05-19 14:32:14 [INFO] Set transformer.h.7.mlp.c_fc.weight sparsity with mask 2359296 707788 0.7000003390842013.
2023-05-19 14:32:14 [INFO] Set transformer.h.7.mlp.c_proj.weight sparsity with mask 2359296 707788 0.7000003390842013.
2023-05-19 14:32:14 [INFO] Set transformer.h.8.attn.c_attn.weight sparsity with mask 1769472 530841 0.7000003390842013.
2023-05-19 14:32:14 [INFO] Set transformer.h.8.attn.c_proj.weight sparsity with mask 589824 176947 0.7000003390842013.
2023-05-19 14:32:14 [INFO] Set transformer.h.8.mlp.c_fc.weight sparsity with mask 2359296 707788 0.7000003390842013.
2023-05-19 14:32:14 [INFO] Set transformer.h.8.mlp.c_proj.weight sparsity with mask 2359296 707788 0.7000003390842013.
2023-05-19 14:32:14 [INFO] Set transformer.h.9.attn.c_attn.weight sparsity with mask 1769472 530841 0.7000003390842013.
2023-05-19 14:32:14 [INFO] Set transformer.h.9.attn.c_proj.weight sparsity with mask 589824 176947 0.7000003390842013.
2023-05-19 14:32:14 [INFO] Set transformer.h.9.mlp.c_fc.weight sparsity with mask 2359296 707788 0.7000003390842013.
2023-05-19 14:32:14 [INFO] Set transformer.h.9.mlp.c_proj.weight sparsity with mask 2359296 707788 0.7000003390842013.
2023-05-19 14:32:14 [INFO] Set transformer.h.10.attn.c_attn.weight sparsity with mask 1769472 530841 0.7000003390842013.
2023-05-19 14:32:14 [INFO] Set transformer.h.10.attn.c_proj.weight sparsity with mask 589824 176947 0.7000003390842013.
2023-05-19 14:32:14 [INFO] Set transformer.h.10.mlp.c_fc.weight sparsity with mask 2359296 707788 0.7000003390842013.
2023-05-19 14:32:14 [INFO] Set transformer.h.10.mlp.c_proj.weight sparsity with mask 2359296 707788 0.7000003390842013.
2023-05-19 14:32:14 [INFO] Set transformer.h.11.attn.c_attn.weight sparsity with mask 1769472 530841 0.7000003390842013.
2023-05-19 14:32:14 [INFO] Set transformer.h.11.attn.c_proj.weight sparsity with mask 589824 176947 0.7000003390842013.
2023-05-19 14:32:14 [INFO] Set transformer.h.11.mlp.c_fc.weight sparsity with mask 2359296 707788 0.7000003390842013.
2023-05-19 14:32:14 [INFO] Set transformer.h.11.mlp.c_proj.weight sparsity with mask 2359296 707788 0.7000003390842013.
2023-05-19 14:32:15 [INFO]                                    Name  ... Sparsity(%)
0                transformer.wte.weight  ...       70.00
1                transformer.wpe.weight  ...       70.00
2             transformer.h.0.attn.bias  ...       49.95
3    transformer.h.0.attn.c_attn.weight  ...       70.00
4    transformer.h.0.attn.c_proj.weight  ...       70.00
..                                  ...  ...         ...
59  transformer.h.11.attn.c_proj.weight  ...       70.00
60     transformer.h.11.mlp.c_fc.weight  ...       70.00
61   transformer.h.11.mlp.c_proj.weight  ...       70.00
62                       lm_head.weight  ...       70.00
63                      Total sparsity:  ...       68.56

[64 rows x 5 columns]
2023-05-19 14:32:15 [INFO] 68.55932812997986
2023-05-19 14:32:15 [INFO] 

Training completed. Do not forget to share your model on huggingface.co/models =)


                                                   100%|██████████| 256/256 [4:50:47<00:00, 68.04s/it]100%|██████████| 256/256 [4:50:47<00:00, 68.15s/it]
2023-05-19 14:32:15 [INFO] Saving model checkpoint to ./test_epoch
2023-05-19 14:32:20 [INFO] Model pruning is done. Start to evaluate the pruned model.
2023-05-19 14:32:20 [INFO] Pruned model score is [].
2023-05-19 14:32:21 [INFO]                                    Name  ... Sparsity(%)
0                transformer.wte.weight  ...       70.00
1                transformer.wpe.weight  ...       70.00
2             transformer.h.0.attn.bias  ...       49.95
3    transformer.h.0.attn.c_attn.weight  ...       70.00
4    transformer.h.0.attn.c_proj.weight  ...       70.00
..                                  ...  ...         ...
59  transformer.h.11.attn.c_proj.weight  ...       70.00
60     transformer.h.11.mlp.c_fc.weight  ...       70.00
61   transformer.h.11.mlp.c_proj.weight  ...       70.00
62                       lm_head.weight  ...       70.00
63                      Total sparsity:  ...       68.56

[64 rows x 5 columns]
2023-05-19 14:32:21 [INFO] 68.55932812997986
2023-05-19 14:32:21 [INFO] Saving model checkpoint to ./CodeGPT-Py150_pruned_70.0%_sparsity
2023-05-19 14:32:28 [WARNING] Force convert framework model to neural_compressor model.
2023-05-19 14:32:29 [INFO] Start to get the baseline model's score before pruning.
2023-05-19 14:32:29 [INFO] Baseline model's score is [].
2023-05-19 14:32:29 [INFO] Model pruning begins.
2023-05-19 14:32:29 [INFO] The following columns in the training set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: output, code, input.
/home/dsochirca/.conda/envs/test/lib/python3.7/site-packages/transformers/optimization.py:395: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  FutureWarning,
2023-05-19 14:32:29 [INFO] ***** Running training *****
2023-05-19 14:32:29 [INFO]   Num examples = 128
2023-05-19 14:32:29 [INFO]   Num Epochs = 2
2023-05-19 14:32:29 [INFO]   Instantaneous batch size per device = 1
2023-05-19 14:32:29 [INFO]   Total train batch size (w. parallel, distributed & accumulation) = 1
2023-05-19 14:32:29 [INFO]   Gradient Accumulation steps = 1
2023-05-19 14:32:29 [INFO]   Total optimization steps = 256
  0%|          | 0/256 [00:00<?, ?it/s]/home/dsochirca/.conda/envs/test/lib/python3.7/site-packages/neural_compressor/experimental/pruner_legacy/group_lasso.py:51: RuntimeWarning: divide by zero encountered in true_divide
  coeff = self.alpha / np.linalg.norm(reshaped_weight, 2, axis=(1,3))
  0%|          | 1/256 [01:50<7:51:29, 110.94s/it]  1%|          | 2/256 [02:58<6:01:50, 85.47s/it]   1%|          | 3/256 [04:09<5:33:03, 78.99s/it]  2%|▏         | 4/256 [05:17<5:12:49, 74.48s/it]  2%|▏         | 5/256 [06:28<5:06:57, 73.38s/it]  2%|▏         | 6/256 [07:36<4:57:07, 71.31s/it]  3%|▎         | 7/256 [08:43<4:50:02, 69.89s/it]  3%|▎         | 8/256 [09:50<4:45:19, 69.03s/it]  4%|▎         | 9/256 [10:57<4:41:16, 68.32s/it]  4%|▍         | 10/256 [12:04<4:38:39, 67.96s/it]  4%|▍         | 11/256 [13:11<4:36:03, 67.61s/it]  5%|▍         | 12/256 [14:19<4:35:44, 67.81s/it]  5%|▌         | 13/256 [15:31<4:39:39, 69.05s/it]  5%|▌         | 14/256 [16:38<4:36:07, 68.46s/it]  6%|▌         | 15/256 [17:46<4:34:06, 68.24s/it]  6%|▋         | 16/256 [18:52<4:31:22, 67.84s/it]  7%|▋         | 17/256 [19:59<4:29:10, 67.58s/it]  7%|▋         | 18/256 [21:06<4:27:14, 67.37s/it]  7%|▋         | 19/256 [22:13<4:25:20, 67.18s/it]  8%|▊         | 20/256 [23:20<4:23:53, 67.09s/it]  8%|▊         | 21/256 [24:27<4:22:32, 67.03s/it]  9%|▊         | 22/256 [25:34<4:21:20, 67.01s/it]  9%|▉         | 23/256 [26:41<4:20:01, 66.96s/it]  9%|▉         | 24/256 [27:47<4:18:47, 66.93s/it] 10%|▉         | 25/256 [28:55<4:17:53, 66.99s/it] 10%|█         | 26/256 [30:02<4:17:12, 67.10s/it] 11%|█         | 27/256 [31:09<4:16:14, 67.14s/it] 11%|█         | 28/256 [32:16<4:15:14, 67.17s/it] 11%|█▏        | 29/256 [33:23<4:13:59, 67.13s/it] 12%|█▏        | 30/256 [34:31<4:13:05, 67.19s/it] 12%|█▏        | 31/256 [35:39<4:13:06, 67.50s/it] 12%|█▎        | 32/256 [36:49<4:14:53, 68.27s/it] 13%|█▎        | 33/256 [37:56<4:12:03, 67.82s/it] 13%|█▎        | 34/256 [39:03<4:09:48, 67.52s/it] 14%|█▎        | 35/256 [40:09<4:07:39, 67.24s/it] 14%|█▍        | 36/256 [41:16<4:06:16, 67.17s/it] 14%|█▍        | 37/256 [42:23<4:04:53, 67.10s/it] 15%|█▍        | 38/256 [43:31<4:04:30, 67.30s/it] 15%|█▌        | 39/256 [44:41<4:06:13, 68.08s/it] 16%|█▌        | 40/256 [45:48<4:04:09, 67.82s/it] 16%|█▌        | 41/256 [46:55<4:02:31, 67.68s/it] 16%|█▋        | 42/256 [48:02<4:00:41, 67.49s/it] 17%|█▋        | 43/256 [49:10<3:59:31, 67.47s/it] 17%|█▋        | 44/256 [50:17<3:58:21, 67.46s/it] 18%|█▊        | 45/256 [51:24<3:56:38, 67.29s/it] 18%|█▊        | 46/256 [52:32<3:55:31, 67.29s/it] 18%|█▊        | 47/256 [53:39<3:54:18, 67.27s/it] 19%|█▉        | 48/256 [54:47<3:54:04, 67.52s/it] 19%|█▉        | 49/256 [55:54<3:52:20, 67.35s/it] 20%|█▉        | 50/256 [57:01<3:50:51, 67.24s/it] 20%|█▉        | 51/256 [58:08<3:49:34, 67.19s/it] 20%|██        | 52/256 [59:15<3:48:23, 67.17s/it] 21%|██        | 53/256 [1:00:22<3:46:48, 67.03s/it] 21%|██        | 54/256 [1:01:29<3:46:07, 67.17s/it] 21%|██▏       | 55/256 [1:02:37<3:45:15, 67.24s/it] 22%|██▏       | 56/256 [1:03:43<3:43:28, 67.04s/it] 22%|██▏       | 57/256 [1:04:50<3:42:34, 67.11s/it] 23%|██▎       | 58/256 [1:05:57<3:41:13, 67.04s/it] 23%|██▎       | 59/256 [1:07:04<3:40:15, 67.09s/it] 23%|██▎       | 60/256 [1:08:11<3:38:59, 67.04s/it] 24%|██▍       | 61/256 [1:09:19<3:37:57, 67.07s/it] 24%|██▍       | 62/256 [1:10:24<3:35:40, 66.70s/it] 25%|██▍       | 63/256 [1:11:34<3:37:18, 67.56s/it] 25%|██▌       | 64/256 [1:12:41<3:35:50, 67.45s/it] 25%|██▌       | 65/256 [1:13:49<3:34:48, 67.48s/it] 26%|██▌       | 66/256 [1:14:56<3:33:12, 67.33s/it] 26%|██▌       | 67/256 [1:16:03<3:31:57, 67.29s/it] 27%|██▋       | 68/256 [1:17:10<3:30:48, 67.28s/it] 27%|██▋       | 69/256 [1:18:18<3:29:50, 67.33s/it] 27%|██▋       | 70/256 [1:19:25<3:28:55, 67.40s/it] 28%|██▊       | 71/256 [1:20:32<3:27:39, 67.35s/it] 28%|██▊       | 72/256 [1:21:39<3:26:15, 67.26s/it] 29%|██▊       | 73/256 [1:22:47<3:25:35, 67.41s/it] 29%|██▉       | 74/256 [1:23:55<3:24:27, 67.41s/it] 29%|██▉       | 75/256 [1:25:02<3:23:22, 67.42s/it] 30%|██▉       | 76/256 [1:26:09<3:22:12, 67.40s/it] 30%|███       | 77/256 [1:27:17<3:21:00, 67.38s/it] 30%|███       | 78/256 [1:28:24<3:19:22, 67.20s/it] 31%|███       | 79/256 [1:29:30<3:17:56, 67.10s/it] 31%|███▏      | 80/256 [1:30:41<3:19:59, 68.18s/it] 32%|███▏      | 81/256 [1:31:48<3:17:49, 67.83s/it] 32%|███▏      | 82/256 [1:32:55<3:16:01, 67.59s/it] 32%|███▏      | 83/256 [1:34:02<3:14:11, 67.35s/it] 33%|███▎      | 84/256 [1:35:09<3:13:03, 67.35s/it] 33%|███▎      | 85/256 [1:36:16<3:11:30, 67.20s/it] 34%|███▎      | 86/256 [1:37:23<3:10:31, 67.25s/it] 34%|███▍      | 87/256 [1:38:30<3:08:57, 67.09s/it] 34%|███▍      | 88/256 [1:39:37<3:07:59, 67.14s/it] 35%|███▍      | 89/256 [1:40:45<3:07:04, 67.22s/it] 35%|███▌      | 90/256 [1:41:52<3:06:18, 67.34s/it] 36%|███▌      | 91/256 [1:43:00<3:05:09, 67.33s/it] 36%|███▌      | 92/256 [1:44:07<3:03:58, 67.31s/it] 36%|███▋      | 93/256 [1:45:14<3:02:23, 67.14s/it] 37%|███▋      | 94/256 [1:46:21<3:01:02, 67.05s/it] 37%|███▋      | 95/256 [1:47:30<3:02:01, 67.84s/it] 38%|███▊      | 96/256 [1:48:37<3:00:22, 67.64s/it] 38%|███▊      | 97/256 [1:49:44<2:58:24, 67.32s/it] 38%|███▊      | 98/256 [1:50:51<2:56:50, 67.15s/it] 39%|███▊      | 99/256 [1:51:58<2:55:29, 67.07s/it] 39%|███▉      | 100/256 [1:53:04<2:54:00, 66.93s/it] 39%|███▉      | 101/256 [1:54:11<2:52:57, 66.95s/it] 40%|███▉      | 102/256 [1:55:18<2:51:52, 66.96s/it] 40%|████      | 103/256 [1:56:25<2:50:49, 66.99s/it] 41%|████      | 104/256 [1:57:32<2:49:32, 66.92s/it] 41%|████      | 105/256 [1:58:39<2:48:36, 67.00s/it] 41%|████▏     | 106/256 [1:59:46<2:47:06, 66.85s/it] 42%|████▏     | 107/256 [2:00:52<2:45:42, 66.73s/it] 42%|████▏     | 108/256 [2:01:59<2:44:36, 66.74s/it] 43%|████▎     | 109/256 [2:03:05<2:43:18, 66.65s/it] 43%|████▎     | 110/256 [2:04:12<2:42:14, 66.67s/it] 43%|████▎     | 111/256 [2:05:19<2:41:31, 66.84s/it] 44%|████▍     | 112/256 [2:06:26<2:40:30, 66.88s/it] 44%|████▍     | 113/256 [2:07:33<2:39:34, 66.95s/it] 45%|████▍     | 114/256 [2:08:40<2:38:06, 66.81s/it] 45%|████▍     | 115/256 [2:09:47<2:37:14, 66.91s/it] 45%|████▌     | 116/256 [2:10:54<2:36:12, 66.95s/it] 46%|████▌     | 117/256 [2:12:02<2:35:31, 67.13s/it] 46%|████▌     | 118/256 [2:13:08<2:33:53, 66.91s/it] 46%|████▋     | 119/256 [2:14:15<2:32:40, 66.86s/it] 47%|████▋     | 120/256 [2:15:22<2:31:29, 66.83s/it] 47%|████▋     | 121/256 [2:16:35<2:34:51, 68.83s/it] 48%|████▊     | 122/256 [2:17:52<2:39:11, 71.28s/it] 48%|████▊     | 123/256 [2:18:59<2:35:03, 69.95s/it] 48%|████▊     | 124/256 [2:20:06<2:31:57, 69.07s/it] 49%|████▉     | 125/256 [2:21:13<2:29:28, 68.46s/it] 49%|████▉     | 126/256 [2:22:20<2:27:27, 68.05s/it] 50%|████▉     | 127/256 [2:23:27<2:25:36, 67.73s/it] 50%|█████     | 128/256 [2:24:34<2:24:09, 67.57s/it]2023-05-19 16:57:04 [INFO]                                    Name  ... Sparsity(%)
0                transformer.wte.weight  ...       70.00
1                transformer.wpe.weight  ...       70.00
2             transformer.h.0.attn.bias  ...       49.95
3    transformer.h.0.attn.c_attn.weight  ...       70.00
4    transformer.h.0.attn.c_proj.weight  ...       70.00
..                                  ...  ...         ...
59  transformer.h.11.attn.c_proj.weight  ...       70.00
60     transformer.h.11.mlp.c_fc.weight  ...       70.00
61   transformer.h.11.mlp.c_proj.weight  ...       70.00
62                       lm_head.weight  ...       70.00
63                      Total sparsity:  ...       68.56

[64 rows x 5 columns]
2023-05-19 16:57:04 [INFO] 68.55932812997986
/home/dsochirca/.conda/envs/test/lib/python3.7/site-packages/neural_compressor/experimental/pruner_legacy/group_lasso.py:51: RuntimeWarning: divide by zero encountered in true_divide
  coeff = self.alpha / np.linalg.norm(reshaped_weight, 2, axis=(1,3))
 50%|█████     | 129/256 [2:26:26<2:51:06, 80.84s/it] 51%|█████     | 130/256 [2:27:33<2:41:09, 76.74s/it] 51%|█████     | 131/256 [2:28:40<2:33:40, 73.77s/it] 52%|█████▏    | 132/256 [2:29:47<2:28:12, 71.71s/it] 52%|█████▏    | 133/256 [2:30:54<2:24:03, 70.27s/it] 52%|█████▏    | 134/256 [2:32:01<2:20:44, 69.22s/it] 53%|█████▎    | 135/256 [2:33:08<2:18:36, 68.73s/it] 53%|█████▎    | 136/256 [2:34:15<2:16:18, 68.16s/it] 54%|█████▎    | 137/256 [2:35:26<2:17:00, 69.08s/it] 54%|█████▍    | 138/256 [2:36:43<2:20:28, 71.42s/it] 54%|█████▍    | 139/256 [2:38:03<2:24:08, 73.92s/it] 55%|█████▍    | 140/256 [2:39:10<2:19:06, 71.95s/it] 55%|█████▌    | 141/256 [2:40:17<2:14:58, 70.42s/it] 55%|█████▌    | 142/256 [2:41:24<2:11:36, 69.27s/it] 56%|█████▌    | 143/256 [2:42:30<2:08:53, 68.44s/it] 56%|█████▋    | 144/256 [2:43:37<2:07:00, 68.04s/it] 57%|█████▋    | 145/256 [2:44:44<2:05:15, 67.71s/it] 57%|█████▋    | 146/256 [2:45:51<2:03:27, 67.34s/it] 57%|█████▋    | 147/256 [2:46:58<2:02:07, 67.23s/it] 58%|█████▊    | 148/256 [2:48:04<2:00:42, 67.06s/it] 58%|█████▊    | 149/256 [2:49:11<1:59:24, 66.96s/it] 59%|█████▊    | 150/256 [2:50:18<1:58:20, 66.98s/it] 59%|█████▉    | 151/256 [2:51:25<1:57:09, 66.94s/it] 59%|█████▉    | 152/256 [2:52:32<1:56:03, 66.96s/it] 60%|█████▉    | 153/256 [2:53:39<1:54:54, 66.94s/it] 60%|██████    | 154/256 [2:54:46<1:53:38, 66.84s/it] 61%|██████    | 155/256 [2:55:52<1:52:32, 66.86s/it] 61%|██████    | 156/256 [2:56:59<1:51:15, 66.76s/it] 61%|██████▏   | 157/256 [2:58:06<1:50:04, 66.71s/it] 62%|██████▏   | 158/256 [2:59:12<1:48:51, 66.64s/it] 62%|██████▏   | 159/256 [3:00:19<1:47:50, 66.71s/it] 62%|██████▎   | 160/256 [3:01:26<1:46:50, 66.77s/it] 63%|██████▎   | 161/256 [3:02:33<1:45:46, 66.80s/it] 63%|██████▎   | 162/256 [3:03:39<1:44:38, 66.79s/it] 64%|██████▎   | 163/256 [3:04:47<1:43:40, 66.89s/it] 64%|██████▍   | 164/256 [3:05:53<1:42:19, 66.74s/it] 64%|██████▍   | 165/256 [3:06:59<1:41:06, 66.66s/it] 65%|██████▍   | 166/256 [3:08:06<1:39:59, 66.67s/it] 65%|██████▌   | 167/256 [3:09:13<1:38:49, 66.62s/it] 66%|██████▌   | 168/256 [3:10:19<1:37:40, 66.60s/it] 66%|██████▌   | 169/256 [3:11:26<1:36:48, 66.77s/it] 66%|██████▋   | 170/256 [3:12:35<1:36:27, 67.30s/it] 67%|██████▋   | 171/256 [3:13:42<1:35:18, 67.28s/it] 67%|██████▋   | 172/256 [3:14:49<1:34:07, 67.24s/it] 68%|██████▊   | 173/256 [3:15:56<1:32:58, 67.21s/it] 68%|██████▊   | 174/256 [3:17:03<1:31:48, 67.17s/it] 68%|██████▊   | 175/256 [3:18:10<1:30:36, 67.12s/it] 69%|██████▉   | 176/256 [3:19:17<1:29:23, 67.04s/it] 69%|██████▉   | 177/256 [3:20:24<1:28:18, 67.07s/it] 70%|██████▉   | 178/256 [3:21:32<1:27:16, 67.14s/it] 70%|██████▉   | 179/256 [3:22:39<1:26:06, 67.10s/it] 70%|███████   | 180/256 [3:23:46<1:24:53, 67.02s/it] 71%|███████   | 181/256 [3:24:52<1:23:32, 66.83s/it] 71%|███████   | 182/256 [3:25:58<1:22:18, 66.73s/it] 71%|███████▏  | 183/256 [3:27:05<1:21:13, 66.76s/it] 72%|███████▏  | 184/256 [3:28:13<1:20:16, 66.89s/it] 72%|███████▏  | 185/256 [3:29:20<1:19:11, 66.93s/it] 73%|███████▎  | 186/256 [3:30:26<1:18:05, 66.94s/it] 73%|███████▎  | 187/256 [3:31:33<1:16:55, 66.89s/it] 73%|███████▎  | 188/256 [3:32:40<1:15:48, 66.89s/it] 74%|███████▍  | 189/256 [3:33:47<1:14:34, 66.79s/it] 74%|███████▍  | 190/256 [3:34:53<1:13:20, 66.67s/it] 75%|███████▍  | 191/256 [3:36:05<1:13:56, 68.25s/it] 75%|███████▌  | 192/256 [3:37:12<1:12:27, 67.93s/it] 75%|███████▌  | 193/256 [3:38:19<1:10:54, 67.53s/it] 76%|███████▌  | 194/256 [3:39:25<1:09:22, 67.14s/it] 76%|███████▌  | 195/256 [3:40:32<1:08:03, 66.94s/it] 77%|███████▋  | 196/256 [3:41:39<1:06:58, 66.97s/it] 77%|███████▋  | 197/256 [3:42:45<1:05:41, 66.80s/it] 77%|███████▋  | 198/256 [3:43:52<1:04:30, 66.73s/it] 78%|███████▊  | 199/256 [3:44:59<1:03:29, 66.84s/it] 78%|███████▊  | 200/256 [3:46:06<1:02:24, 66.87s/it] 79%|███████▊  | 201/256 [3:47:12<1:01:13, 66.79s/it] 79%|███████▉  | 202/256 [3:48:19<1:00:04, 66.74s/it] 79%|███████▉  | 203/256 [3:49:26<59:03, 66.85s/it]   80%|███████▉  | 204/256 [3:50:32<57:49, 66.72s/it] 80%|████████  | 205/256 [3:51:39<56:48, 66.82s/it] 80%|████████  | 206/256 [3:52:46<55:37, 66.75s/it] 81%|████████  | 207/256 [3:53:53<54:33, 66.81s/it] 81%|████████▏ | 208/256 [3:55:01<53:38, 67.06s/it] 82%|████████▏ | 209/256 [3:56:07<52:29, 67.01s/it] 82%|████████▏ | 210/256 [3:57:14<51:17, 66.90s/it] 82%|████████▏ | 211/256 [3:58:21<50:10, 66.91s/it] 83%|████████▎ | 212/256 [3:59:28<49:04, 66.93s/it] 83%|████████▎ | 213/256 [4:00:35<47:58, 66.95s/it] 84%|████████▎ | 214/256 [4:01:42<46:46, 66.82s/it] 84%|████████▍ | 215/256 [4:02:49<45:44, 66.93s/it] 84%|████████▍ | 216/256 [4:03:56<44:39, 67.00s/it] 85%|████████▍ | 217/256 [4:05:03<43:34, 67.05s/it] 85%|████████▌ | 218/256 [4:06:10<42:27, 67.04s/it] 86%|████████▌ | 219/256 [4:07:17<41:15, 66.89s/it] 86%|████████▌ | 220/256 [4:08:24<40:16, 67.12s/it] 86%|████████▋ | 221/256 [4:09:33<39:21, 67.46s/it] 87%|████████▋ | 222/256 [4:10:39<38:05, 67.23s/it] 87%|████████▋ | 223/256 [4:11:46<36:50, 67.00s/it] 88%|████████▊ | 224/256 [4:12:53<35:43, 66.99s/it] 88%|████████▊ | 225/256 [4:14:00<34:36, 66.99s/it] 88%|████████▊ | 226/256 [4:15:06<33:28, 66.94s/it] 89%|████████▊ | 227/256 [4:16:13<32:21, 66.94s/it] 89%|████████▉ | 228/256 [4:17:20<31:11, 66.83s/it] 89%|████████▉ | 229/256 [4:18:30<30:33, 67.90s/it] 90%|████████▉ | 230/256 [4:19:37<29:17, 67.61s/it] 90%|█████████ | 231/256 [4:20:44<28:04, 67.39s/it] 91%|█████████ | 232/256 [4:21:55<27:19, 68.31s/it] 91%|█████████ | 233/256 [4:23:01<26:00, 67.86s/it]slurmstepd: error: *** STEP 2327687.0 ON cmp004 CANCELLED AT 2023-05-19T18:55:32 DUE TO TIME LIMIT ***
srun: Job step aborted: Waiting up to 32 seconds for job step to finish.
slurmstepd: error: *** JOB 2327687 ON cmp004 CANCELLED AT 2023-05-19T18:55:32 DUE TO TIME LIMIT ***
