Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Found cached dataset codexglue (/home/dsochirca/.cache/huggingface/datasets/0n1xus___codexglue/code-completion-token-py150/1.0.1/cbc1754b04b259211f238bbcad21909b788b5c2c10a60ee52429a8b4be0ffbbe)
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:06<00:12,  6.40s/it] 67%|██████▋   | 2/3 [00:07<00:03,  3.57s/it]100%|██████████| 3/3 [00:10<00:00,  3.10s/it]100%|██████████| 3/3 [00:10<00:00,  3.51s/it]
  0%|          | 0/50000 [00:00<?, ?it/s] 11%|█▏        | 5687/50000 [00:00<00:00, 56861.65it/s] 23%|██▎       | 11442/50000 [00:00<00:00, 57251.88it/s] 35%|███▌      | 17581/50000 [00:00<00:00, 59137.20it/s] 47%|████▋     | 23495/50000 [00:00<00:00, 38130.43it/s] 59%|█████▉    | 29451/50000 [00:00<00:00, 43843.16it/s] 70%|███████   | 35148/50000 [00:00<00:00, 47460.63it/s] 82%|████████▏ | 40844/50000 [00:00<00:00, 50145.56it/s] 93%|█████████▎| 46505/50000 [00:00<00:00, 52003.66it/s]100%|██████████| 50000/50000 [00:02<00:00, 22585.26it/s]
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
2023-06-14 19:18:55 [WARNING] Force convert framework model to neural_compressor model.
2023-06-14 19:18:55 [INFO] Pass query framework capability elapsed time: 1.23 ms
2023-06-14 19:18:55 [INFO] Adaptor has 1 recipes.
2023-06-14 19:18:55 [INFO] 0 recipes specified by user.
2023-06-14 19:18:55 [INFO] 0 recipes require future tuning.
2023-06-14 19:18:55 [INFO] ..............use_distributed_tuning: None
2023-06-14 19:18:55 [INFO] Get FP32 model baseline.
2023-06-14 19:18:55 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: input, output, code.
You're using a GPT2TokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:38,  2.57it/s]  3%|▎         | 3/100 [00:01<00:54,  1.77it/s]  4%|▍         | 4/100 [00:02<01:05,  1.47it/s]  5%|▌         | 5/100 [00:03<01:06,  1.42it/s]  6%|▌         | 6/100 [00:04<01:09,  1.35it/s]  7%|▋         | 7/100 [00:04<01:10,  1.32it/s]  8%|▊         | 8/100 [00:05<01:11,  1.29it/s]  9%|▉         | 9/100 [00:06<01:12,  1.26it/s] 10%|█         | 10/100 [00:07<01:09,  1.30it/s] 11%|█         | 11/100 [00:07<01:08,  1.30it/s] 12%|█▏        | 12/100 [00:09<01:38,  1.12s/it] 13%|█▎        | 13/100 [00:10<01:34,  1.09s/it] 14%|█▍        | 14/100 [00:11<01:23,  1.03it/s] 15%|█▌        | 15/100 [00:12<01:16,  1.11it/s] 16%|█▌        | 16/100 [00:13<01:12,  1.16it/s] 17%|█▋        | 17/100 [00:13<01:09,  1.20it/s] 18%|█▊        | 18/100 [00:14<01:07,  1.22it/s] 19%|█▉        | 19/100 [00:15<01:03,  1.28it/s] 20%|██        | 20/100 [00:16<01:01,  1.30it/s] 21%|██        | 21/100 [00:17<01:16,  1.03it/s] 22%|██▏       | 22/100 [00:20<01:55,  1.48s/it] 23%|██▎       | 23/100 [00:21<01:40,  1.31s/it] 24%|██▍       | 24/100 [00:21<01:27,  1.15s/it] 25%|██▌       | 25/100 [00:23<01:35,  1.28s/it] 26%|██▌       | 26/100 [00:26<02:23,  1.94s/it] 27%|██▋       | 27/100 [00:30<02:51,  2.34s/it] 28%|██▊       | 28/100 [00:34<03:19,  2.77s/it] 29%|██▉       | 29/100 [00:35<02:47,  2.35s/it] 30%|███       | 30/100 [00:36<02:11,  1.89s/it] 31%|███       | 31/100 [00:36<01:45,  1.53s/it] 32%|███▏      | 32/100 [00:40<02:35,  2.28s/it] 33%|███▎      | 33/100 [00:42<02:15,  2.02s/it] 34%|███▍      | 34/100 [00:43<01:50,  1.67s/it] 35%|███▌      | 35/100 [00:44<01:32,  1.43s/it] 36%|███▌      | 36/100 [00:44<01:17,  1.21s/it] 37%|███▋      | 37/100 [00:45<01:08,  1.08s/it] 38%|███▊      | 38/100 [00:46<01:02,  1.01s/it] 39%|███▉      | 39/100 [00:47<00:57,  1.07it/s] 40%|████      | 40/100 [00:47<00:52,  1.13it/s] 41%|████      | 41/100 [00:48<00:50,  1.16it/s] 42%|████▏     | 42/100 [00:49<00:49,  1.18it/s] 43%|████▎     | 43/100 [00:50<00:47,  1.20it/s] 44%|████▍     | 44/100 [00:51<00:46,  1.21it/s] 45%|████▌     | 45/100 [00:51<00:43,  1.26it/s] 46%|████▌     | 46/100 [00:52<00:46,  1.16it/s] 47%|████▋     | 47/100 [00:56<01:34,  1.78s/it] 48%|████▊     | 48/100 [00:59<01:50,  2.12s/it] 49%|████▉     | 49/100 [01:00<01:28,  1.74s/it] 50%|█████     | 50/100 [01:02<01:22,  1.66s/it] 51%|█████     | 51/100 [01:03<01:19,  1.62s/it] 52%|█████▏    | 52/100 [01:04<01:04,  1.35s/it] 53%|█████▎    | 53/100 [01:04<00:54,  1.15s/it] 54%|█████▍    | 54/100 [01:05<00:51,  1.12s/it] 55%|█████▌    | 55/100 [01:08<01:06,  1.47s/it] 56%|█████▌    | 56/100 [01:09<00:56,  1.28s/it] 57%|█████▋    | 57/100 [01:09<00:48,  1.14s/it] 58%|█████▊    | 58/100 [01:12<01:04,  1.55s/it] 59%|█████▉    | 59/100 [01:15<01:18,  1.92s/it] 60%|██████    | 60/100 [01:18<01:36,  2.42s/it] 61%|██████    | 61/100 [01:19<01:16,  1.96s/it] 62%|██████▏   | 62/100 [01:20<01:00,  1.60s/it] 63%|██████▎   | 63/100 [01:21<00:50,  1.36s/it] 64%|██████▍   | 64/100 [01:23<00:55,  1.53s/it] 65%|██████▌   | 65/100 [01:24<00:46,  1.32s/it] 66%|██████▌   | 66/100 [01:24<00:39,  1.16s/it] 67%|██████▋   | 67/100 [01:25<00:34,  1.05s/it] 68%|██████▊   | 68/100 [01:26<00:31,  1.03it/s] 69%|██████▉   | 69/100 [01:27<00:31,  1.02s/it] 70%|███████   | 70/100 [01:29<00:37,  1.24s/it] 71%|███████   | 71/100 [01:33<00:59,  2.04s/it] 72%|███████▏  | 72/100 [01:33<00:46,  1.67s/it] 73%|███████▎  | 73/100 [01:36<00:50,  1.86s/it] 74%|███████▍  | 74/100 [01:38<00:53,  2.06s/it] 75%|███████▌  | 75/100 [01:39<00:42,  1.70s/it] 76%|███████▌  | 76/100 [01:40<00:35,  1.46s/it] 77%|███████▋  | 77/100 [01:41<00:30,  1.31s/it] 78%|███████▊  | 78/100 [01:42<00:29,  1.36s/it] 79%|███████▉  | 79/100 [01:43<00:25,  1.20s/it] 80%|████████  | 80/100 [01:44<00:22,  1.11s/it] 81%|████████  | 81/100 [01:45<00:19,  1.05s/it] 82%|████████▏ | 82/100 [01:46<00:17,  1.04it/s] 83%|████████▎ | 83/100 [01:47<00:15,  1.10it/s] 84%|████████▍ | 84/100 [01:49<00:22,  1.38s/it] 85%|████████▌ | 85/100 [01:50<00:19,  1.27s/it] 86%|████████▌ | 86/100 [01:51<00:15,  1.14s/it] 87%|████████▋ | 87/100 [01:52<00:13,  1.05s/it] 88%|████████▊ | 88/100 [01:53<00:12,  1.08s/it] 89%|████████▉ | 89/100 [01:54<00:12,  1.14s/it] 90%|█████████ | 90/100 [01:55<00:10,  1.01s/it] 91%|█████████ | 91/100 [01:57<00:11,  1.32s/it] 92%|█████████▏| 92/100 [02:00<00:14,  1.75s/it] 93%|█████████▎| 93/100 [02:03<00:15,  2.28s/it] 94%|█████████▍| 94/100 [02:04<00:10,  1.81s/it] 95%|█████████▌| 95/100 [02:05<00:07,  1.52s/it] 96%|█████████▌| 96/100 [02:06<00:05,  1.31s/it] 97%|█████████▋| 97/100 [02:07<00:03,  1.22s/it] 98%|█████████▊| 98/100 [02:08<00:02,  1.10s/it] 99%|█████████▉| 99/100 [02:09<00:01,  1.18s/it]100%|██████████| 100/100 [02:13<00:00,  1.96s/it]100%|██████████| 100/100 [02:13<00:00,  1.33s/it]
2023-06-14 19:21:10 [INFO] {
2023-06-14 19:21:10 [INFO]     'eval_loss': 1.1736871004104614,
2023-06-14 19:21:10 [INFO]     'eval_runtime': 134.5076,
2023-06-14 19:21:10 [INFO]     'eval_samples_per_second': 0.743,
2023-06-14 19:21:10 [INFO]     'eval_steps_per_second': 0.743
2023-06-14 19:21:10 [INFO] }
2023-06-14 19:21:10 [INFO] metric: 0.743
2023-06-14 19:21:10 [INFO] Throughput: 0.743 samples/sec
2023-06-14 19:21:10 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-18-17/./history.snapshot.
2023-06-14 19:21:10 [INFO] FP32 baseline is: [Accuracy: 0.7430, Duration (seconds): 134.5328]
2023-06-14 19:21:11 [INFO] |******Mixed Precision Statistics******|
2023-06-14 19:21:11 [INFO] +-----------------+----------+---------+
2023-06-14 19:21:11 [INFO] |     Op Type     |  Total   |   INT8  |
2023-06-14 19:21:11 [INFO] +-----------------+----------+---------+
2023-06-14 19:21:11 [INFO] |    Embedding    |    2     |    2    |
2023-06-14 19:21:11 [INFO] |      Linear     |    1     |    1    |
2023-06-14 19:21:11 [INFO] +-----------------+----------+---------+
2023-06-14 19:21:11 [INFO] Pass quantize model elapsed time: 1620.2 ms
2023-06-14 19:21:11 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: input, output, code.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:03<02:43,  1.66s/it]  3%|▎         | 3/100 [00:05<02:48,  1.74s/it]  4%|▍         | 4/100 [00:06<02:14,  1.40s/it]  5%|▌         | 5/100 [00:07<02:18,  1.46s/it]  6%|▌         | 6/100 [00:08<01:55,  1.22s/it]  7%|▋         | 7/100 [00:11<02:54,  1.87s/it]  8%|▊         | 8/100 [00:12<02:19,  1.51s/it]  9%|▉         | 9/100 [00:13<01:57,  1.29s/it] 10%|█         | 10/100 [00:13<01:43,  1.15s/it] 11%|█         | 11/100 [00:14<01:34,  1.06s/it] 12%|█▏        | 12/100 [00:15<01:26,  1.02it/s] 13%|█▎        | 13/100 [00:17<01:44,  1.20s/it] 14%|█▍        | 14/100 [00:18<01:32,  1.07s/it] 15%|█▌        | 15/100 [00:18<01:23,  1.02it/s] 16%|█▌        | 16/100 [00:19<01:15,  1.12it/s] 17%|█▋        | 17/100 [00:20<01:11,  1.17it/s] 18%|█▊        | 18/100 [00:21<01:13,  1.12it/s] 19%|█▉        | 19/100 [00:22<01:10,  1.15it/s] 20%|██        | 20/100 [00:22<01:07,  1.19it/s] 21%|██        | 21/100 [00:23<01:02,  1.27it/s] 22%|██▏       | 22/100 [00:24<00:59,  1.31it/s] 23%|██▎       | 23/100 [00:24<00:57,  1.33it/s] 24%|██▍       | 24/100 [00:25<00:56,  1.34it/s] 25%|██▌       | 25/100 [00:26<00:53,  1.40it/s] 26%|██▌       | 26/100 [00:27<00:51,  1.43it/s] 27%|██▋       | 27/100 [00:28<00:59,  1.22it/s] 28%|██▊       | 28/100 [00:28<00:56,  1.27it/s] 29%|██▉       | 29/100 [00:29<00:55,  1.29it/s] 30%|███       | 30/100 [00:30<00:54,  1.28it/s] 31%|███       | 31/100 [00:33<01:34,  1.37s/it] 32%|███▏      | 32/100 [00:34<01:31,  1.34s/it] 33%|███▎      | 33/100 [00:35<01:34,  1.41s/it] 34%|███▍      | 34/100 [00:36<01:17,  1.18s/it] 35%|███▌      | 35/100 [00:37<01:05,  1.01s/it] 36%|███▌      | 36/100 [00:37<00:57,  1.11it/s] 37%|███▋      | 37/100 [00:38<00:53,  1.17it/s] 38%|███▊      | 38/100 [00:39<00:50,  1.22it/s] 39%|███▉      | 39/100 [00:40<00:48,  1.25it/s] 40%|████      | 40/100 [00:40<00:46,  1.28it/s] 41%|████      | 41/100 [00:41<00:45,  1.30it/s] 42%|████▏     | 42/100 [00:42<00:43,  1.34it/s] 43%|████▎     | 43/100 [00:42<00:42,  1.35it/s] 44%|████▍     | 44/100 [00:43<00:42,  1.32it/s] 45%|████▌     | 45/100 [00:44<00:40,  1.37it/s] 46%|████▌     | 46/100 [00:45<00:37,  1.43it/s] 47%|████▋     | 47/100 [00:45<00:36,  1.46it/s] 48%|████▊     | 48/100 [00:46<00:36,  1.42it/s] 49%|████▉     | 49/100 [00:47<00:37,  1.36it/s] 50%|█████     | 50/100 [00:48<00:37,  1.35it/s] 51%|█████     | 51/100 [00:48<00:36,  1.33it/s] 52%|█████▏    | 52/100 [00:49<00:34,  1.37it/s] 53%|█████▎    | 53/100 [00:50<00:33,  1.41it/s] 54%|█████▍    | 54/100 [00:50<00:33,  1.38it/s] 55%|█████▌    | 55/100 [00:51<00:33,  1.36it/s] 56%|█████▌    | 56/100 [00:52<00:31,  1.39it/s] 57%|█████▋    | 57/100 [00:53<00:32,  1.33it/s] 58%|█████▊    | 58/100 [00:53<00:31,  1.32it/s] 59%|█████▉    | 59/100 [00:54<00:31,  1.31it/s] 60%|██████    | 60/100 [00:55<00:30,  1.32it/s] 61%|██████    | 61/100 [00:56<00:29,  1.34it/s] 62%|██████▏   | 62/100 [00:56<00:27,  1.37it/s] 63%|██████▎   | 63/100 [00:59<00:49,  1.34s/it] 64%|██████▍   | 64/100 [01:00<00:41,  1.14s/it] 65%|██████▌   | 65/100 [01:01<00:35,  1.02s/it] 66%|██████▌   | 66/100 [01:01<00:31,  1.07it/s] 67%|██████▋   | 67/100 [01:03<00:33,  1.03s/it] 68%|██████▊   | 68/100 [01:04<00:37,  1.17s/it] 69%|██████▉   | 69/100 [01:05<00:31,  1.03s/it] 70%|███████   | 70/100 [01:05<00:28,  1.06it/s] 71%|███████   | 71/100 [01:09<00:47,  1.64s/it] 72%|███████▏  | 72/100 [01:10<00:42,  1.53s/it] 73%|███████▎  | 73/100 [01:11<00:37,  1.39s/it] 74%|███████▍  | 74/100 [01:12<00:35,  1.35s/it] 75%|███████▌  | 75/100 [01:13<00:29,  1.16s/it] 76%|███████▌  | 76/100 [01:14<00:27,  1.14s/it] 77%|███████▋  | 77/100 [01:15<00:23,  1.01s/it] 78%|███████▊  | 78/100 [01:16<00:20,  1.07it/s] 79%|███████▉  | 79/100 [01:16<00:18,  1.12it/s] 80%|████████  | 80/100 [01:17<00:17,  1.17it/s] 81%|████████  | 81/100 [01:18<00:15,  1.20it/s] 82%|████████▏ | 82/100 [01:19<00:14,  1.25it/s] 83%|████████▎ | 83/100 [01:19<00:13,  1.30it/s] 84%|████████▍ | 84/100 [01:20<00:12,  1.30it/s] 85%|████████▌ | 85/100 [01:21<00:11,  1.31it/s] 86%|████████▌ | 86/100 [01:22<00:10,  1.36it/s] 87%|████████▋ | 87/100 [01:22<00:09,  1.39it/s] 88%|████████▊ | 88/100 [01:23<00:08,  1.41it/s] 89%|████████▉ | 89/100 [01:24<00:07,  1.42it/s] 90%|█████████ | 90/100 [01:24<00:06,  1.44it/s] 91%|█████████ | 91/100 [01:25<00:06,  1.48it/s] 92%|█████████▏| 92/100 [01:26<00:05,  1.49it/s] 93%|█████████▎| 93/100 [01:26<00:04,  1.50it/s] 94%|█████████▍| 94/100 [01:27<00:04,  1.48it/s] 95%|█████████▌| 95/100 [01:28<00:03,  1.47it/s] 96%|█████████▌| 96/100 [01:28<00:02,  1.49it/s] 97%|█████████▋| 97/100 [01:29<00:02,  1.49it/s] 98%|█████████▊| 98/100 [01:30<00:01,  1.48it/s] 99%|█████████▉| 99/100 [01:30<00:00,  1.49it/s]100%|██████████| 100/100 [01:31<00:00,  1.50it/s]100%|██████████| 100/100 [01:31<00:00,  1.09it/s]
2023-06-14 19:22:44 [INFO] {
2023-06-14 19:22:44 [INFO]     'eval_loss': 1.1748971939086914,
2023-06-14 19:22:44 [INFO]     'eval_runtime': 92.4378,
2023-06-14 19:22:44 [INFO]     'eval_samples_per_second': 1.082,
2023-06-14 19:22:44 [INFO]     'eval_steps_per_second': 1.082
2023-06-14 19:22:44 [INFO] }
2023-06-14 19:22:44 [INFO] metric: 1.082
2023-06-14 19:22:44 [INFO] Throughput: 1.082 samples/sec
2023-06-14 19:22:44 [INFO] Tune 1 result is: [Accuracy (int8|fp32): 1.0820|0.7430, Duration (seconds) (int8|fp32): 92.4425|134.5328], Best tune result is: [Accuracy: 1.0820, Duration (seconds): 92.4425]
2023-06-14 19:22:44 [INFO] |***********************Tune Result Statistics**********************|
2023-06-14 19:22:44 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 19:22:44 [INFO] |     Info Type      |  Baseline | Tune 1 result | Best tune result |
2023-06-14 19:22:44 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 19:22:44 [INFO] |      Accuracy      |  0.7430   |    1.0820     |     1.0820       |
2023-06-14 19:22:44 [INFO] | Duration (seconds) | 134.5328  |    92.4425    |     92.4425      |
2023-06-14 19:22:44 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 19:22:44 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-18-17/./history.snapshot.
2023-06-14 19:22:45 [INFO] Apply all recipes.
2023-06-14 19:22:45 [WARNING] Find evaluated tuning config, skip.
2023-06-14 19:22:45 [INFO] Apply recipe one by one.
2023-06-14 19:22:45 [INFO] Start to fallback op to fp32 one by one.
2023-06-14 19:22:45 [INFO] |******Mixed Precision Statistics******|
2023-06-14 19:22:45 [INFO] +-------------+--------+------+--------+
2023-06-14 19:22:45 [INFO] |   Op Type   | Total  | INT8 |  FP32  |
2023-06-14 19:22:45 [INFO] +-------------+--------+------+--------+
2023-06-14 19:22:45 [INFO] |  Embedding  |   2    |  2   |   0    |
2023-06-14 19:22:45 [INFO] |    Linear   |   1    |  0   |   1    |
2023-06-14 19:22:45 [INFO] +-------------+--------+------+--------+
2023-06-14 19:22:45 [INFO] Pass quantize model elapsed time: 296.07 ms
2023-06-14 19:22:45 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: input, output, code.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:35,  2.74it/s]  3%|▎         | 3/100 [00:01<00:49,  1.95it/s]  4%|▍         | 4/100 [00:02<00:56,  1.69it/s]  5%|▌         | 5/100 [00:02<01:00,  1.57it/s]  6%|▌         | 6/100 [00:03<01:02,  1.49it/s]  7%|▋         | 7/100 [00:04<01:03,  1.46it/s]  8%|▊         | 8/100 [00:05<01:04,  1.43it/s]  9%|▉         | 9/100 [00:05<01:04,  1.41it/s] 10%|█         | 10/100 [00:06<01:04,  1.40it/s] 11%|█         | 11/100 [00:07<01:04,  1.38it/s] 12%|█▏        | 12/100 [00:08<01:04,  1.37it/s] 13%|█▎        | 13/100 [00:08<01:03,  1.37it/s] 14%|█▍        | 14/100 [00:09<01:02,  1.37it/s] 15%|█▌        | 15/100 [00:10<01:04,  1.31it/s] 16%|█▌        | 16/100 [00:11<01:18,  1.07it/s] 17%|█▋        | 17/100 [00:12<01:12,  1.15it/s] 18%|█▊        | 18/100 [00:13<01:17,  1.05it/s] 19%|█▉        | 19/100 [00:14<01:18,  1.03it/s] 20%|██        | 20/100 [00:15<01:13,  1.09it/s] 21%|██        | 21/100 [00:16<01:12,  1.08it/s] 22%|██▏       | 22/100 [00:17<01:09,  1.13it/s] 23%|██▎       | 23/100 [00:17<01:07,  1.14it/s] 24%|██▍       | 24/100 [00:19<01:14,  1.02it/s] 25%|██▌       | 25/100 [00:20<01:13,  1.02it/s] 26%|██▌       | 26/100 [00:20<01:07,  1.09it/s] 27%|██▋       | 27/100 [00:21<01:02,  1.16it/s] 28%|██▊       | 28/100 [00:22<00:59,  1.22it/s] 29%|██▉       | 29/100 [00:23<01:01,  1.16it/s] 30%|███       | 30/100 [00:24<00:57,  1.22it/s] 31%|███       | 31/100 [00:24<00:54,  1.26it/s] 32%|███▏      | 32/100 [00:25<00:53,  1.27it/s] 33%|███▎      | 33/100 [00:27<01:07,  1.01s/it] 34%|███▍      | 34/100 [00:30<02:00,  1.83s/it] 35%|███▌      | 35/100 [00:34<02:27,  2.27s/it] 36%|███▌      | 36/100 [00:37<02:54,  2.73s/it] 37%|███▋      | 37/100 [00:41<03:13,  3.07s/it] 38%|███▊      | 38/100 [00:43<02:43,  2.64s/it] 39%|███▉      | 39/100 [00:44<02:06,  2.07s/it] 40%|████      | 40/100 [00:44<01:40,  1.67s/it] 41%|████      | 41/100 [00:45<01:21,  1.38s/it] 42%|████▏     | 42/100 [00:46<01:08,  1.19s/it] 43%|████▎     | 43/100 [00:47<00:59,  1.05s/it] 44%|████▍     | 44/100 [00:47<00:53,  1.05it/s] 45%|████▌     | 45/100 [00:48<00:49,  1.12it/s] 46%|████▌     | 46/100 [00:49<00:45,  1.18it/s] 47%|████▋     | 47/100 [00:49<00:42,  1.23it/s] 48%|████▊     | 48/100 [00:52<01:10,  1.36s/it] 49%|████▉     | 49/100 [00:56<01:42,  2.00s/it] 50%|█████     | 50/100 [00:57<01:30,  1.82s/it] 51%|█████     | 51/100 [00:58<01:12,  1.48s/it] 52%|█████▏    | 52/100 [00:58<00:59,  1.24s/it] 53%|█████▎    | 53/100 [00:59<00:50,  1.08s/it] 54%|█████▍    | 54/100 [01:00<00:44,  1.04it/s] 55%|█████▌    | 55/100 [01:00<00:39,  1.13it/s] 56%|█████▌    | 56/100 [01:01<00:36,  1.21it/s] 57%|█████▋    | 57/100 [01:02<00:34,  1.26it/s] 58%|█████▊    | 58/100 [01:03<00:32,  1.31it/s] 59%|█████▉    | 59/100 [01:03<00:30,  1.34it/s] 60%|██████    | 60/100 [01:04<00:29,  1.36it/s] 61%|██████    | 61/100 [01:05<00:28,  1.38it/s] 62%|██████▏   | 62/100 [01:05<00:27,  1.38it/s] 63%|██████▎   | 63/100 [01:06<00:30,  1.23it/s] 64%|██████▍   | 64/100 [01:07<00:30,  1.18it/s] 65%|██████▌   | 65/100 [01:08<00:29,  1.21it/s] 66%|██████▌   | 66/100 [01:09<00:30,  1.11it/s] 67%|██████▋   | 67/100 [01:11<00:41,  1.25s/it] 68%|██████▊   | 68/100 [01:12<00:35,  1.11s/it] 69%|██████▉   | 69/100 [01:13<00:31,  1.01s/it] 70%|███████   | 70/100 [01:15<00:43,  1.45s/it] 71%|███████   | 71/100 [01:18<00:54,  1.89s/it] 72%|███████▏  | 72/100 [01:20<00:48,  1.72s/it] 73%|███████▎  | 73/100 [01:21<00:44,  1.65s/it] 74%|███████▍  | 74/100 [01:23<00:42,  1.63s/it] 75%|███████▌  | 75/100 [01:24<00:36,  1.46s/it] 76%|███████▌  | 76/100 [01:25<00:30,  1.26s/it] 77%|███████▋  | 77/100 [01:25<00:25,  1.12s/it] 78%|███████▊  | 78/100 [01:26<00:24,  1.12s/it] 79%|███████▉  | 79/100 [01:28<00:27,  1.32s/it] 80%|████████  | 80/100 [01:29<00:22,  1.13s/it] 81%|████████  | 81/100 [01:30<00:18,  1.01it/s] 82%|████████▏ | 82/100 [01:30<00:16,  1.11it/s] 83%|████████▎ | 83/100 [01:31<00:14,  1.19it/s] 84%|████████▍ | 84/100 [01:32<00:12,  1.26it/s] 85%|████████▌ | 85/100 [01:32<00:11,  1.31it/s] 86%|████████▌ | 86/100 [01:33<00:11,  1.23it/s] 87%|████████▋ | 87/100 [01:34<00:10,  1.29it/s] 88%|████████▊ | 88/100 [01:35<00:09,  1.29it/s] 89%|████████▉ | 89/100 [01:35<00:08,  1.32it/s] 90%|█████████ | 90/100 [01:36<00:07,  1.35it/s] 91%|█████████ | 91/100 [01:37<00:06,  1.30it/s] 92%|█████████▏| 92/100 [01:38<00:05,  1.34it/s] 93%|█████████▎| 93/100 [01:38<00:05,  1.36it/s] 94%|█████████▍| 94/100 [01:39<00:04,  1.24it/s] 95%|█████████▌| 95/100 [01:40<00:03,  1.25it/s] 96%|█████████▌| 96/100 [01:42<00:04,  1.11s/it] 97%|█████████▋| 97/100 [01:43<00:03,  1.12s/it] 98%|█████████▊| 98/100 [01:44<00:02,  1.02s/it] 99%|█████████▉| 99/100 [01:45<00:00,  1.07it/s]100%|██████████| 100/100 [01:46<00:00,  1.06it/s]100%|██████████| 100/100 [01:46<00:00,  1.06s/it]
2023-06-14 19:24:32 [INFO] {
2023-06-14 19:24:32 [INFO]     'eval_loss': 1.1737359762191772,
2023-06-14 19:24:32 [INFO]     'eval_runtime': 106.8484,
2023-06-14 19:24:32 [INFO]     'eval_samples_per_second': 0.936,
2023-06-14 19:24:32 [INFO]     'eval_steps_per_second': 0.936
2023-06-14 19:24:32 [INFO] }
2023-06-14 19:24:32 [INFO] metric: 0.936
2023-06-14 19:24:32 [INFO] Throughput: 0.936 samples/sec
2023-06-14 19:24:32 [INFO] Tune 3 result is: [Accuracy (int8|fp32): 0.9360|0.7430, Duration (seconds) (int8|fp32): 106.8540|134.5328], Best tune result is: [Accuracy: 1.0820, Duration (seconds): 92.4425]
2023-06-14 19:24:32 [INFO] |***********************Tune Result Statistics**********************|
2023-06-14 19:24:32 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 19:24:32 [INFO] |     Info Type      |  Baseline | Tune 3 result | Best tune result |
2023-06-14 19:24:32 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 19:24:32 [INFO] |      Accuracy      |  0.7430   |    0.9360     |     1.0820       |
2023-06-14 19:24:32 [INFO] | Duration (seconds) | 134.5328  |   106.8540    |     92.4425      |
2023-06-14 19:24:32 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 19:24:32 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-18-17/./history.snapshot.
2023-06-14 19:24:33 [INFO] |******Mixed Precision Statistics******|
2023-06-14 19:24:33 [INFO] +-------------+--------+------+--------+
2023-06-14 19:24:33 [INFO] |   Op Type   | Total  | INT8 |  FP32  |
2023-06-14 19:24:33 [INFO] +-------------+--------+------+--------+
2023-06-14 19:24:33 [INFO] |  Embedding  |   2    |  1   |   1    |
2023-06-14 19:24:33 [INFO] |    Linear   |   1    |  1   |   0    |
2023-06-14 19:24:33 [INFO] +-------------+--------+------+--------+
2023-06-14 19:24:33 [INFO] Pass quantize model elapsed time: 1458.29 ms
2023-06-14 19:24:33 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: input, output, code.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:36,  2.67it/s]  3%|▎         | 3/100 [00:02<01:16,  1.27it/s]  4%|▍         | 4/100 [00:03<01:50,  1.15s/it]  5%|▌         | 5/100 [00:05<02:03,  1.30s/it]  6%|▌         | 6/100 [00:06<01:50,  1.18s/it]  7%|▋         | 7/100 [00:08<02:03,  1.33s/it]  8%|▊         | 8/100 [00:08<01:47,  1.17s/it]  9%|▉         | 9/100 [00:10<01:52,  1.23s/it] 10%|█         | 10/100 [00:10<01:36,  1.07s/it] 11%|█         | 11/100 [00:11<01:24,  1.05it/s] 12%|█▏        | 12/100 [00:12<01:17,  1.14it/s] 13%|█▎        | 13/100 [00:13<01:11,  1.22it/s] 14%|█▍        | 14/100 [00:13<01:07,  1.28it/s] 15%|█▌        | 15/100 [00:14<01:04,  1.32it/s] 16%|█▌        | 16/100 [00:15<01:02,  1.35it/s] 17%|█▋        | 17/100 [00:15<01:01,  1.35it/s] 18%|█▊        | 18/100 [00:16<01:04,  1.26it/s] 19%|█▉        | 19/100 [00:17<01:01,  1.31it/s] 20%|██        | 20/100 [00:18<00:59,  1.35it/s] 21%|██        | 21/100 [00:18<00:57,  1.37it/s] 22%|██▏       | 22/100 [00:19<00:56,  1.39it/s] 23%|██▎       | 23/100 [00:20<00:55,  1.40it/s] 24%|██▍       | 24/100 [00:20<00:54,  1.41it/s] 25%|██▌       | 25/100 [00:21<00:53,  1.40it/s] 26%|██▌       | 26/100 [00:22<00:53,  1.40it/s] 27%|██▋       | 27/100 [00:23<00:52,  1.40it/s] 28%|██▊       | 28/100 [00:23<00:51,  1.40it/s] 29%|██▉       | 29/100 [00:24<00:51,  1.38it/s] 30%|███       | 30/100 [00:25<01:05,  1.07it/s] 31%|███       | 31/100 [00:26<01:02,  1.10it/s] 32%|███▏      | 32/100 [00:27<01:04,  1.05it/s] 33%|███▎      | 33/100 [00:29<01:19,  1.18s/it] 34%|███▍      | 34/100 [00:32<01:50,  1.68s/it] 35%|███▌      | 35/100 [00:33<01:29,  1.38s/it] 36%|███▌      | 36/100 [00:33<01:14,  1.17s/it] 37%|███▋      | 37/100 [00:34<01:04,  1.03s/it] 38%|███▊      | 38/100 [00:35<00:57,  1.07it/s] 39%|███▉      | 39/100 [00:35<00:52,  1.16it/s] 40%|████      | 40/100 [00:36<00:55,  1.09it/s] 41%|████      | 41/100 [00:37<00:50,  1.16it/s] 42%|████▏     | 42/100 [00:38<00:52,  1.10it/s] 43%|████▎     | 43/100 [00:39<00:49,  1.15it/s] 44%|████▍     | 44/100 [00:40<00:45,  1.22it/s] 45%|████▌     | 45/100 [00:40<00:42,  1.28it/s] 46%|████▌     | 46/100 [00:41<00:40,  1.34it/s] 47%|████▋     | 47/100 [00:42<00:38,  1.37it/s] 48%|████▊     | 48/100 [00:42<00:37,  1.37it/s] 49%|████▉     | 49/100 [00:43<00:36,  1.41it/s] 50%|█████     | 50/100 [00:44<00:37,  1.32it/s] 51%|█████     | 51/100 [00:45<00:39,  1.25it/s] 52%|█████▏    | 52/100 [00:46<00:40,  1.18it/s] 53%|█████▎    | 53/100 [00:47<00:41,  1.13it/s] 54%|█████▍    | 54/100 [00:48<00:38,  1.20it/s] 55%|█████▌    | 55/100 [00:48<00:39,  1.15it/s] 56%|█████▌    | 56/100 [00:50<00:49,  1.12s/it] 57%|█████▋    | 57/100 [00:51<00:42,  1.01it/s] 58%|█████▊    | 58/100 [00:52<00:37,  1.11it/s] 59%|█████▉    | 59/100 [00:52<00:34,  1.20it/s] 60%|██████    | 60/100 [00:53<00:31,  1.26it/s] 61%|██████    | 61/100 [00:54<00:29,  1.31it/s] 62%|██████▏   | 62/100 [00:54<00:28,  1.33it/s] 63%|██████▎   | 63/100 [00:55<00:27,  1.36it/s] 64%|██████▍   | 64/100 [00:56<00:25,  1.39it/s] 65%|██████▌   | 65/100 [00:56<00:25,  1.40it/s] 66%|██████▌   | 66/100 [00:57<00:27,  1.25it/s] 67%|██████▋   | 67/100 [00:58<00:25,  1.30it/s] 68%|██████▊   | 68/100 [00:59<00:23,  1.34it/s] 69%|██████▉   | 69/100 [01:00<00:22,  1.35it/s] 70%|███████   | 70/100 [01:00<00:22,  1.36it/s] 71%|███████   | 71/100 [01:01<00:21,  1.35it/s] 72%|███████▏  | 72/100 [01:02<00:20,  1.37it/s] 73%|███████▎  | 73/100 [01:03<00:19,  1.36it/s] 74%|███████▍  | 74/100 [01:03<00:18,  1.39it/s] 75%|███████▌  | 75/100 [01:04<00:18,  1.37it/s] 76%|███████▌  | 76/100 [01:05<00:17,  1.37it/s] 77%|███████▋  | 77/100 [01:05<00:16,  1.40it/s] 78%|███████▊  | 78/100 [01:06<00:15,  1.42it/s] 79%|███████▉  | 79/100 [01:07<00:14,  1.43it/s] 80%|████████  | 80/100 [01:07<00:14,  1.41it/s] 81%|████████  | 81/100 [01:08<00:13,  1.43it/s] 82%|████████▏ | 82/100 [01:09<00:12,  1.40it/s] 83%|████████▎ | 83/100 [01:10<00:12,  1.42it/s] 84%|████████▍ | 84/100 [01:10<00:11,  1.43it/s] 85%|████████▌ | 85/100 [01:11<00:10,  1.44it/s] 86%|████████▌ | 86/100 [01:12<00:10,  1.39it/s] 87%|████████▋ | 87/100 [01:12<00:09,  1.42it/s] 88%|████████▊ | 88/100 [01:13<00:08,  1.43it/s] 89%|████████▉ | 89/100 [01:15<00:12,  1.10s/it] 90%|█████████ | 90/100 [01:16<00:09,  1.02it/s] 91%|█████████ | 91/100 [01:17<00:08,  1.09it/s] 92%|█████████▏| 92/100 [01:17<00:06,  1.18it/s] 93%|█████████▎| 93/100 [01:18<00:05,  1.25it/s] 94%|█████████▍| 94/100 [01:19<00:04,  1.31it/s] 95%|█████████▌| 95/100 [01:20<00:04,  1.11it/s] 96%|█████████▌| 96/100 [01:21<00:03,  1.12it/s] 97%|█████████▋| 97/100 [01:22<00:02,  1.04it/s] 98%|█████████▊| 98/100 [01:23<00:01,  1.13it/s] 99%|█████████▉| 99/100 [01:24<00:00,  1.07it/s]100%|██████████| 100/100 [01:25<00:00,  1.05s/it]100%|██████████| 100/100 [01:25<00:00,  1.17it/s]
2023-06-14 19:26:00 [INFO] {
2023-06-14 19:26:00 [INFO]     'eval_loss': 1.1746976375579834,
2023-06-14 19:26:00 [INFO]     'eval_runtime': 86.5933,
2023-06-14 19:26:00 [INFO]     'eval_samples_per_second': 1.155,
2023-06-14 19:26:00 [INFO]     'eval_steps_per_second': 1.155
2023-06-14 19:26:00 [INFO] }
2023-06-14 19:26:00 [INFO] metric: 1.155
2023-06-14 19:26:00 [INFO] Throughput: 1.155 samples/sec
2023-06-14 19:26:00 [INFO] Tune 4 result is: [Accuracy (int8|fp32): 1.1550|0.7430, Duration (seconds) (int8|fp32): 86.5997|134.5328], Best tune result is: [Accuracy: 1.1550, Duration (seconds): 86.5997]
2023-06-14 19:26:00 [INFO] |***********************Tune Result Statistics**********************|
2023-06-14 19:26:00 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 19:26:00 [INFO] |     Info Type      |  Baseline | Tune 4 result | Best tune result |
2023-06-14 19:26:00 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 19:26:00 [INFO] |      Accuracy      |  0.7430   |    1.1550     |     1.1550       |
2023-06-14 19:26:00 [INFO] | Duration (seconds) | 134.5328  |    86.5997    |     86.5997      |
2023-06-14 19:26:00 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 19:26:00 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-18-17/./history.snapshot.
2023-06-14 19:26:07 [INFO] |******Mixed Precision Statistics******|
2023-06-14 19:26:07 [INFO] +-------------+--------+------+--------+
2023-06-14 19:26:07 [INFO] |   Op Type   | Total  | INT8 |  FP32  |
2023-06-14 19:26:07 [INFO] +-------------+--------+------+--------+
2023-06-14 19:26:07 [INFO] |  Embedding  |   2    |  1   |   1    |
2023-06-14 19:26:07 [INFO] |    Linear   |   1    |  1   |   0    |
2023-06-14 19:26:07 [INFO] +-------------+--------+------+--------+
2023-06-14 19:26:07 [INFO] Pass quantize model elapsed time: 844.07 ms
2023-06-14 19:26:07 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: input, output, code.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:37,  2.63it/s]  3%|▎         | 3/100 [00:01<00:51,  1.87it/s]  4%|▍         | 4/100 [00:02<00:58,  1.64it/s]  5%|▌         | 5/100 [00:03<01:02,  1.51it/s]  6%|▌         | 6/100 [00:03<01:09,  1.35it/s]  7%|▋         | 7/100 [00:04<01:08,  1.36it/s]  8%|▊         | 8/100 [00:05<01:07,  1.37it/s]  9%|▉         | 9/100 [00:06<01:06,  1.36it/s] 10%|█         | 10/100 [00:06<01:05,  1.37it/s] 11%|█         | 11/100 [00:07<01:04,  1.38it/s] 12%|█▏        | 12/100 [00:08<01:03,  1.38it/s] 13%|█▎        | 13/100 [00:08<01:02,  1.39it/s] 14%|█▍        | 14/100 [00:09<01:01,  1.39it/s] 15%|█▌        | 15/100 [00:10<01:01,  1.39it/s] 16%|█▌        | 16/100 [00:11<01:00,  1.39it/s] 17%|█▋        | 17/100 [00:11<01:00,  1.38it/s] 18%|█▊        | 18/100 [00:12<00:59,  1.38it/s] 19%|█▉        | 19/100 [00:13<00:58,  1.39it/s] 20%|██        | 20/100 [00:14<00:58,  1.38it/s] 21%|██        | 21/100 [00:14<00:57,  1.36it/s] 22%|██▏       | 22/100 [00:16<01:16,  1.02it/s] 23%|██▎       | 23/100 [00:17<01:11,  1.07it/s] 24%|██▍       | 24/100 [00:18<01:15,  1.01it/s] 25%|██▌       | 25/100 [00:19<01:13,  1.02it/s] 26%|██▌       | 26/100 [00:19<01:06,  1.11it/s] 27%|██▋       | 27/100 [00:21<01:16,  1.05s/it] 28%|██▊       | 28/100 [00:23<01:39,  1.38s/it] 29%|██▉       | 29/100 [00:24<01:26,  1.21s/it] 30%|███       | 30/100 [00:24<01:13,  1.05s/it] 31%|███       | 31/100 [00:25<01:05,  1.06it/s] 32%|███▏      | 32/100 [00:26<00:59,  1.15it/s] 33%|███▎      | 33/100 [00:27<00:55,  1.20it/s] 34%|███▍      | 34/100 [00:28<01:07,  1.03s/it] 35%|███▌      | 35/100 [00:30<01:15,  1.16s/it] 36%|███▌      | 36/100 [00:30<01:07,  1.05s/it] 37%|███▋      | 37/100 [00:31<00:59,  1.06it/s] 38%|███▊      | 38/100 [00:32<00:53,  1.16it/s] 39%|███▉      | 39/100 [00:32<00:49,  1.23it/s] 40%|████      | 40/100 [00:33<00:46,  1.29it/s] 41%|████      | 41/100 [00:34<00:44,  1.32it/s] 42%|████▏     | 42/100 [00:35<00:43,  1.35it/s] 43%|████▎     | 43/100 [00:35<00:42,  1.34it/s] 44%|████▍     | 44/100 [00:36<00:40,  1.37it/s] 45%|████▌     | 45/100 [00:37<00:39,  1.39it/s] 46%|████▌     | 46/100 [00:38<00:41,  1.32it/s] 47%|████▋     | 47/100 [00:38<00:42,  1.25it/s] 48%|████▊     | 48/100 [00:39<00:40,  1.30it/s] 49%|████▉     | 49/100 [00:40<00:38,  1.32it/s] 50%|█████     | 50/100 [00:41<00:38,  1.29it/s] 51%|█████     | 51/100 [00:41<00:37,  1.32it/s] 52%|█████▏    | 52/100 [00:42<00:39,  1.23it/s] 53%|█████▎    | 53/100 [00:45<01:03,  1.34s/it] 54%|█████▍    | 54/100 [00:47<01:16,  1.66s/it] 55%|█████▌    | 55/100 [00:50<01:23,  1.86s/it] 56%|█████▌    | 56/100 [00:50<01:06,  1.51s/it] 57%|█████▋    | 57/100 [00:51<00:54,  1.27s/it] 58%|█████▊    | 58/100 [00:52<00:46,  1.11s/it] 59%|█████▉    | 59/100 [00:52<00:40,  1.02it/s] 60%|██████    | 60/100 [00:53<00:35,  1.12it/s] 61%|██████    | 61/100 [00:54<00:32,  1.21it/s] 62%|██████▏   | 62/100 [00:55<00:29,  1.28it/s] 63%|██████▎   | 63/100 [00:55<00:28,  1.30it/s] 64%|██████▍   | 64/100 [00:56<00:27,  1.33it/s] 65%|██████▌   | 65/100 [00:57<00:25,  1.36it/s] 66%|██████▌   | 66/100 [00:57<00:24,  1.38it/s] 67%|██████▋   | 67/100 [00:58<00:24,  1.36it/s] 68%|██████▊   | 68/100 [00:59<00:22,  1.40it/s] 69%|██████▉   | 69/100 [01:00<00:31,  1.01s/it] 70%|███████   | 70/100 [01:01<00:27,  1.09it/s] 71%|███████   | 71/100 [01:02<00:24,  1.17it/s] 72%|███████▏  | 72/100 [01:03<00:22,  1.25it/s] 73%|███████▎  | 73/100 [01:03<00:21,  1.27it/s] 74%|███████▍  | 74/100 [01:04<00:19,  1.31it/s] 75%|███████▌  | 75/100 [01:05<00:18,  1.35it/s] 76%|███████▌  | 76/100 [01:05<00:17,  1.38it/s] 77%|███████▋  | 77/100 [01:06<00:16,  1.41it/s] 78%|███████▊  | 78/100 [01:07<00:15,  1.41it/s] 79%|███████▉  | 79/100 [01:07<00:14,  1.43it/s] 80%|████████  | 80/100 [01:08<00:13,  1.44it/s] 81%|████████  | 81/100 [01:09<00:13,  1.43it/s] 82%|████████▏ | 82/100 [01:10<00:12,  1.39it/s] 83%|████████▎ | 83/100 [01:10<00:12,  1.38it/s] 84%|████████▍ | 84/100 [01:11<00:11,  1.37it/s] 85%|████████▌ | 85/100 [01:12<00:10,  1.38it/s] 86%|████████▌ | 86/100 [01:13<00:10,  1.38it/s] 87%|████████▋ | 87/100 [01:13<00:09,  1.39it/s] 88%|████████▊ | 88/100 [01:14<00:08,  1.39it/s] 89%|████████▉ | 89/100 [01:15<00:07,  1.40it/s] 90%|█████████ | 90/100 [01:15<00:07,  1.39it/s] 91%|█████████ | 91/100 [01:16<00:06,  1.38it/s] 92%|█████████▏| 92/100 [01:17<00:05,  1.36it/s] 93%|█████████▎| 93/100 [01:18<00:05,  1.38it/s] 94%|█████████▍| 94/100 [01:18<00:04,  1.40it/s] 95%|█████████▌| 95/100 [01:19<00:03,  1.40it/s] 96%|█████████▌| 96/100 [01:20<00:02,  1.40it/s] 97%|█████████▋| 97/100 [01:20<00:02,  1.41it/s] 98%|█████████▊| 98/100 [01:21<00:01,  1.43it/s] 99%|█████████▉| 99/100 [01:22<00:00,  1.46it/s]100%|██████████| 100/100 [01:22<00:00,  1.47it/s]100%|██████████| 100/100 [01:22<00:00,  1.21it/s]
2023-06-14 19:27:32 [INFO] {
2023-06-14 19:27:32 [INFO]     'eval_loss': 1.1748887300491333,
2023-06-14 19:27:32 [INFO]     'eval_runtime': 85.7472,
2023-06-14 19:27:32 [INFO]     'eval_samples_per_second': 1.166,
2023-06-14 19:27:32 [INFO]     'eval_steps_per_second': 1.166
2023-06-14 19:27:32 [INFO] }
2023-06-14 19:27:32 [INFO] metric: 1.166
2023-06-14 19:27:32 [INFO] Throughput: 1.166 samples/sec
2023-06-14 19:27:32 [INFO] Tune 5 result is: [Accuracy (int8|fp32): 1.1660|0.7430, Duration (seconds) (int8|fp32): 85.7791|134.5328], Best tune result is: [Accuracy: 1.1660, Duration (seconds): 85.7791]
2023-06-14 19:27:32 [INFO] |***********************Tune Result Statistics**********************|
2023-06-14 19:27:32 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 19:27:32 [INFO] |     Info Type      |  Baseline | Tune 5 result | Best tune result |
2023-06-14 19:27:32 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 19:27:32 [INFO] |      Accuracy      |  0.7430   |    1.1660     |     1.1660       |
2023-06-14 19:27:32 [INFO] | Duration (seconds) | 134.5328  |    85.7791    |     85.7791      |
2023-06-14 19:27:32 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 19:27:32 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-18-17/./history.snapshot.
2023-06-14 19:27:33 [INFO] Start to accumulate fallback to fp32.
2023-06-14 19:27:33 [INFO] |******Mixed Precision Statistics******|
2023-06-14 19:27:33 [INFO] +-------------+--------+------+--------+
2023-06-14 19:27:33 [INFO] |   Op Type   | Total  | INT8 |  FP32  |
2023-06-14 19:27:33 [INFO] +-------------+--------+------+--------+
2023-06-14 19:27:33 [INFO] |  Embedding  |   2    |  0   |   2    |
2023-06-14 19:27:33 [INFO] |    Linear   |   1    |  1   |   0    |
2023-06-14 19:27:33 [INFO] +-------------+--------+------+--------+
2023-06-14 19:27:33 [INFO] Pass quantize model elapsed time: 809.18 ms
2023-06-14 19:27:33 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: input, output, code.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:34,  2.82it/s]  3%|▎         | 3/100 [00:01<00:49,  1.98it/s]  4%|▍         | 4/100 [00:02<00:56,  1.71it/s]  5%|▌         | 5/100 [00:02<01:00,  1.58it/s]  6%|▌         | 6/100 [00:04<01:16,  1.22it/s]  7%|▋         | 7/100 [00:05<01:48,  1.17s/it]  8%|▊         | 8/100 [00:06<01:35,  1.04s/it]  9%|▉         | 9/100 [00:07<01:25,  1.07it/s] 10%|█         | 10/100 [00:08<01:17,  1.15it/s] 11%|█         | 11/100 [00:09<01:32,  1.03s/it] 12%|█▏        | 12/100 [00:10<01:24,  1.04it/s] 13%|█▎        | 13/100 [00:11<01:16,  1.13it/s] 14%|█▍        | 14/100 [00:11<01:11,  1.20it/s] 15%|█▌        | 15/100 [00:12<01:07,  1.26it/s] 16%|█▌        | 16/100 [00:13<01:04,  1.30it/s] 17%|█▋        | 17/100 [00:14<01:15,  1.10it/s] 18%|█▊        | 18/100 [00:15<01:11,  1.15it/s] 19%|█▉        | 19/100 [00:16<01:11,  1.14it/s] 20%|██        | 20/100 [00:18<01:43,  1.30s/it] 21%|██        | 21/100 [00:19<01:28,  1.12s/it] 22%|██▏       | 22/100 [00:19<01:17,  1.00it/s] 23%|██▎       | 23/100 [00:20<01:09,  1.10it/s] 24%|██▍       | 24/100 [00:21<01:04,  1.18it/s] 25%|██▌       | 25/100 [00:21<01:00,  1.25it/s] 26%|██▌       | 26/100 [00:22<00:57,  1.29it/s] 27%|██▋       | 27/100 [00:23<00:54,  1.33it/s] 28%|██▊       | 28/100 [00:24<00:53,  1.35it/s] 29%|██▉       | 29/100 [00:24<00:51,  1.37it/s] 30%|███       | 30/100 [00:28<01:50,  1.58s/it] 31%|███       | 31/100 [00:29<01:31,  1.32s/it] 32%|███▏      | 32/100 [00:29<01:16,  1.13s/it] 33%|███▎      | 33/100 [00:30<01:06,  1.00it/s] 34%|███▍      | 34/100 [00:31<00:59,  1.11it/s] 35%|███▌      | 35/100 [00:31<00:54,  1.19it/s] 36%|███▌      | 36/100 [00:32<00:50,  1.26it/s] 37%|███▋      | 37/100 [00:33<00:48,  1.30it/s] 38%|███▊      | 38/100 [00:33<00:46,  1.33it/s] 39%|███▉      | 39/100 [00:34<00:45,  1.34it/s] 40%|████      | 40/100 [00:35<00:44,  1.36it/s] 41%|████      | 41/100 [00:37<01:06,  1.13s/it] 42%|████▏     | 42/100 [00:40<01:44,  1.80s/it] 43%|████▎     | 43/100 [00:41<01:23,  1.47s/it] 44%|████▍     | 44/100 [00:42<01:09,  1.23s/it] 45%|████▌     | 45/100 [00:42<00:58,  1.07s/it] 46%|████▌     | 46/100 [00:43<00:51,  1.04it/s] 47%|████▋     | 47/100 [00:44<00:46,  1.13it/s] 48%|████▊     | 48/100 [00:44<00:43,  1.20it/s] 49%|████▉     | 49/100 [00:45<00:40,  1.26it/s] 50%|█████     | 50/100 [00:46<00:38,  1.31it/s] 51%|█████     | 51/100 [00:47<00:36,  1.35it/s] 52%|█████▏    | 52/100 [00:48<00:46,  1.03it/s] 53%|█████▎    | 53/100 [00:49<00:41,  1.13it/s] 54%|█████▍    | 54/100 [00:49<00:38,  1.21it/s] 55%|█████▌    | 55/100 [00:51<00:50,  1.12s/it] 56%|█████▌    | 56/100 [00:53<00:53,  1.22s/it] 57%|█████▋    | 57/100 [00:55<01:07,  1.57s/it] 58%|█████▊    | 58/100 [00:56<01:02,  1.49s/it] 59%|█████▉    | 59/100 [00:57<00:51,  1.26s/it] 60%|██████    | 60/100 [00:58<00:49,  1.24s/it] 61%|██████    | 61/100 [01:00<00:48,  1.25s/it] 62%|██████▏   | 62/100 [01:01<00:52,  1.37s/it] 63%|██████▎   | 63/100 [01:02<00:43,  1.17s/it] 64%|██████▍   | 64/100 [01:03<00:42,  1.19s/it] 65%|██████▌   | 65/100 [01:04<00:36,  1.04s/it] 66%|██████▌   | 66/100 [01:05<00:32,  1.05it/s] 67%|██████▋   | 67/100 [01:05<00:28,  1.15it/s] 68%|██████▊   | 68/100 [01:06<00:27,  1.17it/s] 69%|██████▉   | 69/100 [01:07<00:24,  1.25it/s] 70%|███████   | 70/100 [01:07<00:22,  1.31it/s] 71%|███████   | 71/100 [01:08<00:22,  1.31it/s] 72%|███████▏  | 72/100 [01:09<00:21,  1.31it/s] 73%|███████▎  | 73/100 [01:10<00:21,  1.26it/s] 74%|███████▍  | 74/100 [01:12<00:29,  1.14s/it] 75%|███████▌  | 75/100 [01:15<00:41,  1.67s/it] 76%|███████▌  | 76/100 [01:16<00:35,  1.46s/it] 77%|███████▋  | 77/100 [01:19<00:44,  1.95s/it] 78%|███████▊  | 78/100 [01:20<00:41,  1.87s/it] 79%|███████▉  | 79/100 [01:22<00:35,  1.70s/it] 80%|████████  | 80/100 [01:22<00:28,  1.42s/it] 81%|████████  | 81/100 [01:24<00:26,  1.39s/it] 82%|████████▏ | 82/100 [01:27<00:34,  1.90s/it] 83%|████████▎ | 83/100 [01:29<00:32,  1.88s/it] 84%|████████▍ | 84/100 [01:30<00:26,  1.63s/it] 85%|████████▌ | 85/100 [01:32<00:26,  1.76s/it] 86%|████████▌ | 86/100 [01:35<00:29,  2.09s/it] 87%|████████▋ | 87/100 [01:36<00:22,  1.76s/it] 88%|████████▊ | 88/100 [01:36<00:17,  1.47s/it] 89%|████████▉ | 89/100 [01:38<00:16,  1.52s/it] 90%|█████████ | 90/100 [01:41<00:18,  1.90s/it] 91%|█████████ | 91/100 [01:42<00:14,  1.57s/it] 92%|█████████▏| 92/100 [01:42<00:10,  1.33s/it] 93%|█████████▎| 93/100 [01:43<00:07,  1.14s/it] 94%|█████████▍| 94/100 [01:45<00:07,  1.23s/it] 95%|█████████▌| 95/100 [01:48<00:09,  1.83s/it] 96%|█████████▌| 96/100 [01:51<00:09,  2.26s/it] 97%|█████████▋| 97/100 [01:56<00:08,  2.96s/it] 98%|█████████▊| 98/100 [01:58<00:05,  2.62s/it] 99%|█████████▉| 99/100 [01:59<00:02,  2.30s/it]100%|██████████| 100/100 [02:01<00:00,  2.17s/it]100%|██████████| 100/100 [02:01<00:00,  1.21s/it]
2023-06-14 19:29:36 [INFO] {
2023-06-14 19:29:36 [INFO]     'eval_loss': 1.174701452255249,
2023-06-14 19:29:36 [INFO]     'eval_runtime': 122.1609,
2023-06-14 19:29:36 [INFO]     'eval_samples_per_second': 0.819,
2023-06-14 19:29:36 [INFO]     'eval_steps_per_second': 0.819
2023-06-14 19:29:36 [INFO] }
2023-06-14 19:29:36 [INFO] metric: 0.819
2023-06-14 19:29:36 [INFO] Throughput: 0.819 samples/sec
2023-06-14 19:29:36 [INFO] Tune 6 result is: [Accuracy (int8|fp32): 0.8190|0.7430, Duration (seconds) (int8|fp32): 122.1670|134.5328], Best tune result is: [Accuracy: 1.1660, Duration (seconds): 85.7791]
2023-06-14 19:29:36 [INFO] |***********************Tune Result Statistics**********************|
2023-06-14 19:29:36 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 19:29:36 [INFO] |     Info Type      |  Baseline | Tune 6 result | Best tune result |
2023-06-14 19:29:36 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 19:29:36 [INFO] |      Accuracy      |  0.7430   |    0.8190     |     1.1660       |
2023-06-14 19:29:36 [INFO] | Duration (seconds) | 134.5328  |   122.1670    |     85.7791      |
2023-06-14 19:29:36 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 19:29:36 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-18-17/./history.snapshot.
2023-06-14 19:29:36 [WARNING] None of the submodule got qconfig applied. Make sure you passed correct configuration through `qconfig_dict` or by assigning the `.qconfig` attribute directly on submodules.
2023-06-14 19:29:36 [INFO] |******Mixed Precision Statistics******|
2023-06-14 19:29:36 [INFO] +-----------------+----------+---------+
2023-06-14 19:29:36 [INFO] |     Op Type     |  Total   |   FP32  |
2023-06-14 19:29:36 [INFO] +-----------------+----------+---------+
2023-06-14 19:29:36 [INFO] |    Embedding    |    2     |    2    |
2023-06-14 19:29:36 [INFO] |      Linear     |    1     |    1    |
2023-06-14 19:29:36 [INFO] +-----------------+----------+---------+
2023-06-14 19:29:36 [INFO] Pass quantize model elapsed time: 665.14 ms
2023-06-14 19:29:36 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: input, output, code.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:03<03:05,  1.89s/it]  3%|▎         | 3/100 [00:06<03:50,  2.37s/it]  4%|▍         | 4/100 [00:07<03:00,  1.88s/it]  5%|▌         | 5/100 [00:08<02:22,  1.50s/it]  6%|▌         | 6/100 [00:12<03:36,  2.30s/it]  7%|▋         | 7/100 [00:14<03:25,  2.21s/it]  8%|▊         | 8/100 [00:15<02:44,  1.78s/it]  9%|▉         | 9/100 [00:16<02:12,  1.46s/it] 10%|█         | 10/100 [00:16<01:51,  1.24s/it] 11%|█         | 11/100 [00:17<01:38,  1.11s/it] 12%|█▏        | 12/100 [00:18<01:28,  1.00s/it] 13%|█▎        | 13/100 [00:22<02:35,  1.79s/it] 14%|█▍        | 14/100 [00:25<03:12,  2.24s/it] 15%|█▌        | 15/100 [00:27<03:07,  2.21s/it] 16%|█▌        | 16/100 [00:30<03:15,  2.33s/it] 17%|█▋        | 17/100 [00:30<02:34,  1.86s/it] 18%|█▊        | 18/100 [00:31<02:05,  1.53s/it] 19%|█▉        | 19/100 [00:32<01:47,  1.33s/it] 20%|██        | 20/100 [00:34<02:10,  1.63s/it] 21%|██        | 21/100 [00:38<03:01,  2.30s/it] 22%|██▏       | 22/100 [00:40<02:44,  2.11s/it] 23%|██▎       | 23/100 [00:41<02:11,  1.71s/it] 24%|██▍       | 24/100 [00:41<01:48,  1.42s/it] 25%|██▌       | 25/100 [00:43<01:45,  1.40s/it] 26%|██▌       | 26/100 [00:44<01:35,  1.29s/it] 27%|██▋       | 27/100 [00:48<02:30,  2.06s/it] 28%|██▊       | 28/100 [00:51<02:59,  2.49s/it] 29%|██▉       | 29/100 [00:52<02:25,  2.06s/it] 30%|███       | 30/100 [00:55<02:30,  2.15s/it] 31%|███       | 31/100 [00:56<02:16,  1.98s/it] 32%|███▏      | 32/100 [01:00<02:44,  2.42s/it] 33%|███▎      | 33/100 [01:03<03:05,  2.77s/it] 34%|███▍      | 34/100 [01:07<03:24,  3.10s/it] 35%|███▌      | 35/100 [01:11<03:29,  3.22s/it] 36%|███▌      | 36/100 [01:14<03:28,  3.26s/it] 37%|███▋      | 37/100 [01:17<03:31,  3.36s/it] 38%|███▊      | 38/100 [01:21<03:38,  3.52s/it] 39%|███▉      | 39/100 [01:25<03:32,  3.49s/it] 40%|████      | 40/100 [01:29<03:33,  3.56s/it] 41%|████      | 41/100 [01:32<03:33,  3.61s/it] 42%|████▏     | 42/100 [01:36<03:31,  3.65s/it] 43%|████▎     | 43/100 [01:40<03:30,  3.69s/it] 44%|████▍     | 44/100 [01:44<03:29,  3.75s/it] 45%|████▌     | 45/100 [01:48<03:28,  3.78s/it] 46%|████▌     | 46/100 [01:51<03:26,  3.82s/it] 47%|████▋     | 47/100 [01:55<03:21,  3.80s/it] 48%|████▊     | 48/100 [01:59<03:11,  3.68s/it] 49%|████▉     | 49/100 [02:02<03:02,  3.57s/it] 50%|█████     | 50/100 [02:06<03:01,  3.62s/it] 51%|█████     | 51/100 [02:09<02:55,  3.57s/it] 52%|█████▏    | 52/100 [02:13<02:54,  3.64s/it] 53%|█████▎    | 53/100 [02:16<02:49,  3.61s/it] 54%|█████▍    | 54/100 [02:19<02:30,  3.26s/it] 55%|█████▌    | 55/100 [02:23<02:37,  3.49s/it] 56%|█████▌    | 56/100 [02:27<02:38,  3.60s/it] 57%|█████▋    | 57/100 [02:31<02:38,  3.69s/it] 58%|█████▊    | 58/100 [02:34<02:34,  3.68s/it] 59%|█████▉    | 59/100 [02:38<02:33,  3.73s/it] 60%|██████    | 60/100 [02:42<02:31,  3.79s/it] 61%|██████    | 61/100 [02:46<02:24,  3.69s/it] 62%|██████▏   | 62/100 [02:49<02:22,  3.76s/it] 63%|██████▎   | 63/100 [02:53<02:20,  3.79s/it] 64%|██████▍   | 64/100 [02:57<02:17,  3.81s/it] 65%|██████▌   | 65/100 [03:01<02:14,  3.85s/it] 66%|██████▌   | 66/100 [03:05<02:10,  3.84s/it] 67%|██████▋   | 67/100 [03:09<02:06,  3.83s/it] 68%|██████▊   | 68/100 [03:12<02:01,  3.79s/it] 69%|██████▉   | 69/100 [03:16<01:56,  3.75s/it] 70%|███████   | 70/100 [03:20<01:53,  3.79s/it] 71%|███████   | 71/100 [03:24<01:50,  3.80s/it] 72%|███████▏  | 72/100 [03:28<01:47,  3.84s/it] 73%|███████▎  | 73/100 [03:31<01:37,  3.60s/it] 74%|███████▍  | 74/100 [03:32<01:11,  2.75s/it] 75%|███████▌  | 75/100 [03:33<00:57,  2.30s/it] 76%|███████▌  | 76/100 [03:37<01:06,  2.76s/it] 77%|███████▋  | 77/100 [03:41<01:11,  3.10s/it] 78%|███████▊  | 78/100 [03:44<01:12,  3.29s/it] 79%|███████▉  | 79/100 [03:48<01:11,  3.42s/it] 80%|████████  | 80/100 [03:52<01:09,  3.49s/it] 81%|████████  | 81/100 [03:55<01:06,  3.50s/it] 82%|████████▏ | 82/100 [03:59<01:02,  3.48s/it] 83%|████████▎ | 83/100 [04:02<01:00,  3.54s/it] 84%|████████▍ | 84/100 [04:06<00:58,  3.63s/it] 85%|████████▌ | 85/100 [04:10<00:55,  3.73s/it] 86%|████████▌ | 86/100 [04:14<00:52,  3.78s/it] 87%|████████▋ | 87/100 [04:18<00:49,  3.80s/it] 88%|████████▊ | 88/100 [04:22<00:45,  3.82s/it] 89%|████████▉ | 89/100 [04:26<00:42,  3.82s/it] 90%|█████████ | 90/100 [04:27<00:32,  3.26s/it] 91%|█████████ | 91/100 [04:28<00:22,  2.51s/it] 92%|█████████▏| 92/100 [04:29<00:15,  1.99s/it] 93%|█████████▎| 93/100 [04:31<00:13,  1.97s/it] 94%|█████████▍| 94/100 [04:35<00:15,  2.51s/it] 95%|█████████▌| 95/100 [04:38<00:14,  2.83s/it] 96%|█████████▌| 96/100 [04:42<00:11,  2.97s/it] 97%|█████████▋| 97/100 [04:43<00:07,  2.44s/it] 98%|█████████▊| 98/100 [04:44<00:04,  2.01s/it] 99%|█████████▉| 99/100 [04:45<00:01,  1.72s/it]100%|██████████| 100/100 [04:49<00:00,  2.33s/it]100%|██████████| 100/100 [04:49<00:00,  2.89s/it]
2023-06-14 19:34:29 [INFO] {
2023-06-14 19:34:29 [INFO]     'eval_loss': 1.1736871004104614,
2023-06-14 19:34:29 [INFO]     'eval_runtime': 292.8926,
2023-06-14 19:34:29 [INFO]     'eval_samples_per_second': 0.341,
2023-06-14 19:34:29 [INFO]     'eval_steps_per_second': 0.341
2023-06-14 19:34:29 [INFO] }
2023-06-14 19:34:29 [INFO] metric: 0.341
2023-06-14 19:34:29 [INFO] Throughput: 0.341 samples/sec
2023-06-14 19:34:29 [INFO] Tune 7 result is: [Accuracy (int8|fp32): 0.3410|0.7430, Duration (seconds) (int8|fp32): 292.8983|134.5328], Best tune result is: [Accuracy: 1.1660, Duration (seconds): 85.7791]
2023-06-14 19:34:29 [INFO] |***********************Tune Result Statistics**********************|
2023-06-14 19:34:29 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 19:34:29 [INFO] |     Info Type      |  Baseline | Tune 7 result | Best tune result |
2023-06-14 19:34:29 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 19:34:29 [INFO] |      Accuracy      |  0.7430   |    0.3410     |     1.1660       |
2023-06-14 19:34:29 [INFO] | Duration (seconds) | 134.5328  |   292.8983    |     85.7791      |
2023-06-14 19:34:29 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 19:34:29 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-18-17/./history.snapshot.
2023-06-14 19:34:31 [INFO] |******Mixed Precision Statistics******|
2023-06-14 19:34:31 [INFO] +-------------+--------+------+--------+
2023-06-14 19:34:31 [INFO] |   Op Type   | Total  | INT8 |  FP32  |
2023-06-14 19:34:31 [INFO] +-------------+--------+------+--------+
2023-06-14 19:34:31 [INFO] |  Embedding  |   2    |  1   |   1    |
2023-06-14 19:34:31 [INFO] |    Linear   |   1    |  1   |   0    |
2023-06-14 19:34:31 [INFO] +-------------+--------+------+--------+
2023-06-14 19:34:31 [INFO] Pass quantize model elapsed time: 1581.1 ms
2023-06-14 19:34:31 [INFO] Specified timeout or max trials is reached! Found a quantized model which meet accuracy goal. Exit.
2023-06-14 19:34:32 [INFO] Save deploy yaml to /scratch/dsochirca/nc_workspace/2023-06-14_19-18-17/deploy.yaml
2023-06-14 19:34:34 [INFO] Saving model checkpoint to ./test_epoch
2023-06-14 19:34:46 [INFO] quantized model and configure file have saved to ./test_epoch
2023-06-14 19:34:50 [INFO] Saving model checkpoint to ./models/CodeGPT-Py150_0.6_sparse_q_all_layers_sym_per_channel
2023-06-14 19:35:08 [INFO] quantized model and configure file have saved to ./models/CodeGPT-Py150_0.6_sparse_q_all_layers_sym_per_channel
2023-06-14 19:35:11 [WARNING] Force convert framework model to neural_compressor model.
2023-06-14 19:35:11 [INFO] Pass query framework capability elapsed time: 1.22 ms
2023-06-14 19:35:11 [INFO] Adaptor has 1 recipes.
2023-06-14 19:35:11 [INFO] 0 recipes specified by user.
2023-06-14 19:35:11 [INFO] 0 recipes require future tuning.
2023-06-14 19:35:11 [INFO] ..............use_distributed_tuning: None
2023-06-14 19:35:11 [INFO] Get FP32 model baseline.
2023-06-14 19:35:11 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: input, output, code.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:36,  2.69it/s]  3%|▎         | 3/100 [00:01<01:07,  1.44it/s]  4%|▍         | 4/100 [00:03<01:35,  1.01it/s]  5%|▌         | 5/100 [00:06<02:32,  1.61s/it]  6%|▌         | 6/100 [00:07<02:10,  1.39s/it]  7%|▋         | 7/100 [00:08<02:04,  1.34s/it]  8%|▊         | 8/100 [00:10<02:17,  1.49s/it]  9%|▉         | 9/100 [00:10<01:54,  1.26s/it] 10%|█         | 10/100 [00:11<01:39,  1.10s/it] 11%|█         | 11/100 [00:13<02:11,  1.48s/it] 12%|█▏        | 12/100 [00:17<03:12,  2.19s/it] 13%|█▎        | 13/100 [00:18<02:37,  1.81s/it] 14%|█▍        | 14/100 [00:19<02:08,  1.50s/it] 15%|█▌        | 15/100 [00:20<01:48,  1.28s/it] 16%|█▌        | 16/100 [00:21<01:34,  1.12s/it] 17%|█▋        | 17/100 [00:21<01:24,  1.02s/it] 18%|█▊        | 18/100 [00:22<01:17,  1.06it/s] 19%|█▉        | 19/100 [00:23<01:12,  1.12it/s] 20%|██        | 20/100 [00:24<01:08,  1.18it/s] 21%|██        | 21/100 [00:25<01:10,  1.12it/s] 22%|██▏       | 22/100 [00:25<01:06,  1.17it/s] 23%|██▎       | 23/100 [00:26<01:03,  1.22it/s] 24%|██▍       | 24/100 [00:27<01:09,  1.09it/s] 25%|██▌       | 25/100 [00:28<01:04,  1.16it/s] 26%|██▌       | 26/100 [00:29<01:00,  1.22it/s] 27%|██▋       | 27/100 [00:29<00:57,  1.26it/s] 28%|██▊       | 28/100 [00:30<00:55,  1.30it/s] 29%|██▉       | 29/100 [00:31<00:53,  1.32it/s] 30%|███       | 30/100 [00:32<00:52,  1.34it/s] 31%|███       | 31/100 [00:32<00:50,  1.36it/s] 32%|███▏      | 32/100 [00:33<00:49,  1.37it/s] 33%|███▎      | 33/100 [00:34<00:48,  1.37it/s] 34%|███▍      | 34/100 [00:36<01:17,  1.17s/it] 35%|███▌      | 35/100 [00:39<01:43,  1.60s/it] 36%|███▌      | 36/100 [00:39<01:25,  1.33s/it] 37%|███▋      | 37/100 [00:40<01:12,  1.15s/it] 38%|███▊      | 38/100 [00:42<01:35,  1.54s/it] 39%|███▉      | 39/100 [00:45<01:48,  1.79s/it] 40%|████      | 40/100 [00:46<01:31,  1.52s/it] 41%|████      | 41/100 [00:49<01:55,  1.95s/it] 42%|████▏     | 42/100 [00:51<02:00,  2.09s/it] 43%|████▎     | 43/100 [00:52<01:36,  1.69s/it] 44%|████▍     | 44/100 [00:53<01:29,  1.60s/it] 45%|████▌     | 45/100 [00:55<01:33,  1.70s/it] 46%|████▌     | 46/100 [00:59<02:02,  2.26s/it] 47%|████▋     | 47/100 [01:00<01:36,  1.82s/it] 48%|████▊     | 48/100 [01:00<01:21,  1.56s/it] 49%|████▉     | 49/100 [01:02<01:19,  1.56s/it] 50%|█████     | 50/100 [01:03<01:08,  1.36s/it] 51%|█████     | 51/100 [01:04<00:57,  1.18s/it] 52%|█████▏    | 52/100 [01:04<00:50,  1.05s/it] 53%|█████▎    | 53/100 [01:05<00:44,  1.05it/s] 54%|█████▍    | 54/100 [01:06<00:40,  1.13it/s] 55%|█████▌    | 55/100 [01:07<00:38,  1.18it/s] 56%|█████▌    | 56/100 [01:08<00:39,  1.13it/s] 57%|█████▋    | 57/100 [01:09<00:41,  1.05it/s] 58%|█████▊    | 58/100 [01:10<00:43,  1.04s/it] 59%|█████▉    | 59/100 [01:11<00:41,  1.01s/it] 60%|██████    | 60/100 [01:13<00:53,  1.34s/it] 61%|██████    | 61/100 [01:14<00:45,  1.17s/it] 62%|██████▏   | 62/100 [01:15<00:39,  1.03s/it] 63%|██████▎   | 63/100 [01:15<00:36,  1.02it/s] 64%|██████▍   | 64/100 [01:16<00:34,  1.06it/s] 65%|██████▌   | 65/100 [01:18<00:45,  1.29s/it] 66%|██████▌   | 66/100 [01:20<00:43,  1.28s/it] 67%|██████▋   | 67/100 [01:20<00:37,  1.12s/it] 68%|██████▊   | 68/100 [01:21<00:32,  1.01s/it] 69%|██████▉   | 69/100 [01:22<00:28,  1.07it/s] 70%|███████   | 70/100 [01:23<00:29,  1.01it/s] 71%|███████   | 71/100 [01:25<00:36,  1.24s/it] 72%|███████▏  | 72/100 [01:26<00:30,  1.10s/it] 73%|███████▎  | 73/100 [01:26<00:26,  1.01it/s] 74%|███████▍  | 74/100 [01:27<00:23,  1.09it/s] 75%|███████▌  | 75/100 [01:28<00:24,  1.03it/s] 76%|███████▌  | 76/100 [01:30<00:27,  1.15s/it] 77%|███████▋  | 77/100 [01:31<00:27,  1.18s/it] 78%|███████▊  | 78/100 [01:32<00:26,  1.19s/it] 79%|███████▉  | 79/100 [01:34<00:27,  1.31s/it] 80%|████████  | 80/100 [01:35<00:22,  1.14s/it] 81%|████████  | 81/100 [01:35<00:19,  1.01s/it] 82%|████████▏ | 82/100 [01:37<00:22,  1.27s/it] 83%|████████▎ | 83/100 [01:38<00:20,  1.21s/it] 84%|████████▍ | 84/100 [01:40<00:20,  1.27s/it] 85%|████████▌ | 85/100 [01:42<00:22,  1.51s/it] 86%|████████▌ | 86/100 [01:44<00:23,  1.65s/it] 87%|████████▋ | 87/100 [01:44<00:17,  1.37s/it] 88%|████████▊ | 88/100 [01:46<00:18,  1.52s/it] 89%|████████▉ | 89/100 [01:47<00:14,  1.29s/it] 90%|█████████ | 90/100 [01:48<00:11,  1.12s/it] 91%|█████████ | 91/100 [01:48<00:08,  1.00it/s] 92%|█████████▏| 92/100 [01:49<00:07,  1.07it/s] 93%|█████████▎| 93/100 [01:50<00:06,  1.14it/s] 94%|█████████▍| 94/100 [01:51<00:04,  1.21it/s] 95%|█████████▌| 95/100 [01:51<00:03,  1.25it/s] 96%|█████████▌| 96/100 [01:52<00:03,  1.27it/s] 97%|█████████▋| 97/100 [01:53<00:02,  1.28it/s] 98%|█████████▊| 98/100 [01:54<00:01,  1.31it/s] 99%|█████████▉| 99/100 [01:55<00:00,  1.19it/s]100%|██████████| 100/100 [01:55<00:00,  1.23it/s]100%|██████████| 100/100 [01:55<00:00,  1.16s/it]
2023-06-14 19:37:09 [INFO] {
2023-06-14 19:37:09 [INFO]     'eval_loss': 1.1736871004104614,
2023-06-14 19:37:09 [INFO]     'eval_runtime': 118.3196,
2023-06-14 19:37:09 [INFO]     'eval_samples_per_second': 0.845,
2023-06-14 19:37:09 [INFO]     'eval_steps_per_second': 0.845
2023-06-14 19:37:09 [INFO] }
2023-06-14 19:37:09 [INFO] metric: 0.845
2023-06-14 19:37:09 [INFO] Throughput: 0.845 samples/sec
2023-06-14 19:37:09 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-18-17/./history.snapshot.
2023-06-14 19:37:09 [INFO] FP32 baseline is: [Accuracy: 0.8450, Duration (seconds): 118.3237]
2023-06-14 19:37:10 [INFO] |******Mixed Precision Statistics******|
2023-06-14 19:37:10 [INFO] +-----------------+----------+---------+
2023-06-14 19:37:10 [INFO] |     Op Type     |  Total   |   INT8  |
2023-06-14 19:37:10 [INFO] +-----------------+----------+---------+
2023-06-14 19:37:10 [INFO] |    Embedding    |    2     |    2    |
2023-06-14 19:37:10 [INFO] |      Linear     |    1     |    1    |
2023-06-14 19:37:10 [INFO] +-----------------+----------+---------+
2023-06-14 19:37:10 [INFO] Pass quantize model elapsed time: 1028.64 ms
2023-06-14 19:37:10 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: input, output, code.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:01<01:19,  1.23it/s]  3%|▎         | 3/100 [00:02<01:15,  1.29it/s]  4%|▍         | 4/100 [00:03<01:12,  1.32it/s]  5%|▌         | 5/100 [00:03<01:11,  1.34it/s]  6%|▌         | 6/100 [00:04<01:09,  1.35it/s]  7%|▋         | 7/100 [00:05<01:09,  1.35it/s]  8%|▊         | 8/100 [00:06<01:07,  1.35it/s]  9%|▉         | 9/100 [00:07<01:17,  1.18it/s] 10%|█         | 10/100 [00:07<01:16,  1.18it/s] 11%|█         | 11/100 [00:09<01:35,  1.08s/it] 12%|█▏        | 12/100 [00:11<02:04,  1.42s/it] 13%|█▎        | 13/100 [00:14<02:29,  1.72s/it] 14%|█▍        | 14/100 [00:15<02:10,  1.51s/it] 15%|█▌        | 15/100 [00:16<01:51,  1.31s/it] 16%|█▌        | 16/100 [00:16<01:37,  1.16s/it] 17%|█▋        | 17/100 [00:19<02:04,  1.51s/it] 18%|█▊        | 18/100 [00:19<01:42,  1.25s/it] 19%|█▉        | 19/100 [00:20<01:26,  1.07s/it] 20%|██        | 20/100 [00:21<01:15,  1.06it/s] 21%|██        | 21/100 [00:21<01:07,  1.18it/s] 22%|██▏       | 22/100 [00:22<01:01,  1.26it/s] 23%|██▎       | 23/100 [00:24<01:23,  1.09s/it] 24%|██▍       | 24/100 [00:24<01:12,  1.05it/s] 25%|██▌       | 25/100 [00:25<01:04,  1.16it/s] 26%|██▌       | 26/100 [00:26<00:59,  1.25it/s] 27%|██▋       | 27/100 [00:26<00:55,  1.32it/s] 28%|██▊       | 28/100 [00:27<00:52,  1.38it/s] 29%|██▉       | 29/100 [00:28<00:49,  1.43it/s] 30%|███       | 30/100 [00:28<00:48,  1.45it/s] 31%|███       | 31/100 [00:31<01:30,  1.31s/it] 32%|███▏      | 32/100 [00:32<01:16,  1.12s/it] 33%|███▎      | 33/100 [00:32<01:05,  1.02it/s] 34%|███▍      | 34/100 [00:33<00:58,  1.12it/s] 35%|███▌      | 35/100 [00:34<00:53,  1.21it/s] 36%|███▌      | 36/100 [00:34<00:50,  1.27it/s] 37%|███▋      | 37/100 [00:35<00:50,  1.25it/s] 38%|███▊      | 38/100 [00:36<00:51,  1.21it/s] 39%|███▉      | 39/100 [00:37<00:57,  1.06it/s] 40%|████      | 40/100 [00:38<00:55,  1.08it/s] 41%|████      | 41/100 [00:39<00:54,  1.07it/s] 42%|████▏     | 42/100 [00:40<00:54,  1.07it/s] 43%|████▎     | 43/100 [00:42<01:13,  1.30s/it] 44%|████▍     | 44/100 [00:44<01:19,  1.43s/it] 45%|████▌     | 45/100 [00:45<01:08,  1.25s/it] 46%|████▌     | 46/100 [00:46<01:13,  1.37s/it] 47%|████▋     | 47/100 [00:48<01:13,  1.38s/it] 48%|████▊     | 48/100 [00:49<01:04,  1.24s/it] 49%|████▉     | 49/100 [00:50<01:00,  1.18s/it] 50%|█████     | 50/100 [00:51<00:58,  1.16s/it] 51%|█████     | 51/100 [00:52<00:55,  1.14s/it] 52%|█████▏    | 52/100 [00:53<00:49,  1.03s/it] 53%|█████▎    | 53/100 [00:54<00:49,  1.05s/it] 54%|█████▍    | 54/100 [00:55<00:47,  1.03s/it] 55%|█████▌    | 55/100 [00:56<00:41,  1.08it/s] 56%|█████▌    | 56/100 [00:56<00:37,  1.17it/s] 57%|█████▋    | 57/100 [00:57<00:34,  1.25it/s] 58%|█████▊    | 58/100 [00:58<00:32,  1.30it/s] 59%|█████▉    | 59/100 [00:58<00:30,  1.35it/s] 60%|██████    | 60/100 [00:59<00:29,  1.38it/s] 61%|██████    | 61/100 [01:00<00:27,  1.40it/s] 62%|██████▏   | 62/100 [01:00<00:26,  1.44it/s] 63%|██████▎   | 63/100 [01:01<00:25,  1.48it/s] 64%|██████▍   | 64/100 [01:02<00:23,  1.50it/s] 65%|██████▌   | 65/100 [01:02<00:23,  1.52it/s] 66%|██████▌   | 66/100 [01:03<00:22,  1.53it/s] 67%|██████▋   | 67/100 [01:03<00:21,  1.54it/s] 68%|██████▊   | 68/100 [01:04<00:20,  1.54it/s] 69%|██████▉   | 69/100 [01:05<00:20,  1.55it/s] 70%|███████   | 70/100 [01:05<00:19,  1.55it/s] 71%|███████   | 71/100 [01:06<00:18,  1.55it/s] 72%|███████▏  | 72/100 [01:07<00:18,  1.55it/s] 73%|███████▎  | 73/100 [01:07<00:17,  1.55it/s] 74%|███████▍  | 74/100 [01:08<00:16,  1.56it/s] 75%|███████▌  | 75/100 [01:09<00:16,  1.56it/s] 76%|███████▌  | 76/100 [01:09<00:15,  1.56it/s] 77%|███████▋  | 77/100 [01:10<00:14,  1.56it/s] 78%|███████▊  | 78/100 [01:11<00:13,  1.57it/s] 79%|███████▉  | 79/100 [01:11<00:13,  1.58it/s] 80%|████████  | 80/100 [01:12<00:12,  1.58it/s] 81%|████████  | 81/100 [01:12<00:11,  1.58it/s] 82%|████████▏ | 82/100 [01:13<00:11,  1.56it/s] 83%|████████▎ | 83/100 [01:14<00:13,  1.24it/s] 84%|████████▍ | 84/100 [01:15<00:12,  1.28it/s] 85%|████████▌ | 85/100 [01:16<00:11,  1.34it/s] 86%|████████▌ | 86/100 [01:16<00:10,  1.38it/s] 87%|████████▋ | 87/100 [01:17<00:09,  1.41it/s] 88%|████████▊ | 88/100 [01:18<00:08,  1.43it/s] 89%|████████▉ | 89/100 [01:18<00:07,  1.45it/s] 90%|█████████ | 90/100 [01:19<00:06,  1.46it/s] 91%|█████████ | 91/100 [01:20<00:06,  1.47it/s] 92%|█████████▏| 92/100 [01:20<00:05,  1.47it/s] 93%|█████████▎| 93/100 [01:21<00:04,  1.47it/s] 94%|█████████▍| 94/100 [01:22<00:04,  1.48it/s] 95%|█████████▌| 95/100 [01:23<00:04,  1.21it/s] 96%|█████████▌| 96/100 [01:24<00:03,  1.28it/s] 97%|█████████▋| 97/100 [01:24<00:02,  1.34it/s] 98%|█████████▊| 98/100 [01:25<00:01,  1.37it/s] 99%|█████████▉| 99/100 [01:26<00:00,  1.30it/s]100%|██████████| 100/100 [01:26<00:00,  1.36it/s]100%|██████████| 100/100 [01:26<00:00,  1.15it/s]
2023-06-14 19:38:38 [INFO] {
2023-06-14 19:38:38 [INFO]     'eval_loss': 1.1748971939086914,
2023-06-14 19:38:38 [INFO]     'eval_runtime': 87.68,
2023-06-14 19:38:38 [INFO]     'eval_samples_per_second': 1.141,
2023-06-14 19:38:38 [INFO]     'eval_steps_per_second': 1.141
2023-06-14 19:38:38 [INFO] }
2023-06-14 19:38:38 [INFO] metric: 1.141
2023-06-14 19:38:38 [INFO] Throughput: 1.141 samples/sec
2023-06-14 19:38:38 [INFO] Tune 1 result is: [Accuracy (int8|fp32): 1.1410|0.8450, Duration (seconds) (int8|fp32): 87.6841|118.3237], Best tune result is: [Accuracy: 1.1410, Duration (seconds): 87.6841]
2023-06-14 19:38:38 [INFO] |***********************Tune Result Statistics**********************|
2023-06-14 19:38:38 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 19:38:38 [INFO] |     Info Type      |  Baseline | Tune 1 result | Best tune result |
2023-06-14 19:38:38 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 19:38:38 [INFO] |      Accuracy      |  0.8450   |    1.1410     |     1.1410       |
2023-06-14 19:38:38 [INFO] | Duration (seconds) | 118.3237  |    87.6841    |     87.6841      |
2023-06-14 19:38:38 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 19:38:38 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-18-17/./history.snapshot.
2023-06-14 19:38:43 [INFO] Apply all recipes.
2023-06-14 19:38:43 [WARNING] Find evaluated tuning config, skip.
2023-06-14 19:38:43 [INFO] Apply recipe one by one.
2023-06-14 19:38:43 [INFO] Start to fallback op to fp32 one by one.
2023-06-14 19:38:44 [INFO] |******Mixed Precision Statistics******|
2023-06-14 19:38:44 [INFO] +-------------+--------+------+--------+
2023-06-14 19:38:44 [INFO] |   Op Type   | Total  | INT8 |  FP32  |
2023-06-14 19:38:44 [INFO] +-------------+--------+------+--------+
2023-06-14 19:38:44 [INFO] |  Embedding  |   2    |  2   |   0    |
2023-06-14 19:38:44 [INFO] |    Linear   |   1    |  0   |   1    |
2023-06-14 19:38:44 [INFO] +-------------+--------+------+--------+
2023-06-14 19:38:44 [INFO] Pass quantize model elapsed time: 525.27 ms
2023-06-14 19:38:44 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: input, output, code.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:35,  2.78it/s]  3%|▎         | 3/100 [00:01<00:50,  1.93it/s]  4%|▍         | 4/100 [00:02<00:57,  1.67it/s]  5%|▌         | 5/100 [00:02<01:00,  1.56it/s]  6%|▌         | 6/100 [00:04<01:26,  1.09it/s]  7%|▋         | 7/100 [00:05<01:19,  1.17it/s]  8%|▊         | 8/100 [00:07<01:55,  1.26s/it]  9%|▉         | 9/100 [00:07<01:38,  1.08s/it] 10%|█         | 10/100 [00:08<01:35,  1.06s/it] 11%|█         | 11/100 [00:09<01:24,  1.05it/s] 12%|█▏        | 12/100 [00:10<01:17,  1.13it/s] 13%|█▎        | 13/100 [00:11<01:11,  1.21it/s] 14%|█▍        | 14/100 [00:11<01:07,  1.27it/s] 15%|█▌        | 15/100 [00:16<02:37,  1.85s/it] 16%|█▌        | 16/100 [00:21<04:11,  2.99s/it] 17%|█▋        | 17/100 [00:22<03:15,  2.35s/it] 18%|█▊        | 18/100 [00:23<02:32,  1.86s/it] 19%|█▉        | 19/100 [00:24<02:06,  1.56s/it] 20%|██        | 20/100 [00:25<02:00,  1.50s/it] 21%|██        | 21/100 [00:26<01:39,  1.26s/it] 22%|██▏       | 22/100 [00:26<01:26,  1.11s/it] 23%|██▎       | 23/100 [00:27<01:18,  1.03s/it] 24%|██▍       | 24/100 [00:29<01:30,  1.19s/it] 25%|██▌       | 25/100 [00:31<01:57,  1.56s/it] 26%|██▌       | 26/100 [00:34<02:12,  1.78s/it] 27%|██▋       | 27/100 [00:34<01:46,  1.45s/it] 28%|██▊       | 28/100 [00:35<01:28,  1.23s/it] 29%|██▉       | 29/100 [00:36<01:15,  1.07s/it] 30%|███       | 30/100 [00:37<01:12,  1.04s/it] 31%|███       | 31/100 [00:39<01:28,  1.29s/it] 32%|███▏      | 32/100 [00:39<01:17,  1.14s/it] 33%|███▎      | 33/100 [00:40<01:07,  1.01s/it] 34%|███▍      | 34/100 [00:41<01:00,  1.09it/s] 35%|███▌      | 35/100 [00:41<00:56,  1.16it/s] 36%|███▌      | 36/100 [00:46<02:02,  1.91s/it] 37%|███▋      | 37/100 [00:50<02:40,  2.55s/it] 38%|███▊      | 38/100 [00:51<02:04,  2.01s/it] 39%|███▉      | 39/100 [00:51<01:38,  1.61s/it] 40%|████      | 40/100 [00:52<01:19,  1.33s/it] 41%|████      | 41/100 [00:53<01:07,  1.14s/it] 42%|████▏     | 42/100 [00:55<01:33,  1.61s/it] 43%|████▎     | 43/100 [00:57<01:32,  1.62s/it] 44%|████▍     | 44/100 [00:58<01:15,  1.35s/it] 45%|████▌     | 45/100 [00:58<01:04,  1.17s/it] 46%|████▌     | 46/100 [01:05<02:23,  2.67s/it] 47%|████▋     | 47/100 [01:10<03:06,  3.52s/it] 48%|████▊     | 48/100 [01:12<02:37,  3.03s/it] 49%|████▉     | 49/100 [01:13<01:58,  2.32s/it] 50%|█████     | 50/100 [01:13<01:31,  1.82s/it] 51%|█████     | 51/100 [01:14<01:12,  1.48s/it] 52%|█████▏    | 52/100 [01:15<00:59,  1.24s/it] 53%|█████▎    | 53/100 [01:15<00:50,  1.07s/it] 54%|█████▍    | 54/100 [01:16<00:43,  1.05it/s] 55%|█████▌    | 55/100 [01:17<00:39,  1.14it/s] 56%|█████▌    | 56/100 [01:18<00:37,  1.17it/s] 57%|█████▋    | 57/100 [01:21<01:03,  1.49s/it] 58%|█████▊    | 58/100 [01:21<00:51,  1.24s/it] 59%|█████▉    | 59/100 [01:22<00:43,  1.06s/it] 60%|██████    | 60/100 [01:23<00:37,  1.06it/s] 61%|██████    | 61/100 [01:23<00:33,  1.16it/s] 62%|██████▏   | 62/100 [01:24<00:30,  1.23it/s] 63%|██████▎   | 63/100 [01:25<00:31,  1.16it/s] 64%|██████▍   | 64/100 [01:26<00:29,  1.21it/s] 65%|██████▌   | 65/100 [01:26<00:27,  1.29it/s] 66%|██████▌   | 66/100 [01:27<00:28,  1.18it/s] 67%|██████▋   | 67/100 [01:29<00:34,  1.05s/it] 68%|██████▊   | 68/100 [01:30<00:35,  1.10s/it] 69%|██████▉   | 69/100 [01:31<00:35,  1.15s/it] 70%|███████   | 70/100 [01:32<00:30,  1.00s/it] 71%|███████   | 71/100 [01:33<00:26,  1.11it/s] 72%|███████▏  | 72/100 [01:33<00:23,  1.20it/s] 73%|███████▎  | 73/100 [01:34<00:21,  1.26it/s] 74%|███████▍  | 74/100 [01:35<00:19,  1.32it/s] 75%|███████▌  | 75/100 [01:35<00:18,  1.37it/s] 76%|███████▌  | 76/100 [01:37<00:23,  1.04it/s] 77%|███████▋  | 77/100 [01:38<00:21,  1.06it/s] 78%|███████▊  | 78/100 [01:38<00:19,  1.14it/s] 79%|███████▉  | 79/100 [01:39<00:17,  1.21it/s] 80%|████████  | 80/100 [01:41<00:24,  1.22s/it] 81%|████████  | 81/100 [01:43<00:24,  1.30s/it] 82%|████████▏ | 82/100 [01:43<00:20,  1.13s/it] 83%|████████▎ | 83/100 [01:44<00:17,  1.01s/it] 84%|████████▍ | 84/100 [01:45<00:15,  1.03it/s] 85%|████████▌ | 85/100 [01:46<00:13,  1.13it/s] 86%|████████▌ | 86/100 [01:47<00:12,  1.13it/s] 87%|████████▋ | 87/100 [01:47<00:10,  1.23it/s] 88%|████████▊ | 88/100 [01:48<00:09,  1.31it/s] 89%|████████▉ | 89/100 [01:49<00:08,  1.37it/s] 90%|█████████ | 90/100 [01:49<00:07,  1.40it/s] 91%|█████████ | 91/100 [01:50<00:06,  1.43it/s] 92%|█████████▏| 92/100 [01:51<00:05,  1.44it/s] 93%|█████████▎| 93/100 [01:51<00:04,  1.45it/s] 94%|█████████▍| 94/100 [01:52<00:04,  1.27it/s] 95%|█████████▌| 95/100 [01:53<00:03,  1.29it/s] 96%|█████████▌| 96/100 [01:55<00:04,  1.15s/it] 97%|█████████▋| 97/100 [01:56<00:03,  1.02s/it] 98%|█████████▊| 98/100 [01:57<00:01,  1.09it/s] 99%|█████████▉| 99/100 [01:57<00:00,  1.17it/s]100%|██████████| 100/100 [01:58<00:00,  1.25it/s]100%|██████████| 100/100 [01:58<00:00,  1.18s/it]
2023-06-14 19:40:43 [INFO] {
2023-06-14 19:40:43 [INFO]     'eval_loss': 1.1737359762191772,
2023-06-14 19:40:43 [INFO]     'eval_runtime': 119.5443,
2023-06-14 19:40:43 [INFO]     'eval_samples_per_second': 0.837,
2023-06-14 19:40:43 [INFO]     'eval_steps_per_second': 0.837
2023-06-14 19:40:43 [INFO] }
2023-06-14 19:40:43 [INFO] metric: 0.837
2023-06-14 19:40:43 [INFO] Throughput: 0.837 samples/sec
2023-06-14 19:40:43 [INFO] Tune 3 result is: [Accuracy (int8|fp32): 0.8370|0.8450, Duration (seconds) (int8|fp32): 119.5562|118.3237], Best tune result is: [Accuracy: 1.1410, Duration (seconds): 87.6841]
2023-06-14 19:40:43 [INFO] |***********************Tune Result Statistics**********************|
2023-06-14 19:40:43 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 19:40:43 [INFO] |     Info Type      |  Baseline | Tune 3 result | Best tune result |
2023-06-14 19:40:43 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 19:40:43 [INFO] |      Accuracy      |  0.8450   |    0.8370     |     1.1410       |
2023-06-14 19:40:43 [INFO] | Duration (seconds) | 118.3237  |   119.5562    |     87.6841      |
2023-06-14 19:40:43 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 19:40:43 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-18-17/./history.snapshot.
2023-06-14 19:40:45 [INFO] |******Mixed Precision Statistics******|
2023-06-14 19:40:45 [INFO] +-------------+--------+------+--------+
2023-06-14 19:40:45 [INFO] |   Op Type   | Total  | INT8 |  FP32  |
2023-06-14 19:40:45 [INFO] +-------------+--------+------+--------+
2023-06-14 19:40:45 [INFO] |  Embedding  |   2    |  1   |   1    |
2023-06-14 19:40:45 [INFO] |    Linear   |   1    |  1   |   0    |
2023-06-14 19:40:45 [INFO] +-------------+--------+------+--------+
2023-06-14 19:40:45 [INFO] Pass quantize model elapsed time: 955.04 ms
2023-06-14 19:40:45 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: input, output, code.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:47,  2.07it/s]  3%|▎         | 3/100 [00:04<02:39,  1.64s/it]  4%|▍         | 4/100 [00:05<02:07,  1.32s/it]  5%|▌         | 5/100 [00:06<01:55,  1.21s/it]  6%|▌         | 6/100 [00:07<01:55,  1.23s/it]  7%|▋         | 7/100 [00:12<03:39,  2.36s/it]  8%|▊         | 8/100 [00:15<04:19,  2.82s/it]  9%|▉         | 9/100 [00:19<04:46,  3.14s/it] 10%|█         | 10/100 [00:20<03:40,  2.45s/it] 11%|█         | 11/100 [00:22<03:24,  2.30s/it] 12%|█▏        | 12/100 [00:26<03:57,  2.70s/it] 13%|█▎        | 13/100 [00:29<04:22,  3.02s/it] 14%|█▍        | 14/100 [00:32<04:01,  2.81s/it] 15%|█▌        | 15/100 [00:34<03:32,  2.50s/it] 16%|█▌        | 16/100 [00:37<03:49,  2.73s/it] 17%|█▋        | 17/100 [00:41<04:12,  3.05s/it] 18%|█▊        | 18/100 [00:44<04:29,  3.28s/it] 19%|█▉        | 19/100 [00:48<04:38,  3.43s/it] 20%|██        | 20/100 [00:52<04:45,  3.56s/it] 21%|██        | 21/100 [00:55<04:18,  3.28s/it] 22%|██▏       | 22/100 [00:59<04:28,  3.44s/it] 23%|██▎       | 23/100 [01:02<04:29,  3.51s/it] 24%|██▍       | 24/100 [01:05<04:04,  3.22s/it] 25%|██▌       | 25/100 [01:07<03:36,  2.88s/it] 26%|██▌       | 26/100 [01:11<03:54,  3.17s/it] 27%|██▋       | 27/100 [01:14<04:01,  3.30s/it] 28%|██▊       | 28/100 [01:18<04:07,  3.44s/it] 29%|██▉       | 29/100 [01:22<04:08,  3.50s/it] 30%|███       | 30/100 [01:25<04:11,  3.59s/it] 31%|███       | 31/100 [01:29<04:13,  3.67s/it] 32%|███▏      | 32/100 [01:33<04:11,  3.70s/it] 33%|███▎      | 33/100 [01:37<04:04,  3.64s/it] 34%|███▍      | 34/100 [01:40<04:03,  3.69s/it] 35%|███▌      | 35/100 [01:44<03:59,  3.69s/it] 36%|███▌      | 36/100 [01:48<03:51,  3.61s/it] 37%|███▋      | 37/100 [01:51<03:49,  3.65s/it] 38%|███▊      | 38/100 [01:55<03:47,  3.67s/it] 39%|███▉      | 39/100 [01:58<03:38,  3.57s/it] 40%|████      | 40/100 [02:02<03:39,  3.66s/it] 41%|████      | 41/100 [02:06<03:38,  3.70s/it] 42%|████▏     | 42/100 [02:10<03:36,  3.74s/it] 43%|████▎     | 43/100 [02:14<03:34,  3.76s/it] 44%|████▍     | 44/100 [02:17<03:29,  3.75s/it] 45%|████▌     | 45/100 [02:21<03:26,  3.76s/it] 46%|████▌     | 46/100 [02:25<03:23,  3.77s/it] 47%|████▋     | 47/100 [02:28<03:04,  3.49s/it] 48%|████▊     | 48/100 [02:32<03:05,  3.57s/it] 49%|████▉     | 49/100 [02:35<03:04,  3.62s/it] 50%|█████     | 50/100 [02:39<03:05,  3.71s/it] 51%|█████     | 51/100 [02:43<02:59,  3.67s/it] 52%|█████▏    | 52/100 [02:46<02:51,  3.58s/it] 53%|█████▎    | 53/100 [02:49<02:36,  3.32s/it] 54%|█████▍    | 54/100 [02:52<02:37,  3.41s/it] 55%|█████▌    | 55/100 [02:56<02:36,  3.49s/it] 56%|█████▌    | 56/100 [03:00<02:36,  3.55s/it] 57%|█████▋    | 57/100 [03:04<02:34,  3.60s/it] 58%|█████▊    | 58/100 [03:07<02:32,  3.64s/it] 59%|█████▉    | 59/100 [03:11<02:31,  3.70s/it] 60%|██████    | 60/100 [03:15<02:30,  3.76s/it] 61%|██████    | 61/100 [03:19<02:26,  3.76s/it] 62%|██████▏   | 62/100 [03:22<02:21,  3.73s/it] 63%|██████▎   | 63/100 [03:26<02:17,  3.71s/it] 64%|██████▍   | 64/100 [03:29<02:07,  3.53s/it] 65%|██████▌   | 65/100 [03:32<01:56,  3.32s/it] 66%|██████▌   | 66/100 [03:36<01:56,  3.43s/it] 67%|██████▋   | 67/100 [03:40<01:56,  3.53s/it] 68%|██████▊   | 68/100 [03:43<01:55,  3.60s/it] 69%|██████▉   | 69/100 [03:47<01:51,  3.60s/it] 70%|███████   | 70/100 [03:50<01:46,  3.56s/it] 71%|███████   | 71/100 [03:54<01:45,  3.63s/it] 72%|███████▏  | 72/100 [03:58<01:42,  3.66s/it] 73%|███████▎  | 73/100 [04:02<01:39,  3.68s/it] 74%|███████▍  | 74/100 [04:04<01:23,  3.22s/it] 75%|███████▌  | 75/100 [04:07<01:22,  3.30s/it] 76%|███████▌  | 76/100 [04:10<01:15,  3.15s/it] 77%|███████▋  | 77/100 [04:14<01:16,  3.30s/it] 78%|███████▊  | 78/100 [04:18<01:16,  3.48s/it] 79%|███████▉  | 79/100 [04:21<01:14,  3.54s/it] 80%|████████  | 80/100 [04:25<01:11,  3.60s/it] 81%|████████  | 81/100 [04:29<01:09,  3.64s/it] 82%|████████▏ | 82/100 [04:32<01:03,  3.55s/it] 83%|████████▎ | 83/100 [04:36<01:00,  3.56s/it] 84%|████████▍ | 84/100 [04:39<00:58,  3.63s/it] 85%|████████▌ | 85/100 [04:43<00:55,  3.69s/it] 86%|████████▌ | 86/100 [04:47<00:50,  3.58s/it] 87%|████████▋ | 87/100 [04:50<00:47,  3.64s/it] 88%|████████▊ | 88/100 [04:54<00:44,  3.71s/it] 89%|████████▉ | 89/100 [04:58<00:41,  3.76s/it] 90%|█████████ | 90/100 [05:02<00:37,  3.77s/it] 91%|█████████ | 91/100 [05:06<00:33,  3.75s/it] 92%|█████████▏| 92/100 [05:09<00:29,  3.67s/it] 93%|█████████▎| 93/100 [05:13<00:26,  3.73s/it] 94%|█████████▍| 94/100 [05:17<00:22,  3.76s/it] 95%|█████████▌| 95/100 [05:20<00:18,  3.75s/it] 96%|█████████▌| 96/100 [05:22<00:12,  3.01s/it] 97%|█████████▋| 97/100 [05:22<00:06,  2.32s/it] 98%|█████████▊| 98/100 [05:23<00:03,  1.85s/it] 99%|█████████▉| 99/100 [05:24<00:01,  1.55s/it]100%|██████████| 100/100 [05:27<00:00,  1.99s/it]100%|██████████| 100/100 [05:27<00:00,  3.28s/it]
2023-06-14 19:46:13 [INFO] {
2023-06-14 19:46:13 [INFO]     'eval_loss': 1.1746976375579834,
2023-06-14 19:46:13 [INFO]     'eval_runtime': 328.3608,
2023-06-14 19:46:13 [INFO]     'eval_samples_per_second': 0.305,
2023-06-14 19:46:13 [INFO]     'eval_steps_per_second': 0.305
2023-06-14 19:46:13 [INFO] }
2023-06-14 19:46:13 [INFO] metric: 0.305
2023-06-14 19:46:13 [INFO] Throughput: 0.305 samples/sec
2023-06-14 19:46:13 [INFO] Tune 4 result is: [Accuracy (int8|fp32): 0.3050|0.8450, Duration (seconds) (int8|fp32): 328.3665|118.3237], Best tune result is: [Accuracy: 1.1410, Duration (seconds): 87.6841]
2023-06-14 19:46:13 [INFO] |***********************Tune Result Statistics**********************|
2023-06-14 19:46:13 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 19:46:13 [INFO] |     Info Type      |  Baseline | Tune 4 result | Best tune result |
2023-06-14 19:46:13 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 19:46:13 [INFO] |      Accuracy      |  0.8450   |    0.3050     |     1.1410       |
2023-06-14 19:46:13 [INFO] | Duration (seconds) | 118.3237  |   328.3665    |     87.6841      |
2023-06-14 19:46:13 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 19:46:13 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-18-17/./history.snapshot.
2023-06-14 19:46:17 [INFO] |******Mixed Precision Statistics******|
2023-06-14 19:46:17 [INFO] +-------------+--------+------+--------+
2023-06-14 19:46:17 [INFO] |   Op Type   | Total  | INT8 |  FP32  |
2023-06-14 19:46:17 [INFO] +-------------+--------+------+--------+
2023-06-14 19:46:17 [INFO] |  Embedding  |   2    |  1   |   1    |
2023-06-14 19:46:17 [INFO] |    Linear   |   1    |  1   |   0    |
2023-06-14 19:46:17 [INFO] +-------------+--------+------+--------+
2023-06-14 19:46:17 [INFO] Pass quantize model elapsed time: 1060.7 ms
2023-06-14 19:46:17 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: input, output, code.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:34,  2.86it/s]  3%|▎         | 3/100 [00:01<00:48,  2.02it/s]  4%|▍         | 4/100 [00:02<00:54,  1.78it/s]  5%|▌         | 5/100 [00:02<00:57,  1.66it/s]  6%|▌         | 6/100 [00:04<01:38,  1.05s/it]  7%|▋         | 7/100 [00:05<01:27,  1.06it/s]  8%|▊         | 8/100 [00:06<01:19,  1.15it/s]  9%|▉         | 9/100 [00:06<01:14,  1.22it/s] 10%|█         | 10/100 [00:07<01:11,  1.27it/s] 11%|█         | 11/100 [00:08<01:08,  1.30it/s] 12%|█▏        | 12/100 [00:09<01:06,  1.32it/s] 13%|█▎        | 13/100 [00:10<01:29,  1.03s/it] 14%|█▍        | 14/100 [00:11<01:25,  1.01it/s] 15%|█▌        | 15/100 [00:12<01:18,  1.08it/s] 16%|█▌        | 16/100 [00:13<01:14,  1.12it/s] 17%|█▋        | 17/100 [00:14<01:26,  1.04s/it] 18%|█▊        | 18/100 [00:17<02:03,  1.51s/it] 19%|█▉        | 19/100 [00:18<01:57,  1.45s/it] 20%|██        | 20/100 [00:19<01:40,  1.25s/it] 21%|██        | 21/100 [00:19<01:26,  1.10s/it] 22%|██▏       | 22/100 [00:20<01:16,  1.02it/s] 23%|██▎       | 23/100 [00:21<01:09,  1.10it/s] 24%|██▍       | 24/100 [00:22<01:05,  1.17it/s] 25%|██▌       | 25/100 [00:22<01:01,  1.22it/s] 26%|██▌       | 26/100 [00:23<00:59,  1.25it/s] 27%|██▋       | 27/100 [00:24<00:57,  1.28it/s] 28%|██▊       | 28/100 [00:25<00:59,  1.21it/s] 29%|██▉       | 29/100 [00:26<00:57,  1.23it/s] 30%|███       | 30/100 [00:26<00:54,  1.29it/s] 31%|███       | 31/100 [00:27<00:55,  1.24it/s] 32%|███▏      | 32/100 [00:28<00:53,  1.27it/s] 33%|███▎      | 33/100 [00:29<00:55,  1.21it/s] 34%|███▍      | 34/100 [00:30<00:59,  1.11it/s] 35%|███▌      | 35/100 [00:31<01:05,  1.01s/it] 36%|███▌      | 36/100 [00:32<01:10,  1.10s/it] 37%|███▋      | 37/100 [00:34<01:07,  1.08s/it] 38%|███▊      | 38/100 [00:34<01:02,  1.01s/it] 39%|███▉      | 39/100 [00:35<00:55,  1.10it/s] 40%|████      | 40/100 [00:36<00:51,  1.18it/s] 41%|████      | 41/100 [00:36<00:47,  1.24it/s] 42%|████▏     | 42/100 [00:37<00:45,  1.29it/s] 43%|████▎     | 43/100 [00:38<00:43,  1.32it/s] 44%|████▍     | 44/100 [00:39<00:44,  1.25it/s] 45%|████▌     | 45/100 [00:39<00:42,  1.29it/s] 46%|████▌     | 46/100 [00:40<00:40,  1.32it/s] 47%|████▋     | 47/100 [00:42<00:51,  1.02it/s] 48%|████▊     | 48/100 [00:42<00:46,  1.11it/s] 49%|████▉     | 49/100 [00:44<00:49,  1.03it/s] 50%|█████     | 50/100 [00:44<00:46,  1.07it/s] 51%|█████     | 51/100 [00:46<00:56,  1.16s/it] 52%|█████▏    | 52/100 [00:47<00:50,  1.05s/it] 53%|█████▎    | 53/100 [00:48<00:43,  1.07it/s] 54%|█████▍    | 54/100 [00:49<00:47,  1.04s/it] 55%|█████▌    | 55/100 [00:50<00:43,  1.04it/s] 56%|█████▌    | 56/100 [00:50<00:38,  1.15it/s] 57%|█████▋    | 57/100 [00:51<00:39,  1.08it/s] 58%|█████▊    | 58/100 [00:52<00:36,  1.14it/s] 59%|█████▉    | 59/100 [00:54<00:52,  1.27s/it] 60%|██████    | 60/100 [00:55<00:44,  1.10s/it] 61%|██████    | 61/100 [00:56<00:39,  1.01s/it] 62%|██████▏   | 62/100 [00:56<00:34,  1.09it/s] 63%|██████▎   | 63/100 [00:58<00:38,  1.04s/it] 64%|██████▍   | 64/100 [00:59<00:36,  1.00s/it] 65%|██████▌   | 65/100 [01:00<00:38,  1.10s/it] 66%|██████▌   | 66/100 [01:01<00:41,  1.21s/it] 67%|██████▋   | 67/100 [01:04<00:56,  1.70s/it] 68%|██████▊   | 68/100 [01:05<00:47,  1.48s/it] 69%|██████▉   | 69/100 [01:06<00:39,  1.29s/it] 70%|███████   | 70/100 [01:08<00:42,  1.41s/it] 71%|███████   | 71/100 [01:09<00:42,  1.46s/it] 72%|███████▏  | 72/100 [01:10<00:34,  1.23s/it] 73%|███████▎  | 73/100 [01:11<00:28,  1.07s/it] 74%|███████▍  | 74/100 [01:11<00:24,  1.05it/s] 75%|███████▌  | 75/100 [01:12<00:21,  1.14it/s] 76%|███████▌  | 76/100 [01:13<00:19,  1.21it/s] 77%|███████▋  | 77/100 [01:14<00:18,  1.27it/s] 78%|███████▊  | 78/100 [01:14<00:16,  1.32it/s] 79%|███████▉  | 79/100 [01:15<00:15,  1.35it/s] 80%|████████  | 80/100 [01:16<00:14,  1.37it/s] 81%|████████  | 81/100 [01:16<00:13,  1.38it/s] 82%|████████▏ | 82/100 [01:17<00:12,  1.40it/s] 83%|████████▎ | 83/100 [01:18<00:12,  1.41it/s] 84%|████████▍ | 84/100 [01:18<00:11,  1.42it/s] 85%|████████▌ | 85/100 [01:19<00:10,  1.38it/s] 86%|████████▌ | 86/100 [01:20<00:10,  1.39it/s] 87%|████████▋ | 87/100 [01:21<00:09,  1.40it/s] 88%|████████▊ | 88/100 [01:21<00:08,  1.41it/s] 89%|████████▉ | 89/100 [01:22<00:07,  1.41it/s] 90%|█████████ | 90/100 [01:23<00:07,  1.40it/s] 91%|█████████ | 91/100 [01:24<00:06,  1.32it/s] 92%|█████████▏| 92/100 [01:24<00:05,  1.35it/s] 93%|█████████▎| 93/100 [01:25<00:05,  1.30it/s] 94%|█████████▍| 94/100 [01:27<00:06,  1.02s/it] 95%|█████████▌| 95/100 [01:28<00:05,  1.14s/it] 96%|█████████▌| 96/100 [01:30<00:04,  1.20s/it] 97%|█████████▋| 97/100 [01:30<00:03,  1.07s/it] 98%|█████████▊| 98/100 [01:31<00:01,  1.04it/s] 99%|█████████▉| 99/100 [01:32<00:00,  1.11it/s]100%|██████████| 100/100 [01:32<00:00,  1.19it/s]100%|██████████| 100/100 [01:32<00:00,  1.08it/s]
2023-06-14 19:47:51 [INFO] {
2023-06-14 19:47:51 [INFO]     'eval_loss': 1.1748887300491333,
2023-06-14 19:47:51 [INFO]     'eval_runtime': 93.7179,
2023-06-14 19:47:51 [INFO]     'eval_samples_per_second': 1.067,
2023-06-14 19:47:51 [INFO]     'eval_steps_per_second': 1.067
2023-06-14 19:47:51 [INFO] }
2023-06-14 19:47:51 [INFO] metric: 1.067
2023-06-14 19:47:51 [INFO] Throughput: 1.067 samples/sec
2023-06-14 19:47:51 [INFO] Tune 5 result is: [Accuracy (int8|fp32): 1.0670|0.8450, Duration (seconds) (int8|fp32): 93.7240|118.3237], Best tune result is: [Accuracy: 1.1410, Duration (seconds): 87.6841]
2023-06-14 19:47:51 [INFO] |***********************Tune Result Statistics**********************|
2023-06-14 19:47:51 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 19:47:51 [INFO] |     Info Type      |  Baseline | Tune 5 result | Best tune result |
2023-06-14 19:47:51 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 19:47:51 [INFO] |      Accuracy      |  0.8450   |    1.0670     |     1.1410       |
2023-06-14 19:47:51 [INFO] | Duration (seconds) | 118.3237  |    93.7240    |     87.6841      |
2023-06-14 19:47:51 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 19:47:51 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-18-17/./history.snapshot.
2023-06-14 19:47:51 [INFO] Start to accumulate fallback to fp32.
2023-06-14 19:47:52 [INFO] |******Mixed Precision Statistics******|
2023-06-14 19:47:52 [INFO] +-------------+--------+------+--------+
2023-06-14 19:47:52 [INFO] |   Op Type   | Total  | INT8 |  FP32  |
2023-06-14 19:47:52 [INFO] +-------------+--------+------+--------+
2023-06-14 19:47:52 [INFO] |  Embedding  |   2    |  1   |   1    |
2023-06-14 19:47:52 [INFO] |    Linear   |   1    |  0   |   1    |
2023-06-14 19:47:52 [INFO] +-------------+--------+------+--------+
2023-06-14 19:47:52 [INFO] Pass quantize model elapsed time: 683.05 ms
2023-06-14 19:47:52 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: input, output, code.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:01<01:03,  1.54it/s]  3%|▎         | 3/100 [00:02<01:07,  1.44it/s]  4%|▍         | 4/100 [00:02<01:09,  1.38it/s]  5%|▌         | 5/100 [00:03<01:18,  1.21it/s]  6%|▌         | 6/100 [00:06<02:12,  1.41s/it]  7%|▋         | 7/100 [00:07<02:03,  1.32s/it]  8%|▊         | 8/100 [00:08<01:45,  1.14s/it]  9%|▉         | 9/100 [00:09<01:36,  1.06s/it] 10%|█         | 10/100 [00:11<02:13,  1.48s/it] 11%|█         | 11/100 [00:12<02:04,  1.40s/it] 12%|█▏        | 12/100 [00:13<01:45,  1.20s/it] 13%|█▎        | 13/100 [00:14<01:35,  1.10s/it] 14%|█▍        | 14/100 [00:16<01:59,  1.39s/it] 15%|█▌        | 15/100 [00:20<02:55,  2.07s/it] 16%|█▌        | 16/100 [00:22<02:54,  2.08s/it] 17%|█▋        | 17/100 [00:23<02:32,  1.84s/it] 18%|█▊        | 18/100 [00:25<02:40,  1.95s/it] 19%|█▉        | 19/100 [00:26<02:14,  1.67s/it] 20%|██        | 20/100 [00:27<01:59,  1.49s/it] 21%|██        | 21/100 [00:28<01:40,  1.27s/it] 22%|██▏       | 22/100 [00:30<01:46,  1.36s/it] 23%|██▎       | 23/100 [00:31<01:52,  1.46s/it] 24%|██▍       | 24/100 [00:33<01:45,  1.39s/it] 25%|██▌       | 25/100 [00:33<01:30,  1.21s/it] 26%|██▌       | 26/100 [00:34<01:21,  1.11s/it] 27%|██▋       | 27/100 [00:36<01:37,  1.34s/it] 28%|██▊       | 28/100 [00:38<01:44,  1.45s/it] 29%|██▉       | 29/100 [00:39<01:37,  1.37s/it] 30%|███       | 30/100 [00:40<01:38,  1.40s/it] 31%|███       | 31/100 [00:42<01:34,  1.36s/it] 32%|███▏      | 32/100 [00:43<01:20,  1.18s/it] 33%|███▎      | 33/100 [00:44<01:17,  1.16s/it] 34%|███▍      | 34/100 [00:45<01:21,  1.24s/it] 35%|███▌      | 35/100 [00:46<01:16,  1.17s/it] 36%|███▌      | 36/100 [00:47<01:06,  1.04s/it] 37%|███▋      | 37/100 [00:48<00:59,  1.06it/s] 38%|███▊      | 38/100 [00:48<00:55,  1.12it/s] 39%|███▉      | 39/100 [00:49<00:56,  1.07it/s] 40%|████      | 40/100 [00:50<00:59,  1.01it/s] 41%|████      | 41/100 [00:51<00:53,  1.10it/s] 42%|████▏     | 42/100 [00:52<00:52,  1.11it/s] 43%|████▎     | 43/100 [00:54<01:07,  1.19s/it] 44%|████▍     | 44/100 [00:55<01:04,  1.16s/it] 45%|████▌     | 45/100 [00:57<01:19,  1.45s/it] 46%|████▌     | 46/100 [00:58<01:06,  1.24s/it] 47%|████▋     | 47/100 [00:59<01:03,  1.20s/it] 48%|████▊     | 48/100 [01:01<01:15,  1.45s/it] 49%|████▉     | 49/100 [01:03<01:20,  1.57s/it] 50%|█████     | 50/100 [01:04<01:13,  1.46s/it] 51%|█████     | 51/100 [01:06<01:15,  1.55s/it] 52%|█████▏    | 52/100 [01:07<01:04,  1.34s/it] 53%|█████▎    | 53/100 [01:08<01:00,  1.29s/it] 54%|█████▍    | 54/100 [01:09<00:55,  1.20s/it] 55%|█████▌    | 55/100 [01:10<00:47,  1.06s/it] 56%|█████▌    | 56/100 [01:10<00:41,  1.05it/s] 57%|█████▋    | 57/100 [01:11<00:37,  1.14it/s] 58%|█████▊    | 58/100 [01:12<00:34,  1.22it/s] 59%|█████▉    | 59/100 [01:12<00:32,  1.27it/s] 60%|██████    | 60/100 [01:13<00:30,  1.31it/s] 61%|██████    | 61/100 [01:14<00:29,  1.34it/s] 62%|██████▏   | 62/100 [01:15<00:28,  1.35it/s] 63%|██████▎   | 63/100 [01:15<00:27,  1.37it/s] 64%|██████▍   | 64/100 [01:17<00:36,  1.01s/it] 65%|██████▌   | 65/100 [01:18<00:32,  1.08it/s] 66%|██████▌   | 66/100 [01:19<00:31,  1.09it/s] 67%|██████▋   | 67/100 [01:20<00:32,  1.02it/s] 68%|██████▊   | 68/100 [01:21<00:38,  1.20s/it] 69%|██████▉   | 69/100 [01:22<00:35,  1.14s/it] 70%|███████   | 70/100 [01:23<00:30,  1.02s/it] 71%|███████   | 71/100 [01:25<00:35,  1.21s/it] 72%|███████▏  | 72/100 [01:27<00:39,  1.42s/it] 73%|███████▎  | 73/100 [01:28<00:33,  1.26s/it] 74%|███████▍  | 74/100 [01:28<00:28,  1.10s/it] 75%|███████▌  | 75/100 [01:30<00:28,  1.15s/it] 76%|███████▌  | 76/100 [01:31<00:26,  1.10s/it] 77%|███████▋  | 77/100 [01:32<00:30,  1.31s/it] 78%|███████▊  | 78/100 [01:33<00:25,  1.15s/it] 79%|███████▉  | 79/100 [01:34<00:22,  1.07s/it] 80%|████████  | 80/100 [01:37<00:34,  1.70s/it] 81%|████████  | 81/100 [01:39<00:30,  1.60s/it] 82%|████████▏ | 82/100 [01:40<00:26,  1.47s/it] 83%|████████▎ | 83/100 [01:42<00:28,  1.67s/it] 84%|████████▍ | 84/100 [01:43<00:26,  1.67s/it] 85%|████████▌ | 85/100 [01:45<00:22,  1.50s/it] 86%|████████▌ | 86/100 [01:45<00:17,  1.27s/it] 87%|████████▋ | 87/100 [01:47<00:16,  1.27s/it] 88%|████████▊ | 88/100 [01:47<00:13,  1.11s/it] 89%|████████▉ | 89/100 [01:48<00:10,  1.01it/s] 90%|█████████ | 90/100 [01:49<00:09,  1.05it/s] 91%|█████████ | 91/100 [01:50<00:08,  1.12it/s] 92%|█████████▏| 92/100 [01:51<00:08,  1.05s/it] 93%|█████████▎| 93/100 [01:52<00:06,  1.05it/s] 94%|█████████▍| 94/100 [01:53<00:05,  1.12it/s] 95%|█████████▌| 95/100 [01:53<00:04,  1.17it/s] 96%|█████████▌| 96/100 [01:54<00:03,  1.09it/s] 97%|█████████▋| 97/100 [01:55<00:02,  1.09it/s] 98%|█████████▊| 98/100 [01:56<00:01,  1.16it/s] 99%|█████████▉| 99/100 [01:57<00:00,  1.22it/s]100%|██████████| 100/100 [01:58<00:00,  1.25it/s]100%|██████████| 100/100 [01:58<00:00,  1.18s/it]
2023-06-14 19:49:51 [INFO] {
2023-06-14 19:49:51 [INFO]     'eval_loss': 1.173761248588562,
2023-06-14 19:49:51 [INFO]     'eval_runtime': 118.8574,
2023-06-14 19:49:51 [INFO]     'eval_samples_per_second': 0.841,
2023-06-14 19:49:51 [INFO]     'eval_steps_per_second': 0.841
2023-06-14 19:49:51 [INFO] }
2023-06-14 19:49:51 [INFO] metric: 0.841
2023-06-14 19:49:51 [INFO] Throughput: 0.841 samples/sec
2023-06-14 19:49:51 [INFO] Tune 6 result is: [Accuracy (int8|fp32): 0.8410|0.8450, Duration (seconds) (int8|fp32): 118.8634|118.3237], Best tune result is: [Accuracy: 1.1410, Duration (seconds): 87.6841]
2023-06-14 19:49:51 [INFO] |***********************Tune Result Statistics**********************|
2023-06-14 19:49:51 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 19:49:51 [INFO] |     Info Type      |  Baseline | Tune 6 result | Best tune result |
2023-06-14 19:49:51 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 19:49:51 [INFO] |      Accuracy      |  0.8450   |    0.8410     |     1.1410       |
2023-06-14 19:49:51 [INFO] | Duration (seconds) | 118.3237  |   118.8634    |     87.6841      |
2023-06-14 19:49:51 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 19:49:51 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-18-17/./history.snapshot.
2023-06-14 19:49:53 [WARNING] None of the submodule got qconfig applied. Make sure you passed correct configuration through `qconfig_dict` or by assigning the `.qconfig` attribute directly on submodules.
2023-06-14 19:49:53 [INFO] |******Mixed Precision Statistics******|
2023-06-14 19:49:53 [INFO] +-----------------+----------+---------+
2023-06-14 19:49:53 [INFO] |     Op Type     |  Total   |   FP32  |
2023-06-14 19:49:53 [INFO] +-----------------+----------+---------+
2023-06-14 19:49:53 [INFO] |    Embedding    |    2     |    2    |
2023-06-14 19:49:53 [INFO] |      Linear     |    1     |    1    |
2023-06-14 19:49:53 [INFO] +-----------------+----------+---------+
2023-06-14 19:49:53 [INFO] Pass quantize model elapsed time: 179.8 ms
2023-06-14 19:49:53 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: input, output, code.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:37,  2.59it/s]  3%|▎         | 3/100 [00:01<00:53,  1.81it/s]  4%|▍         | 4/100 [00:02<01:00,  1.58it/s]  5%|▌         | 5/100 [00:03<01:02,  1.51it/s]  6%|▌         | 6/100 [00:03<01:03,  1.47it/s]  7%|▋         | 7/100 [00:04<01:04,  1.44it/s]  8%|▊         | 8/100 [00:05<01:04,  1.42it/s]  9%|▉         | 9/100 [00:06<01:07,  1.34it/s] 10%|█         | 10/100 [00:06<01:06,  1.35it/s] 11%|█         | 11/100 [00:08<01:24,  1.06it/s] 12%|█▏        | 12/100 [00:08<01:17,  1.13it/s] 13%|█▎        | 13/100 [00:10<01:31,  1.05s/it] 14%|█▍        | 14/100 [00:11<01:21,  1.05it/s] 15%|█▌        | 15/100 [00:11<01:15,  1.12it/s] 16%|█▌        | 16/100 [00:15<02:12,  1.58s/it] 17%|█▋        | 17/100 [00:19<03:16,  2.37s/it] 18%|█▊        | 18/100 [00:21<03:01,  2.21s/it] 19%|█▉        | 19/100 [00:21<02:27,  1.83s/it] 20%|██        | 20/100 [00:22<02:03,  1.55s/it] 21%|██        | 21/100 [00:25<02:35,  1.96s/it] 22%|██▏       | 22/100 [00:27<02:28,  1.90s/it] 23%|██▎       | 23/100 [00:29<02:31,  1.96s/it] 24%|██▍       | 24/100 [00:31<02:19,  1.84s/it] 25%|██▌       | 25/100 [00:31<01:52,  1.50s/it] 26%|██▌       | 26/100 [00:32<01:33,  1.26s/it] 27%|██▋       | 27/100 [00:33<01:19,  1.09s/it] 28%|██▊       | 28/100 [00:34<01:10,  1.02it/s] 29%|██▉       | 29/100 [00:35<01:10,  1.01it/s] 30%|███       | 30/100 [00:35<01:03,  1.11it/s] 31%|███       | 31/100 [00:36<00:58,  1.18it/s] 32%|███▏      | 32/100 [00:37<00:54,  1.24it/s] 33%|███▎      | 33/100 [00:38<01:09,  1.04s/it] 34%|███▍      | 34/100 [00:39<01:07,  1.02s/it] 35%|███▌      | 35/100 [00:40<01:00,  1.08it/s] 36%|███▌      | 36/100 [00:41<00:55,  1.16it/s] 37%|███▋      | 37/100 [00:41<00:51,  1.23it/s] 38%|███▊      | 38/100 [00:42<00:53,  1.17it/s] 39%|███▉      | 39/100 [00:43<00:49,  1.24it/s] 40%|████      | 40/100 [00:44<00:53,  1.11it/s] 41%|████      | 41/100 [00:46<01:18,  1.32s/it] 42%|████▏     | 42/100 [00:49<01:30,  1.56s/it] 43%|████▎     | 43/100 [00:49<01:13,  1.30s/it] 44%|████▍     | 44/100 [00:50<01:02,  1.11s/it] 45%|████▌     | 45/100 [00:51<00:54,  1.01it/s] 46%|████▌     | 46/100 [00:51<00:48,  1.11it/s] 47%|████▋     | 47/100 [00:52<00:44,  1.20it/s] 48%|████▊     | 48/100 [00:53<00:41,  1.26it/s] 49%|████▉     | 49/100 [00:53<00:39,  1.30it/s] 50%|█████     | 50/100 [00:54<00:37,  1.32it/s] 51%|█████     | 51/100 [00:55<00:36,  1.34it/s] 52%|█████▏    | 52/100 [00:56<00:35,  1.35it/s] 53%|█████▎    | 53/100 [00:56<00:34,  1.35it/s] 54%|█████▍    | 54/100 [00:57<00:34,  1.35it/s] 55%|█████▌    | 55/100 [00:58<00:32,  1.37it/s] 56%|█████▌    | 56/100 [00:59<00:34,  1.27it/s] 57%|█████▋    | 57/100 [00:59<00:32,  1.31it/s] 58%|█████▊    | 58/100 [01:00<00:31,  1.35it/s] 59%|█████▉    | 59/100 [01:01<00:29,  1.37it/s] 60%|██████    | 60/100 [01:02<00:32,  1.23it/s] 61%|██████    | 61/100 [01:03<00:30,  1.26it/s] 62%|██████▏   | 62/100 [01:03<00:29,  1.29it/s] 63%|██████▎   | 63/100 [01:05<00:39,  1.07s/it] 64%|██████▍   | 64/100 [01:06<00:40,  1.14s/it] 65%|██████▌   | 65/100 [01:07<00:36,  1.05s/it] 66%|██████▌   | 66/100 [01:08<00:35,  1.03s/it] 67%|██████▋   | 67/100 [01:09<00:30,  1.07it/s] 68%|██████▊   | 68/100 [01:10<00:27,  1.16it/s] 69%|██████▉   | 69/100 [01:10<00:25,  1.23it/s] 70%|███████   | 70/100 [01:11<00:23,  1.28it/s] 71%|███████   | 71/100 [01:12<00:21,  1.32it/s] 72%|███████▏  | 72/100 [01:12<00:20,  1.34it/s] 73%|███████▎  | 73/100 [01:13<00:19,  1.37it/s] 74%|███████▍  | 74/100 [01:14<00:18,  1.39it/s] 75%|███████▌  | 75/100 [01:14<00:17,  1.40it/s] 76%|███████▌  | 76/100 [01:15<00:18,  1.31it/s] 77%|███████▋  | 77/100 [01:17<00:21,  1.05it/s] 78%|███████▊  | 78/100 [01:17<00:19,  1.14it/s] 79%|███████▉  | 79/100 [01:18<00:17,  1.21it/s] 80%|████████  | 80/100 [01:19<00:16,  1.23it/s] 81%|████████  | 81/100 [01:20<00:14,  1.28it/s] 82%|████████▏ | 82/100 [01:21<00:15,  1.18it/s] 83%|████████▎ | 83/100 [01:22<00:16,  1.02it/s] 84%|████████▍ | 84/100 [01:24<00:18,  1.16s/it] 85%|████████▌ | 85/100 [01:26<00:21,  1.46s/it] 86%|████████▌ | 86/100 [01:29<00:29,  2.11s/it] 87%|████████▋ | 87/100 [01:31<00:25,  1.95s/it] 88%|████████▊ | 88/100 [01:32<00:20,  1.74s/it] 89%|████████▉ | 89/100 [01:33<00:16,  1.53s/it] 90%|█████████ | 90/100 [01:34<00:13,  1.30s/it] 91%|█████████ | 91/100 [01:35<00:10,  1.12s/it] 92%|█████████▏| 92/100 [01:36<00:08,  1.09s/it] 93%|█████████▎| 93/100 [01:36<00:06,  1.03it/s] 94%|█████████▍| 94/100 [01:37<00:05,  1.07it/s] 95%|█████████▌| 95/100 [01:38<00:04,  1.09it/s] 96%|█████████▌| 96/100 [01:39<00:03,  1.16it/s] 97%|█████████▋| 97/100 [01:40<00:02,  1.23it/s] 98%|█████████▊| 98/100 [01:40<00:01,  1.28it/s] 99%|█████████▉| 99/100 [01:41<00:00,  1.32it/s]100%|██████████| 100/100 [01:42<00:00,  1.35it/s]100%|██████████| 100/100 [01:42<00:00,  1.02s/it]
2023-06-14 19:51:36 [INFO] {
2023-06-14 19:51:36 [INFO]     'eval_loss': 1.1736871004104614,
2023-06-14 19:51:36 [INFO]     'eval_runtime': 103.0958,
2023-06-14 19:51:36 [INFO]     'eval_samples_per_second': 0.97,
2023-06-14 19:51:36 [INFO]     'eval_steps_per_second': 0.97
2023-06-14 19:51:36 [INFO] }
2023-06-14 19:51:36 [INFO] metric: 0.97
2023-06-14 19:51:36 [INFO] Throughput: 0.97 samples/sec
2023-06-14 19:51:36 [INFO] Tune 7 result is: [Accuracy (int8|fp32): 0.9700|0.8450, Duration (seconds) (int8|fp32): 103.1020|118.3237], Best tune result is: [Accuracy: 1.1410, Duration (seconds): 87.6841]
2023-06-14 19:51:36 [INFO] |***********************Tune Result Statistics**********************|
2023-06-14 19:51:36 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 19:51:36 [INFO] |     Info Type      |  Baseline | Tune 7 result | Best tune result |
2023-06-14 19:51:36 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 19:51:36 [INFO] |      Accuracy      |  0.8450   |    0.9700     |     1.1410       |
2023-06-14 19:51:36 [INFO] | Duration (seconds) | 118.3237  |   103.1020    |     87.6841      |
2023-06-14 19:51:36 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 19:51:36 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-18-17/./history.snapshot.
2023-06-14 19:51:39 [INFO] |******Mixed Precision Statistics******|
2023-06-14 19:51:39 [INFO] +-----------------+----------+---------+
2023-06-14 19:51:39 [INFO] |     Op Type     |  Total   |   INT8  |
2023-06-14 19:51:39 [INFO] +-----------------+----------+---------+
2023-06-14 19:51:39 [INFO] |    Embedding    |    2     |    2    |
2023-06-14 19:51:39 [INFO] |      Linear     |    1     |    1    |
2023-06-14 19:51:39 [INFO] +-----------------+----------+---------+
2023-06-14 19:51:39 [INFO] Pass quantize model elapsed time: 1185.77 ms
2023-06-14 19:51:39 [INFO] Specified timeout or max trials is reached! Found a quantized model which meet accuracy goal. Exit.
2023-06-14 19:51:39 [INFO] Save deploy yaml to /scratch/dsochirca/nc_workspace/2023-06-14_19-18-17/deploy.yaml
2023-06-14 19:51:39 [INFO] Saving model checkpoint to ./test_epoch
2023-06-14 19:51:53 [INFO] quantized model and configure file have saved to ./test_epoch
2023-06-14 19:52:01 [INFO] Saving model checkpoint to ./models/CodeGPT-Py150_0.6_sparse_q_all_layers_asym_per_channel
2023-06-14 19:52:18 [INFO] quantized model and configure file have saved to ./models/CodeGPT-Py150_0.6_sparse_q_all_layers_asym_per_channel
2023-06-14 19:52:19 [WARNING] Force convert framework model to neural_compressor model.
2023-06-14 19:52:19 [INFO] Pass query framework capability elapsed time: 1.2 ms
2023-06-14 19:52:19 [INFO] Adaptor has 1 recipes.
2023-06-14 19:52:19 [INFO] 0 recipes specified by user.
2023-06-14 19:52:19 [INFO] 0 recipes require future tuning.
2023-06-14 19:52:19 [INFO] ..............use_distributed_tuning: None
2023-06-14 19:52:19 [INFO] Get FP32 model baseline.
2023-06-14 19:52:19 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: input, output, code.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:01<01:15,  1.30it/s]  3%|▎         | 3/100 [00:02<01:36,  1.00it/s]  4%|▍         | 4/100 [00:04<02:07,  1.33s/it]  5%|▌         | 5/100 [00:07<02:58,  1.88s/it]  6%|▌         | 6/100 [00:10<03:32,  2.26s/it]  7%|▋         | 7/100 [00:12<03:19,  2.14s/it]  8%|▊         | 8/100 [00:14<03:12,  2.10s/it]  9%|▉         | 9/100 [00:15<02:34,  1.70s/it] 10%|█         | 10/100 [00:16<02:07,  1.42s/it] 11%|█         | 11/100 [00:16<01:48,  1.22s/it] 12%|█▏        | 12/100 [00:17<01:35,  1.08s/it] 13%|█▎        | 13/100 [00:20<02:08,  1.48s/it] 14%|█▍        | 14/100 [00:20<01:49,  1.27s/it] 15%|█▌        | 15/100 [00:21<01:33,  1.10s/it] 16%|█▌        | 16/100 [00:22<01:22,  1.02it/s] 17%|█▋        | 17/100 [00:23<01:14,  1.11it/s] 18%|█▊        | 18/100 [00:26<02:13,  1.63s/it] 19%|█▉        | 19/100 [00:27<02:09,  1.60s/it] 20%|██        | 20/100 [00:29<02:00,  1.50s/it] 21%|██        | 21/100 [00:31<02:13,  1.69s/it] 22%|██▏       | 22/100 [00:33<02:30,  1.93s/it] 23%|██▎       | 23/100 [00:36<02:48,  2.19s/it] 24%|██▍       | 24/100 [00:40<03:18,  2.61s/it] 25%|██▌       | 25/100 [00:44<03:44,  3.00s/it] 26%|██▌       | 26/100 [00:46<03:19,  2.69s/it] 27%|██▋       | 27/100 [00:47<02:47,  2.29s/it] 28%|██▊       | 28/100 [00:48<02:12,  1.84s/it] 29%|██▉       | 29/100 [00:49<01:54,  1.61s/it] 30%|███       | 30/100 [00:50<01:41,  1.46s/it] 31%|███       | 31/100 [00:51<01:34,  1.38s/it] 32%|███▏      | 32/100 [00:52<01:29,  1.32s/it] 33%|███▎      | 33/100 [00:54<01:33,  1.40s/it] 34%|███▍      | 34/100 [00:55<01:20,  1.22s/it] 35%|███▌      | 35/100 [00:55<01:10,  1.08s/it] 36%|███▌      | 36/100 [00:56<01:03,  1.01it/s] 37%|███▋      | 37/100 [00:57<00:57,  1.10it/s] 38%|███▊      | 38/100 [00:58<00:52,  1.18it/s] 39%|███▉      | 39/100 [01:00<01:15,  1.24s/it] 40%|████      | 40/100 [01:00<01:06,  1.10s/it] 41%|████      | 41/100 [01:01<00:58,  1.00it/s] 42%|████▏     | 42/100 [01:02<00:53,  1.08it/s] 43%|████▎     | 43/100 [01:03<00:49,  1.15it/s] 44%|████▍     | 44/100 [01:03<00:46,  1.21it/s] 45%|████▌     | 45/100 [01:05<00:57,  1.04s/it] 46%|████▌     | 46/100 [01:08<01:27,  1.63s/it] 47%|████▋     | 47/100 [01:09<01:13,  1.38s/it] 48%|████▊     | 48/100 [01:10<01:02,  1.20s/it] 49%|████▉     | 49/100 [01:10<00:53,  1.05s/it] 50%|█████     | 50/100 [01:13<01:18,  1.57s/it] 51%|█████     | 51/100 [01:14<01:05,  1.34s/it] 52%|█████▏    | 52/100 [01:15<00:56,  1.17s/it] 53%|█████▎    | 53/100 [01:15<00:48,  1.04s/it] 54%|█████▍    | 54/100 [01:16<00:45,  1.01it/s] 55%|█████▌    | 55/100 [01:20<01:23,  1.86s/it] 56%|█████▌    | 56/100 [01:22<01:21,  1.85s/it] 57%|█████▋    | 57/100 [01:24<01:21,  1.89s/it] 58%|█████▊    | 58/100 [01:27<01:28,  2.10s/it] 59%|█████▉    | 59/100 [01:27<01:10,  1.72s/it] 60%|██████    | 60/100 [01:28<00:56,  1.41s/it] 61%|██████    | 61/100 [01:30<00:55,  1.44s/it] 62%|██████▏   | 62/100 [01:33<01:20,  2.13s/it] 63%|██████▎   | 63/100 [01:37<01:38,  2.66s/it] 64%|██████▍   | 64/100 [01:41<01:45,  2.94s/it] 65%|██████▌   | 65/100 [01:45<01:52,  3.22s/it] 66%|██████▌   | 66/100 [01:48<01:55,  3.40s/it] 67%|██████▋   | 67/100 [01:52<01:56,  3.54s/it] 68%|██████▊   | 68/100 [01:56<01:53,  3.55s/it] 69%|██████▉   | 69/100 [01:59<01:47,  3.46s/it] 70%|███████   | 70/100 [02:03<01:45,  3.51s/it] 71%|███████   | 71/100 [02:04<01:20,  2.78s/it] 72%|███████▏  | 72/100 [02:08<01:24,  3.04s/it] 73%|███████▎  | 73/100 [02:11<01:22,  3.06s/it] 74%|███████▍  | 74/100 [02:15<01:25,  3.31s/it] 75%|███████▌  | 75/100 [02:18<01:24,  3.38s/it] 76%|███████▌  | 76/100 [02:22<01:24,  3.54s/it] 77%|███████▋  | 77/100 [02:26<01:23,  3.65s/it] 78%|███████▊  | 78/100 [02:29<01:18,  3.57s/it] 79%|███████▉  | 79/100 [02:33<01:16,  3.62s/it] 80%|████████  | 80/100 [02:36<01:08,  3.42s/it] 81%|████████  | 81/100 [02:39<01:05,  3.42s/it] 82%|████████▏ | 82/100 [02:43<01:03,  3.52s/it] 83%|████████▎ | 83/100 [02:47<01:01,  3.60s/it] 84%|████████▍ | 84/100 [02:51<00:58,  3.64s/it] 85%|████████▌ | 85/100 [02:54<00:54,  3.63s/it] 86%|████████▌ | 86/100 [02:58<00:51,  3.68s/it] 87%|████████▋ | 87/100 [03:02<00:48,  3.72s/it] 88%|████████▊ | 88/100 [03:06<00:45,  3.77s/it] 89%|████████▉ | 89/100 [03:09<00:40,  3.67s/it] 90%|█████████ | 90/100 [03:13<00:37,  3.75s/it] 91%|█████████ | 91/100 [03:17<00:33,  3.75s/it] 92%|█████████▏| 92/100 [03:21<00:30,  3.80s/it] 93%|█████████▎| 93/100 [03:25<00:26,  3.82s/it] 94%|█████████▍| 94/100 [03:28<00:22,  3.82s/it] 95%|█████████▌| 95/100 [03:32<00:19,  3.85s/it] 96%|█████████▌| 96/100 [03:36<00:15,  3.85s/it] 97%|█████████▋| 97/100 [03:40<00:11,  3.79s/it] 98%|█████████▊| 98/100 [03:43<00:07,  3.71s/it] 99%|█████████▉| 99/100 [03:46<00:03,  3.45s/it]100%|██████████| 100/100 [03:50<00:00,  3.57s/it]100%|██████████| 100/100 [03:50<00:00,  2.31s/it]
2023-06-14 19:56:11 [INFO] {
2023-06-14 19:56:11 [INFO]     'eval_loss': 1.1736871004104614,
2023-06-14 19:56:11 [INFO]     'eval_runtime': 231.9502,
2023-06-14 19:56:11 [INFO]     'eval_samples_per_second': 0.431,
2023-06-14 19:56:11 [INFO]     'eval_steps_per_second': 0.431
2023-06-14 19:56:11 [INFO] }
2023-06-14 19:56:11 [INFO] metric: 0.431
2023-06-14 19:56:11 [INFO] Throughput: 0.431 samples/sec
2023-06-14 19:56:11 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-18-17/./history.snapshot.
2023-06-14 19:56:11 [INFO] FP32 baseline is: [Accuracy: 0.4310, Duration (seconds): 231.9535]
2023-06-14 19:56:13 [INFO] |******Mixed Precision Statistics******|
2023-06-14 19:56:13 [INFO] +-----------------+----------+---------+
2023-06-14 19:56:13 [INFO] |     Op Type     |  Total   |   INT8  |
2023-06-14 19:56:13 [INFO] +-----------------+----------+---------+
2023-06-14 19:56:13 [INFO] |    Embedding    |    2     |    2    |
2023-06-14 19:56:13 [INFO] |      Linear     |    1     |    1    |
2023-06-14 19:56:13 [INFO] +-----------------+----------+---------+
2023-06-14 19:56:13 [INFO] Pass quantize model elapsed time: 1957.42 ms
2023-06-14 19:56:13 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: input, output, code.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:03<03:02,  1.86s/it]  3%|▎         | 3/100 [00:07<04:14,  2.63s/it]  4%|▍         | 4/100 [00:11<04:50,  3.03s/it]  5%|▌         | 5/100 [00:14<05:11,  3.28s/it]  6%|▌         | 6/100 [00:18<05:22,  3.43s/it]  7%|▋         | 7/100 [00:22<05:26,  3.51s/it]  8%|▊         | 8/100 [00:25<05:18,  3.47s/it]  9%|▉         | 9/100 [00:29<05:17,  3.48s/it] 10%|█         | 10/100 [00:32<05:21,  3.57s/it] 11%|█         | 11/100 [00:36<05:23,  3.64s/it] 12%|█▏        | 12/100 [00:40<05:24,  3.69s/it] 13%|█▎        | 13/100 [00:44<05:21,  3.69s/it] 14%|█▍        | 14/100 [00:48<05:20,  3.73s/it] 15%|█▌        | 15/100 [00:51<05:13,  3.68s/it] 16%|█▌        | 16/100 [00:55<05:11,  3.71s/it] 17%|█▋        | 17/100 [00:59<05:05,  3.68s/it] 18%|█▊        | 18/100 [01:02<04:48,  3.52s/it] 19%|█▉        | 19/100 [01:05<04:47,  3.55s/it] 20%|██        | 20/100 [01:08<04:12,  3.16s/it] 21%|██        | 21/100 [01:08<03:11,  2.43s/it] 22%|██▏       | 22/100 [01:09<02:29,  1.92s/it] 23%|██▎       | 23/100 [01:10<02:00,  1.56s/it] 24%|██▍       | 24/100 [01:10<01:39,  1.31s/it] 25%|██▌       | 25/100 [01:11<01:28,  1.17s/it] 26%|██▌       | 26/100 [01:12<01:17,  1.05s/it] 27%|██▋       | 27/100 [01:13<01:09,  1.05it/s] 28%|██▊       | 28/100 [01:13<01:03,  1.14it/s] 29%|██▉       | 29/100 [01:14<00:59,  1.19it/s] 30%|███       | 30/100 [01:15<00:56,  1.24it/s] 31%|███       | 31/100 [01:16<00:53,  1.28it/s] 32%|███▏      | 32/100 [01:17<01:03,  1.07it/s] 33%|███▎      | 33/100 [01:18<00:58,  1.15it/s] 34%|███▍      | 34/100 [01:18<00:54,  1.21it/s] 35%|███▌      | 35/100 [01:19<00:51,  1.26it/s] 36%|███▌      | 36/100 [01:20<00:49,  1.30it/s] 37%|███▋      | 37/100 [01:21<00:47,  1.33it/s] 38%|███▊      | 38/100 [01:21<00:46,  1.34it/s] 39%|███▉      | 39/100 [01:22<00:44,  1.36it/s] 40%|████      | 40/100 [01:23<00:54,  1.10it/s] 41%|████      | 41/100 [01:26<01:22,  1.39s/it] 42%|████▏     | 42/100 [01:30<02:00,  2.08s/it] 43%|████▎     | 43/100 [01:30<01:35,  1.68s/it] 44%|████▍     | 44/100 [01:31<01:25,  1.53s/it] 45%|████▌     | 45/100 [01:32<01:10,  1.29s/it] 46%|████▌     | 46/100 [01:33<01:00,  1.12s/it] 47%|████▋     | 47/100 [01:34<00:54,  1.02s/it] 48%|████▊     | 48/100 [01:35<00:53,  1.03s/it] 49%|████▉     | 49/100 [01:36<01:03,  1.25s/it] 50%|█████     | 50/100 [01:38<01:02,  1.26s/it] 51%|█████     | 51/100 [01:38<00:53,  1.09s/it] 52%|█████▏    | 52/100 [01:40<00:56,  1.17s/it] 53%|█████▎    | 53/100 [01:41<00:52,  1.11s/it] 54%|█████▍    | 54/100 [01:42<00:45,  1.01it/s] 55%|█████▌    | 55/100 [01:42<00:40,  1.11it/s] 56%|█████▌    | 56/100 [01:43<00:37,  1.18it/s] 57%|█████▋    | 57/100 [01:44<00:34,  1.25it/s] 58%|█████▊    | 58/100 [01:44<00:32,  1.29it/s] 59%|█████▉    | 59/100 [01:45<00:30,  1.33it/s] 60%|██████    | 60/100 [01:46<00:31,  1.28it/s] 61%|██████    | 61/100 [01:47<00:29,  1.32it/s] 62%|██████▏   | 62/100 [01:48<00:31,  1.22it/s] 63%|██████▎   | 63/100 [01:49<00:39,  1.08s/it] 64%|██████▍   | 64/100 [01:50<00:38,  1.07s/it] 65%|██████▌   | 65/100 [01:51<00:37,  1.07s/it] 66%|██████▌   | 66/100 [01:52<00:32,  1.03it/s] 67%|██████▋   | 67/100 [01:53<00:29,  1.13it/s] 68%|██████▊   | 68/100 [01:53<00:26,  1.22it/s] 69%|██████▉   | 69/100 [01:54<00:24,  1.28it/s] 70%|███████   | 70/100 [01:55<00:22,  1.33it/s] 71%|███████   | 71/100 [01:55<00:21,  1.38it/s] 72%|███████▏  | 72/100 [01:56<00:19,  1.40it/s] 73%|███████▎  | 73/100 [01:57<00:18,  1.42it/s] 74%|███████▍  | 74/100 [01:58<00:19,  1.33it/s] 75%|███████▌  | 75/100 [01:58<00:18,  1.38it/s] 76%|███████▌  | 76/100 [01:59<00:17,  1.40it/s] 77%|███████▋  | 77/100 [02:00<00:19,  1.15it/s] 78%|███████▊  | 78/100 [02:02<00:21,  1.02it/s] 79%|███████▉  | 79/100 [02:02<00:19,  1.07it/s] 80%|████████  | 80/100 [02:04<00:23,  1.19s/it] 81%|████████  | 81/100 [02:05<00:20,  1.10s/it] 82%|████████▏ | 82/100 [02:07<00:26,  1.48s/it] 83%|████████▎ | 83/100 [02:08<00:22,  1.32s/it] 84%|████████▍ | 84/100 [02:11<00:25,  1.60s/it] 85%|████████▌ | 85/100 [02:12<00:21,  1.46s/it] 86%|████████▌ | 86/100 [02:14<00:22,  1.63s/it] 87%|████████▋ | 87/100 [02:14<00:17,  1.34s/it] 88%|████████▊ | 88/100 [02:17<00:21,  1.76s/it] 89%|████████▉ | 89/100 [02:19<00:18,  1.66s/it] 90%|█████████ | 90/100 [02:19<00:13,  1.37s/it] 91%|█████████ | 91/100 [02:20<00:10,  1.17s/it] 92%|█████████▏| 92/100 [02:21<00:08,  1.03s/it] 93%|█████████▎| 93/100 [02:21<00:06,  1.08it/s] 94%|█████████▍| 94/100 [02:22<00:05,  1.16it/s] 95%|█████████▌| 95/100 [02:23<00:04,  1.03it/s] 96%|█████████▌| 96/100 [02:24<00:03,  1.11it/s] 97%|█████████▋| 97/100 [02:25<00:02,  1.16it/s] 98%|█████████▊| 98/100 [02:26<00:01,  1.12it/s] 99%|█████████▉| 99/100 [02:27<00:00,  1.01it/s]100%|██████████| 100/100 [02:29<00:00,  1.16s/it]100%|██████████| 100/100 [02:29<00:00,  1.49s/it]
2023-06-14 19:58:45 [INFO] {
2023-06-14 19:58:45 [INFO]     'eval_loss': 1.1748971939086914,
2023-06-14 19:58:45 [INFO]     'eval_runtime': 152.3628,
2023-06-14 19:58:45 [INFO]     'eval_samples_per_second': 0.656,
2023-06-14 19:58:45 [INFO]     'eval_steps_per_second': 0.656
2023-06-14 19:58:45 [INFO] }
2023-06-14 19:58:45 [INFO] metric: 0.656
2023-06-14 19:58:45 [INFO] Throughput: 0.656 samples/sec
2023-06-14 19:58:45 [INFO] Tune 1 result is: [Accuracy (int8|fp32): 0.6560|0.4310, Duration (seconds) (int8|fp32): 152.3677|231.9535], Best tune result is: [Accuracy: 0.6560, Duration (seconds): 152.3677]
2023-06-14 19:58:45 [INFO] |***********************Tune Result Statistics**********************|
2023-06-14 19:58:45 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 19:58:45 [INFO] |     Info Type      |  Baseline | Tune 1 result | Best tune result |
2023-06-14 19:58:45 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 19:58:45 [INFO] |      Accuracy      |  0.4310   |    0.6560     |     0.6560       |
2023-06-14 19:58:45 [INFO] | Duration (seconds) | 231.9535  |   152.3677    |    152.3677      |
2023-06-14 19:58:45 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 19:58:45 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-18-17/./history.snapshot.
2023-06-14 19:58:46 [INFO] Apply all recipes.
2023-06-14 19:58:46 [WARNING] Find evaluated tuning config, skip.
2023-06-14 19:58:46 [INFO] Apply recipe one by one.
2023-06-14 19:58:46 [INFO] Start to fallback op to fp32 one by one.
2023-06-14 19:58:47 [INFO] |******Mixed Precision Statistics******|
2023-06-14 19:58:47 [INFO] +-------------+--------+------+--------+
2023-06-14 19:58:47 [INFO] |   Op Type   | Total  | INT8 |  FP32  |
2023-06-14 19:58:47 [INFO] +-------------+--------+------+--------+
2023-06-14 19:58:47 [INFO] |  Embedding  |   2    |  2   |   0    |
2023-06-14 19:58:47 [INFO] |    Linear   |   1    |  0   |   1    |
2023-06-14 19:58:47 [INFO] +-------------+--------+------+--------+
2023-06-14 19:58:47 [INFO] Pass quantize model elapsed time: 976.06 ms
2023-06-14 19:58:47 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: input, output, code.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:01<00:56,  1.74it/s]  3%|▎         | 3/100 [00:02<01:20,  1.20it/s]  4%|▍         | 4/100 [00:03<01:43,  1.07s/it]  5%|▌         | 5/100 [00:06<02:28,  1.56s/it]  6%|▌         | 6/100 [00:08<02:33,  1.63s/it]  7%|▋         | 7/100 [00:09<02:12,  1.42s/it]  8%|▊         | 8/100 [00:09<01:51,  1.21s/it]  9%|▉         | 9/100 [00:12<02:23,  1.57s/it] 10%|█         | 10/100 [00:13<02:06,  1.41s/it] 11%|█         | 11/100 [00:13<01:47,  1.20s/it] 12%|█▏        | 12/100 [00:14<01:33,  1.06s/it] 13%|█▎        | 13/100 [00:15<01:24,  1.03it/s] 14%|█▍        | 14/100 [00:16<01:17,  1.11it/s] 15%|█▌        | 15/100 [00:16<01:12,  1.18it/s] 16%|█▌        | 16/100 [00:17<01:08,  1.23it/s] 17%|█▋        | 17/100 [00:18<01:05,  1.27it/s] 18%|█▊        | 18/100 [00:19<01:03,  1.29it/s] 19%|█▉        | 19/100 [00:20<01:20,  1.01it/s] 20%|██        | 20/100 [00:21<01:26,  1.08s/it] 21%|██        | 21/100 [00:23<01:29,  1.13s/it] 22%|██▏       | 22/100 [00:24<01:35,  1.23s/it] 23%|██▎       | 23/100 [00:25<01:23,  1.09s/it] 24%|██▍       | 24/100 [00:26<01:15,  1.00it/s] 25%|██▌       | 25/100 [00:28<01:42,  1.36s/it] 26%|██▌       | 26/100 [00:29<01:36,  1.31s/it] 27%|██▋       | 27/100 [00:30<01:36,  1.33s/it] 28%|██▊       | 28/100 [00:33<01:52,  1.56s/it] 29%|██▉       | 29/100 [00:33<01:36,  1.37s/it] 30%|███       | 30/100 [00:34<01:21,  1.17s/it] 31%|███       | 31/100 [00:35<01:14,  1.08s/it] 32%|███▏      | 32/100 [00:36<01:09,  1.03s/it] 33%|███▎      | 33/100 [00:37<01:02,  1.07it/s] 34%|███▍      | 34/100 [00:38<01:10,  1.07s/it] 35%|███▌      | 35/100 [00:40<01:26,  1.34s/it] 36%|███▌      | 36/100 [00:42<01:41,  1.59s/it] 37%|███▋      | 37/100 [00:43<01:27,  1.38s/it] 38%|███▊      | 38/100 [00:45<01:37,  1.57s/it] 39%|███▉      | 39/100 [00:46<01:28,  1.44s/it] 40%|████      | 40/100 [00:48<01:38,  1.63s/it] 41%|████      | 41/100 [00:50<01:42,  1.74s/it] 42%|████▏     | 42/100 [00:51<01:27,  1.51s/it] 43%|████▎     | 43/100 [00:53<01:28,  1.56s/it] 44%|████▍     | 44/100 [00:54<01:23,  1.50s/it] 45%|████▌     | 45/100 [00:55<01:10,  1.28s/it] 46%|████▌     | 46/100 [00:56<01:00,  1.11s/it] 47%|████▋     | 47/100 [00:57<00:52,  1.01it/s] 48%|████▊     | 48/100 [00:57<00:47,  1.10it/s] 49%|████▉     | 49/100 [00:58<00:43,  1.17it/s] 50%|█████     | 50/100 [00:59<00:40,  1.22it/s] 51%|█████     | 51/100 [00:59<00:38,  1.26it/s] 52%|█████▏    | 52/100 [01:00<00:36,  1.30it/s] 53%|█████▎    | 53/100 [01:01<00:35,  1.32it/s] 54%|█████▍    | 54/100 [01:02<00:34,  1.33it/s] 55%|█████▌    | 55/100 [01:02<00:34,  1.32it/s] 56%|█████▌    | 56/100 [01:03<00:32,  1.34it/s] 57%|█████▋    | 57/100 [01:06<00:57,  1.33s/it] 58%|█████▊    | 58/100 [01:06<00:48,  1.15s/it] 59%|█████▉    | 59/100 [01:07<00:41,  1.02s/it] 60%|██████    | 60/100 [01:08<00:37,  1.07it/s] 61%|██████    | 61/100 [01:09<00:33,  1.15it/s] 62%|██████▏   | 62/100 [01:10<00:33,  1.14it/s] 63%|██████▎   | 63/100 [01:10<00:30,  1.22it/s] 64%|██████▍   | 64/100 [01:11<00:28,  1.27it/s] 65%|██████▌   | 65/100 [01:12<00:30,  1.14it/s] 66%|██████▌   | 66/100 [01:13<00:28,  1.21it/s] 67%|██████▋   | 67/100 [01:13<00:26,  1.26it/s] 68%|██████▊   | 68/100 [01:14<00:24,  1.30it/s] 69%|██████▉   | 69/100 [01:15<00:23,  1.32it/s] 70%|███████   | 70/100 [01:16<00:22,  1.34it/s] 71%|███████   | 71/100 [01:16<00:21,  1.35it/s] 72%|███████▏  | 72/100 [01:17<00:21,  1.32it/s] 73%|███████▎  | 73/100 [01:18<00:20,  1.32it/s] 74%|███████▍  | 74/100 [01:19<00:19,  1.35it/s] 75%|███████▌  | 75/100 [01:19<00:18,  1.35it/s] 76%|███████▌  | 76/100 [01:20<00:17,  1.35it/s] 77%|███████▋  | 77/100 [01:21<00:17,  1.34it/s] 78%|███████▊  | 78/100 [01:22<00:16,  1.33it/s] 79%|███████▉  | 79/100 [01:24<00:23,  1.10s/it] 80%|████████  | 80/100 [01:24<00:20,  1.02s/it] 81%|████████  | 81/100 [01:25<00:17,  1.08it/s] 82%|████████▏ | 82/100 [01:26<00:15,  1.14it/s] 83%|████████▎ | 83/100 [01:27<00:14,  1.20it/s] 84%|████████▍ | 84/100 [01:27<00:13,  1.22it/s] 85%|████████▌ | 85/100 [01:28<00:11,  1.27it/s] 86%|████████▌ | 86/100 [01:29<00:11,  1.25it/s] 87%|████████▋ | 87/100 [01:33<00:22,  1.77s/it] 88%|████████▊ | 88/100 [01:37<00:29,  2.44s/it] 89%|████████▉ | 89/100 [01:40<00:29,  2.71s/it] 90%|█████████ | 90/100 [01:41<00:21,  2.11s/it] 91%|█████████ | 91/100 [01:42<00:15,  1.68s/it] 92%|█████████▏| 92/100 [01:42<00:11,  1.38s/it] 93%|█████████▎| 93/100 [01:43<00:08,  1.17s/it] 94%|█████████▍| 94/100 [01:44<00:06,  1.03s/it] 95%|█████████▌| 95/100 [01:44<00:04,  1.08it/s] 96%|█████████▌| 96/100 [01:45<00:03,  1.17it/s] 97%|█████████▋| 97/100 [01:46<00:02,  1.24it/s] 98%|█████████▊| 98/100 [01:47<00:01,  1.28it/s] 99%|█████████▉| 99/100 [01:47<00:00,  1.32it/s]100%|██████████| 100/100 [01:48<00:00,  1.34it/s]100%|██████████| 100/100 [01:48<00:00,  1.08s/it]
2023-06-14 20:00:37 [INFO] {
2023-06-14 20:00:37 [INFO]     'eval_loss': 1.1737359762191772,
2023-06-14 20:00:37 [INFO]     'eval_runtime': 109.6449,
2023-06-14 20:00:37 [INFO]     'eval_samples_per_second': 0.912,
2023-06-14 20:00:37 [INFO]     'eval_steps_per_second': 0.912
2023-06-14 20:00:37 [INFO] }
2023-06-14 20:00:37 [INFO] metric: 0.912
2023-06-14 20:00:37 [INFO] Throughput: 0.912 samples/sec
2023-06-14 20:00:37 [INFO] Tune 3 result is: [Accuracy (int8|fp32): 0.9120|0.4310, Duration (seconds) (int8|fp32): 109.6511|231.9535], Best tune result is: [Accuracy: 0.9120, Duration (seconds): 109.6511]
2023-06-14 20:00:37 [INFO] |***********************Tune Result Statistics**********************|
2023-06-14 20:00:37 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 20:00:37 [INFO] |     Info Type      |  Baseline | Tune 3 result | Best tune result |
2023-06-14 20:00:37 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 20:00:37 [INFO] |      Accuracy      |  0.4310   |    0.9120     |     0.9120       |
2023-06-14 20:00:37 [INFO] | Duration (seconds) | 231.9535  |   109.6511    |    109.6511      |
2023-06-14 20:00:37 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 20:00:37 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-18-17/./history.snapshot.
2023-06-14 20:00:38 [INFO] |******Mixed Precision Statistics******|
2023-06-14 20:00:38 [INFO] +-------------+--------+------+--------+
2023-06-14 20:00:38 [INFO] |   Op Type   | Total  | INT8 |  FP32  |
2023-06-14 20:00:38 [INFO] +-------------+--------+------+--------+
2023-06-14 20:00:38 [INFO] |  Embedding  |   2    |  1   |   1    |
2023-06-14 20:00:38 [INFO] |    Linear   |   1    |  1   |   0    |
2023-06-14 20:00:38 [INFO] +-------------+--------+------+--------+
2023-06-14 20:00:38 [INFO] Pass quantize model elapsed time: 954.5 ms
2023-06-14 20:00:38 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: input, output, code.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:38,  2.52it/s]  3%|▎         | 3/100 [00:01<00:52,  1.85it/s]  4%|▍         | 4/100 [00:02<00:58,  1.63it/s]  5%|▌         | 5/100 [00:03<01:02,  1.52it/s]  6%|▌         | 6/100 [00:03<01:04,  1.46it/s]  7%|▋         | 7/100 [00:07<02:33,  1.65s/it]  8%|▊         | 8/100 [00:08<02:14,  1.46s/it]  9%|▉         | 9/100 [00:10<02:18,  1.52s/it] 10%|█         | 10/100 [00:11<02:10,  1.45s/it] 11%|█         | 11/100 [00:12<01:50,  1.24s/it] 12%|█▏        | 12/100 [00:12<01:35,  1.09s/it] 13%|█▎        | 13/100 [00:13<01:25,  1.01it/s] 14%|█▍        | 14/100 [00:14<01:18,  1.09it/s] 15%|█▌        | 15/100 [00:15<01:13,  1.15it/s] 16%|█▌        | 16/100 [00:15<01:10,  1.19it/s] 17%|█▋        | 17/100 [00:16<01:07,  1.23it/s] 18%|█▊        | 18/100 [00:17<01:08,  1.19it/s] 19%|█▉        | 19/100 [00:18<01:08,  1.18it/s] 20%|██        | 20/100 [00:19<01:10,  1.14it/s] 21%|██        | 21/100 [00:20<01:07,  1.16it/s] 22%|██▏       | 22/100 [00:21<01:09,  1.13it/s] 23%|██▎       | 23/100 [00:23<01:32,  1.20s/it] 24%|██▍       | 24/100 [00:23<01:20,  1.06s/it] 25%|██▌       | 25/100 [00:24<01:11,  1.05it/s] 26%|██▌       | 26/100 [00:25<01:05,  1.13it/s] 27%|██▋       | 27/100 [00:26<01:01,  1.19it/s] 28%|██▊       | 28/100 [00:26<01:01,  1.18it/s] 29%|██▉       | 29/100 [00:28<01:07,  1.06it/s] 30%|███       | 30/100 [00:29<01:08,  1.03it/s] 31%|███       | 31/100 [00:33<02:09,  1.88s/it] 32%|███▏      | 32/100 [00:34<01:53,  1.67s/it] 33%|███▎      | 33/100 [00:36<01:54,  1.71s/it] 34%|███▍      | 34/100 [00:36<01:34,  1.44s/it] 35%|███▌      | 35/100 [00:37<01:19,  1.22s/it] 36%|███▌      | 36/100 [00:38<01:08,  1.07s/it] 37%|███▋      | 37/100 [00:39<01:06,  1.05s/it] 38%|███▊      | 38/100 [00:40<00:59,  1.05it/s] 39%|███▉      | 39/100 [00:40<00:54,  1.12it/s] 40%|████      | 40/100 [00:41<00:50,  1.18it/s] 41%|████      | 41/100 [00:42<00:47,  1.23it/s] 42%|████▏     | 42/100 [00:42<00:45,  1.27it/s] 43%|████▎     | 43/100 [00:44<00:48,  1.16it/s] 44%|████▍     | 44/100 [00:45<01:04,  1.15s/it] 45%|████▌     | 45/100 [00:46<00:56,  1.02s/it] 46%|████▌     | 46/100 [00:47<00:50,  1.07it/s] 47%|████▋     | 47/100 [00:48<00:47,  1.13it/s] 48%|████▊     | 48/100 [00:48<00:44,  1.18it/s] 49%|████▉     | 49/100 [00:50<00:49,  1.02it/s] 50%|█████     | 50/100 [00:51<00:55,  1.11s/it] 51%|█████     | 51/100 [00:52<00:57,  1.18s/it] 52%|█████▏    | 52/100 [00:54<00:59,  1.24s/it] 53%|█████▎    | 53/100 [00:54<00:50,  1.08s/it] 54%|█████▍    | 54/100 [00:55<00:45,  1.02it/s] 55%|█████▌    | 55/100 [00:56<00:41,  1.10it/s] 56%|█████▌    | 56/100 [00:57<00:37,  1.16it/s] 57%|█████▋    | 57/100 [00:57<00:35,  1.22it/s] 58%|█████▊    | 58/100 [00:58<00:33,  1.25it/s] 59%|█████▉    | 59/100 [00:59<00:32,  1.27it/s] 60%|██████    | 60/100 [01:00<00:33,  1.18it/s] 61%|██████    | 61/100 [01:01<00:31,  1.23it/s] 62%|██████▏   | 62/100 [01:02<00:31,  1.22it/s] 63%|██████▎   | 63/100 [01:02<00:30,  1.23it/s] 64%|██████▍   | 64/100 [01:04<00:35,  1.01it/s] 65%|██████▌   | 65/100 [01:05<00:34,  1.01it/s] 66%|██████▌   | 66/100 [01:05<00:31,  1.09it/s] 67%|██████▋   | 67/100 [01:07<00:39,  1.21s/it] 68%|██████▊   | 68/100 [01:08<00:34,  1.07s/it] 69%|██████▉   | 69/100 [01:09<00:30,  1.03it/s] 70%|███████   | 70/100 [01:10<00:27,  1.11it/s] 71%|███████   | 71/100 [01:10<00:24,  1.17it/s] 72%|███████▏  | 72/100 [01:11<00:23,  1.19it/s] 73%|███████▎  | 73/100 [01:15<00:47,  1.77s/it] 74%|███████▍  | 74/100 [01:18<00:56,  2.16s/it] 75%|███████▌  | 75/100 [01:21<00:56,  2.26s/it] 76%|███████▌  | 76/100 [01:21<00:43,  1.80s/it] 77%|███████▋  | 77/100 [01:22<00:34,  1.49s/it] 78%|███████▊  | 78/100 [01:23<00:30,  1.40s/it] 79%|███████▉  | 79/100 [01:24<00:25,  1.21s/it] 80%|████████  | 80/100 [01:25<00:21,  1.08s/it] 81%|████████  | 81/100 [01:26<00:18,  1.01it/s] 82%|████████▏ | 82/100 [01:26<00:16,  1.09it/s] 83%|████████▎ | 83/100 [01:27<00:16,  1.06it/s] 84%|████████▍ | 84/100 [01:28<00:15,  1.02it/s] 85%|████████▌ | 85/100 [01:31<00:20,  1.35s/it] 86%|████████▌ | 86/100 [01:32<00:20,  1.43s/it] 87%|████████▋ | 87/100 [01:35<00:25,  1.94s/it] 88%|████████▊ | 88/100 [01:37<00:22,  1.83s/it] 89%|████████▉ | 89/100 [01:40<00:23,  2.11s/it] 90%|█████████ | 90/100 [01:41<00:18,  1.83s/it] 91%|█████████ | 91/100 [01:42<00:14,  1.56s/it] 92%|█████████▏| 92/100 [01:43<00:10,  1.34s/it] 93%|█████████▎| 93/100 [01:45<00:11,  1.63s/it] 94%|█████████▍| 94/100 [01:47<00:11,  1.85s/it] 95%|█████████▌| 95/100 [01:48<00:07,  1.59s/it] 96%|█████████▌| 96/100 [01:49<00:05,  1.34s/it] 97%|█████████▋| 97/100 [01:51<00:04,  1.50s/it] 98%|█████████▊| 98/100 [01:53<00:03,  1.62s/it] 99%|█████████▉| 99/100 [01:54<00:01,  1.35s/it]100%|██████████| 100/100 [01:54<00:00,  1.16s/it]100%|██████████| 100/100 [01:54<00:00,  1.15s/it]
2023-06-14 20:02:34 [INFO] {
2023-06-14 20:02:34 [INFO]     'eval_loss': 1.1746976375579834,
2023-06-14 20:02:34 [INFO]     'eval_runtime': 115.653,
2023-06-14 20:02:34 [INFO]     'eval_samples_per_second': 0.865,
2023-06-14 20:02:34 [INFO]     'eval_steps_per_second': 0.865
2023-06-14 20:02:34 [INFO] }
2023-06-14 20:02:34 [INFO] metric: 0.865
2023-06-14 20:02:34 [INFO] Throughput: 0.865 samples/sec
2023-06-14 20:02:34 [INFO] Tune 4 result is: [Accuracy (int8|fp32): 0.8650|0.4310, Duration (seconds) (int8|fp32): 115.6594|231.9535], Best tune result is: [Accuracy: 0.9120, Duration (seconds): 109.6511]
2023-06-14 20:02:34 [INFO] |***********************Tune Result Statistics**********************|
2023-06-14 20:02:34 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 20:02:34 [INFO] |     Info Type      |  Baseline | Tune 4 result | Best tune result |
2023-06-14 20:02:34 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 20:02:34 [INFO] |      Accuracy      |  0.4310   |    0.8650     |     0.9120       |
2023-06-14 20:02:34 [INFO] | Duration (seconds) | 231.9535  |   115.6594    |    109.6511      |
2023-06-14 20:02:34 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 20:02:34 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-18-17/./history.snapshot.
2023-06-14 20:02:34 [INFO] |******Mixed Precision Statistics******|
2023-06-14 20:02:34 [INFO] +-------------+--------+------+--------+
2023-06-14 20:02:34 [INFO] |   Op Type   | Total  | INT8 |  FP32  |
2023-06-14 20:02:34 [INFO] +-------------+--------+------+--------+
2023-06-14 20:02:34 [INFO] |  Embedding  |   2    |  1   |   1    |
2023-06-14 20:02:34 [INFO] |    Linear   |   1    |  1   |   0    |
2023-06-14 20:02:34 [INFO] +-------------+--------+------+--------+
2023-06-14 20:02:34 [INFO] Pass quantize model elapsed time: 818.04 ms
2023-06-14 20:02:35 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: input, output, code.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:02<02:04,  1.27s/it]  3%|▎         | 3/100 [00:03<01:41,  1.04s/it]  4%|▍         | 4/100 [00:03<01:28,  1.08it/s]  5%|▌         | 5/100 [00:04<01:20,  1.17it/s]  6%|▌         | 6/100 [00:05<01:16,  1.23it/s]  7%|▋         | 7/100 [00:06<01:13,  1.26it/s]  8%|▊         | 8/100 [00:06<01:11,  1.29it/s]  9%|▉         | 9/100 [00:07<01:10,  1.30it/s] 10%|█         | 10/100 [00:08<01:08,  1.31it/s] 11%|█         | 11/100 [00:09<01:14,  1.20it/s] 12%|█▏        | 12/100 [00:12<02:01,  1.38s/it] 13%|█▎        | 13/100 [00:13<02:05,  1.44s/it] 14%|█▍        | 14/100 [00:14<01:54,  1.33s/it] 15%|█▌        | 15/100 [00:16<02:16,  1.61s/it] 16%|█▌        | 16/100 [00:18<02:10,  1.56s/it] 17%|█▋        | 17/100 [00:19<02:00,  1.46s/it] 18%|█▊        | 18/100 [00:20<01:55,  1.40s/it] 19%|█▉        | 19/100 [00:21<01:36,  1.20s/it] 20%|██        | 20/100 [00:22<01:24,  1.05s/it] 21%|██        | 21/100 [00:23<01:15,  1.05it/s] 22%|██▏       | 22/100 [00:23<01:08,  1.14it/s] 23%|██▎       | 23/100 [00:24<01:04,  1.20it/s] 24%|██▍       | 24/100 [00:26<01:24,  1.11s/it] 25%|██▌       | 25/100 [00:27<01:17,  1.03s/it] 26%|██▌       | 26/100 [00:27<01:09,  1.07it/s] 27%|██▋       | 27/100 [00:30<01:52,  1.54s/it] 28%|██▊       | 28/100 [00:33<02:09,  1.79s/it] 29%|██▉       | 29/100 [00:34<01:57,  1.65s/it] 30%|███       | 30/100 [00:35<01:37,  1.39s/it] 31%|███       | 31/100 [00:35<01:21,  1.18s/it] 32%|███▏      | 32/100 [00:36<01:10,  1.04s/it] 33%|███▎      | 33/100 [00:37<01:02,  1.07it/s] 34%|███▍      | 34/100 [00:38<00:57,  1.15it/s] 35%|███▌      | 35/100 [00:39<00:58,  1.11it/s] 36%|███▌      | 36/100 [00:39<00:54,  1.17it/s] 37%|███▋      | 37/100 [00:40<00:51,  1.22it/s] 38%|███▊      | 38/100 [00:41<00:50,  1.23it/s] 39%|███▉      | 39/100 [00:42<00:47,  1.28it/s] 40%|████      | 40/100 [00:43<00:52,  1.14it/s] 41%|████      | 41/100 [00:48<02:05,  2.13s/it] 42%|████▏     | 42/100 [00:51<02:31,  2.62s/it] 43%|████▎     | 43/100 [00:55<02:47,  2.95s/it] 44%|████▍     | 44/100 [00:58<02:46,  2.97s/it] 45%|████▌     | 45/100 [01:00<02:28,  2.70s/it] 46%|████▌     | 46/100 [01:03<02:22,  2.64s/it] 47%|████▋     | 47/100 [01:07<02:38,  2.99s/it] 48%|████▊     | 48/100 [01:10<02:37,  3.02s/it] 49%|████▉     | 49/100 [01:11<02:03,  2.42s/it] 50%|█████     | 50/100 [01:12<01:41,  2.04s/it] 51%|█████     | 51/100 [01:13<01:21,  1.67s/it] 52%|█████▏    | 52/100 [01:13<01:06,  1.39s/it] 53%|█████▎    | 53/100 [01:14<00:56,  1.19s/it] 54%|█████▍    | 54/100 [01:15<00:48,  1.06s/it] 55%|█████▌    | 55/100 [01:18<01:20,  1.78s/it] 56%|█████▌    | 56/100 [01:22<01:45,  2.40s/it] 57%|█████▋    | 57/100 [01:25<01:50,  2.56s/it] 58%|█████▊    | 58/100 [01:27<01:33,  2.23s/it] 59%|█████▉    | 59/100 [01:27<01:12,  1.77s/it] 60%|██████    | 60/100 [01:28<01:01,  1.53s/it] 61%|██████    | 61/100 [01:29<00:51,  1.33s/it] 62%|██████▏   | 62/100 [01:30<00:45,  1.19s/it] 63%|██████▎   | 63/100 [01:31<00:39,  1.05s/it] 64%|██████▍   | 64/100 [01:32<00:35,  1.00it/s] 65%|██████▌   | 65/100 [01:33<00:41,  1.18s/it] 66%|██████▌   | 66/100 [01:34<00:38,  1.12s/it] 67%|██████▋   | 67/100 [01:35<00:33,  1.00s/it] 68%|██████▊   | 68/100 [01:36<00:29,  1.08it/s] 69%|██████▉   | 69/100 [01:36<00:26,  1.15it/s] 70%|███████   | 70/100 [01:37<00:28,  1.06it/s] 71%|███████   | 71/100 [01:38<00:26,  1.11it/s] 72%|███████▏  | 72/100 [01:39<00:23,  1.18it/s] 73%|███████▎  | 73/100 [01:42<00:38,  1.43s/it] 74%|███████▍  | 74/100 [01:43<00:32,  1.26s/it] 75%|███████▌  | 75/100 [01:44<00:31,  1.24s/it] 76%|███████▌  | 76/100 [01:45<00:25,  1.08s/it] 77%|███████▋  | 77/100 [01:46<00:26,  1.17s/it] 78%|███████▊  | 78/100 [01:47<00:22,  1.04s/it] 79%|███████▉  | 79/100 [01:48<00:26,  1.26s/it] 80%|████████  | 80/100 [01:51<00:31,  1.60s/it] 81%|████████  | 81/100 [01:52<00:28,  1.51s/it] 82%|████████▏ | 82/100 [01:53<00:24,  1.35s/it] 83%|████████▎ | 83/100 [01:55<00:26,  1.54s/it] 84%|████████▍ | 84/100 [01:56<00:20,  1.31s/it] 85%|████████▌ | 85/100 [01:58<00:25,  1.68s/it] 86%|████████▌ | 86/100 [01:59<00:21,  1.50s/it] 87%|████████▋ | 87/100 [02:00<00:16,  1.27s/it] 88%|████████▊ | 88/100 [02:01<00:13,  1.10s/it] 89%|████████▉ | 89/100 [02:02<00:11,  1.08s/it] 90%|█████████ | 90/100 [02:03<00:10,  1.04s/it] 91%|█████████ | 91/100 [02:05<00:12,  1.36s/it] 92%|█████████▏| 92/100 [02:08<00:15,  1.99s/it] 93%|█████████▎| 93/100 [02:12<00:16,  2.38s/it] 94%|█████████▍| 94/100 [02:15<00:16,  2.71s/it] 95%|█████████▌| 95/100 [02:16<00:10,  2.12s/it] 96%|█████████▌| 96/100 [02:17<00:07,  1.87s/it] 97%|█████████▋| 97/100 [02:19<00:05,  1.81s/it] 98%|█████████▊| 98/100 [02:20<00:02,  1.48s/it] 99%|█████████▉| 99/100 [02:20<00:01,  1.25s/it]100%|██████████| 100/100 [02:21<00:00,  1.10s/it]100%|██████████| 100/100 [02:21<00:00,  1.42s/it]
2023-06-14 20:04:58 [INFO] {
2023-06-14 20:04:58 [INFO]     'eval_loss': 1.1748887300491333,
2023-06-14 20:04:58 [INFO]     'eval_runtime': 143.6357,
2023-06-14 20:04:58 [INFO]     'eval_samples_per_second': 0.696,
2023-06-14 20:04:58 [INFO]     'eval_steps_per_second': 0.696
2023-06-14 20:04:58 [INFO] }
2023-06-14 20:04:58 [INFO] metric: 0.696
2023-06-14 20:04:58 [INFO] Throughput: 0.696 samples/sec
2023-06-14 20:04:58 [INFO] Tune 5 result is: [Accuracy (int8|fp32): 0.6960|0.4310, Duration (seconds) (int8|fp32): 143.6417|231.9535], Best tune result is: [Accuracy: 0.9120, Duration (seconds): 109.6511]
2023-06-14 20:04:58 [INFO] |***********************Tune Result Statistics**********************|
2023-06-14 20:04:58 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 20:04:58 [INFO] |     Info Type      |  Baseline | Tune 5 result | Best tune result |
2023-06-14 20:04:58 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 20:04:58 [INFO] |      Accuracy      |  0.4310   |    0.6960     |     0.9120       |
2023-06-14 20:04:58 [INFO] | Duration (seconds) | 231.9535  |   143.6417    |    109.6511      |
2023-06-14 20:04:58 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 20:04:58 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-18-17/./history.snapshot.
2023-06-14 20:04:58 [INFO] Start to accumulate fallback to fp32.
2023-06-14 20:04:59 [INFO] |******Mixed Precision Statistics******|
2023-06-14 20:04:59 [INFO] +-------------+--------+------+--------+
2023-06-14 20:04:59 [INFO] |   Op Type   | Total  | INT8 |  FP32  |
2023-06-14 20:04:59 [INFO] +-------------+--------+------+--------+
2023-06-14 20:04:59 [INFO] |  Embedding  |   2    |  1   |   1    |
2023-06-14 20:04:59 [INFO] |    Linear   |   1    |  0   |   1    |
2023-06-14 20:04:59 [INFO] +-------------+--------+------+--------+
2023-06-14 20:04:59 [INFO] Pass quantize model elapsed time: 364.64 ms
2023-06-14 20:04:59 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: input, output, code.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:46,  2.10it/s]  3%|▎         | 3/100 [00:02<01:30,  1.08it/s]  4%|▍         | 4/100 [00:04<01:51,  1.16s/it]  5%|▌         | 5/100 [00:05<01:46,  1.13s/it]  6%|▌         | 6/100 [00:06<01:46,  1.13s/it]  7%|▋         | 7/100 [00:07<01:50,  1.19s/it]  8%|▊         | 8/100 [00:08<01:41,  1.10s/it]  9%|▉         | 9/100 [00:09<01:31,  1.00s/it] 10%|█         | 10/100 [00:10<01:23,  1.08it/s] 11%|█         | 11/100 [00:10<01:18,  1.13it/s] 12%|█▏        | 12/100 [00:12<01:37,  1.11s/it] 13%|█▎        | 13/100 [00:16<02:49,  1.95s/it] 14%|█▍        | 14/100 [00:17<02:17,  1.60s/it] 15%|█▌        | 15/100 [00:17<01:54,  1.35s/it] 16%|█▌        | 16/100 [00:18<01:40,  1.19s/it] 17%|█▋        | 17/100 [00:22<02:45,  1.99s/it] 18%|█▊        | 18/100 [00:26<03:29,  2.55s/it] 19%|█▉        | 19/100 [00:30<03:57,  2.93s/it] 20%|██        | 20/100 [00:32<03:40,  2.76s/it] 21%|██        | 21/100 [00:33<02:51,  2.16s/it] 22%|██▏       | 22/100 [00:34<02:16,  1.75s/it] 23%|██▎       | 23/100 [00:37<02:43,  2.12s/it] 24%|██▍       | 24/100 [00:39<02:36,  2.06s/it] 25%|██▌       | 25/100 [00:40<02:11,  1.76s/it] 26%|██▌       | 26/100 [00:43<02:56,  2.39s/it] 27%|██▋       | 27/100 [00:46<02:46,  2.28s/it] 28%|██▊       | 28/100 [00:47<02:18,  1.92s/it] 29%|██▉       | 29/100 [00:47<01:51,  1.57s/it] 30%|███       | 30/100 [00:49<01:41,  1.45s/it] 31%|███       | 31/100 [00:49<01:26,  1.26s/it] 32%|███▏      | 32/100 [00:50<01:17,  1.14s/it] 33%|███▎      | 33/100 [00:52<01:39,  1.48s/it] 34%|███▍      | 34/100 [00:53<01:26,  1.31s/it] 35%|███▌      | 35/100 [00:54<01:14,  1.15s/it] 36%|███▌      | 36/100 [00:55<01:06,  1.05s/it] 37%|███▋      | 37/100 [00:57<01:25,  1.36s/it] 38%|███▊      | 38/100 [00:58<01:14,  1.19s/it] 39%|███▉      | 39/100 [00:59<01:09,  1.14s/it] 40%|████      | 40/100 [01:00<01:02,  1.04s/it] 41%|████      | 41/100 [01:01<01:12,  1.23s/it] 42%|████▏     | 42/100 [01:03<01:14,  1.29s/it] 43%|████▎     | 43/100 [01:04<01:09,  1.22s/it] 44%|████▍     | 44/100 [01:05<01:00,  1.08s/it] 45%|████▌     | 45/100 [01:08<01:32,  1.69s/it] 46%|████▌     | 46/100 [01:08<01:15,  1.41s/it] 47%|████▋     | 47/100 [01:09<01:04,  1.22s/it] 48%|████▊     | 48/100 [01:13<01:39,  1.90s/it] 49%|████▉     | 49/100 [01:16<02:04,  2.44s/it] 50%|█████     | 50/100 [01:20<02:19,  2.79s/it] 51%|█████     | 51/100 [01:24<02:33,  3.13s/it] 52%|█████▏    | 52/100 [01:28<02:40,  3.35s/it] 53%|█████▎    | 53/100 [01:32<02:42,  3.46s/it] 54%|█████▍    | 54/100 [01:35<02:45,  3.59s/it] 55%|█████▌    | 55/100 [01:39<02:44,  3.65s/it] 56%|█████▌    | 56/100 [01:43<02:41,  3.67s/it] 57%|█████▋    | 57/100 [01:45<02:10,  3.04s/it] 58%|█████▊    | 58/100 [01:45<01:39,  2.37s/it] 59%|█████▉    | 59/100 [01:48<01:36,  2.34s/it] 60%|██████    | 60/100 [01:51<01:50,  2.77s/it] 61%|██████    | 61/100 [01:55<02:00,  3.10s/it] 62%|██████▏   | 62/100 [01:59<02:04,  3.27s/it] 63%|██████▎   | 63/100 [02:03<02:08,  3.47s/it] 64%|██████▍   | 64/100 [02:06<02:02,  3.41s/it] 65%|██████▌   | 65/100 [02:10<02:00,  3.45s/it] 66%|██████▌   | 66/100 [02:13<01:57,  3.45s/it] 67%|██████▋   | 67/100 [02:17<01:58,  3.58s/it] 68%|██████▊   | 68/100 [02:20<01:50,  3.46s/it] 69%|██████▉   | 69/100 [02:24<01:51,  3.61s/it] 70%|███████   | 70/100 [02:28<01:47,  3.59s/it] 71%|███████   | 71/100 [02:31<01:44,  3.61s/it] 72%|███████▏  | 72/100 [02:35<01:43,  3.69s/it] 73%|███████▎  | 73/100 [02:39<01:39,  3.68s/it] 74%|███████▍  | 74/100 [02:42<01:31,  3.54s/it] 75%|███████▌  | 75/100 [02:46<01:30,  3.64s/it] 76%|███████▌  | 76/100 [02:50<01:28,  3.69s/it] 77%|███████▋  | 77/100 [02:53<01:24,  3.65s/it] 78%|███████▊  | 78/100 [02:57<01:20,  3.67s/it] 79%|███████▉  | 79/100 [03:01<01:18,  3.72s/it] 80%|████████  | 80/100 [03:04<01:10,  3.53s/it] 81%|████████  | 81/100 [03:05<00:53,  2.81s/it] 82%|████████▏ | 82/100 [03:09<00:56,  3.14s/it] 83%|████████▎ | 83/100 [03:13<00:56,  3.32s/it] 84%|████████▍ | 84/100 [03:17<00:56,  3.51s/it] 85%|████████▌ | 85/100 [03:21<00:54,  3.65s/it] 86%|████████▌ | 86/100 [03:24<00:51,  3.69s/it] 87%|████████▋ | 87/100 [03:28<00:48,  3.74s/it] 88%|████████▊ | 88/100 [03:32<00:44,  3.74s/it] 89%|████████▉ | 89/100 [03:36<00:41,  3.74s/it] 90%|█████████ | 90/100 [03:39<00:35,  3.60s/it] 91%|█████████ | 91/100 [03:43<00:32,  3.56s/it] 92%|█████████▏| 92/100 [03:46<00:29,  3.63s/it] 93%|█████████▎| 93/100 [03:50<00:26,  3.72s/it] 94%|█████████▍| 94/100 [03:51<00:17,  2.88s/it] 95%|█████████▌| 95/100 [03:52<00:11,  2.38s/it] 96%|█████████▌| 96/100 [03:53<00:07,  1.94s/it] 97%|█████████▋| 97/100 [03:54<00:04,  1.59s/it] 98%|█████████▊| 98/100 [03:55<00:03,  1.50s/it] 99%|█████████▉| 99/100 [03:56<00:01,  1.39s/it]100%|██████████| 100/100 [03:57<00:00,  1.21s/it]100%|██████████| 100/100 [03:57<00:00,  2.38s/it]
2023-06-14 20:09:00 [INFO] {
2023-06-14 20:09:00 [INFO]     'eval_loss': 1.173661231994629,
2023-06-14 20:09:00 [INFO]     'eval_runtime': 241.3161,
2023-06-14 20:09:00 [INFO]     'eval_samples_per_second': 0.414,
2023-06-14 20:09:00 [INFO]     'eval_steps_per_second': 0.414
2023-06-14 20:09:00 [INFO] }
2023-06-14 20:09:00 [INFO] metric: 0.414
2023-06-14 20:09:00 [INFO] Throughput: 0.414 samples/sec
2023-06-14 20:09:00 [INFO] Tune 6 result is: [Accuracy (int8|fp32): 0.4140|0.4310, Duration (seconds) (int8|fp32): 241.3227|231.9535], Best tune result is: [Accuracy: 0.9120, Duration (seconds): 109.6511]
2023-06-14 20:09:00 [INFO] |***********************Tune Result Statistics**********************|
2023-06-14 20:09:00 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 20:09:00 [INFO] |     Info Type      |  Baseline | Tune 6 result | Best tune result |
2023-06-14 20:09:00 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 20:09:00 [INFO] |      Accuracy      |  0.4310   |    0.4140     |     0.9120       |
2023-06-14 20:09:00 [INFO] | Duration (seconds) | 231.9535  |   241.3227    |    109.6511      |
2023-06-14 20:09:00 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 20:09:00 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-18-17/./history.snapshot.
2023-06-14 20:09:00 [WARNING] None of the submodule got qconfig applied. Make sure you passed correct configuration through `qconfig_dict` or by assigning the `.qconfig` attribute directly on submodules.
2023-06-14 20:09:00 [INFO] |******Mixed Precision Statistics******|
2023-06-14 20:09:00 [INFO] +-----------------+----------+---------+
2023-06-14 20:09:00 [INFO] |     Op Type     |  Total   |   FP32  |
2023-06-14 20:09:00 [INFO] +-----------------+----------+---------+
2023-06-14 20:09:00 [INFO] |    Embedding    |    2     |    2    |
2023-06-14 20:09:00 [INFO] |      Linear     |    1     |    1    |
2023-06-14 20:09:00 [INFO] +-----------------+----------+---------+
2023-06-14 20:09:00 [INFO] Pass quantize model elapsed time: 333.97 ms
2023-06-14 20:09:01 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: input, output, code.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:37,  2.64it/s]  3%|▎         | 3/100 [00:01<01:10,  1.37it/s]  4%|▍         | 4/100 [00:02<01:17,  1.23it/s]  5%|▌         | 5/100 [00:03<01:15,  1.25it/s]  6%|▌         | 6/100 [00:05<01:36,  1.03s/it]  7%|▋         | 7/100 [00:06<01:41,  1.09s/it]  8%|▊         | 8/100 [00:07<01:42,  1.11s/it]  9%|▉         | 9/100 [00:10<02:20,  1.55s/it] 10%|█         | 10/100 [00:11<02:09,  1.44s/it] 11%|█         | 11/100 [00:12<01:59,  1.34s/it] 12%|█▏        | 12/100 [00:13<01:42,  1.16s/it] 13%|█▎        | 13/100 [00:13<01:29,  1.03s/it] 14%|█▍        | 14/100 [00:14<01:20,  1.06it/s] 15%|█▌        | 15/100 [00:15<01:14,  1.13it/s] 16%|█▌        | 16/100 [00:17<01:56,  1.38s/it] 17%|█▋        | 17/100 [00:19<01:58,  1.42s/it] 18%|█▊        | 18/100 [00:20<01:40,  1.23s/it] 19%|█▉        | 19/100 [00:20<01:27,  1.08s/it] 20%|██        | 20/100 [00:21<01:20,  1.00s/it] 21%|██        | 21/100 [00:22<01:12,  1.09it/s] 22%|██▏       | 22/100 [00:23<01:07,  1.16it/s] 23%|██▎       | 23/100 [00:24<01:18,  1.02s/it] 24%|██▍       | 24/100 [00:25<01:13,  1.03it/s] 25%|██▌       | 25/100 [00:26<01:08,  1.10it/s] 26%|██▌       | 26/100 [00:26<01:03,  1.16it/s] 27%|██▋       | 27/100 [00:27<01:03,  1.14it/s] 28%|██▊       | 28/100 [00:28<00:59,  1.20it/s] 29%|██▉       | 29/100 [00:29<00:56,  1.25it/s] 30%|███       | 30/100 [00:30<00:58,  1.19it/s] 31%|███       | 31/100 [00:31<01:01,  1.11it/s] 32%|███▏      | 32/100 [00:32<01:00,  1.12it/s] 33%|███▎      | 33/100 [00:32<00:56,  1.19it/s] 34%|███▍      | 34/100 [00:33<00:53,  1.24it/s] 35%|███▌      | 35/100 [00:34<00:50,  1.28it/s] 36%|███▌      | 36/100 [00:35<00:48,  1.32it/s] 37%|███▋      | 37/100 [00:35<00:47,  1.34it/s] 38%|███▊      | 38/100 [00:36<00:45,  1.35it/s] 39%|███▉      | 39/100 [00:37<00:46,  1.31it/s] 40%|████      | 40/100 [00:39<01:03,  1.06s/it] 41%|████      | 41/100 [00:40<01:06,  1.12s/it] 42%|████▏     | 42/100 [00:41<01:00,  1.04s/it] 43%|████▎     | 43/100 [00:42<01:02,  1.09s/it] 44%|████▍     | 44/100 [00:44<01:26,  1.55s/it] 45%|████▌     | 45/100 [00:47<01:43,  1.88s/it] 46%|████▌     | 46/100 [00:49<01:43,  1.91s/it] 47%|████▋     | 47/100 [00:50<01:22,  1.56s/it] 48%|████▊     | 48/100 [00:51<01:08,  1.32s/it] 49%|████▉     | 49/100 [00:52<01:09,  1.36s/it] 50%|█████     | 50/100 [00:53<00:58,  1.18s/it] 51%|█████     | 51/100 [00:54<00:51,  1.05s/it] 52%|█████▏    | 52/100 [00:54<00:45,  1.05it/s] 53%|█████▎    | 53/100 [00:55<00:41,  1.13it/s] 54%|█████▍    | 54/100 [00:56<00:38,  1.19it/s] 55%|█████▌    | 55/100 [00:57<00:36,  1.23it/s] 56%|█████▌    | 56/100 [00:57<00:34,  1.26it/s] 57%|█████▋    | 57/100 [00:58<00:35,  1.20it/s] 58%|█████▊    | 58/100 [01:00<00:42,  1.02s/it] 59%|█████▉    | 59/100 [01:00<00:39,  1.03it/s] 60%|██████    | 60/100 [01:02<00:44,  1.11s/it] 61%|██████    | 61/100 [01:04<00:54,  1.39s/it] 62%|██████▏   | 62/100 [01:06<00:55,  1.45s/it] 63%|██████▎   | 63/100 [01:06<00:46,  1.27s/it] 64%|██████▍   | 64/100 [01:07<00:40,  1.11s/it] 65%|██████▌   | 65/100 [01:08<00:35,  1.01s/it] 66%|██████▌   | 66/100 [01:09<00:31,  1.09it/s] 67%|██████▋   | 67/100 [01:11<00:41,  1.25s/it] 68%|██████▊   | 68/100 [01:12<00:38,  1.21s/it] 69%|██████▉   | 69/100 [01:13<00:33,  1.07s/it] 70%|███████   | 70/100 [01:13<00:29,  1.02it/s] 71%|███████   | 71/100 [01:15<00:30,  1.07s/it] 72%|███████▏  | 72/100 [01:16<00:30,  1.09s/it] 73%|███████▎  | 73/100 [01:17<00:28,  1.06s/it] 74%|███████▍  | 74/100 [01:18<00:26,  1.02s/it] 75%|███████▌  | 75/100 [01:19<00:31,  1.24s/it] 76%|███████▌  | 76/100 [01:22<00:36,  1.52s/it] 77%|███████▋  | 77/100 [01:23<00:33,  1.44s/it] 78%|███████▊  | 78/100 [01:24<00:27,  1.24s/it] 79%|███████▉  | 79/100 [01:24<00:23,  1.10s/it] 80%|████████  | 80/100 [01:25<00:19,  1.00it/s] 81%|████████  | 81/100 [01:27<00:22,  1.16s/it] 82%|████████▏ | 82/100 [01:28<00:21,  1.21s/it] 83%|████████▎ | 83/100 [01:29<00:18,  1.11s/it] 84%|████████▍ | 84/100 [01:30<00:19,  1.21s/it] 85%|████████▌ | 85/100 [01:33<00:24,  1.61s/it] 86%|████████▌ | 86/100 [01:34<00:21,  1.57s/it] 87%|████████▋ | 87/100 [01:36<00:20,  1.57s/it] 88%|████████▊ | 88/100 [01:37<00:15,  1.33s/it] 89%|████████▉ | 89/100 [01:37<00:12,  1.16s/it] 90%|█████████ | 90/100 [01:39<00:11,  1.17s/it] 91%|█████████ | 91/100 [01:40<00:11,  1.24s/it] 92%|█████████▏| 92/100 [01:41<00:08,  1.11s/it] 93%|█████████▎| 93/100 [01:42<00:06,  1.00it/s] 94%|█████████▍| 94/100 [01:44<00:07,  1.32s/it] 95%|█████████▌| 95/100 [01:44<00:05,  1.17s/it] 96%|█████████▌| 96/100 [01:45<00:04,  1.05s/it] 97%|█████████▋| 97/100 [01:46<00:02,  1.01it/s] 98%|█████████▊| 98/100 [01:47<00:01,  1.09it/s] 99%|█████████▉| 99/100 [01:48<00:00,  1.14it/s]100%|██████████| 100/100 [01:48<00:00,  1.18it/s]100%|██████████| 100/100 [01:48<00:00,  1.09s/it]
2023-06-14 20:10:51 [INFO] {
2023-06-14 20:10:51 [INFO]     'eval_loss': 1.1736871004104614,
2023-06-14 20:10:51 [INFO]     'eval_runtime': 110.1028,
2023-06-14 20:10:51 [INFO]     'eval_samples_per_second': 0.908,
2023-06-14 20:10:51 [INFO]     'eval_steps_per_second': 0.908
2023-06-14 20:10:51 [INFO] }
2023-06-14 20:10:51 [INFO] metric: 0.908
2023-06-14 20:10:51 [INFO] Throughput: 0.908 samples/sec
2023-06-14 20:10:51 [INFO] Tune 7 result is: [Accuracy (int8|fp32): 0.9080|0.4310, Duration (seconds) (int8|fp32): 110.1098|231.9535], Best tune result is: [Accuracy: 0.9120, Duration (seconds): 109.6511]
2023-06-14 20:10:51 [INFO] |***********************Tune Result Statistics**********************|
2023-06-14 20:10:51 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 20:10:51 [INFO] |     Info Type      |  Baseline | Tune 7 result | Best tune result |
2023-06-14 20:10:51 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 20:10:51 [INFO] |      Accuracy      |  0.4310   |    0.9080     |     0.9120       |
2023-06-14 20:10:51 [INFO] | Duration (seconds) | 231.9535  |   110.1098    |    109.6511      |
2023-06-14 20:10:51 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 20:10:51 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-18-17/./history.snapshot.
2023-06-14 20:10:52 [INFO] |******Mixed Precision Statistics******|
2023-06-14 20:10:52 [INFO] +-------------+--------+------+--------+
2023-06-14 20:10:52 [INFO] |   Op Type   | Total  | INT8 |  FP32  |
2023-06-14 20:10:52 [INFO] +-------------+--------+------+--------+
2023-06-14 20:10:52 [INFO] |  Embedding  |   2    |  2   |   0    |
2023-06-14 20:10:52 [INFO] |    Linear   |   1    |  0   |   1    |
2023-06-14 20:10:52 [INFO] +-------------+--------+------+--------+
2023-06-14 20:10:52 [INFO] Pass quantize model elapsed time: 771.47 ms
2023-06-14 20:10:52 [INFO] Specified timeout or max trials is reached! Found a quantized model which meet accuracy goal. Exit.
2023-06-14 20:10:52 [INFO] Save deploy yaml to /scratch/dsochirca/nc_workspace/2023-06-14_19-18-17/deploy.yaml
2023-06-14 20:10:53 [INFO] Saving model checkpoint to ./test_epoch
2023-06-14 20:11:06 [INFO] quantized model and configure file have saved to ./test_epoch
2023-06-14 20:11:12 [INFO] Saving model checkpoint to ./models/CodeGPT-Py150_0.6_sparse_q_all_layers_asym_per_tensor
2023-06-14 20:11:30 [INFO] quantized model and configure file have saved to ./models/CodeGPT-Py150_0.6_sparse_q_all_layers_asym_per_tensor
2023-06-14 20:11:32 [WARNING] Force convert framework model to neural_compressor model.
2023-06-14 20:11:32 [INFO] Pass query framework capability elapsed time: 1.21 ms
2023-06-14 20:11:32 [INFO] Adaptor has 1 recipes.
2023-06-14 20:11:32 [INFO] 0 recipes specified by user.
2023-06-14 20:11:32 [INFO] 0 recipes require future tuning.
2023-06-14 20:11:32 [INFO] ..............use_distributed_tuning: None
2023-06-14 20:11:32 [INFO] Get FP32 model baseline.
2023-06-14 20:11:32 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: input, output, code.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:39,  2.47it/s]  3%|▎         | 3/100 [00:02<01:21,  1.19it/s]  4%|▍         | 4/100 [00:02<01:16,  1.25it/s]  5%|▌         | 5/100 [00:04<01:50,  1.16s/it]  6%|▌         | 6/100 [00:05<01:42,  1.09s/it]  7%|▋         | 7/100 [00:07<01:47,  1.15s/it]  8%|▊         | 8/100 [00:11<03:11,  2.08s/it]  9%|▉         | 9/100 [00:12<02:39,  1.75s/it] 10%|█         | 10/100 [00:13<02:20,  1.56s/it] 11%|█         | 11/100 [00:14<02:04,  1.40s/it] 12%|█▏        | 12/100 [00:15<02:04,  1.42s/it] 13%|█▎        | 13/100 [00:20<03:18,  2.28s/it] 14%|█▍        | 14/100 [00:21<02:55,  2.04s/it] 15%|█▌        | 15/100 [00:22<02:20,  1.65s/it] 16%|█▌        | 16/100 [00:24<02:26,  1.74s/it] 17%|█▋        | 17/100 [00:25<02:08,  1.54s/it] 18%|█▊        | 18/100 [00:26<01:47,  1.31s/it] 19%|█▉        | 19/100 [00:27<01:42,  1.27s/it] 20%|██        | 20/100 [00:29<02:07,  1.59s/it] 21%|██        | 21/100 [00:32<02:33,  1.94s/it] 22%|██▏       | 22/100 [00:35<02:47,  2.15s/it] 23%|██▎       | 23/100 [00:37<02:56,  2.29s/it] 24%|██▍       | 24/100 [00:39<02:39,  2.10s/it] 25%|██▌       | 25/100 [00:40<02:12,  1.76s/it] 26%|██▌       | 26/100 [00:41<01:47,  1.46s/it] 27%|██▋       | 27/100 [00:44<02:21,  1.94s/it] 28%|██▊       | 28/100 [00:45<02:03,  1.72s/it] 29%|██▉       | 29/100 [00:46<01:41,  1.43s/it] 30%|███       | 30/100 [00:49<02:29,  2.14s/it] 31%|███       | 31/100 [00:51<02:18,  2.01s/it] 32%|███▏      | 32/100 [00:52<01:52,  1.66s/it] 33%|███▎      | 33/100 [00:55<02:22,  2.12s/it] 34%|███▍      | 34/100 [00:58<02:30,  2.28s/it] 35%|███▌      | 35/100 [01:00<02:36,  2.41s/it] 36%|███▌      | 36/100 [01:01<02:02,  1.92s/it] 37%|███▋      | 37/100 [01:02<01:48,  1.73s/it] 38%|███▊      | 38/100 [01:03<01:29,  1.44s/it] 39%|███▉      | 39/100 [01:04<01:14,  1.22s/it] 40%|████      | 40/100 [01:05<01:04,  1.07s/it] 41%|████      | 41/100 [01:05<00:57,  1.03it/s] 42%|████▏     | 42/100 [01:06<00:52,  1.10it/s] 43%|████▎     | 43/100 [01:07<00:54,  1.05it/s] 44%|████▍     | 44/100 [01:08<00:49,  1.13it/s] 45%|████▌     | 45/100 [01:09<00:47,  1.16it/s] 46%|████▌     | 46/100 [01:11<01:02,  1.16s/it] 47%|████▋     | 47/100 [01:12<01:04,  1.22s/it] 48%|████▊     | 48/100 [01:14<01:17,  1.49s/it] 49%|████▉     | 49/100 [01:16<01:18,  1.53s/it] 50%|█████     | 50/100 [01:17<01:17,  1.55s/it] 51%|█████     | 51/100 [01:18<01:07,  1.38s/it] 52%|█████▏    | 52/100 [01:19<00:58,  1.23s/it] 53%|█████▎    | 53/100 [01:20<00:54,  1.16s/it] 54%|█████▍    | 54/100 [01:21<00:48,  1.05s/it] 55%|█████▌    | 55/100 [01:22<00:43,  1.03it/s] 56%|█████▌    | 56/100 [01:23<00:40,  1.09it/s] 57%|█████▋    | 57/100 [01:23<00:38,  1.13it/s] 58%|█████▊    | 58/100 [01:24<00:35,  1.17it/s] 59%|█████▉    | 59/100 [01:25<00:33,  1.21it/s] 60%|██████    | 60/100 [01:26<00:32,  1.24it/s] 61%|██████    | 61/100 [01:27<00:31,  1.22it/s] 62%|██████▏   | 62/100 [01:28<00:35,  1.07it/s] 63%|██████▎   | 63/100 [01:30<00:49,  1.33s/it] 64%|██████▍   | 64/100 [01:32<00:58,  1.63s/it] 65%|██████▌   | 65/100 [01:33<00:48,  1.37s/it] 66%|██████▌   | 66/100 [01:36<01:03,  1.87s/it] 67%|██████▋   | 67/100 [01:37<00:50,  1.54s/it] 68%|██████▊   | 68/100 [01:38<00:41,  1.31s/it] 69%|██████▉   | 69/100 [01:39<00:39,  1.28s/it] 70%|███████   | 70/100 [01:40<00:33,  1.13s/it] 71%|███████   | 71/100 [01:40<00:29,  1.03s/it] 72%|███████▏  | 72/100 [01:43<00:45,  1.63s/it] 73%|███████▎  | 73/100 [01:47<00:56,  2.11s/it] 74%|███████▍  | 74/100 [01:50<01:07,  2.61s/it] 75%|███████▌  | 75/100 [01:52<00:57,  2.30s/it] 76%|███████▌  | 76/100 [01:55<00:56,  2.36s/it] 77%|███████▋  | 77/100 [01:56<00:46,  2.02s/it] 78%|███████▊  | 78/100 [01:59<00:53,  2.43s/it] 79%|███████▉  | 79/100 [02:02<00:50,  2.42s/it] 80%|████████  | 80/100 [02:02<00:38,  1.94s/it] 81%|████████  | 81/100 [02:03<00:31,  1.65s/it] 82%|████████▏ | 82/100 [02:05<00:28,  1.58s/it] 83%|████████▎ | 83/100 [02:06<00:22,  1.33s/it] 84%|████████▍ | 84/100 [02:06<00:18,  1.16s/it] 85%|████████▌ | 85/100 [02:10<00:29,  1.96s/it] 86%|████████▌ | 86/100 [02:11<00:24,  1.74s/it] 87%|████████▋ | 87/100 [02:12<00:18,  1.45s/it] 88%|████████▊ | 88/100 [02:13<00:15,  1.26s/it] 89%|████████▉ | 89/100 [02:14<00:12,  1.12s/it] 90%|█████████ | 90/100 [02:16<00:14,  1.41s/it] 91%|█████████ | 91/100 [02:18<00:13,  1.53s/it] 92%|█████████▏| 92/100 [02:18<00:10,  1.30s/it] 93%|█████████▎| 93/100 [02:19<00:08,  1.16s/it] 94%|█████████▍| 94/100 [02:20<00:06,  1.12s/it] 95%|█████████▌| 95/100 [02:21<00:05,  1.03s/it] 96%|█████████▌| 96/100 [02:23<00:05,  1.38s/it] 97%|█████████▋| 97/100 [02:26<00:05,  1.92s/it] 98%|█████████▊| 98/100 [02:27<00:03,  1.59s/it] 99%|█████████▉| 99/100 [02:28<00:01,  1.36s/it]100%|██████████| 100/100 [02:32<00:00,  2.14s/it]100%|██████████| 100/100 [02:32<00:00,  1.53s/it]
2023-06-14 20:14:06 [INFO] {
2023-06-14 20:14:06 [INFO]     'eval_loss': 1.1736871004104614,
2023-06-14 20:14:06 [INFO]     'eval_runtime': 154.1178,
2023-06-14 20:14:06 [INFO]     'eval_samples_per_second': 0.649,
2023-06-14 20:14:06 [INFO]     'eval_steps_per_second': 0.649
2023-06-14 20:14:06 [INFO] }
2023-06-14 20:14:06 [INFO] metric: 0.649
2023-06-14 20:14:06 [INFO] Throughput: 0.649 samples/sec
2023-06-14 20:14:06 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-18-17/./history.snapshot.
2023-06-14 20:14:06 [INFO] FP32 baseline is: [Accuracy: 0.6490, Duration (seconds): 154.1266]
2023-06-14 20:14:08 [INFO] |******Mixed Precision Statistics******|
2023-06-14 20:14:08 [INFO] +-----------------+----------+---------+
2023-06-14 20:14:08 [INFO] |     Op Type     |  Total   |   INT8  |
2023-06-14 20:14:08 [INFO] +-----------------+----------+---------+
2023-06-14 20:14:08 [INFO] |    Embedding    |    2     |    2    |
2023-06-14 20:14:08 [INFO] |      Linear     |    1     |    1    |
2023-06-14 20:14:08 [INFO] +-----------------+----------+---------+
2023-06-14 20:14:08 [INFO] Pass quantize model elapsed time: 1357.55 ms
2023-06-14 20:14:08 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: input, output, code.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:02<02:08,  1.31s/it]  3%|▎         | 3/100 [00:03<01:59,  1.24s/it]  4%|▍         | 4/100 [00:07<03:21,  2.10s/it]  5%|▌         | 5/100 [00:10<04:08,  2.61s/it]  6%|▌         | 6/100 [00:13<04:20,  2.77s/it]  7%|▋         | 7/100 [00:15<03:31,  2.27s/it]  8%|▊         | 8/100 [00:17<03:15,  2.13s/it]  9%|▉         | 9/100 [00:17<02:41,  1.77s/it] 10%|█         | 10/100 [00:18<02:17,  1.52s/it] 11%|█         | 11/100 [00:19<01:54,  1.28s/it] 12%|█▏        | 12/100 [00:20<01:46,  1.21s/it] 13%|█▎        | 13/100 [00:22<01:59,  1.37s/it] 14%|█▍        | 14/100 [00:23<01:44,  1.22s/it] 15%|█▌        | 15/100 [00:24<01:50,  1.30s/it] 16%|█▌        | 16/100 [00:25<01:40,  1.19s/it] 17%|█▋        | 17/100 [00:26<01:27,  1.05s/it] 18%|█▊        | 18/100 [00:27<01:31,  1.12s/it] 19%|█▉        | 19/100 [00:28<01:23,  1.04s/it] 20%|██        | 20/100 [00:29<01:14,  1.07it/s] 21%|██        | 21/100 [00:30<01:10,  1.12it/s] 22%|██▏       | 22/100 [00:30<01:05,  1.19it/s] 23%|██▎       | 23/100 [00:31<01:01,  1.25it/s] 24%|██▍       | 24/100 [00:32<00:58,  1.29it/s] 25%|██▌       | 25/100 [00:33<01:13,  1.02it/s] 26%|██▌       | 26/100 [00:36<01:57,  1.59s/it] 27%|██▋       | 27/100 [00:40<02:37,  2.16s/it] 28%|██▊       | 28/100 [00:43<03:04,  2.56s/it] 29%|██▉       | 29/100 [00:47<03:29,  2.94s/it] 30%|███       | 30/100 [00:48<02:45,  2.37s/it] 31%|███       | 31/100 [00:49<02:09,  1.88s/it] 32%|███▏      | 32/100 [00:50<01:44,  1.53s/it] 33%|███▎      | 33/100 [00:50<01:26,  1.29s/it] 34%|███▍      | 34/100 [00:51<01:13,  1.11s/it] 35%|███▌      | 35/100 [00:52<01:04,  1.01it/s] 36%|███▌      | 36/100 [00:52<00:58,  1.10it/s] 37%|███▋      | 37/100 [00:53<00:53,  1.18it/s] 38%|███▊      | 38/100 [00:54<00:57,  1.07it/s] 39%|███▉      | 39/100 [00:55<00:53,  1.15it/s] 40%|████      | 40/100 [00:57<01:14,  1.24s/it] 41%|████      | 41/100 [00:58<01:16,  1.30s/it] 42%|████▏     | 42/100 [01:00<01:15,  1.30s/it] 43%|████▎     | 43/100 [01:01<01:10,  1.24s/it] 44%|████▍     | 44/100 [01:02<01:00,  1.09s/it] 45%|████▌     | 45/100 [01:05<01:35,  1.75s/it] 46%|████▌     | 46/100 [01:09<02:07,  2.37s/it] 47%|████▋     | 47/100 [01:12<02:20,  2.65s/it] 48%|████▊     | 48/100 [01:16<02:36,  3.00s/it] 49%|████▉     | 49/100 [01:20<02:45,  3.24s/it] 50%|█████     | 50/100 [01:23<02:37,  3.15s/it] 51%|█████     | 51/100 [01:26<02:42,  3.31s/it] 52%|█████▏    | 52/100 [01:30<02:42,  3.39s/it] 53%|█████▎    | 53/100 [01:33<02:42,  3.46s/it] 54%|█████▍    | 54/100 [01:37<02:33,  3.33s/it] 55%|█████▌    | 55/100 [01:40<02:35,  3.46s/it] 56%|█████▌    | 56/100 [01:43<02:29,  3.39s/it] 57%|█████▋    | 57/100 [01:47<02:23,  3.35s/it] 58%|█████▊    | 58/100 [01:50<02:20,  3.35s/it] 59%|█████▉    | 59/100 [01:54<02:22,  3.47s/it] 60%|██████    | 60/100 [01:58<02:22,  3.56s/it] 61%|██████    | 61/100 [02:01<02:21,  3.63s/it] 62%|██████▏   | 62/100 [02:05<02:20,  3.70s/it] 63%|██████▎   | 63/100 [02:09<02:17,  3.73s/it] 64%|██████▍   | 64/100 [02:13<02:14,  3.75s/it] 65%|██████▌   | 65/100 [02:16<02:06,  3.61s/it] 66%|██████▌   | 66/100 [02:19<01:59,  3.52s/it] 67%|██████▋   | 67/100 [02:22<01:51,  3.37s/it] 68%|██████▊   | 68/100 [02:26<01:50,  3.46s/it] 69%|██████▉   | 69/100 [02:28<01:30,  2.93s/it] 70%|███████   | 70/100 [02:32<01:34,  3.16s/it] 71%|███████   | 71/100 [02:35<01:37,  3.35s/it] 72%|███████▏  | 72/100 [02:39<01:34,  3.38s/it] 73%|███████▎  | 73/100 [02:42<01:33,  3.47s/it] 74%|███████▍  | 74/100 [02:46<01:31,  3.52s/it] 75%|███████▌  | 75/100 [02:49<01:19,  3.20s/it] 76%|███████▌  | 76/100 [02:52<01:18,  3.25s/it] 77%|███████▋  | 77/100 [02:56<01:18,  3.40s/it] 78%|███████▊  | 78/100 [02:59<01:15,  3.42s/it] 79%|███████▉  | 79/100 [03:03<01:13,  3.49s/it] 80%|████████  | 80/100 [03:05<01:04,  3.21s/it] 81%|████████  | 81/100 [03:09<01:04,  3.38s/it] 82%|████████▏ | 82/100 [03:13<01:01,  3.40s/it] 83%|████████▎ | 83/100 [03:16<00:59,  3.52s/it] 84%|████████▍ | 84/100 [03:20<00:54,  3.43s/it] 85%|████████▌ | 85/100 [03:23<00:51,  3.44s/it] 86%|████████▌ | 86/100 [03:27<00:50,  3.58s/it] 87%|████████▋ | 87/100 [03:31<00:46,  3.61s/it] 88%|████████▊ | 88/100 [03:34<00:42,  3.51s/it] 89%|████████▉ | 89/100 [03:37<00:37,  3.43s/it] 90%|█████████ | 90/100 [03:40<00:33,  3.31s/it] 91%|█████████ | 91/100 [03:43<00:28,  3.21s/it] 92%|█████████▏| 92/100 [03:47<00:26,  3.36s/it] 93%|█████████▎| 93/100 [03:48<00:19,  2.80s/it] 94%|█████████▍| 94/100 [03:49<00:13,  2.18s/it] 95%|█████████▌| 95/100 [03:50<00:08,  1.74s/it] 96%|█████████▌| 96/100 [03:51<00:05,  1.43s/it] 97%|█████████▋| 97/100 [03:51<00:03,  1.22s/it] 98%|█████████▊| 98/100 [03:52<00:02,  1.12s/it] 99%|█████████▉| 99/100 [03:54<00:01,  1.46s/it]100%|██████████| 100/100 [03:58<00:00,  2.16s/it]100%|██████████| 100/100 [03:58<00:00,  2.39s/it]
2023-06-14 20:18:08 [INFO] {
2023-06-14 20:18:08 [INFO]     'eval_loss': 1.1748971939086914,
2023-06-14 20:18:08 [INFO]     'eval_runtime': 240.3103,
2023-06-14 20:18:08 [INFO]     'eval_samples_per_second': 0.416,
2023-06-14 20:18:08 [INFO]     'eval_steps_per_second': 0.416
2023-06-14 20:18:08 [INFO] }
2023-06-14 20:18:08 [INFO] metric: 0.416
2023-06-14 20:18:08 [INFO] Throughput: 0.416 samples/sec
2023-06-14 20:18:08 [INFO] Tune 1 result is: [Accuracy (int8|fp32): 0.4160|0.6490, Duration (seconds) (int8|fp32): 240.3143|154.1266], Best tune result is: n/a
2023-06-14 20:18:08 [INFO] |***********************Tune Result Statistics**********************|
2023-06-14 20:18:08 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 20:18:08 [INFO] |     Info Type      |  Baseline | Tune 1 result | Best tune result |
2023-06-14 20:18:08 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 20:18:08 [INFO] |      Accuracy      |  0.6490   |    0.4160     |       n/a        |
2023-06-14 20:18:08 [INFO] | Duration (seconds) | 154.1266  |   240.3143    |       n/a        |
2023-06-14 20:18:08 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 20:18:08 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-18-17/./history.snapshot.
2023-06-14 20:18:08 [INFO] Apply all recipes.
2023-06-14 20:18:08 [WARNING] Find evaluated tuning config, skip.
2023-06-14 20:18:08 [INFO] Apply recipe one by one.
2023-06-14 20:18:08 [INFO] Start to fallback op to fp32 one by one.
2023-06-14 20:18:09 [INFO] |******Mixed Precision Statistics******|
2023-06-14 20:18:09 [INFO] +-------------+--------+------+--------+
2023-06-14 20:18:09 [INFO] |   Op Type   | Total  | INT8 |  FP32  |
2023-06-14 20:18:09 [INFO] +-------------+--------+------+--------+
2023-06-14 20:18:09 [INFO] |  Embedding  |   2    |  2   |   0    |
2023-06-14 20:18:09 [INFO] |    Linear   |   1    |  0   |   1    |
2023-06-14 20:18:09 [INFO] +-------------+--------+------+--------+
2023-06-14 20:18:09 [INFO] Pass quantize model elapsed time: 879.6 ms
2023-06-14 20:18:09 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: input, output, code.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:03<03:02,  1.86s/it]  3%|▎         | 3/100 [00:05<02:59,  1.85s/it]  4%|▍         | 4/100 [00:07<02:48,  1.76s/it]  5%|▌         | 5/100 [00:08<02:19,  1.47s/it]  6%|▌         | 6/100 [00:10<02:40,  1.71s/it]  7%|▋         | 7/100 [00:11<02:12,  1.43s/it]  8%|▊         | 8/100 [00:11<01:55,  1.25s/it]  9%|▉         | 9/100 [00:15<02:54,  1.92s/it] 10%|█         | 10/100 [00:19<03:42,  2.47s/it] 11%|█         | 11/100 [00:22<04:16,  2.89s/it] 12%|█▏        | 12/100 [00:23<03:19,  2.27s/it] 13%|█▎        | 13/100 [00:24<02:38,  1.82s/it] 14%|█▍        | 14/100 [00:25<02:10,  1.52s/it] 15%|█▌        | 15/100 [00:29<03:07,  2.20s/it] 16%|█▌        | 16/100 [00:30<02:51,  2.04s/it] 17%|█▋        | 17/100 [00:32<02:37,  1.89s/it] 18%|█▊        | 18/100 [00:33<02:25,  1.77s/it] 19%|█▉        | 19/100 [00:36<02:42,  2.00s/it] 20%|██        | 20/100 [00:38<02:43,  2.05s/it] 21%|██        | 21/100 [00:39<02:26,  1.85s/it] 22%|██▏       | 22/100 [00:40<01:59,  1.53s/it] 23%|██▎       | 23/100 [00:41<01:42,  1.33s/it] 24%|██▍       | 24/100 [00:43<01:45,  1.39s/it] 25%|██▌       | 25/100 [00:44<01:33,  1.25s/it] 26%|██▌       | 26/100 [00:44<01:21,  1.10s/it] 27%|██▋       | 27/100 [00:46<01:22,  1.14s/it] 28%|██▊       | 28/100 [00:46<01:13,  1.02s/it] 29%|██▉       | 29/100 [00:47<01:08,  1.04it/s] 30%|███       | 30/100 [00:48<01:03,  1.10it/s] 31%|███       | 31/100 [00:49<00:59,  1.17it/s] 32%|███▏      | 32/100 [00:49<00:55,  1.23it/s] 33%|███▎      | 33/100 [00:50<00:52,  1.28it/s] 34%|███▍      | 34/100 [00:51<00:50,  1.30it/s] 35%|███▌      | 35/100 [00:52<00:49,  1.32it/s] 36%|███▌      | 36/100 [00:52<00:49,  1.30it/s] 37%|███▋      | 37/100 [00:53<00:47,  1.32it/s] 38%|███▊      | 38/100 [00:54<00:46,  1.34it/s] 39%|███▉      | 39/100 [00:56<01:19,  1.30s/it] 40%|████      | 40/100 [01:00<02:01,  2.03s/it] 41%|████      | 41/100 [01:04<02:24,  2.44s/it] 42%|████▏     | 42/100 [01:06<02:29,  2.57s/it] 43%|████▎     | 43/100 [01:07<01:55,  2.02s/it] 44%|████▍     | 44/100 [01:08<01:32,  1.66s/it] 45%|████▌     | 45/100 [01:12<02:03,  2.25s/it] 46%|████▌     | 46/100 [01:15<02:19,  2.59s/it] 47%|████▋     | 47/100 [01:16<01:47,  2.03s/it] 48%|████▊     | 48/100 [01:16<01:25,  1.64s/it] 49%|████▉     | 49/100 [01:17<01:10,  1.38s/it] 50%|█████     | 50/100 [01:18<00:59,  1.18s/it] 51%|█████     | 51/100 [01:20<01:08,  1.40s/it] 52%|█████▏    | 52/100 [01:21<01:06,  1.38s/it] 53%|█████▎    | 53/100 [01:22<00:55,  1.19s/it] 54%|█████▍    | 54/100 [01:23<00:48,  1.05s/it] 55%|█████▌    | 55/100 [01:24<00:53,  1.19s/it] 56%|█████▌    | 56/100 [01:26<00:55,  1.26s/it] 57%|█████▋    | 57/100 [01:27<00:57,  1.34s/it] 58%|█████▊    | 58/100 [01:28<00:48,  1.16s/it] 59%|█████▉    | 59/100 [01:29<00:44,  1.08s/it] 60%|██████    | 60/100 [01:31<01:01,  1.53s/it] 61%|██████    | 61/100 [01:34<01:14,  1.91s/it] 62%|██████▏   | 62/100 [01:36<01:17,  2.03s/it] 63%|██████▎   | 63/100 [01:38<01:08,  1.85s/it] 64%|██████▍   | 64/100 [01:39<01:04,  1.79s/it] 65%|██████▌   | 65/100 [01:41<00:58,  1.66s/it] 66%|██████▌   | 66/100 [01:42<00:53,  1.58s/it] 67%|██████▋   | 67/100 [01:44<00:49,  1.51s/it] 68%|██████▊   | 68/100 [01:44<00:40,  1.28s/it] 69%|██████▉   | 69/100 [01:47<00:50,  1.62s/it] 70%|███████   | 70/100 [01:51<01:09,  2.30s/it] 71%|███████   | 71/100 [01:53<01:10,  2.42s/it] 72%|███████▏  | 72/100 [01:55<00:59,  2.11s/it] 73%|███████▎  | 73/100 [01:58<01:08,  2.53s/it] 74%|███████▍  | 74/100 [02:02<01:15,  2.90s/it] 75%|███████▌  | 75/100 [02:04<01:07,  2.72s/it] 76%|███████▌  | 76/100 [02:05<00:51,  2.14s/it] 77%|███████▋  | 77/100 [02:06<00:39,  1.73s/it] 78%|███████▊  | 78/100 [02:09<00:45,  2.09s/it] 79%|███████▉  | 79/100 [02:10<00:37,  1.81s/it] 80%|████████  | 80/100 [02:11<00:29,  1.49s/it] 81%|████████  | 81/100 [02:11<00:24,  1.28s/it] 82%|████████▏ | 82/100 [02:12<00:21,  1.18s/it] 83%|████████▎ | 83/100 [02:13<00:17,  1.06s/it] 84%|████████▍ | 84/100 [02:14<00:15,  1.04it/s] 85%|████████▌ | 85/100 [02:15<00:13,  1.10it/s] 86%|████████▌ | 86/100 [02:15<00:12,  1.16it/s] 87%|████████▋ | 87/100 [02:16<00:10,  1.20it/s] 88%|████████▊ | 88/100 [02:17<00:09,  1.21it/s] 89%|████████▉ | 89/100 [02:18<00:09,  1.19it/s] 90%|█████████ | 90/100 [02:19<00:10,  1.02s/it] 91%|█████████ | 91/100 [02:21<00:10,  1.16s/it] 92%|█████████▏| 92/100 [02:22<00:10,  1.29s/it] 93%|█████████▎| 93/100 [02:24<00:09,  1.43s/it] 94%|█████████▍| 94/100 [02:25<00:07,  1.21s/it] 95%|█████████▌| 95/100 [02:26<00:05,  1.06s/it] 96%|█████████▌| 96/100 [02:26<00:03,  1.05it/s] 97%|█████████▋| 97/100 [02:27<00:02,  1.11it/s] 98%|█████████▊| 98/100 [02:29<00:02,  1.13s/it] 99%|█████████▉| 99/100 [02:30<00:01,  1.12s/it]100%|██████████| 100/100 [02:31<00:00,  1.01it/s]100%|██████████| 100/100 [02:31<00:00,  1.51s/it]
2023-06-14 20:20:43 [INFO] {
2023-06-14 20:20:43 [INFO]     'eval_loss': 1.1737359762191772,
2023-06-14 20:20:43 [INFO]     'eval_runtime': 154.0265,
2023-06-14 20:20:43 [INFO]     'eval_samples_per_second': 0.649,
2023-06-14 20:20:43 [INFO]     'eval_steps_per_second': 0.649
2023-06-14 20:20:43 [INFO] }
2023-06-14 20:20:43 [INFO] metric: 0.649
2023-06-14 20:20:43 [INFO] Throughput: 0.649 samples/sec
2023-06-14 20:20:43 [INFO] Tune 3 result is: [Accuracy (int8|fp32): 0.6490|0.6490, Duration (seconds) (int8|fp32): 154.0360|154.1266], Best tune result is: [Accuracy: 0.6490, Duration (seconds): 154.0360]
2023-06-14 20:20:43 [INFO] |***********************Tune Result Statistics**********************|
2023-06-14 20:20:43 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 20:20:43 [INFO] |     Info Type      |  Baseline | Tune 3 result | Best tune result |
2023-06-14 20:20:43 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 20:20:43 [INFO] |      Accuracy      |  0.6490   |    0.6490     |     0.6490       |
2023-06-14 20:20:43 [INFO] | Duration (seconds) | 154.1266  |   154.0360    |    154.0360      |
2023-06-14 20:20:43 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 20:20:43 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-18-17/./history.snapshot.
2023-06-14 20:20:45 [INFO] |******Mixed Precision Statistics******|
2023-06-14 20:20:45 [INFO] +-------------+--------+------+--------+
2023-06-14 20:20:45 [INFO] |   Op Type   | Total  | INT8 |  FP32  |
2023-06-14 20:20:45 [INFO] +-------------+--------+------+--------+
2023-06-14 20:20:45 [INFO] |  Embedding  |   2    |  1   |   1    |
2023-06-14 20:20:45 [INFO] |    Linear   |   1    |  1   |   0    |
2023-06-14 20:20:45 [INFO] +-------------+--------+------+--------+
2023-06-14 20:20:45 [INFO] Pass quantize model elapsed time: 958.39 ms
2023-06-14 20:20:45 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: input, output, code.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:33,  2.95it/s]  3%|▎         | 3/100 [00:02<01:20,  1.21it/s]  4%|▍         | 4/100 [00:03<01:33,  1.03it/s]  5%|▌         | 5/100 [00:04<01:22,  1.15it/s]  6%|▌         | 6/100 [00:04<01:18,  1.20it/s]  7%|▋         | 7/100 [00:07<02:11,  1.41s/it]  8%|▊         | 8/100 [00:10<03:03,  1.99s/it]  9%|▉         | 9/100 [00:13<03:33,  2.35s/it] 10%|█         | 10/100 [00:15<02:58,  1.98s/it] 11%|█         | 11/100 [00:15<02:22,  1.60s/it] 12%|█▏        | 12/100 [00:16<01:58,  1.34s/it] 13%|█▎        | 13/100 [00:17<01:41,  1.16s/it] 14%|█▍        | 14/100 [00:18<01:29,  1.04s/it] 15%|█▌        | 15/100 [00:18<01:21,  1.04it/s] 16%|█▌        | 16/100 [00:19<01:16,  1.10it/s] 17%|█▋        | 17/100 [00:20<01:18,  1.06it/s] 18%|█▊        | 18/100 [00:21<01:16,  1.07it/s] 19%|█▉        | 19/100 [00:22<01:18,  1.03it/s] 20%|██        | 20/100 [00:23<01:21,  1.02s/it] 21%|██        | 21/100 [00:24<01:14,  1.06it/s] 22%|██▏       | 22/100 [00:25<01:08,  1.13it/s] 23%|██▎       | 23/100 [00:26<01:07,  1.15it/s] 24%|██▍       | 24/100 [00:26<01:03,  1.20it/s] 25%|██▌       | 25/100 [00:27<01:07,  1.10it/s] 26%|██▌       | 26/100 [00:28<01:05,  1.13it/s] 27%|██▋       | 27/100 [00:29<01:00,  1.21it/s] 28%|██▊       | 28/100 [00:30<01:06,  1.08it/s] 29%|██▉       | 29/100 [00:32<01:21,  1.15s/it] 30%|███       | 30/100 [00:34<01:42,  1.47s/it] 31%|███       | 31/100 [00:35<01:37,  1.41s/it] 32%|███▏      | 32/100 [00:36<01:22,  1.21s/it] 33%|███▎      | 33/100 [00:39<01:52,  1.67s/it] 34%|███▍      | 34/100 [00:41<02:06,  1.91s/it] 35%|███▌      | 35/100 [00:42<01:47,  1.66s/it] 36%|███▌      | 36/100 [00:45<02:00,  1.89s/it] 37%|███▋      | 37/100 [00:46<01:39,  1.58s/it] 38%|███▊      | 38/100 [00:46<01:21,  1.32s/it] 39%|███▉      | 39/100 [00:47<01:09,  1.13s/it] 40%|████      | 40/100 [00:48<00:59,  1.01it/s] 41%|████      | 41/100 [00:48<00:52,  1.12it/s] 42%|████▏     | 42/100 [00:49<00:48,  1.20it/s] 43%|████▎     | 43/100 [00:50<00:44,  1.27it/s] 44%|████▍     | 44/100 [00:50<00:42,  1.31it/s] 45%|████▌     | 45/100 [00:51<00:41,  1.33it/s] 46%|████▌     | 46/100 [00:52<00:39,  1.35it/s] 47%|████▋     | 47/100 [00:52<00:38,  1.37it/s] 48%|████▊     | 48/100 [00:53<00:37,  1.37it/s] 49%|████▉     | 49/100 [00:54<00:44,  1.14it/s] 50%|█████     | 50/100 [00:55<00:42,  1.17it/s] 51%|█████     | 51/100 [00:56<00:40,  1.20it/s] 52%|█████▏    | 52/100 [00:57<00:38,  1.23it/s] 53%|█████▎    | 53/100 [01:00<01:13,  1.56s/it] 54%|█████▍    | 54/100 [01:01<01:04,  1.39s/it] 55%|█████▌    | 55/100 [01:02<00:54,  1.20s/it] 56%|█████▌    | 56/100 [01:03<00:45,  1.04s/it] 57%|█████▋    | 57/100 [01:03<00:40,  1.07it/s] 58%|█████▊    | 58/100 [01:05<00:54,  1.29s/it] 59%|█████▉    | 59/100 [01:08<01:07,  1.65s/it] 60%|██████    | 60/100 [01:10<01:10,  1.77s/it] 61%|██████    | 61/100 [01:13<01:30,  2.33s/it] 62%|██████▏   | 62/100 [01:16<01:35,  2.52s/it] 63%|██████▎   | 63/100 [01:20<01:45,  2.86s/it] 64%|██████▍   | 64/100 [01:22<01:27,  2.43s/it] 65%|██████▌   | 65/100 [01:22<01:07,  1.92s/it] 66%|██████▌   | 66/100 [01:23<00:53,  1.57s/it] 67%|██████▋   | 67/100 [01:24<00:43,  1.33s/it] 68%|██████▊   | 68/100 [01:25<00:36,  1.16s/it] 69%|██████▉   | 69/100 [01:25<00:31,  1.03s/it] 70%|███████   | 70/100 [01:26<00:28,  1.05it/s] 71%|███████   | 71/100 [01:27<00:26,  1.11it/s] 72%|███████▏  | 72/100 [01:28<00:23,  1.17it/s] 73%|███████▎  | 73/100 [01:28<00:22,  1.22it/s] 74%|███████▍  | 74/100 [01:29<00:20,  1.25it/s] 75%|███████▌  | 75/100 [01:30<00:19,  1.28it/s] 76%|███████▌  | 76/100 [01:31<00:18,  1.29it/s] 77%|███████▋  | 77/100 [01:31<00:17,  1.30it/s] 78%|███████▊  | 78/100 [01:32<00:17,  1.27it/s] 79%|███████▉  | 79/100 [01:33<00:16,  1.29it/s] 80%|████████  | 80/100 [01:34<00:20,  1.00s/it] 81%|████████  | 81/100 [01:37<00:27,  1.47s/it] 82%|████████▏ | 82/100 [01:38<00:26,  1.45s/it] 83%|████████▎ | 83/100 [01:41<00:31,  1.83s/it] 84%|████████▍ | 84/100 [01:45<00:37,  2.36s/it] 85%|████████▌ | 85/100 [01:48<00:37,  2.53s/it] 86%|████████▌ | 86/100 [01:49<00:30,  2.16s/it] 87%|████████▋ | 87/100 [01:52<00:31,  2.44s/it] 88%|████████▊ | 88/100 [01:54<00:26,  2.20s/it] 89%|████████▉ | 89/100 [01:56<00:23,  2.16s/it] 90%|█████████ | 90/100 [01:59<00:23,  2.34s/it] 91%|█████████ | 91/100 [02:01<00:21,  2.44s/it] 92%|█████████▏| 92/100 [02:03<00:17,  2.16s/it] 93%|█████████▎| 93/100 [02:05<00:15,  2.16s/it] 94%|█████████▍| 94/100 [02:08<00:14,  2.35s/it] 95%|█████████▌| 95/100 [02:11<00:13,  2.77s/it] 96%|█████████▌| 96/100 [02:15<00:12,  3.07s/it] 97%|█████████▋| 97/100 [02:17<00:07,  2.59s/it] 98%|█████████▊| 98/100 [02:17<00:04,  2.03s/it] 99%|█████████▉| 99/100 [02:19<00:02,  2.00s/it]100%|██████████| 100/100 [02:21<00:00,  1.82s/it]100%|██████████| 100/100 [02:21<00:00,  1.41s/it]
2023-06-14 20:23:07 [INFO] {
2023-06-14 20:23:07 [INFO]     'eval_loss': 1.1746976375579834,
2023-06-14 20:23:07 [INFO]     'eval_runtime': 141.9077,
2023-06-14 20:23:07 [INFO]     'eval_samples_per_second': 0.705,
2023-06-14 20:23:07 [INFO]     'eval_steps_per_second': 0.705
2023-06-14 20:23:07 [INFO] }
2023-06-14 20:23:07 [INFO] metric: 0.705
2023-06-14 20:23:07 [INFO] Throughput: 0.705 samples/sec
2023-06-14 20:23:07 [INFO] Tune 4 result is: [Accuracy (int8|fp32): 0.7050|0.6490, Duration (seconds) (int8|fp32): 141.9159|154.1266], Best tune result is: [Accuracy: 0.7050, Duration (seconds): 141.9159]
2023-06-14 20:23:07 [INFO] |***********************Tune Result Statistics**********************|
2023-06-14 20:23:07 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 20:23:07 [INFO] |     Info Type      |  Baseline | Tune 4 result | Best tune result |
2023-06-14 20:23:07 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 20:23:07 [INFO] |      Accuracy      |  0.6490   |    0.7050     |     0.7050       |
2023-06-14 20:23:07 [INFO] | Duration (seconds) | 154.1266  |   141.9159    |    141.9159      |
2023-06-14 20:23:07 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 20:23:07 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-18-17/./history.snapshot.
2023-06-14 20:23:09 [INFO] |******Mixed Precision Statistics******|
2023-06-14 20:23:09 [INFO] +-------------+--------+------+--------+
2023-06-14 20:23:09 [INFO] |   Op Type   | Total  | INT8 |  FP32  |
2023-06-14 20:23:09 [INFO] +-------------+--------+------+--------+
2023-06-14 20:23:09 [INFO] |  Embedding  |   2    |  1   |   1    |
2023-06-14 20:23:09 [INFO] |    Linear   |   1    |  1   |   0    |
2023-06-14 20:23:09 [INFO] +-------------+--------+------+--------+
2023-06-14 20:23:09 [INFO] Pass quantize model elapsed time: 1779.32 ms
2023-06-14 20:23:09 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: input, output, code.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:02<02:11,  1.35s/it]  3%|▎         | 3/100 [00:03<01:57,  1.21s/it]  4%|▍         | 4/100 [00:07<03:22,  2.11s/it]  5%|▌         | 5/100 [00:09<03:06,  1.97s/it]  6%|▌         | 6/100 [00:09<02:26,  1.56s/it]  7%|▋         | 7/100 [00:10<01:59,  1.29s/it]  8%|▊         | 8/100 [00:11<01:42,  1.11s/it]  9%|▉         | 9/100 [00:12<01:47,  1.18s/it] 10%|█         | 10/100 [00:14<02:20,  1.56s/it] 11%|█         | 11/100 [00:16<02:05,  1.42s/it] 12%|█▏        | 12/100 [00:16<01:48,  1.23s/it] 13%|█▎        | 13/100 [00:18<01:49,  1.26s/it] 14%|█▍        | 14/100 [00:19<02:00,  1.41s/it] 15%|█▌        | 15/100 [00:23<02:58,  2.10s/it] 16%|█▌        | 16/100 [00:24<02:28,  1.77s/it] 17%|█▋        | 17/100 [00:25<02:05,  1.51s/it] 18%|█▊        | 18/100 [00:28<02:33,  1.87s/it] 19%|█▉        | 19/100 [00:31<03:02,  2.26s/it] 20%|██        | 20/100 [00:33<03:03,  2.29s/it] 21%|██        | 21/100 [00:34<02:24,  1.83s/it] 22%|██▏       | 22/100 [00:37<02:48,  2.16s/it] 23%|██▎       | 23/100 [00:41<03:22,  2.63s/it] 24%|██▍       | 24/100 [00:43<03:21,  2.65s/it] 25%|██▌       | 25/100 [00:46<03:27,  2.77s/it] 26%|██▌       | 26/100 [00:48<02:47,  2.27s/it] 27%|██▋       | 27/100 [00:48<02:11,  1.80s/it] 28%|██▊       | 28/100 [00:51<02:24,  2.01s/it] 29%|██▉       | 29/100 [00:52<02:00,  1.69s/it] 30%|███       | 30/100 [00:52<01:39,  1.42s/it] 31%|███       | 31/100 [00:54<01:34,  1.37s/it] 32%|███▏      | 32/100 [00:56<01:47,  1.58s/it] 33%|███▎      | 33/100 [00:59<02:24,  2.16s/it] 34%|███▍      | 34/100 [01:03<02:55,  2.66s/it] 35%|███▌      | 35/100 [01:06<03:02,  2.80s/it] 36%|███▌      | 36/100 [01:07<02:28,  2.31s/it] 37%|███▋      | 37/100 [01:08<01:57,  1.87s/it] 38%|███▊      | 38/100 [01:09<01:36,  1.55s/it] 39%|███▉      | 39/100 [01:11<01:46,  1.75s/it] 40%|████      | 40/100 [01:13<01:50,  1.85s/it] 41%|████      | 41/100 [01:14<01:28,  1.50s/it] 42%|████▏     | 42/100 [01:15<01:13,  1.26s/it] 43%|████▎     | 43/100 [01:15<01:02,  1.09s/it] 44%|████▍     | 44/100 [01:16<00:54,  1.02it/s] 45%|████▌     | 45/100 [01:17<00:49,  1.11it/s] 46%|████▌     | 46/100 [01:18<00:45,  1.19it/s] 47%|████▋     | 47/100 [01:18<00:42,  1.26it/s] 48%|████▊     | 48/100 [01:19<00:39,  1.31it/s] 49%|████▉     | 49/100 [01:20<00:37,  1.35it/s] 50%|█████     | 50/100 [01:22<01:05,  1.31s/it] 51%|█████     | 51/100 [01:25<01:24,  1.73s/it] 52%|█████▏    | 52/100 [01:29<01:51,  2.33s/it] 53%|█████▎    | 53/100 [01:31<01:52,  2.40s/it] 54%|█████▍    | 54/100 [01:34<01:52,  2.44s/it] 55%|█████▌    | 55/100 [01:35<01:30,  2.00s/it] 56%|█████▌    | 56/100 [01:38<01:39,  2.27s/it] 57%|█████▋    | 57/100 [01:39<01:23,  1.95s/it] 58%|█████▊    | 58/100 [01:40<01:06,  1.58s/it] 59%|█████▉    | 59/100 [01:40<00:55,  1.36s/it] 60%|██████    | 60/100 [01:41<00:46,  1.17s/it] 61%|██████    | 61/100 [01:42<00:43,  1.11s/it] 62%|██████▏   | 62/100 [01:43<00:37,  1.00it/s] 63%|██████▎   | 63/100 [01:44<00:34,  1.09it/s] 64%|██████▍   | 64/100 [01:44<00:32,  1.12it/s] 65%|██████▌   | 65/100 [01:45<00:29,  1.19it/s] 66%|██████▌   | 66/100 [01:48<00:44,  1.31s/it] 67%|██████▋   | 67/100 [01:51<01:00,  1.84s/it] 68%|██████▊   | 68/100 [01:51<00:48,  1.51s/it] 69%|██████▉   | 69/100 [01:52<00:39,  1.27s/it] 70%|███████   | 70/100 [01:56<00:59,  2.00s/it] 71%|███████   | 71/100 [01:58<00:59,  2.05s/it] 72%|███████▏  | 72/100 [01:59<00:49,  1.76s/it] 73%|███████▎  | 73/100 [02:03<01:03,  2.36s/it] 74%|███████▍  | 74/100 [02:06<01:09,  2.69s/it] 75%|███████▌  | 75/100 [02:08<01:00,  2.40s/it] 76%|███████▌  | 76/100 [02:09<00:47,  1.99s/it] 77%|███████▋  | 77/100 [02:10<00:36,  1.59s/it] 78%|███████▊  | 78/100 [02:10<00:29,  1.32s/it] 79%|███████▉  | 79/100 [02:11<00:23,  1.13s/it] 80%|████████  | 80/100 [02:12<00:20,  1.01s/it] 81%|████████  | 81/100 [02:13<00:17,  1.08it/s] 82%|████████▏ | 82/100 [02:15<00:25,  1.39s/it] 83%|████████▎ | 83/100 [02:19<00:35,  2.11s/it] 84%|████████▍ | 84/100 [02:22<00:37,  2.34s/it] 85%|████████▌ | 85/100 [02:22<00:27,  1.86s/it] 86%|████████▌ | 86/100 [02:23<00:21,  1.51s/it] 87%|████████▋ | 87/100 [02:24<00:16,  1.27s/it] 88%|████████▊ | 88/100 [02:25<00:13,  1.10s/it] 89%|████████▉ | 89/100 [02:25<00:10,  1.01it/s] 90%|█████████ | 90/100 [02:26<00:09,  1.09it/s] 91%|█████████ | 91/100 [02:27<00:07,  1.16it/s] 92%|█████████▏| 92/100 [02:28<00:07,  1.11it/s] 93%|█████████▎| 93/100 [02:31<00:12,  1.74s/it] 94%|█████████▍| 94/100 [02:35<00:13,  2.30s/it] 95%|█████████▌| 95/100 [02:36<00:10,  2.00s/it] 96%|█████████▌| 96/100 [02:37<00:06,  1.61s/it] 97%|█████████▋| 97/100 [02:38<00:03,  1.33s/it] 98%|█████████▊| 98/100 [02:39<00:02,  1.23s/it] 99%|█████████▉| 99/100 [02:42<00:01,  1.98s/it]100%|██████████| 100/100 [02:46<00:00,  2.54s/it]100%|██████████| 100/100 [02:46<00:00,  1.67s/it]
2023-06-14 20:25:59 [INFO] {
2023-06-14 20:25:59 [INFO]     'eval_loss': 1.1748887300491333,
2023-06-14 20:25:59 [INFO]     'eval_runtime': 170.1529,
2023-06-14 20:25:59 [INFO]     'eval_samples_per_second': 0.588,
2023-06-14 20:25:59 [INFO]     'eval_steps_per_second': 0.588
2023-06-14 20:25:59 [INFO] }
2023-06-14 20:25:59 [INFO] metric: 0.588
2023-06-14 20:25:59 [INFO] Throughput: 0.588 samples/sec
2023-06-14 20:25:59 [INFO] Tune 5 result is: [Accuracy (int8|fp32): 0.5880|0.6490, Duration (seconds) (int8|fp32): 170.1642|154.1266], Best tune result is: [Accuracy: 0.7050, Duration (seconds): 141.9159]
2023-06-14 20:25:59 [INFO] |***********************Tune Result Statistics**********************|
2023-06-14 20:25:59 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 20:25:59 [INFO] |     Info Type      |  Baseline | Tune 5 result | Best tune result |
2023-06-14 20:25:59 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 20:25:59 [INFO] |      Accuracy      |  0.6490   |    0.5880     |     0.7050       |
2023-06-14 20:25:59 [INFO] | Duration (seconds) | 154.1266  |   170.1642    |    141.9159      |
2023-06-14 20:25:59 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 20:25:59 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-18-17/./history.snapshot.
2023-06-14 20:25:59 [INFO] Start to accumulate fallback to fp32.
2023-06-14 20:26:00 [INFO] |******Mixed Precision Statistics******|
2023-06-14 20:26:00 [INFO] +-------------+--------+------+--------+
2023-06-14 20:26:00 [INFO] |   Op Type   | Total  | INT8 |  FP32  |
2023-06-14 20:26:00 [INFO] +-------------+--------+------+--------+
2023-06-14 20:26:00 [INFO] |  Embedding  |   2    |  1   |   1    |
2023-06-14 20:26:00 [INFO] |    Linear   |   1    |  0   |   1    |
2023-06-14 20:26:00 [INFO] +-------------+--------+------+--------+
2023-06-14 20:26:00 [INFO] Pass quantize model elapsed time: 940.63 ms
2023-06-14 20:26:00 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: input, output, code.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:01<01:36,  1.01it/s]  3%|▎         | 3/100 [00:05<03:36,  2.23s/it]  4%|▍         | 4/100 [00:07<03:20,  2.09s/it]  5%|▌         | 5/100 [00:08<02:35,  1.64s/it]  6%|▌         | 6/100 [00:09<02:07,  1.36s/it]  7%|▋         | 7/100 [00:10<01:49,  1.18s/it]  8%|▊         | 8/100 [00:10<01:37,  1.06s/it]  9%|▉         | 9/100 [00:11<01:30,  1.01it/s] 10%|█         | 10/100 [00:14<02:05,  1.39s/it] 11%|█         | 11/100 [00:16<02:23,  1.62s/it] 12%|█▏        | 12/100 [00:17<02:08,  1.46s/it] 13%|█▎        | 13/100 [00:18<01:50,  1.27s/it] 14%|█▍        | 14/100 [00:18<01:36,  1.12s/it] 15%|█▌        | 15/100 [00:22<02:39,  1.87s/it] 16%|█▌        | 16/100 [00:26<03:23,  2.43s/it] 17%|█▋        | 17/100 [00:27<02:42,  1.96s/it] 18%|█▊        | 18/100 [00:28<02:14,  1.64s/it] 19%|█▉        | 19/100 [00:29<01:57,  1.45s/it] 20%|██        | 20/100 [00:29<01:40,  1.26s/it] 21%|██        | 21/100 [00:31<01:46,  1.35s/it] 22%|██▏       | 22/100 [00:33<01:56,  1.49s/it] 23%|██▎       | 23/100 [00:34<01:39,  1.29s/it] 24%|██▍       | 24/100 [00:34<01:26,  1.14s/it] 25%|██▌       | 25/100 [00:35<01:18,  1.04s/it] 26%|██▌       | 26/100 [00:36<01:11,  1.03it/s] 27%|██▋       | 27/100 [00:37<01:17,  1.06s/it] 28%|██▊       | 28/100 [00:39<01:25,  1.19s/it] 29%|██▉       | 29/100 [00:40<01:22,  1.16s/it] 30%|███       | 30/100 [00:41<01:14,  1.06s/it] 31%|███       | 31/100 [00:41<01:07,  1.02it/s] 32%|███▏      | 32/100 [00:43<01:26,  1.27s/it] 33%|███▎      | 33/100 [00:44<01:15,  1.13s/it] 34%|███▍      | 34/100 [00:45<01:07,  1.03s/it] 35%|███▌      | 35/100 [00:46<01:02,  1.05it/s] 36%|███▌      | 36/100 [00:47<00:57,  1.11it/s] 37%|███▋      | 37/100 [00:47<00:55,  1.14it/s] 38%|███▊      | 38/100 [00:48<00:52,  1.17it/s] 39%|███▉      | 39/100 [00:49<00:57,  1.06it/s] 40%|████      | 40/100 [00:51<01:17,  1.30s/it] 41%|████      | 41/100 [00:52<01:07,  1.14s/it] 42%|████▏     | 42/100 [00:53<01:07,  1.16s/it] 43%|████▎     | 43/100 [00:54<00:59,  1.05s/it] 44%|████▍     | 44/100 [00:55<00:59,  1.06s/it] 45%|████▌     | 45/100 [00:57<01:01,  1.12s/it] 46%|████▌     | 46/100 [00:57<00:54,  1.02s/it] 47%|████▋     | 47/100 [00:58<00:50,  1.05it/s] 48%|████▊     | 48/100 [00:59<00:46,  1.12it/s] 49%|████▉     | 49/100 [01:00<00:44,  1.15it/s] 50%|█████     | 50/100 [01:01<00:42,  1.18it/s] 51%|█████     | 51/100 [01:04<01:25,  1.75s/it] 52%|█████▏    | 52/100 [01:07<01:31,  1.91s/it] 53%|█████▎    | 53/100 [01:11<01:58,  2.51s/it] 54%|█████▍    | 54/100 [01:13<01:52,  2.44s/it] 55%|█████▌    | 55/100 [01:14<01:27,  1.94s/it] 56%|█████▌    | 56/100 [01:14<01:10,  1.60s/it] 57%|█████▋    | 57/100 [01:16<01:02,  1.44s/it] 58%|█████▊    | 58/100 [01:16<00:52,  1.25s/it] 59%|█████▉    | 59/100 [01:19<01:12,  1.77s/it] 60%|██████    | 60/100 [01:21<01:09,  1.74s/it] 61%|██████    | 61/100 [01:22<00:57,  1.47s/it] 62%|██████▏   | 62/100 [01:23<00:50,  1.33s/it] 63%|██████▎   | 63/100 [01:24<00:49,  1.34s/it] 64%|██████▍   | 64/100 [01:25<00:42,  1.17s/it] 65%|██████▌   | 65/100 [01:26<00:37,  1.07s/it] 66%|██████▌   | 66/100 [01:27<00:33,  1.01it/s] 67%|██████▋   | 67/100 [01:27<00:31,  1.06it/s] 68%|██████▊   | 68/100 [01:29<00:31,  1.00it/s] 69%|██████▉   | 69/100 [01:31<00:48,  1.57s/it] 70%|███████   | 70/100 [01:34<00:54,  1.83s/it] 71%|███████   | 71/100 [01:35<00:45,  1.55s/it] 72%|███████▏  | 72/100 [01:37<00:51,  1.83s/it] 73%|███████▎  | 73/100 [01:38<00:40,  1.52s/it] 74%|███████▍  | 74/100 [01:39<00:33,  1.29s/it] 75%|███████▌  | 75/100 [01:40<00:30,  1.22s/it] 76%|███████▌  | 76/100 [01:43<00:41,  1.72s/it] 77%|███████▋  | 77/100 [01:47<00:53,  2.32s/it] 78%|███████▊  | 78/100 [01:50<01:01,  2.78s/it] 79%|███████▉  | 79/100 [01:54<01:06,  3.15s/it] 80%|████████  | 80/100 [01:58<01:07,  3.40s/it] 81%|████████  | 81/100 [02:02<01:05,  3.47s/it] 82%|████████▏ | 82/100 [02:06<01:05,  3.63s/it] 83%|████████▎ | 83/100 [02:10<01:02,  3.68s/it] 84%|████████▍ | 84/100 [02:14<01:00,  3.77s/it] 85%|████████▌ | 85/100 [02:18<00:57,  3.81s/it] 86%|████████▌ | 86/100 [02:22<00:54,  3.87s/it] 87%|████████▋ | 87/100 [02:26<00:50,  3.89s/it] 88%|████████▊ | 88/100 [02:29<00:45,  3.76s/it] 89%|████████▉ | 89/100 [02:33<00:42,  3.83s/it] 90%|█████████ | 90/100 [02:37<00:38,  3.84s/it] 91%|█████████ | 91/100 [02:41<00:34,  3.87s/it] 92%|█████████▏| 92/100 [02:44<00:29,  3.74s/it] 93%|█████████▎| 93/100 [02:48<00:26,  3.76s/it] 94%|█████████▍| 94/100 [02:52<00:22,  3.75s/it] 95%|█████████▌| 95/100 [02:56<00:19,  3.81s/it] 96%|█████████▌| 96/100 [03:00<00:15,  3.83s/it] 97%|█████████▋| 97/100 [03:04<00:11,  3.86s/it] 98%|█████████▊| 98/100 [03:08<00:07,  3.87s/it] 99%|█████████▉| 99/100 [03:11<00:03,  3.87s/it]100%|██████████| 100/100 [03:15<00:00,  3.88s/it]100%|██████████| 100/100 [03:15<00:00,  1.96s/it]
2023-06-14 20:29:17 [INFO] {
2023-06-14 20:29:17 [INFO]     'eval_loss': 1.173661231994629,
2023-06-14 20:29:17 [INFO]     'eval_runtime': 197.0328,
2023-06-14 20:29:17 [INFO]     'eval_samples_per_second': 0.508,
2023-06-14 20:29:17 [INFO]     'eval_steps_per_second': 0.508
2023-06-14 20:29:17 [INFO] }
2023-06-14 20:29:17 [INFO] metric: 0.508
2023-06-14 20:29:17 [INFO] Throughput: 0.508 samples/sec
2023-06-14 20:29:17 [INFO] Tune 6 result is: [Accuracy (int8|fp32): 0.5080|0.6490, Duration (seconds) (int8|fp32): 197.0403|154.1266], Best tune result is: [Accuracy: 0.7050, Duration (seconds): 141.9159]
2023-06-14 20:29:17 [INFO] |***********************Tune Result Statistics**********************|
2023-06-14 20:29:17 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 20:29:17 [INFO] |     Info Type      |  Baseline | Tune 6 result | Best tune result |
2023-06-14 20:29:17 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 20:29:17 [INFO] |      Accuracy      |  0.6490   |    0.5080     |     0.7050       |
2023-06-14 20:29:17 [INFO] | Duration (seconds) | 154.1266  |   197.0403    |    141.9159      |
2023-06-14 20:29:17 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 20:29:17 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-18-17/./history.snapshot.
2023-06-14 20:29:18 [WARNING] None of the submodule got qconfig applied. Make sure you passed correct configuration through `qconfig_dict` or by assigning the `.qconfig` attribute directly on submodules.
2023-06-14 20:29:18 [INFO] |******Mixed Precision Statistics******|
2023-06-14 20:29:18 [INFO] +-----------------+----------+---------+
2023-06-14 20:29:18 [INFO] |     Op Type     |  Total   |   FP32  |
2023-06-14 20:29:18 [INFO] +-----------------+----------+---------+
2023-06-14 20:29:18 [INFO] |    Embedding    |    2     |    2    |
2023-06-14 20:29:18 [INFO] |      Linear     |    1     |    1    |
2023-06-14 20:29:18 [INFO] +-----------------+----------+---------+
2023-06-14 20:29:18 [INFO] Pass quantize model elapsed time: 718.83 ms
2023-06-14 20:29:18 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: input, output, code.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:03<03:06,  1.90s/it]  3%|▎         | 3/100 [00:07<04:22,  2.71s/it]  4%|▍         | 4/100 [00:11<05:00,  3.13s/it]  5%|▌         | 5/100 [00:15<05:23,  3.40s/it]  6%|▌         | 6/100 [00:19<05:28,  3.49s/it]  7%|▋         | 7/100 [00:22<05:30,  3.56s/it]  8%|▊         | 8/100 [00:26<05:28,  3.57s/it]  9%|▉         | 9/100 [00:30<05:29,  3.62s/it] 10%|█         | 10/100 [00:33<05:32,  3.69s/it] 11%|█         | 11/100 [00:37<05:34,  3.76s/it] 12%|█▏        | 12/100 [00:39<04:31,  3.09s/it] 13%|█▎        | 13/100 [00:41<04:14,  2.92s/it] 14%|█▍        | 14/100 [00:45<04:25,  3.08s/it] 15%|█▌        | 15/100 [00:48<04:16,  3.02s/it] 16%|█▌        | 16/100 [00:50<03:49,  2.73s/it] 17%|█▋        | 17/100 [00:51<02:58,  2.15s/it] 18%|█▊        | 18/100 [00:51<02:23,  1.74s/it] 19%|█▉        | 19/100 [00:55<03:09,  2.34s/it] 20%|██        | 20/100 [00:58<03:09,  2.37s/it] 21%|██        | 21/100 [00:59<02:48,  2.13s/it] 22%|██▏       | 22/100 [01:00<02:14,  1.73s/it] 23%|██▎       | 23/100 [01:01<02:06,  1.65s/it] 24%|██▍       | 24/100 [01:02<01:51,  1.47s/it] 25%|██▌       | 25/100 [01:03<01:34,  1.26s/it] 26%|██▌       | 26/100 [01:04<01:21,  1.11s/it] 27%|██▋       | 27/100 [01:05<01:16,  1.04s/it] 28%|██▊       | 28/100 [01:06<01:11,  1.01it/s] 29%|██▉       | 29/100 [01:06<01:04,  1.10it/s] 30%|███       | 30/100 [01:07<01:01,  1.15it/s] 31%|███       | 31/100 [01:08<01:01,  1.12it/s] 32%|███▏      | 32/100 [01:11<01:41,  1.49s/it] 33%|███▎      | 33/100 [01:14<02:04,  1.86s/it] 34%|███▍      | 34/100 [01:15<01:48,  1.65s/it] 35%|███▌      | 35/100 [01:16<01:36,  1.48s/it] 36%|███▌      | 36/100 [01:17<01:21,  1.27s/it] 37%|███▋      | 37/100 [01:18<01:10,  1.12s/it] 38%|███▊      | 38/100 [01:19<01:08,  1.10s/it] 39%|███▉      | 39/100 [01:19<01:01,  1.00s/it] 40%|████      | 40/100 [01:20<00:56,  1.07it/s] 41%|████      | 41/100 [01:22<01:10,  1.19s/it] 42%|████▏     | 42/100 [01:24<01:19,  1.37s/it] 43%|████▎     | 43/100 [01:25<01:19,  1.40s/it] 44%|████▍     | 44/100 [01:26<01:07,  1.21s/it] 45%|████▌     | 45/100 [01:27<00:58,  1.07s/it] 46%|████▌     | 46/100 [01:29<01:12,  1.35s/it] 47%|████▋     | 47/100 [01:29<01:01,  1.16s/it] 48%|████▊     | 48/100 [01:31<01:00,  1.16s/it] 49%|████▉     | 49/100 [01:31<00:54,  1.06s/it] 50%|█████     | 50/100 [01:32<00:49,  1.02it/s] 51%|█████     | 51/100 [01:33<00:47,  1.04it/s] 52%|█████▏    | 52/100 [01:34<00:43,  1.11it/s] 53%|█████▎    | 53/100 [01:35<00:41,  1.14it/s] 54%|█████▍    | 54/100 [01:36<00:40,  1.13it/s] 55%|█████▌    | 55/100 [01:36<00:38,  1.16it/s] 56%|█████▌    | 56/100 [01:38<00:45,  1.03s/it] 57%|█████▋    | 57/100 [01:41<01:07,  1.57s/it] 58%|█████▊    | 58/100 [01:42<00:55,  1.33s/it] 59%|█████▉    | 59/100 [01:42<00:47,  1.17s/it] 60%|██████    | 60/100 [01:43<00:41,  1.05s/it] 61%|██████    | 61/100 [01:44<00:37,  1.04it/s] 62%|██████▏   | 62/100 [01:45<00:35,  1.07it/s] 63%|██████▎   | 63/100 [01:48<01:02,  1.69s/it] 64%|██████▍   | 64/100 [01:49<00:51,  1.42s/it] 65%|██████▌   | 65/100 [01:50<00:43,  1.23s/it] 66%|██████▌   | 66/100 [01:51<00:37,  1.10s/it] 67%|██████▋   | 67/100 [01:54<00:56,  1.70s/it] 68%|██████▊   | 68/100 [01:57<01:08,  2.15s/it] 69%|██████▉   | 69/100 [01:59<01:02,  2.02s/it] 70%|███████   | 70/100 [02:00<00:56,  1.90s/it] 71%|███████   | 71/100 [02:01<00:48,  1.66s/it] 72%|███████▏  | 72/100 [02:02<00:41,  1.48s/it] 73%|███████▎  | 73/100 [02:03<00:34,  1.27s/it] 74%|███████▍  | 74/100 [02:04<00:29,  1.12s/it] 75%|███████▌  | 75/100 [02:05<00:26,  1.05s/it] 76%|███████▌  | 76/100 [02:06<00:23,  1.03it/s] 77%|███████▋  | 77/100 [02:06<00:21,  1.06it/s] 78%|███████▊  | 78/100 [02:09<00:31,  1.41s/it] 79%|███████▉  | 79/100 [02:10<00:27,  1.32s/it] 80%|████████  | 80/100 [02:12<00:27,  1.39s/it] 81%|████████  | 81/100 [02:12<00:22,  1.19s/it] 82%|████████▏ | 82/100 [02:13<00:18,  1.05s/it] 83%|████████▎ | 83/100 [02:14<00:16,  1.05it/s] 84%|████████▍ | 84/100 [02:14<00:14,  1.13it/s] 85%|████████▌ | 85/100 [02:15<00:12,  1.20it/s] 86%|████████▌ | 86/100 [02:16<00:11,  1.24it/s] 87%|████████▋ | 87/100 [02:17<00:10,  1.28it/s] 88%|████████▊ | 88/100 [02:17<00:09,  1.31it/s] 89%|████████▉ | 89/100 [02:18<00:08,  1.25it/s] 90%|█████████ | 90/100 [02:19<00:07,  1.27it/s] 91%|█████████ | 91/100 [02:20<00:07,  1.18it/s] 92%|█████████▏| 92/100 [02:21<00:07,  1.03it/s] 93%|█████████▎| 93/100 [02:22<00:06,  1.07it/s] 94%|█████████▍| 94/100 [02:23<00:05,  1.11it/s] 95%|█████████▌| 95/100 [02:24<00:04,  1.14it/s] 96%|█████████▌| 96/100 [02:26<00:04,  1.23s/it] 97%|█████████▋| 97/100 [02:27<00:03,  1.08s/it] 98%|█████████▊| 98/100 [02:28<00:02,  1.19s/it] 99%|█████████▉| 99/100 [02:29<00:01,  1.06s/it]100%|██████████| 100/100 [02:30<00:00,  1.01s/it]100%|██████████| 100/100 [02:30<00:00,  1.50s/it]
2023-06-14 20:31:52 [INFO] {
2023-06-14 20:31:52 [INFO]     'eval_loss': 1.1736871004104614,
2023-06-14 20:31:52 [INFO]     'eval_runtime': 153.9549,
2023-06-14 20:31:52 [INFO]     'eval_samples_per_second': 0.65,
2023-06-14 20:31:52 [INFO]     'eval_steps_per_second': 0.65
2023-06-14 20:31:52 [INFO] }
2023-06-14 20:31:52 [INFO] metric: 0.65
2023-06-14 20:31:52 [INFO] Throughput: 0.65 samples/sec
2023-06-14 20:31:52 [INFO] Tune 7 result is: [Accuracy (int8|fp32): 0.6500|0.6490, Duration (seconds) (int8|fp32): 153.9614|154.1266], Best tune result is: [Accuracy: 0.7050, Duration (seconds): 141.9159]
2023-06-14 20:31:52 [INFO] |***********************Tune Result Statistics**********************|
2023-06-14 20:31:52 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 20:31:52 [INFO] |     Info Type      |  Baseline | Tune 7 result | Best tune result |
2023-06-14 20:31:52 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 20:31:52 [INFO] |      Accuracy      |  0.6490   |    0.6500     |     0.7050       |
2023-06-14 20:31:52 [INFO] | Duration (seconds) | 154.1266  |   153.9614    |    141.9159      |
2023-06-14 20:31:52 [INFO] +--------------------+-----------+---------------+------------------+
2023-06-14 20:31:52 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-18-17/./history.snapshot.
2023-06-14 20:31:54 [INFO] |******Mixed Precision Statistics******|
2023-06-14 20:31:54 [INFO] +-------------+--------+------+--------+
2023-06-14 20:31:54 [INFO] |   Op Type   | Total  | INT8 |  FP32  |
2023-06-14 20:31:54 [INFO] +-------------+--------+------+--------+
2023-06-14 20:31:54 [INFO] |  Embedding  |   2    |  1   |   1    |
2023-06-14 20:31:54 [INFO] |    Linear   |   1    |  1   |   0    |
2023-06-14 20:31:54 [INFO] +-------------+--------+------+--------+
2023-06-14 20:31:54 [INFO] Pass quantize model elapsed time: 1403.18 ms
2023-06-14 20:31:54 [INFO] Specified timeout or max trials is reached! Found a quantized model which meet accuracy goal. Exit.
2023-06-14 20:31:54 [INFO] Save deploy yaml to /scratch/dsochirca/nc_workspace/2023-06-14_19-18-17/deploy.yaml
2023-06-14 20:31:54 [INFO] Saving model checkpoint to ./test_epoch
2023-06-14 20:32:05 [INFO] quantized model and configure file have saved to ./test_epoch
2023-06-14 20:32:09 [INFO] Saving model checkpoint to ./models/CodeGPT-Py150_0.6_sparse_q_all_layers_sym_per_tensor
2023-06-14 20:32:18 [INFO] quantized model and configure file have saved to ./models/CodeGPT-Py150_0.6_sparse_q_all_layers_sym_per_tensor
