Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Found cached dataset codexglue (/home/dsochirca/.cache/huggingface/datasets/0n1xus___codexglue/code-completion-token-py150/1.0.1/cbc1754b04b259211f238bbcad21909b788b5c2c10a60ee52429a8b4be0ffbbe)
  0%|          | 0/3 [00:00<?, ?it/s] 33%|███▎      | 1/3 [00:01<00:02,  1.37s/it]100%|██████████| 3/3 [00:01<00:00,  2.14it/s]
  0%|          | 0/50000 [00:00<?, ?it/s] 13%|█▎        | 6364/50000 [00:00<00:00, 63632.32it/s] 25%|██▌       | 12728/50000 [00:00<00:00, 61284.56it/s] 38%|███▊      | 18863/50000 [00:00<00:00, 41821.20it/s] 49%|████▉     | 24658/50000 [00:00<00:00, 46714.68it/s] 61%|██████    | 30517/50000 [00:00<00:00, 50282.09it/s] 73%|███████▎  | 36375/50000 [00:00<00:00, 52782.52it/s] 84%|████████▍ | 42113/50000 [00:00<00:00, 54166.81it/s] 96%|█████████▌| 48114/50000 [00:00<00:00, 55923.07it/s]100%|██████████| 50000/50000 [00:02<00:00, 23956.25it/s]
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
2023-06-14 19:19:45 [WARNING] Force convert framework model to neural_compressor model.
2023-06-14 19:19:45 [INFO] Pass query framework capability elapsed time: 1.08 ms
2023-06-14 19:19:45 [INFO] Adaptor has 1 recipes.
2023-06-14 19:19:45 [INFO] 0 recipes specified by user.
2023-06-14 19:19:45 [INFO] 0 recipes require future tuning.
2023-06-14 19:19:45 [INFO] ..............use_distributed_tuning: None
2023-06-14 19:19:45 [INFO] Get FP32 model baseline.
2023-06-14 19:19:45 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: output, input, code.
You're using a GPT2TokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:30,  3.23it/s]  3%|▎         | 3/100 [00:01<00:42,  2.28it/s]  4%|▍         | 4/100 [00:01<00:48,  1.98it/s]  5%|▌         | 5/100 [00:02<00:51,  1.83it/s]  6%|▌         | 6/100 [00:03<00:53,  1.75it/s]  7%|▋         | 7/100 [00:03<00:54,  1.71it/s]  8%|▊         | 8/100 [00:04<00:54,  1.68it/s]  9%|▉         | 9/100 [00:04<00:54,  1.66it/s] 10%|█         | 10/100 [00:05<00:54,  1.65it/s] 11%|█         | 11/100 [00:06<00:54,  1.64it/s] 12%|█▏        | 12/100 [00:06<00:53,  1.63it/s] 13%|█▎        | 13/100 [00:07<00:53,  1.63it/s] 14%|█▍        | 14/100 [00:08<00:52,  1.63it/s] 15%|█▌        | 15/100 [00:08<00:52,  1.61it/s] 16%|█▌        | 16/100 [00:09<00:51,  1.62it/s] 17%|█▋        | 17/100 [00:09<00:51,  1.62it/s] 18%|█▊        | 18/100 [00:10<00:50,  1.61it/s] 19%|█▉        | 19/100 [00:11<00:50,  1.62it/s] 20%|██        | 20/100 [00:11<00:49,  1.61it/s] 21%|██        | 21/100 [00:12<00:49,  1.61it/s] 22%|██▏       | 22/100 [00:13<00:48,  1.61it/s] 23%|██▎       | 23/100 [00:13<00:48,  1.59it/s] 24%|██▍       | 24/100 [00:14<00:47,  1.60it/s] 25%|██▌       | 25/100 [00:14<00:46,  1.60it/s] 26%|██▌       | 26/100 [00:15<00:46,  1.59it/s] 27%|██▋       | 27/100 [00:16<00:45,  1.60it/s] 28%|██▊       | 28/100 [00:16<00:44,  1.61it/s] 29%|██▉       | 29/100 [00:17<00:44,  1.61it/s] 30%|███       | 30/100 [00:18<00:43,  1.61it/s] 31%|███       | 31/100 [00:18<00:42,  1.61it/s] 32%|███▏      | 32/100 [00:19<00:42,  1.61it/s] 33%|███▎      | 33/100 [00:19<00:41,  1.61it/s] 34%|███▍      | 34/100 [00:20<00:40,  1.61it/s] 35%|███▌      | 35/100 [00:21<00:40,  1.61it/s] 36%|███▌      | 36/100 [00:21<00:39,  1.62it/s] 37%|███▋      | 37/100 [00:22<00:39,  1.62it/s] 38%|███▊      | 38/100 [00:22<00:38,  1.62it/s] 39%|███▉      | 39/100 [00:23<00:37,  1.61it/s] 40%|████      | 40/100 [00:24<00:37,  1.60it/s] 41%|████      | 41/100 [00:24<00:36,  1.61it/s] 42%|████▏     | 42/100 [00:25<00:36,  1.61it/s] 43%|████▎     | 43/100 [00:26<00:35,  1.60it/s] 44%|████▍     | 44/100 [00:26<00:34,  1.61it/s] 45%|████▌     | 45/100 [00:27<00:34,  1.61it/s] 46%|████▌     | 46/100 [00:27<00:33,  1.61it/s] 47%|████▋     | 47/100 [00:28<00:32,  1.61it/s] 48%|████▊     | 48/100 [00:29<00:32,  1.60it/s] 49%|████▉     | 49/100 [00:29<00:31,  1.61it/s] 50%|█████     | 50/100 [00:30<00:31,  1.61it/s] 51%|█████     | 51/100 [00:31<00:30,  1.61it/s] 52%|█████▏    | 52/100 [00:31<00:29,  1.61it/s] 53%|█████▎    | 53/100 [00:32<00:29,  1.62it/s] 54%|█████▍    | 54/100 [00:32<00:28,  1.62it/s] 55%|█████▌    | 55/100 [00:33<00:27,  1.62it/s] 56%|█████▌    | 56/100 [00:34<00:27,  1.62it/s] 57%|█████▋    | 57/100 [00:34<00:26,  1.62it/s] 58%|█████▊    | 58/100 [00:35<00:25,  1.62it/s] 59%|█████▉    | 59/100 [00:35<00:25,  1.62it/s] 60%|██████    | 60/100 [00:36<00:24,  1.62it/s] 61%|██████    | 61/100 [00:37<00:24,  1.62it/s] 62%|██████▏   | 62/100 [00:37<00:23,  1.62it/s] 63%|██████▎   | 63/100 [00:38<00:22,  1.62it/s] 64%|██████▍   | 64/100 [00:39<00:22,  1.62it/s] 65%|██████▌   | 65/100 [00:39<00:21,  1.62it/s] 66%|██████▌   | 66/100 [00:40<00:21,  1.62it/s] 67%|██████▋   | 67/100 [00:40<00:20,  1.62it/s] 68%|██████▊   | 68/100 [00:41<00:19,  1.62it/s] 69%|██████▉   | 69/100 [00:42<00:19,  1.61it/s] 70%|███████   | 70/100 [00:42<00:18,  1.61it/s] 71%|███████   | 71/100 [00:43<00:18,  1.61it/s] 72%|███████▏  | 72/100 [00:44<00:17,  1.61it/s] 73%|███████▎  | 73/100 [00:44<00:16,  1.61it/s] 74%|███████▍  | 74/100 [00:45<00:16,  1.61it/s] 75%|███████▌  | 75/100 [00:45<00:15,  1.61it/s] 76%|███████▌  | 76/100 [00:46<00:14,  1.61it/s] 77%|███████▋  | 77/100 [00:47<00:14,  1.61it/s] 78%|███████▊  | 78/100 [00:47<00:13,  1.61it/s] 79%|███████▉  | 79/100 [00:48<00:13,  1.61it/s] 80%|████████  | 80/100 [00:49<00:12,  1.61it/s] 81%|████████  | 81/100 [00:49<00:11,  1.61it/s] 82%|████████▏ | 82/100 [00:50<00:11,  1.61it/s] 83%|████████▎ | 83/100 [00:50<00:10,  1.61it/s] 84%|████████▍ | 84/100 [00:51<00:09,  1.61it/s] 85%|████████▌ | 85/100 [00:52<00:09,  1.62it/s] 86%|████████▌ | 86/100 [00:52<00:08,  1.62it/s] 87%|████████▋ | 87/100 [00:53<00:08,  1.62it/s] 88%|████████▊ | 88/100 [00:53<00:07,  1.62it/s] 89%|████████▉ | 89/100 [00:54<00:06,  1.62it/s] 90%|█████████ | 90/100 [00:55<00:06,  1.62it/s] 91%|█████████ | 91/100 [00:55<00:05,  1.62it/s] 92%|█████████▏| 92/100 [00:56<00:04,  1.62it/s] 93%|█████████▎| 93/100 [00:57<00:04,  1.62it/s] 94%|█████████▍| 94/100 [00:57<00:03,  1.62it/s] 95%|█████████▌| 95/100 [00:58<00:03,  1.62it/s] 96%|█████████▌| 96/100 [00:58<00:02,  1.62it/s] 97%|█████████▋| 97/100 [00:59<00:01,  1.62it/s] 98%|█████████▊| 98/100 [01:00<00:01,  1.62it/s] 99%|█████████▉| 99/100 [01:00<00:00,  1.62it/s]100%|██████████| 100/100 [01:01<00:00,  1.62it/s]100%|██████████| 100/100 [01:01<00:00,  1.63it/s]
2023-06-14 19:20:48 [INFO] {
2023-06-14 19:20:48 [INFO]     'eval_loss': 1.1736871004104614,
2023-06-14 19:20:48 [INFO]     'eval_runtime': 62.1315,
2023-06-14 19:20:48 [INFO]     'eval_samples_per_second': 1.609,
2023-06-14 19:20:48 [INFO]     'eval_steps_per_second': 1.609
2023-06-14 19:20:48 [INFO] }
2023-06-14 19:20:48 [INFO] metric: 1.609
2023-06-14 19:20:48 [INFO] Throughput: 1.609 samples/sec
2023-06-14 19:20:48 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-19-27/./history.snapshot.
2023-06-14 19:20:48 [INFO] FP32 baseline is: [Accuracy: 1.6090, Duration (seconds): 62.1355]
2023-06-14 19:20:49 [INFO] |******Mixed Precision Statistics******|
2023-06-14 19:20:49 [INFO] +-----------------+----------+---------+
2023-06-14 19:20:49 [INFO] |     Op Type     |  Total   |   INT8  |
2023-06-14 19:20:49 [INFO] +-----------------+----------+---------+
2023-06-14 19:20:49 [INFO] |    Embedding    |    2     |    2    |
2023-06-14 19:20:49 [INFO] |      Linear     |    1     |    1    |
2023-06-14 19:20:49 [INFO] +-----------------+----------+---------+
2023-06-14 19:20:49 [INFO] Pass quantize model elapsed time: 953.57 ms
2023-06-14 19:20:49 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: output, input, code.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:31,  3.09it/s]  3%|▎         | 3/100 [00:01<00:43,  2.22it/s]  4%|▍         | 4/100 [00:01<00:49,  1.96it/s]  5%|▌         | 5/100 [00:02<00:52,  1.81it/s]  6%|▌         | 6/100 [00:03<00:54,  1.73it/s]  7%|▋         | 7/100 [00:03<00:55,  1.68it/s]  8%|▊         | 8/100 [00:04<00:55,  1.65it/s]  9%|▉         | 9/100 [00:05<00:56,  1.62it/s] 10%|█         | 10/100 [00:05<00:56,  1.60it/s] 11%|█         | 11/100 [00:06<00:55,  1.60it/s] 12%|█▏        | 12/100 [00:06<00:54,  1.60it/s] 13%|█▎        | 13/100 [00:07<00:54,  1.61it/s] 14%|█▍        | 14/100 [00:08<00:53,  1.62it/s] 15%|█▌        | 15/100 [00:08<00:52,  1.61it/s] 16%|█▌        | 16/100 [00:09<00:52,  1.60it/s] 17%|█▋        | 17/100 [00:10<00:51,  1.61it/s] 18%|█▊        | 18/100 [00:10<00:50,  1.61it/s] 19%|█▉        | 19/100 [00:11<00:50,  1.59it/s] 20%|██        | 20/100 [00:11<00:51,  1.57it/s] 21%|██        | 21/100 [00:12<00:50,  1.55it/s] 22%|██▏       | 22/100 [00:13<00:50,  1.55it/s] 23%|██▎       | 23/100 [00:13<00:49,  1.55it/s] 24%|██▍       | 24/100 [00:14<00:49,  1.55it/s] 25%|██▌       | 25/100 [00:15<00:48,  1.54it/s] 26%|██▌       | 26/100 [00:15<00:47,  1.54it/s] 27%|██▋       | 27/100 [00:16<00:46,  1.56it/s] 28%|██▊       | 28/100 [00:17<00:45,  1.57it/s] 29%|██▉       | 29/100 [00:17<00:45,  1.55it/s] 30%|███       | 30/100 [00:18<00:44,  1.56it/s] 31%|███       | 31/100 [00:19<00:44,  1.56it/s] 32%|███▏      | 32/100 [00:19<00:43,  1.55it/s] 33%|███▎      | 33/100 [00:20<00:43,  1.55it/s] 34%|███▍      | 34/100 [00:20<00:42,  1.55it/s] 35%|███▌      | 35/100 [00:21<00:41,  1.56it/s] 36%|███▌      | 36/100 [00:22<00:40,  1.58it/s] 37%|███▋      | 37/100 [00:22<00:39,  1.59it/s] 38%|███▊      | 38/100 [00:23<00:39,  1.59it/s] 39%|███▉      | 39/100 [00:24<00:38,  1.59it/s] 40%|████      | 40/100 [00:24<00:38,  1.57it/s] 41%|████      | 41/100 [00:25<00:37,  1.56it/s] 42%|████▏     | 42/100 [00:26<00:37,  1.57it/s] 43%|████▎     | 43/100 [00:26<00:36,  1.56it/s] 44%|████▍     | 44/100 [00:27<00:36,  1.55it/s] 45%|████▌     | 45/100 [00:28<00:35,  1.55it/s] 46%|████▌     | 46/100 [00:28<00:34,  1.56it/s] 47%|████▋     | 47/100 [00:29<00:34,  1.55it/s] 48%|████▊     | 48/100 [00:30<00:34,  1.49it/s] 49%|████▉     | 49/100 [00:30<00:33,  1.51it/s] 50%|█████     | 50/100 [00:31<00:32,  1.55it/s] 51%|█████     | 51/100 [00:31<00:31,  1.57it/s] 52%|█████▏    | 52/100 [00:32<00:30,  1.58it/s] 53%|█████▎    | 53/100 [00:33<00:29,  1.57it/s] 54%|█████▍    | 54/100 [00:33<00:29,  1.57it/s] 55%|█████▌    | 55/100 [00:34<00:28,  1.59it/s] 56%|█████▌    | 56/100 [00:35<00:27,  1.59it/s] 57%|█████▋    | 57/100 [00:35<00:26,  1.60it/s] 58%|█████▊    | 58/100 [00:36<00:26,  1.58it/s] 59%|█████▉    | 59/100 [00:36<00:25,  1.59it/s] 60%|██████    | 60/100 [00:37<00:25,  1.59it/s] 61%|██████    | 61/100 [00:38<00:24,  1.57it/s] 62%|██████▏   | 62/100 [00:38<00:24,  1.58it/s] 63%|██████▎   | 63/100 [00:39<00:23,  1.57it/s] 64%|██████▍   | 64/100 [00:40<00:23,  1.56it/s] 65%|██████▌   | 65/100 [00:40<00:22,  1.56it/s] 66%|██████▌   | 66/100 [00:41<00:21,  1.56it/s] 67%|██████▋   | 67/100 [00:42<00:21,  1.57it/s] 68%|██████▊   | 68/100 [00:42<00:20,  1.58it/s] 69%|██████▉   | 69/100 [00:43<00:19,  1.57it/s] 70%|███████   | 70/100 [00:43<00:19,  1.57it/s] 71%|███████   | 71/100 [00:44<00:18,  1.59it/s] 72%|███████▏  | 72/100 [00:45<00:17,  1.58it/s] 73%|███████▎  | 73/100 [00:45<00:17,  1.58it/s] 74%|███████▍  | 74/100 [00:46<00:16,  1.57it/s] 75%|███████▌  | 75/100 [00:47<00:16,  1.55it/s] 76%|███████▌  | 76/100 [00:47<00:15,  1.56it/s] 77%|███████▋  | 77/100 [00:48<00:14,  1.57it/s] 78%|███████▊  | 78/100 [00:49<00:13,  1.57it/s] 79%|███████▉  | 79/100 [00:49<00:13,  1.57it/s] 80%|████████  | 80/100 [00:50<00:12,  1.57it/s] 81%|████████  | 81/100 [00:50<00:11,  1.58it/s] 82%|████████▏ | 82/100 [00:51<00:11,  1.57it/s] 83%|████████▎ | 83/100 [00:52<00:10,  1.57it/s] 84%|████████▍ | 84/100 [00:52<00:10,  1.55it/s] 85%|████████▌ | 85/100 [00:53<00:09,  1.56it/s] 86%|████████▌ | 86/100 [00:54<00:08,  1.57it/s] 87%|████████▋ | 87/100 [00:54<00:08,  1.56it/s] 88%|████████▊ | 88/100 [00:55<00:07,  1.58it/s] 89%|████████▉ | 89/100 [00:56<00:06,  1.58it/s] 90%|█████████ | 90/100 [00:56<00:06,  1.58it/s] 91%|█████████ | 91/100 [00:57<00:05,  1.59it/s] 92%|█████████▏| 92/100 [00:57<00:05,  1.59it/s] 93%|█████████▎| 93/100 [00:58<00:04,  1.59it/s] 94%|█████████▍| 94/100 [00:59<00:03,  1.58it/s] 95%|█████████▌| 95/100 [00:59<00:03,  1.59it/s] 96%|█████████▌| 96/100 [01:00<00:02,  1.59it/s] 97%|█████████▋| 97/100 [01:01<00:01,  1.59it/s] 98%|█████████▊| 98/100 [01:01<00:01,  1.59it/s] 99%|█████████▉| 99/100 [01:02<00:00,  1.58it/s]100%|██████████| 100/100 [01:02<00:00,  1.58it/s]100%|██████████| 100/100 [01:02<00:00,  1.59it/s]
2023-06-14 19:21:52 [INFO] {
2023-06-14 19:21:52 [INFO]     'eval_loss': 1.1748971939086914,
2023-06-14 19:21:52 [INFO]     'eval_runtime': 63.6985,
2023-06-14 19:21:52 [INFO]     'eval_samples_per_second': 1.57,
2023-06-14 19:21:52 [INFO]     'eval_steps_per_second': 1.57
2023-06-14 19:21:52 [INFO] }
2023-06-14 19:21:52 [INFO] metric: 1.57
2023-06-14 19:21:52 [INFO] Throughput: 1.57 samples/sec
2023-06-14 19:21:52 [INFO] Tune 1 result is: [Accuracy (int8|fp32): 1.5700|1.6090, Duration (seconds) (int8|fp32): 63.7029|62.1355], Best tune result is: n/a
2023-06-14 19:21:52 [INFO] |**********************Tune Result Statistics**********************|
2023-06-14 19:21:52 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:21:52 [INFO] |     Info Type      | Baseline | Tune 1 result | Best tune result |
2023-06-14 19:21:52 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:21:52 [INFO] |      Accuracy      | 1.6090   |    1.5700     |       n/a        |
2023-06-14 19:21:52 [INFO] | Duration (seconds) | 62.1355  |    63.7029    |       n/a        |
2023-06-14 19:21:52 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:21:52 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-19-27/./history.snapshot.
2023-06-14 19:21:56 [INFO] Apply all recipes.
2023-06-14 19:21:56 [WARNING] Find evaluated tuning config, skip.
2023-06-14 19:21:56 [INFO] Apply recipe one by one.
2023-06-14 19:21:56 [INFO] Start to fallback op to fp32 one by one.
2023-06-14 19:21:57 [INFO] |******Mixed Precision Statistics******|
2023-06-14 19:21:57 [INFO] +-------------+--------+------+--------+
2023-06-14 19:21:57 [INFO] |   Op Type   | Total  | INT8 |  FP32  |
2023-06-14 19:21:57 [INFO] +-------------+--------+------+--------+
2023-06-14 19:21:57 [INFO] |  Embedding  |   2    |  2   |   0    |
2023-06-14 19:21:57 [INFO] |    Linear   |   1    |  0   |   1    |
2023-06-14 19:21:57 [INFO] +-------------+--------+------+--------+
2023-06-14 19:21:57 [INFO] Pass quantize model elapsed time: 285.95 ms
2023-06-14 19:21:57 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: output, input, code.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:31,  3.10it/s]  3%|▎         | 3/100 [00:01<00:44,  2.19it/s]  4%|▍         | 4/100 [00:01<00:50,  1.90it/s]  5%|▌         | 5/100 [00:02<00:54,  1.75it/s]  6%|▌         | 6/100 [00:03<00:56,  1.67it/s]  7%|▋         | 7/100 [00:03<00:57,  1.62it/s]  8%|▊         | 8/100 [00:04<00:57,  1.59it/s]  9%|▉         | 9/100 [00:05<00:57,  1.57it/s] 10%|█         | 10/100 [00:05<00:57,  1.57it/s] 11%|█         | 11/100 [00:06<00:57,  1.55it/s] 12%|█▏        | 12/100 [00:07<00:56,  1.55it/s] 13%|█▎        | 13/100 [00:07<00:56,  1.55it/s] 14%|█▍        | 14/100 [00:08<00:55,  1.55it/s] 15%|█▌        | 15/100 [00:09<00:55,  1.55it/s] 16%|█▌        | 16/100 [00:09<00:54,  1.54it/s] 17%|█▋        | 17/100 [00:10<00:53,  1.54it/s] 18%|█▊        | 18/100 [00:11<00:53,  1.54it/s] 19%|█▉        | 19/100 [00:11<00:52,  1.54it/s] 20%|██        | 20/100 [00:12<00:52,  1.53it/s] 21%|██        | 21/100 [00:13<00:51,  1.53it/s] 22%|██▏       | 22/100 [00:13<00:51,  1.53it/s] 23%|██▎       | 23/100 [00:14<00:50,  1.53it/s] 24%|██▍       | 24/100 [00:14<00:49,  1.52it/s] 25%|██▌       | 25/100 [00:15<00:49,  1.52it/s] 26%|██▌       | 26/100 [00:16<00:48,  1.52it/s] 27%|██▋       | 27/100 [00:16<00:47,  1.52it/s] 28%|██▊       | 28/100 [00:17<00:47,  1.51it/s] 29%|██▉       | 29/100 [00:18<00:46,  1.52it/s] 30%|███       | 30/100 [00:18<00:45,  1.52it/s] 31%|███       | 31/100 [00:19<00:45,  1.53it/s] 32%|███▏      | 32/100 [00:20<00:44,  1.52it/s] 33%|███▎      | 33/100 [00:20<00:43,  1.53it/s] 34%|███▍      | 34/100 [00:21<00:43,  1.52it/s] 35%|███▌      | 35/100 [00:22<00:42,  1.53it/s] 36%|███▌      | 36/100 [00:22<00:41,  1.53it/s] 37%|███▋      | 37/100 [00:23<00:41,  1.53it/s] 38%|███▊      | 38/100 [00:24<00:40,  1.53it/s] 39%|███▉      | 39/100 [00:24<00:39,  1.54it/s] 40%|████      | 40/100 [00:25<00:38,  1.54it/s] 41%|████      | 41/100 [00:26<00:38,  1.54it/s] 42%|████▏     | 42/100 [00:26<00:37,  1.53it/s] 43%|████▎     | 43/100 [00:27<00:37,  1.53it/s] 44%|████▍     | 44/100 [00:28<00:36,  1.53it/s] 45%|████▌     | 45/100 [00:28<00:35,  1.53it/s] 46%|████▌     | 46/100 [00:29<00:35,  1.53it/s] 47%|████▋     | 47/100 [00:30<00:34,  1.53it/s] 48%|████▊     | 48/100 [00:30<00:34,  1.53it/s] 49%|████▉     | 49/100 [00:31<00:33,  1.53it/s] 50%|█████     | 50/100 [00:32<00:32,  1.52it/s] 51%|█████     | 51/100 [00:32<00:32,  1.53it/s] 52%|█████▏    | 52/100 [00:33<00:31,  1.53it/s] 53%|█████▎    | 53/100 [00:33<00:30,  1.53it/s] 54%|█████▍    | 54/100 [00:34<00:30,  1.53it/s] 55%|█████▌    | 55/100 [00:35<00:29,  1.53it/s] 56%|█████▌    | 56/100 [00:35<00:28,  1.53it/s] 57%|█████▋    | 57/100 [00:36<00:28,  1.53it/s] 58%|█████▊    | 58/100 [00:37<00:27,  1.53it/s] 59%|█████▉    | 59/100 [00:37<00:26,  1.53it/s] 60%|██████    | 60/100 [00:38<00:26,  1.53it/s] 61%|██████    | 61/100 [00:39<00:25,  1.53it/s] 62%|██████▏   | 62/100 [00:39<00:24,  1.52it/s] 63%|██████▎   | 63/100 [00:40<00:24,  1.52it/s] 64%|██████▍   | 64/100 [00:41<00:23,  1.52it/s] 65%|██████▌   | 65/100 [00:41<00:22,  1.53it/s] 66%|██████▌   | 66/100 [00:42<00:22,  1.52it/s] 67%|██████▋   | 67/100 [00:43<00:21,  1.53it/s] 68%|██████▊   | 68/100 [00:43<00:21,  1.52it/s] 69%|██████▉   | 69/100 [00:44<00:20,  1.52it/s] 70%|███████   | 70/100 [00:45<00:19,  1.52it/s] 71%|███████   | 71/100 [00:45<00:18,  1.53it/s] 72%|███████▏  | 72/100 [00:46<00:18,  1.53it/s] 73%|███████▎  | 73/100 [00:47<00:17,  1.53it/s] 74%|███████▍  | 74/100 [00:47<00:17,  1.53it/s] 75%|███████▌  | 75/100 [00:48<00:16,  1.52it/s] 76%|███████▌  | 76/100 [00:49<00:15,  1.52it/s] 77%|███████▋  | 77/100 [00:49<00:15,  1.52it/s] 78%|███████▊  | 78/100 [00:50<00:14,  1.52it/s] 79%|███████▉  | 79/100 [00:51<00:13,  1.52it/s] 80%|████████  | 80/100 [00:51<00:13,  1.52it/s] 81%|████████  | 81/100 [00:52<00:12,  1.52it/s] 82%|████████▏ | 82/100 [00:53<00:11,  1.51it/s] 83%|████████▎ | 83/100 [00:53<00:11,  1.52it/s] 84%|████████▍ | 84/100 [00:54<00:10,  1.52it/s] 85%|████████▌ | 85/100 [00:54<00:09,  1.52it/s] 86%|████████▌ | 86/100 [00:55<00:09,  1.52it/s] 87%|████████▋ | 87/100 [00:56<00:08,  1.52it/s] 88%|████████▊ | 88/100 [00:56<00:07,  1.52it/s] 89%|████████▉ | 89/100 [00:57<00:07,  1.52it/s] 90%|█████████ | 90/100 [00:58<00:06,  1.52it/s] 91%|█████████ | 91/100 [00:58<00:05,  1.52it/s] 92%|█████████▏| 92/100 [00:59<00:05,  1.52it/s] 93%|█████████▎| 93/100 [01:00<00:04,  1.52it/s] 94%|█████████▍| 94/100 [01:00<00:03,  1.52it/s] 95%|█████████▌| 95/100 [01:01<00:03,  1.52it/s] 96%|█████████▌| 96/100 [01:02<00:02,  1.52it/s] 97%|█████████▋| 97/100 [01:02<00:01,  1.52it/s] 98%|█████████▊| 98/100 [01:03<00:01,  1.53it/s] 99%|█████████▉| 99/100 [01:04<00:00,  1.53it/s]100%|██████████| 100/100 [01:04<00:00,  1.53it/s]100%|██████████| 100/100 [01:04<00:00,  1.54it/s]
2023-06-14 19:23:02 [INFO] {
2023-06-14 19:23:02 [INFO]     'eval_loss': 1.1737359762191772,
2023-06-14 19:23:02 [INFO]     'eval_runtime': 65.4814,
2023-06-14 19:23:02 [INFO]     'eval_samples_per_second': 1.527,
2023-06-14 19:23:02 [INFO]     'eval_steps_per_second': 1.527
2023-06-14 19:23:02 [INFO] }
2023-06-14 19:23:02 [INFO] metric: 1.527
2023-06-14 19:23:02 [INFO] Throughput: 1.527 samples/sec
2023-06-14 19:23:02 [INFO] Tune 3 result is: [Accuracy (int8|fp32): 1.5270|1.6090, Duration (seconds) (int8|fp32): 65.4863|62.1355], Best tune result is: n/a
2023-06-14 19:23:02 [INFO] |**********************Tune Result Statistics**********************|
2023-06-14 19:23:02 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:23:02 [INFO] |     Info Type      | Baseline | Tune 3 result | Best tune result |
2023-06-14 19:23:02 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:23:02 [INFO] |      Accuracy      | 1.6090   |    1.5270     |       n/a        |
2023-06-14 19:23:02 [INFO] | Duration (seconds) | 62.1355  |    65.4863    |       n/a        |
2023-06-14 19:23:02 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:23:02 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-19-27/./history.snapshot.
2023-06-14 19:23:03 [INFO] |******Mixed Precision Statistics******|
2023-06-14 19:23:03 [INFO] +-------------+--------+------+--------+
2023-06-14 19:23:03 [INFO] |   Op Type   | Total  | INT8 |  FP32  |
2023-06-14 19:23:03 [INFO] +-------------+--------+------+--------+
2023-06-14 19:23:03 [INFO] |  Embedding  |   2    |  1   |   1    |
2023-06-14 19:23:03 [INFO] |    Linear   |   1    |  1   |   0    |
2023-06-14 19:23:03 [INFO] +-------------+--------+------+--------+
2023-06-14 19:23:03 [INFO] Pass quantize model elapsed time: 906.56 ms
2023-06-14 19:23:03 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: output, input, code.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:30,  3.24it/s]  3%|▎         | 3/100 [00:01<00:42,  2.29it/s]  4%|▍         | 4/100 [00:01<00:48,  1.99it/s]  5%|▌         | 5/100 [00:02<00:51,  1.84it/s]  6%|▌         | 6/100 [00:03<00:53,  1.76it/s]  7%|▋         | 7/100 [00:03<00:54,  1.71it/s]  8%|▊         | 8/100 [00:04<00:54,  1.68it/s]  9%|▉         | 9/100 [00:04<00:54,  1.66it/s] 10%|█         | 10/100 [00:05<00:54,  1.65it/s] 11%|█         | 11/100 [00:06<00:54,  1.64it/s] 12%|█▏        | 12/100 [00:06<00:53,  1.63it/s] 13%|█▎        | 13/100 [00:07<00:53,  1.63it/s] 14%|█▍        | 14/100 [00:08<00:52,  1.63it/s] 15%|█▌        | 15/100 [00:08<00:52,  1.62it/s] 16%|█▌        | 16/100 [00:09<00:51,  1.62it/s] 17%|█▋        | 17/100 [00:09<00:51,  1.62it/s] 18%|█▊        | 18/100 [00:10<00:50,  1.62it/s] 19%|█▉        | 19/100 [00:11<00:50,  1.62it/s] 20%|██        | 20/100 [00:11<00:49,  1.62it/s] 21%|██        | 21/100 [00:12<00:48,  1.62it/s] 22%|██▏       | 22/100 [00:12<00:48,  1.62it/s] 23%|██▎       | 23/100 [00:13<00:47,  1.61it/s] 24%|██▍       | 24/100 [00:14<00:47,  1.61it/s] 25%|██▌       | 25/100 [00:14<00:46,  1.61it/s] 26%|██▌       | 26/100 [00:15<00:45,  1.61it/s] 27%|██▋       | 27/100 [00:16<00:45,  1.62it/s] 28%|██▊       | 28/100 [00:16<00:44,  1.62it/s] 29%|██▉       | 29/100 [00:17<00:43,  1.62it/s] 30%|███       | 30/100 [00:17<00:43,  1.62it/s] 31%|███       | 31/100 [00:18<00:42,  1.61it/s] 32%|███▏      | 32/100 [00:19<00:42,  1.61it/s] 33%|███▎      | 33/100 [00:19<00:41,  1.61it/s] 34%|███▍      | 34/100 [00:20<00:41,  1.60it/s] 35%|███▌      | 35/100 [00:21<00:40,  1.60it/s] 36%|███▌      | 36/100 [00:21<00:39,  1.60it/s] 37%|███▋      | 37/100 [00:22<00:39,  1.61it/s] 38%|███▊      | 38/100 [00:22<00:38,  1.62it/s] 39%|███▉      | 39/100 [00:23<00:37,  1.61it/s] 40%|████      | 40/100 [00:24<00:37,  1.61it/s] 41%|████      | 41/100 [00:24<00:36,  1.61it/s] 42%|████▏     | 42/100 [00:25<00:35,  1.61it/s] 43%|████▎     | 43/100 [00:26<00:35,  1.61it/s] 44%|████▍     | 44/100 [00:26<00:34,  1.61it/s] 45%|████▌     | 45/100 [00:27<00:34,  1.61it/s] 46%|████▌     | 46/100 [00:27<00:33,  1.61it/s] 47%|████▋     | 47/100 [00:28<00:32,  1.61it/s] 48%|████▊     | 48/100 [00:29<00:32,  1.61it/s] 49%|████▉     | 49/100 [00:29<00:31,  1.62it/s] 50%|█████     | 50/100 [00:30<00:31,  1.61it/s] 51%|█████     | 51/100 [00:30<00:30,  1.61it/s] 52%|█████▏    | 52/100 [00:31<00:29,  1.62it/s] 53%|█████▎    | 53/100 [00:32<00:29,  1.62it/s] 54%|█████▍    | 54/100 [00:32<00:28,  1.62it/s] 55%|█████▌    | 55/100 [00:33<00:27,  1.62it/s] 56%|█████▌    | 56/100 [00:34<00:27,  1.61it/s] 57%|█████▋    | 57/100 [00:34<00:26,  1.61it/s] 58%|█████▊    | 58/100 [00:35<00:25,  1.62it/s] 59%|█████▉    | 59/100 [00:35<00:25,  1.62it/s] 60%|██████    | 60/100 [00:36<00:24,  1.62it/s] 61%|██████    | 61/100 [00:37<00:24,  1.61it/s] 62%|██████▏   | 62/100 [00:37<00:23,  1.61it/s] 63%|██████▎   | 63/100 [00:38<00:22,  1.61it/s] 64%|██████▍   | 64/100 [00:39<00:22,  1.61it/s] 65%|██████▌   | 65/100 [00:39<00:21,  1.61it/s] 66%|██████▌   | 66/100 [00:40<00:21,  1.62it/s] 67%|██████▋   | 67/100 [00:40<00:20,  1.62it/s] 68%|██████▊   | 68/100 [00:41<00:19,  1.62it/s] 69%|██████▉   | 69/100 [00:42<00:19,  1.61it/s] 70%|███████   | 70/100 [00:42<00:18,  1.61it/s] 71%|███████   | 71/100 [00:43<00:18,  1.61it/s] 72%|███████▏  | 72/100 [00:43<00:17,  1.61it/s] 73%|███████▎  | 73/100 [00:44<00:16,  1.60it/s] 74%|███████▍  | 74/100 [00:45<00:16,  1.60it/s] 75%|███████▌  | 75/100 [00:45<00:15,  1.60it/s] 76%|███████▌  | 76/100 [00:46<00:15,  1.59it/s] 77%|███████▋  | 77/100 [00:47<00:14,  1.59it/s] 78%|███████▊  | 78/100 [00:47<00:13,  1.59it/s] 79%|███████▉  | 79/100 [00:48<00:13,  1.59it/s] 80%|████████  | 80/100 [00:49<00:12,  1.59it/s] 81%|████████  | 81/100 [00:49<00:11,  1.59it/s] 82%|████████▏ | 82/100 [00:50<00:11,  1.59it/s] 83%|████████▎ | 83/100 [00:50<00:10,  1.59it/s] 84%|████████▍ | 84/100 [00:51<00:10,  1.59it/s] 85%|████████▌ | 85/100 [00:52<00:09,  1.59it/s] 86%|████████▌ | 86/100 [00:52<00:08,  1.59it/s] 87%|████████▋ | 87/100 [00:53<00:08,  1.59it/s] 88%|████████▊ | 88/100 [00:54<00:07,  1.59it/s] 89%|████████▉ | 89/100 [00:54<00:06,  1.59it/s] 90%|█████████ | 90/100 [00:55<00:06,  1.58it/s] 91%|█████████ | 91/100 [00:55<00:05,  1.58it/s] 92%|█████████▏| 92/100 [00:56<00:05,  1.58it/s] 93%|█████████▎| 93/100 [00:57<00:04,  1.58it/s] 94%|█████████▍| 94/100 [00:57<00:03,  1.58it/s] 95%|█████████▌| 95/100 [00:58<00:03,  1.58it/s] 96%|█████████▌| 96/100 [00:59<00:02,  1.58it/s] 97%|█████████▋| 97/100 [00:59<00:01,  1.58it/s] 98%|█████████▊| 98/100 [01:00<00:01,  1.58it/s] 99%|█████████▉| 99/100 [01:01<00:00,  1.58it/s]100%|██████████| 100/100 [01:01<00:00,  1.58it/s]100%|██████████| 100/100 [01:01<00:00,  1.62it/s]
2023-06-14 19:24:06 [INFO] {
2023-06-14 19:24:06 [INFO]     'eval_loss': 1.1746976375579834,
2023-06-14 19:24:06 [INFO]     'eval_runtime': 62.292,
2023-06-14 19:24:06 [INFO]     'eval_samples_per_second': 1.605,
2023-06-14 19:24:06 [INFO]     'eval_steps_per_second': 1.605
2023-06-14 19:24:06 [INFO] }
2023-06-14 19:24:06 [INFO] metric: 1.605
2023-06-14 19:24:06 [INFO] Throughput: 1.605 samples/sec
2023-06-14 19:24:06 [INFO] Tune 4 result is: [Accuracy (int8|fp32): 1.6050|1.6090, Duration (seconds) (int8|fp32): 62.2975|62.1355], Best tune result is: [Accuracy: 1.6050, Duration (seconds): 62.2975]
2023-06-14 19:24:06 [INFO] |**********************Tune Result Statistics**********************|
2023-06-14 19:24:06 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:24:06 [INFO] |     Info Type      | Baseline | Tune 4 result | Best tune result |
2023-06-14 19:24:06 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:24:06 [INFO] |      Accuracy      | 1.6090   |    1.6050     |     1.6050       |
2023-06-14 19:24:06 [INFO] | Duration (seconds) | 62.1355  |    62.2975    |     62.2975      |
2023-06-14 19:24:06 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:24:06 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-19-27/./history.snapshot.
2023-06-14 19:24:07 [INFO] |******Mixed Precision Statistics******|
2023-06-14 19:24:07 [INFO] +-------------+--------+------+--------+
2023-06-14 19:24:07 [INFO] |   Op Type   | Total  | INT8 |  FP32  |
2023-06-14 19:24:07 [INFO] +-------------+--------+------+--------+
2023-06-14 19:24:07 [INFO] |  Embedding  |   2    |  1   |   1    |
2023-06-14 19:24:07 [INFO] |    Linear   |   1    |  1   |   0    |
2023-06-14 19:24:07 [INFO] +-------------+--------+------+--------+
2023-06-14 19:24:07 [INFO] Pass quantize model elapsed time: 804.59 ms
2023-06-14 19:24:07 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: output, input, code.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:35,  2.79it/s]  3%|▎         | 3/100 [00:01<00:49,  1.97it/s]  4%|▍         | 4/100 [00:02<00:56,  1.70it/s]  5%|▌         | 5/100 [00:02<01:00,  1.58it/s]  6%|▌         | 6/100 [00:03<01:02,  1.51it/s]  7%|▋         | 7/100 [00:04<01:03,  1.46it/s]  8%|▊         | 8/100 [00:05<01:03,  1.44it/s]  9%|▉         | 9/100 [00:05<01:03,  1.42it/s] 10%|█         | 10/100 [00:06<01:03,  1.41it/s] 11%|█         | 11/100 [00:07<01:03,  1.40it/s] 12%|█▏        | 12/100 [00:07<01:02,  1.40it/s] 13%|█▎        | 13/100 [00:08<01:02,  1.39it/s] 14%|█▍        | 14/100 [00:09<01:02,  1.39it/s] 15%|█▌        | 15/100 [00:10<01:01,  1.39it/s] 16%|█▌        | 16/100 [00:10<01:00,  1.39it/s] 17%|█▋        | 17/100 [00:11<00:59,  1.39it/s] 18%|█▊        | 18/100 [00:12<00:59,  1.39it/s] 19%|█▉        | 19/100 [00:12<00:58,  1.39it/s] 20%|██        | 20/100 [00:13<00:57,  1.39it/s] 21%|██        | 21/100 [00:14<00:56,  1.39it/s] 22%|██▏       | 22/100 [00:15<00:56,  1.39it/s] 23%|██▎       | 23/100 [00:15<00:55,  1.39it/s] 24%|██▍       | 24/100 [00:16<00:54,  1.39it/s] 25%|██▌       | 25/100 [00:17<00:54,  1.38it/s] 26%|██▌       | 26/100 [00:18<00:53,  1.38it/s] 27%|██▋       | 27/100 [00:18<00:52,  1.38it/s] 28%|██▊       | 28/100 [00:19<00:51,  1.38it/s] 29%|██▉       | 29/100 [00:20<00:51,  1.38it/s] 30%|███       | 30/100 [00:20<00:50,  1.38it/s] 31%|███       | 31/100 [00:21<00:49,  1.39it/s] 32%|███▏      | 32/100 [00:22<00:48,  1.39it/s] 33%|███▎      | 33/100 [00:23<00:48,  1.39it/s] 34%|███▍      | 34/100 [00:23<00:47,  1.38it/s] 35%|███▌      | 35/100 [00:24<00:46,  1.39it/s] 36%|███▌      | 36/100 [00:25<00:46,  1.39it/s] 37%|███▋      | 37/100 [00:25<00:45,  1.38it/s] 38%|███▊      | 38/100 [00:26<00:44,  1.38it/s] 39%|███▉      | 39/100 [00:27<00:44,  1.39it/s] 40%|████      | 40/100 [00:28<00:43,  1.39it/s] 41%|████      | 41/100 [00:28<00:42,  1.39it/s] 42%|████▏     | 42/100 [00:29<00:41,  1.39it/s] 43%|████▎     | 43/100 [00:30<00:41,  1.39it/s] 44%|████▍     | 44/100 [00:31<00:40,  1.38it/s] 45%|████▌     | 45/100 [00:31<00:39,  1.38it/s] 46%|████▌     | 46/100 [00:32<00:39,  1.38it/s] 47%|████▋     | 47/100 [00:33<00:38,  1.39it/s] 48%|████▊     | 48/100 [00:33<00:37,  1.39it/s] 49%|████▉     | 49/100 [00:34<00:36,  1.39it/s] 50%|█████     | 50/100 [00:35<00:35,  1.39it/s] 51%|█████     | 51/100 [00:36<00:35,  1.39it/s] 52%|█████▏    | 52/100 [00:36<00:34,  1.39it/s] 53%|█████▎    | 53/100 [00:37<00:33,  1.39it/s] 54%|█████▍    | 54/100 [00:38<00:33,  1.39it/s] 55%|█████▌    | 55/100 [00:38<00:32,  1.39it/s] 56%|█████▌    | 56/100 [00:39<00:31,  1.39it/s] 57%|█████▋    | 57/100 [00:40<00:31,  1.39it/s] 58%|█████▊    | 58/100 [00:41<00:30,  1.39it/s] 59%|█████▉    | 59/100 [00:41<00:29,  1.39it/s] 60%|██████    | 60/100 [00:42<00:28,  1.39it/s] 61%|██████    | 61/100 [00:43<00:28,  1.39it/s] 62%|██████▏   | 62/100 [00:43<00:27,  1.39it/s] 63%|██████▎   | 63/100 [00:44<00:26,  1.39it/s] 64%|██████▍   | 64/100 [00:45<00:25,  1.39it/s] 65%|██████▌   | 65/100 [00:46<00:25,  1.39it/s] 66%|██████▌   | 66/100 [00:46<00:24,  1.39it/s] 67%|██████▋   | 67/100 [00:47<00:23,  1.39it/s] 68%|██████▊   | 68/100 [00:48<00:23,  1.39it/s] 69%|██████▉   | 69/100 [00:49<00:22,  1.39it/s] 70%|███████   | 70/100 [00:49<00:21,  1.39it/s] 71%|███████   | 71/100 [00:50<00:20,  1.39it/s] 72%|███████▏  | 72/100 [00:51<00:20,  1.39it/s] 73%|███████▎  | 73/100 [00:51<00:19,  1.39it/s] 74%|███████▍  | 74/100 [00:52<00:18,  1.39it/s] 75%|███████▌  | 75/100 [00:53<00:18,  1.39it/s] 76%|███████▌  | 76/100 [00:54<00:17,  1.39it/s] 77%|███████▋  | 77/100 [00:54<00:16,  1.39it/s] 78%|███████▊  | 78/100 [00:55<00:15,  1.39it/s] 79%|███████▉  | 79/100 [00:56<00:15,  1.39it/s] 80%|████████  | 80/100 [00:56<00:14,  1.39it/s] 81%|████████  | 81/100 [00:57<00:13,  1.39it/s] 82%|████████▏ | 82/100 [00:58<00:12,  1.39it/s] 83%|████████▎ | 83/100 [00:59<00:12,  1.39it/s] 84%|████████▍ | 84/100 [00:59<00:11,  1.39it/s] 85%|████████▌ | 85/100 [01:00<00:10,  1.39it/s] 86%|████████▌ | 86/100 [01:01<00:10,  1.39it/s] 87%|████████▋ | 87/100 [01:01<00:09,  1.39it/s] 88%|████████▊ | 88/100 [01:02<00:08,  1.39it/s] 89%|████████▉ | 89/100 [01:03<00:07,  1.39it/s] 90%|█████████ | 90/100 [01:04<00:07,  1.39it/s] 91%|█████████ | 91/100 [01:04<00:06,  1.39it/s] 92%|█████████▏| 92/100 [01:05<00:05,  1.39it/s] 93%|█████████▎| 93/100 [01:06<00:05,  1.39it/s] 94%|█████████▍| 94/100 [01:07<00:04,  1.39it/s] 95%|█████████▌| 95/100 [01:07<00:03,  1.39it/s] 96%|█████████▌| 96/100 [01:08<00:02,  1.39it/s] 97%|█████████▋| 97/100 [01:09<00:02,  1.39it/s] 98%|█████████▊| 98/100 [01:09<00:01,  1.39it/s] 99%|█████████▉| 99/100 [01:10<00:00,  1.39it/s]100%|██████████| 100/100 [01:11<00:00,  1.39it/s]100%|██████████| 100/100 [01:11<00:00,  1.40it/s]
2023-06-14 19:25:19 [INFO] {
2023-06-14 19:25:19 [INFO]     'eval_loss': 1.1748887300491333,
2023-06-14 19:25:19 [INFO]     'eval_runtime': 72.0774,
2023-06-14 19:25:19 [INFO]     'eval_samples_per_second': 1.387,
2023-06-14 19:25:19 [INFO]     'eval_steps_per_second': 1.387
2023-06-14 19:25:19 [INFO] }
2023-06-14 19:25:19 [INFO] metric: 1.387
2023-06-14 19:25:19 [INFO] Throughput: 1.387 samples/sec
2023-06-14 19:25:19 [INFO] Tune 5 result is: [Accuracy (int8|fp32): 1.3870|1.6090, Duration (seconds) (int8|fp32): 72.0828|62.1355], Best tune result is: [Accuracy: 1.6050, Duration (seconds): 62.2975]
2023-06-14 19:25:19 [INFO] |**********************Tune Result Statistics**********************|
2023-06-14 19:25:19 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:25:19 [INFO] |     Info Type      | Baseline | Tune 5 result | Best tune result |
2023-06-14 19:25:19 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:25:19 [INFO] |      Accuracy      | 1.6090   |    1.3870     |     1.6050       |
2023-06-14 19:25:19 [INFO] | Duration (seconds) | 62.1355  |    72.0828    |     62.2975      |
2023-06-14 19:25:19 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:25:19 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-19-27/./history.snapshot.
2023-06-14 19:25:20 [INFO] Start to accumulate fallback to fp32.
2023-06-14 19:25:20 [INFO] |******Mixed Precision Statistics******|
2023-06-14 19:25:20 [INFO] +-------------+--------+------+--------+
2023-06-14 19:25:20 [INFO] |   Op Type   | Total  | INT8 |  FP32  |
2023-06-14 19:25:20 [INFO] +-------------+--------+------+--------+
2023-06-14 19:25:20 [INFO] |  Embedding  |   2    |  1   |   1    |
2023-06-14 19:25:20 [INFO] |    Linear   |   1    |  0   |   1    |
2023-06-14 19:25:20 [INFO] +-------------+--------+------+--------+
2023-06-14 19:25:20 [INFO] Pass quantize model elapsed time: 286.71 ms
2023-06-14 19:25:20 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: output, input, code.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:31,  3.09it/s]  3%|▎         | 3/100 [00:01<00:44,  2.18it/s]  4%|▍         | 4/100 [00:01<00:50,  1.91it/s]  5%|▌         | 5/100 [00:02<00:53,  1.77it/s]  6%|▌         | 6/100 [00:03<00:55,  1.70it/s]  7%|▋         | 7/100 [00:03<00:56,  1.66it/s]  8%|▊         | 8/100 [00:04<00:56,  1.63it/s]  9%|▉         | 9/100 [00:05<00:56,  1.60it/s] 10%|█         | 10/100 [00:05<00:56,  1.59it/s] 11%|█         | 11/100 [00:06<00:56,  1.58it/s] 12%|█▏        | 12/100 [00:07<00:55,  1.57it/s] 13%|█▎        | 13/100 [00:07<00:55,  1.57it/s] 14%|█▍        | 14/100 [00:08<00:54,  1.56it/s] 15%|█▌        | 15/100 [00:08<00:54,  1.57it/s] 16%|█▌        | 16/100 [00:09<00:53,  1.56it/s] 17%|█▋        | 17/100 [00:10<00:53,  1.56it/s] 18%|█▊        | 18/100 [00:10<00:52,  1.55it/s] 19%|█▉        | 19/100 [00:11<00:52,  1.55it/s] 20%|██        | 20/100 [00:12<00:51,  1.55it/s] 21%|██        | 21/100 [00:12<00:50,  1.56it/s] 22%|██▏       | 22/100 [00:13<00:50,  1.56it/s] 23%|██▎       | 23/100 [00:14<00:49,  1.56it/s] 24%|██▍       | 24/100 [00:14<00:48,  1.56it/s] 25%|██▌       | 25/100 [00:15<00:48,  1.56it/s] 26%|██▌       | 26/100 [00:16<00:47,  1.56it/s] 27%|██▋       | 27/100 [00:16<00:46,  1.56it/s] 28%|██▊       | 28/100 [00:17<00:46,  1.56it/s] 29%|██▉       | 29/100 [00:17<00:45,  1.56it/s] 30%|███       | 30/100 [00:18<00:44,  1.56it/s] 31%|███       | 31/100 [00:19<00:44,  1.56it/s] 32%|███▏      | 32/100 [00:19<00:43,  1.56it/s] 33%|███▎      | 33/100 [00:20<00:43,  1.55it/s] 34%|███▍      | 34/100 [00:21<00:42,  1.56it/s] 35%|███▌      | 35/100 [00:21<00:41,  1.56it/s] 36%|███▌      | 36/100 [00:22<00:40,  1.56it/s] 37%|███▋      | 37/100 [00:23<00:40,  1.56it/s] 38%|███▊      | 38/100 [00:23<00:39,  1.56it/s] 39%|███▉      | 39/100 [00:24<00:39,  1.56it/s] 40%|████      | 40/100 [00:25<00:38,  1.56it/s] 41%|████      | 41/100 [00:25<00:37,  1.56it/s] 42%|████▏     | 42/100 [00:26<00:37,  1.56it/s] 43%|████▎     | 43/100 [00:26<00:36,  1.55it/s] 44%|████▍     | 44/100 [00:27<00:35,  1.56it/s] 45%|████▌     | 45/100 [00:28<00:35,  1.56it/s] 46%|████▌     | 46/100 [00:28<00:34,  1.57it/s] 47%|████▋     | 47/100 [00:29<00:33,  1.57it/s] 48%|████▊     | 48/100 [00:30<00:33,  1.56it/s] 49%|████▉     | 49/100 [00:30<00:32,  1.56it/s] 50%|█████     | 50/100 [00:31<00:32,  1.56it/s] 51%|█████     | 51/100 [00:32<00:31,  1.56it/s] 52%|█████▏    | 52/100 [00:32<00:30,  1.56it/s] 53%|█████▎    | 53/100 [00:33<00:30,  1.56it/s] 54%|█████▍    | 54/100 [00:33<00:29,  1.55it/s] 55%|█████▌    | 55/100 [00:34<00:28,  1.56it/s] 56%|█████▌    | 56/100 [00:35<00:28,  1.55it/s] 57%|█████▋    | 57/100 [00:35<00:27,  1.55it/s] 58%|█████▊    | 58/100 [00:36<00:27,  1.55it/s] 59%|█████▉    | 59/100 [00:37<00:26,  1.55it/s] 60%|██████    | 60/100 [00:37<00:25,  1.55it/s] 61%|██████    | 61/100 [00:38<00:25,  1.55it/s] 62%|██████▏   | 62/100 [00:39<00:24,  1.55it/s] 63%|██████▎   | 63/100 [00:39<00:23,  1.55it/s] 64%|██████▍   | 64/100 [00:40<00:23,  1.55it/s] 65%|██████▌   | 65/100 [00:41<00:22,  1.55it/s] 66%|██████▌   | 66/100 [00:41<00:21,  1.55it/s] 67%|██████▋   | 67/100 [00:42<00:21,  1.56it/s] 68%|██████▊   | 68/100 [00:43<00:20,  1.56it/s] 69%|██████▉   | 69/100 [00:43<00:19,  1.56it/s] 70%|███████   | 70/100 [00:44<00:19,  1.56it/s] 71%|███████   | 71/100 [00:44<00:18,  1.56it/s] 72%|███████▏  | 72/100 [00:45<00:17,  1.57it/s] 73%|███████▎  | 73/100 [00:46<00:17,  1.56it/s] 74%|███████▍  | 74/100 [00:46<00:16,  1.57it/s] 75%|███████▌  | 75/100 [00:47<00:15,  1.57it/s] 76%|███████▌  | 76/100 [00:48<00:15,  1.57it/s] 77%|███████▋  | 77/100 [00:48<00:14,  1.57it/s] 78%|███████▊  | 78/100 [00:49<00:14,  1.57it/s] 79%|███████▉  | 79/100 [00:50<00:13,  1.57it/s] 80%|████████  | 80/100 [00:50<00:12,  1.55it/s] 81%|████████  | 81/100 [00:51<00:12,  1.56it/s] 82%|████████▏ | 82/100 [00:51<00:11,  1.55it/s] 83%|████████▎ | 83/100 [00:52<00:10,  1.56it/s] 84%|████████▍ | 84/100 [00:53<00:10,  1.56it/s] 85%|████████▌ | 85/100 [00:53<00:09,  1.56it/s] 86%|████████▌ | 86/100 [00:54<00:08,  1.56it/s] 87%|████████▋ | 87/100 [00:55<00:08,  1.56it/s] 88%|████████▊ | 88/100 [00:55<00:07,  1.56it/s] 89%|████████▉ | 89/100 [00:56<00:07,  1.56it/s] 90%|█████████ | 90/100 [00:57<00:06,  1.56it/s] 91%|█████████ | 91/100 [00:57<00:05,  1.56it/s] 92%|█████████▏| 92/100 [00:58<00:05,  1.56it/s] 93%|█████████▎| 93/100 [00:59<00:04,  1.56it/s] 94%|█████████▍| 94/100 [00:59<00:03,  1.55it/s] 95%|█████████▌| 95/100 [01:00<00:03,  1.56it/s] 96%|█████████▌| 96/100 [01:00<00:02,  1.56it/s] 97%|█████████▋| 97/100 [01:01<00:01,  1.57it/s] 98%|█████████▊| 98/100 [01:02<00:01,  1.57it/s] 99%|█████████▉| 99/100 [01:02<00:00,  1.56it/s]100%|██████████| 100/100 [01:03<00:00,  1.56it/s]100%|██████████| 100/100 [01:03<00:00,  1.57it/s]
2023-06-14 19:26:25 [INFO] {
2023-06-14 19:26:25 [INFO]     'eval_loss': 1.173661231994629,
2023-06-14 19:26:25 [INFO]     'eval_runtime': 64.1402,
2023-06-14 19:26:25 [INFO]     'eval_samples_per_second': 1.559,
2023-06-14 19:26:25 [INFO]     'eval_steps_per_second': 1.559
2023-06-14 19:26:25 [INFO] }
2023-06-14 19:26:25 [INFO] metric: 1.559
2023-06-14 19:26:25 [INFO] Throughput: 1.559 samples/sec
2023-06-14 19:26:25 [INFO] Tune 6 result is: [Accuracy (int8|fp32): 1.5590|1.6090, Duration (seconds) (int8|fp32): 64.1453|62.1355], Best tune result is: [Accuracy: 1.6050, Duration (seconds): 62.2975]
2023-06-14 19:26:25 [INFO] |**********************Tune Result Statistics**********************|
2023-06-14 19:26:25 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:26:25 [INFO] |     Info Type      | Baseline | Tune 6 result | Best tune result |
2023-06-14 19:26:25 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:26:25 [INFO] |      Accuracy      | 1.6090   |    1.5590     |     1.6050       |
2023-06-14 19:26:25 [INFO] | Duration (seconds) | 62.1355  |    64.1453    |     62.2975      |
2023-06-14 19:26:25 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:26:25 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-19-27/./history.snapshot.
2023-06-14 19:26:25 [WARNING] None of the submodule got qconfig applied. Make sure you passed correct configuration through `qconfig_dict` or by assigning the `.qconfig` attribute directly on submodules.
2023-06-14 19:26:25 [INFO] |******Mixed Precision Statistics******|
2023-06-14 19:26:25 [INFO] +-----------------+----------+---------+
2023-06-14 19:26:25 [INFO] |     Op Type     |  Total   |   FP32  |
2023-06-14 19:26:25 [INFO] +-----------------+----------+---------+
2023-06-14 19:26:25 [INFO] |    Embedding    |    2     |    2    |
2023-06-14 19:26:25 [INFO] |      Linear     |    1     |    1    |
2023-06-14 19:26:25 [INFO] +-----------------+----------+---------+
2023-06-14 19:26:25 [INFO] Pass quantize model elapsed time: 132.76 ms
2023-06-14 19:26:25 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: output, input, code.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:32,  2.99it/s]  3%|▎         | 3/100 [00:01<00:46,  2.09it/s]  4%|▍         | 4/100 [00:02<00:52,  1.82it/s]  5%|▌         | 5/100 [00:02<00:56,  1.69it/s]  6%|▌         | 6/100 [00:03<00:58,  1.62it/s]  7%|▋         | 7/100 [00:04<00:58,  1.58it/s]  8%|▊         | 8/100 [00:04<00:59,  1.55it/s]  9%|▉         | 9/100 [00:05<00:59,  1.53it/s] 10%|█         | 10/100 [00:06<00:59,  1.52it/s] 11%|█         | 11/100 [00:06<00:58,  1.51it/s] 12%|█▏        | 12/100 [00:07<00:58,  1.50it/s] 13%|█▎        | 13/100 [00:08<00:57,  1.50it/s] 14%|█▍        | 14/100 [00:08<00:57,  1.50it/s] 15%|█▌        | 15/100 [00:09<00:56,  1.50it/s] 16%|█▌        | 16/100 [00:10<00:56,  1.50it/s] 17%|█▋        | 17/100 [00:10<00:55,  1.50it/s] 18%|█▊        | 18/100 [00:11<00:54,  1.50it/s] 19%|█▉        | 19/100 [00:12<00:54,  1.50it/s] 20%|██        | 20/100 [00:12<00:53,  1.49it/s] 21%|██        | 21/100 [00:13<00:52,  1.49it/s] 22%|██▏       | 22/100 [00:14<00:52,  1.49it/s] 23%|██▎       | 23/100 [00:14<00:51,  1.49it/s] 24%|██▍       | 24/100 [00:15<00:51,  1.49it/s] 25%|██▌       | 25/100 [00:16<00:50,  1.49it/s] 26%|██▌       | 26/100 [00:16<00:49,  1.49it/s] 27%|██▋       | 27/100 [00:17<00:48,  1.49it/s] 28%|██▊       | 28/100 [00:18<00:48,  1.50it/s] 29%|██▉       | 29/100 [00:18<00:47,  1.50it/s] 30%|███       | 30/100 [00:19<00:46,  1.49it/s] 31%|███       | 31/100 [00:20<00:46,  1.50it/s] 32%|███▏      | 32/100 [00:20<00:45,  1.50it/s] 33%|███▎      | 33/100 [00:21<00:44,  1.50it/s] 34%|███▍      | 34/100 [00:22<00:43,  1.50it/s] 35%|███▌      | 35/100 [00:22<00:43,  1.50it/s] 36%|███▌      | 36/100 [00:23<00:42,  1.49it/s] 37%|███▋      | 37/100 [00:24<00:42,  1.49it/s] 38%|███▊      | 38/100 [00:24<00:41,  1.49it/s] 39%|███▉      | 39/100 [00:25<00:40,  1.49it/s] 40%|████      | 40/100 [00:26<00:40,  1.49it/s] 41%|████      | 41/100 [00:26<00:39,  1.49it/s] 42%|████▏     | 42/100 [00:27<00:38,  1.49it/s] 43%|████▎     | 43/100 [00:28<00:38,  1.49it/s] 44%|████▍     | 44/100 [00:28<00:37,  1.49it/s] 45%|████▌     | 45/100 [00:29<00:36,  1.49it/s] 46%|████▌     | 46/100 [00:30<00:36,  1.49it/s] 47%|████▋     | 47/100 [00:30<00:35,  1.49it/s] 48%|████▊     | 48/100 [00:31<00:34,  1.50it/s] 49%|████▉     | 49/100 [00:32<00:34,  1.49it/s] 50%|█████     | 50/100 [00:32<00:33,  1.49it/s] 51%|█████     | 51/100 [00:33<00:32,  1.49it/s] 52%|█████▏    | 52/100 [00:34<00:32,  1.49it/s] 53%|█████▎    | 53/100 [00:34<00:31,  1.49it/s] 54%|█████▍    | 54/100 [00:35<00:30,  1.49it/s] 55%|█████▌    | 55/100 [00:36<00:30,  1.49it/s] 56%|█████▌    | 56/100 [00:36<00:29,  1.49it/s] 57%|█████▋    | 57/100 [00:37<00:28,  1.49it/s] 58%|█████▊    | 58/100 [00:38<00:28,  1.49it/s] 59%|█████▉    | 59/100 [00:38<00:27,  1.48it/s] 60%|██████    | 60/100 [00:39<00:26,  1.49it/s] 61%|██████    | 61/100 [00:40<00:26,  1.49it/s] 62%|██████▏   | 62/100 [00:40<00:25,  1.49it/s] 63%|██████▎   | 63/100 [00:41<00:24,  1.49it/s] 64%|██████▍   | 64/100 [00:42<00:24,  1.49it/s] 65%|██████▌   | 65/100 [00:42<00:23,  1.49it/s] 66%|██████▌   | 66/100 [00:43<00:22,  1.48it/s] 67%|██████▋   | 67/100 [00:44<00:22,  1.48it/s] 68%|██████▊   | 68/100 [00:44<00:21,  1.48it/s] 69%|██████▉   | 69/100 [00:45<00:20,  1.48it/s] 70%|███████   | 70/100 [00:46<00:20,  1.49it/s] 71%|███████   | 71/100 [00:46<00:19,  1.49it/s] 72%|███████▏  | 72/100 [00:47<00:18,  1.49it/s] 73%|███████▎  | 73/100 [00:48<00:18,  1.49it/s] 74%|███████▍  | 74/100 [00:48<00:17,  1.49it/s] 75%|███████▌  | 75/100 [00:49<00:16,  1.49it/s] 76%|███████▌  | 76/100 [00:50<00:16,  1.49it/s] 77%|███████▋  | 77/100 [00:50<00:15,  1.49it/s] 78%|███████▊  | 78/100 [00:51<00:14,  1.49it/s] 79%|███████▉  | 79/100 [00:52<00:14,  1.49it/s] 80%|████████  | 80/100 [00:52<00:13,  1.49it/s] 81%|████████  | 81/100 [00:53<00:12,  1.49it/s] 82%|████████▏ | 82/100 [00:54<00:12,  1.49it/s] 83%|████████▎ | 83/100 [00:54<00:11,  1.49it/s] 84%|████████▍ | 84/100 [00:55<00:10,  1.49it/s] 85%|████████▌ | 85/100 [00:56<00:10,  1.49it/s] 86%|████████▌ | 86/100 [00:56<00:09,  1.49it/s] 87%|████████▋ | 87/100 [00:57<00:08,  1.49it/s] 88%|████████▊ | 88/100 [00:58<00:08,  1.49it/s] 89%|████████▉ | 89/100 [00:59<00:07,  1.49it/s] 90%|█████████ | 90/100 [00:59<00:06,  1.49it/s] 91%|█████████ | 91/100 [01:00<00:06,  1.48it/s] 92%|█████████▏| 92/100 [01:01<00:05,  1.49it/s] 93%|█████████▎| 93/100 [01:01<00:04,  1.49it/s] 94%|█████████▍| 94/100 [01:02<00:04,  1.49it/s] 95%|█████████▌| 95/100 [01:03<00:03,  1.48it/s] 96%|█████████▌| 96/100 [01:03<00:02,  1.48it/s] 97%|█████████▋| 97/100 [01:04<00:02,  1.48it/s] 98%|█████████▊| 98/100 [01:05<00:01,  1.48it/s] 99%|█████████▉| 99/100 [01:05<00:00,  1.48it/s]100%|██████████| 100/100 [01:06<00:00,  1.48it/s]100%|██████████| 100/100 [01:06<00:00,  1.51it/s]
2023-06-14 19:27:32 [INFO] {
2023-06-14 19:27:32 [INFO]     'eval_loss': 1.1736871004104614,
2023-06-14 19:27:32 [INFO]     'eval_runtime': 67.0977,
2023-06-14 19:27:32 [INFO]     'eval_samples_per_second': 1.49,
2023-06-14 19:27:32 [INFO]     'eval_steps_per_second': 1.49
2023-06-14 19:27:32 [INFO] }
2023-06-14 19:27:32 [INFO] metric: 1.49
2023-06-14 19:27:32 [INFO] Throughput: 1.49 samples/sec
2023-06-14 19:27:32 [INFO] Tune 7 result is: [Accuracy (int8|fp32): 1.4900|1.6090, Duration (seconds) (int8|fp32): 67.1034|62.1355], Best tune result is: [Accuracy: 1.6050, Duration (seconds): 62.2975]
2023-06-14 19:27:32 [INFO] |**********************Tune Result Statistics**********************|
2023-06-14 19:27:32 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:27:32 [INFO] |     Info Type      | Baseline | Tune 7 result | Best tune result |
2023-06-14 19:27:32 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:27:32 [INFO] |      Accuracy      | 1.6090   |    1.4900     |     1.6050       |
2023-06-14 19:27:32 [INFO] | Duration (seconds) | 62.1355  |    67.1034    |     62.2975      |
2023-06-14 19:27:32 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:27:32 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-19-27/./history.snapshot.
2023-06-14 19:27:33 [INFO] |******Mixed Precision Statistics******|
2023-06-14 19:27:33 [INFO] +-------------+--------+------+--------+
2023-06-14 19:27:33 [INFO] |   Op Type   | Total  | INT8 |  FP32  |
2023-06-14 19:27:33 [INFO] +-------------+--------+------+--------+
2023-06-14 19:27:33 [INFO] |  Embedding  |   2    |  1   |   1    |
2023-06-14 19:27:33 [INFO] |    Linear   |   1    |  1   |   0    |
2023-06-14 19:27:33 [INFO] +-------------+--------+------+--------+
2023-06-14 19:27:33 [INFO] Pass quantize model elapsed time: 920.19 ms
2023-06-14 19:27:33 [INFO] Specified timeout or max trials is reached! Found a quantized model which meet accuracy goal. Exit.
2023-06-14 19:27:33 [INFO] Save deploy yaml to /scratch/dsochirca/nc_workspace/2023-06-14_19-19-27/deploy.yaml
2023-06-14 19:27:33 [INFO] Saving model checkpoint to ./test_epoch
2023-06-14 19:27:50 [INFO] quantized model and configure file have saved to ./test_epoch
2023-06-14 19:27:58 [INFO] Saving model checkpoint to ./models/CodeGPT-Py150_0.6_sparse_q_only_weights_sym_per_channel
2023-06-14 19:28:17 [INFO] quantized model and configure file have saved to ./models/CodeGPT-Py150_0.6_sparse_q_only_weights_sym_per_channel
2023-06-14 19:28:18 [WARNING] Force convert framework model to neural_compressor model.
2023-06-14 19:28:18 [INFO] Pass query framework capability elapsed time: 1.13 ms
2023-06-14 19:28:18 [INFO] Adaptor has 1 recipes.
2023-06-14 19:28:18 [INFO] 0 recipes specified by user.
2023-06-14 19:28:18 [INFO] 0 recipes require future tuning.
2023-06-14 19:28:18 [INFO] ..............use_distributed_tuning: None
2023-06-14 19:28:18 [INFO] Get FP32 model baseline.
2023-06-14 19:28:18 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: output, input, code.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:34,  2.81it/s]  3%|▎         | 3/100 [00:01<00:50,  1.94it/s]  4%|▍         | 4/100 [00:02<00:55,  1.72it/s]  5%|▌         | 5/100 [00:02<00:58,  1.61it/s]  6%|▌         | 6/100 [00:03<01:01,  1.54it/s]  7%|▋         | 7/100 [00:04<01:02,  1.50it/s]  8%|▊         | 8/100 [00:04<01:03,  1.45it/s]  9%|▉         | 9/100 [00:05<01:03,  1.43it/s] 10%|█         | 10/100 [00:06<01:03,  1.42it/s] 11%|█         | 11/100 [00:07<01:02,  1.41it/s] 12%|█▏        | 12/100 [00:07<01:03,  1.39it/s] 13%|█▎        | 13/100 [00:08<01:01,  1.41it/s] 14%|█▍        | 14/100 [00:09<01:00,  1.42it/s] 15%|█▌        | 15/100 [00:09<00:59,  1.43it/s] 16%|█▌        | 16/100 [00:10<00:58,  1.43it/s] 17%|█▋        | 17/100 [00:11<00:57,  1.43it/s] 18%|█▊        | 18/100 [00:12<00:56,  1.44it/s] 19%|█▉        | 19/100 [00:12<00:57,  1.41it/s] 20%|██        | 20/100 [00:13<00:55,  1.43it/s] 21%|██        | 21/100 [00:14<00:55,  1.41it/s] 22%|██▏       | 22/100 [00:14<00:54,  1.43it/s] 23%|██▎       | 23/100 [00:15<00:53,  1.43it/s] 24%|██▍       | 24/100 [00:16<00:52,  1.44it/s] 25%|██▌       | 25/100 [00:16<00:52,  1.44it/s] 26%|██▌       | 26/100 [00:17<00:51,  1.44it/s] 27%|██▋       | 27/100 [00:18<00:51,  1.42it/s] 28%|██▊       | 28/100 [00:19<00:50,  1.42it/s] 29%|██▉       | 29/100 [00:19<00:50,  1.41it/s] 30%|███       | 30/100 [00:20<00:49,  1.43it/s] 31%|███       | 31/100 [00:21<00:48,  1.42it/s] 32%|███▏      | 32/100 [00:21<00:48,  1.39it/s] 33%|███▎      | 33/100 [00:22<00:47,  1.40it/s] 34%|███▍      | 34/100 [00:23<00:46,  1.41it/s] 35%|███▌      | 35/100 [00:24<00:46,  1.41it/s] 36%|███▌      | 36/100 [00:24<00:45,  1.41it/s] 37%|███▋      | 37/100 [00:25<00:44,  1.42it/s] 38%|███▊      | 38/100 [00:26<00:43,  1.42it/s] 39%|███▉      | 39/100 [00:26<00:42,  1.43it/s] 40%|████      | 40/100 [00:27<00:42,  1.41it/s] 41%|████      | 41/100 [00:28<00:42,  1.39it/s] 42%|████▏     | 42/100 [00:29<00:41,  1.40it/s] 43%|████▎     | 43/100 [00:29<00:40,  1.42it/s] 44%|████▍     | 44/100 [00:30<00:39,  1.42it/s] 45%|████▌     | 45/100 [00:31<00:38,  1.42it/s] 46%|████▌     | 46/100 [00:31<00:37,  1.44it/s] 47%|████▋     | 47/100 [00:32<00:36,  1.43it/s] 48%|████▊     | 48/100 [00:33<00:36,  1.44it/s] 49%|████▉     | 49/100 [00:33<00:36,  1.41it/s] 50%|█████     | 50/100 [00:34<00:36,  1.39it/s] 51%|█████     | 51/100 [00:35<00:35,  1.37it/s] 52%|█████▏    | 52/100 [00:36<00:35,  1.37it/s] 53%|█████▎    | 53/100 [00:36<00:33,  1.39it/s] 54%|█████▍    | 54/100 [00:37<00:33,  1.38it/s] 55%|█████▌    | 55/100 [00:38<00:32,  1.37it/s] 56%|█████▌    | 56/100 [00:39<00:31,  1.39it/s] 57%|█████▋    | 57/100 [00:39<00:31,  1.39it/s] 58%|█████▊    | 58/100 [00:40<00:29,  1.41it/s] 59%|█████▉    | 59/100 [00:41<00:29,  1.40it/s] 60%|██████    | 60/100 [00:41<00:28,  1.39it/s] 61%|██████    | 61/100 [00:42<00:27,  1.41it/s] 62%|██████▏   | 62/100 [00:43<00:27,  1.40it/s] 63%|██████▎   | 63/100 [00:43<00:26,  1.41it/s] 64%|██████▍   | 64/100 [00:44<00:25,  1.40it/s] 65%|██████▌   | 65/100 [00:45<00:24,  1.43it/s] 66%|██████▌   | 66/100 [00:46<00:23,  1.43it/s] 67%|██████▋   | 67/100 [00:46<00:23,  1.43it/s] 68%|██████▊   | 68/100 [00:47<00:22,  1.42it/s] 69%|██████▉   | 69/100 [00:48<00:21,  1.43it/s] 70%|███████   | 70/100 [00:48<00:20,  1.43it/s] 71%|███████   | 71/100 [00:49<00:20,  1.44it/s] 72%|███████▏  | 72/100 [00:50<00:20,  1.40it/s] 73%|███████▎  | 73/100 [00:51<00:19,  1.40it/s] 74%|███████▍  | 74/100 [00:51<00:18,  1.42it/s] 75%|███████▌  | 75/100 [00:52<00:17,  1.42it/s] 76%|███████▌  | 76/100 [00:53<00:16,  1.43it/s] 77%|███████▋  | 77/100 [00:53<00:15,  1.44it/s] 78%|███████▊  | 78/100 [00:54<00:15,  1.42it/s] 79%|███████▉  | 79/100 [00:55<00:14,  1.41it/s] 80%|████████  | 80/100 [00:55<00:14,  1.40it/s] 81%|████████  | 81/100 [00:56<00:13,  1.42it/s] 82%|████████▏ | 82/100 [00:57<00:12,  1.44it/s] 83%|████████▎ | 83/100 [00:58<00:11,  1.44it/s] 84%|████████▍ | 84/100 [00:58<00:11,  1.40it/s] 85%|████████▌ | 85/100 [00:59<00:10,  1.39it/s] 86%|████████▌ | 86/100 [01:00<00:10,  1.40it/s] 87%|████████▋ | 87/100 [01:00<00:09,  1.38it/s] 88%|████████▊ | 88/100 [01:01<00:08,  1.41it/s] 89%|████████▉ | 89/100 [01:02<00:07,  1.43it/s] 90%|█████████ | 90/100 [01:02<00:06,  1.44it/s] 91%|█████████ | 91/100 [01:03<00:06,  1.45it/s] 92%|█████████▏| 92/100 [01:04<00:05,  1.46it/s] 93%|█████████▎| 93/100 [01:05<00:04,  1.44it/s] 94%|█████████▍| 94/100 [01:05<00:04,  1.44it/s] 95%|█████████▌| 95/100 [01:06<00:03,  1.44it/s] 96%|█████████▌| 96/100 [01:07<00:02,  1.44it/s] 97%|█████████▋| 97/100 [01:07<00:02,  1.45it/s] 98%|█████████▊| 98/100 [01:08<00:01,  1.45it/s] 99%|█████████▉| 99/100 [01:09<00:00,  1.43it/s]100%|██████████| 100/100 [01:09<00:00,  1.41it/s]100%|██████████| 100/100 [01:09<00:00,  1.43it/s]
2023-06-14 19:29:29 [INFO] {
2023-06-14 19:29:29 [INFO]     'eval_loss': 1.1736871004104614,
2023-06-14 19:29:29 [INFO]     'eval_runtime': 70.6979,
2023-06-14 19:29:29 [INFO]     'eval_samples_per_second': 1.414,
2023-06-14 19:29:29 [INFO]     'eval_steps_per_second': 1.414
2023-06-14 19:29:29 [INFO] }
2023-06-14 19:29:29 [INFO] metric: 1.414
2023-06-14 19:29:29 [INFO] Throughput: 1.414 samples/sec
2023-06-14 19:29:29 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-19-27/./history.snapshot.
2023-06-14 19:29:29 [INFO] FP32 baseline is: [Accuracy: 1.4140, Duration (seconds): 70.7175]
2023-06-14 19:29:30 [INFO] |******Mixed Precision Statistics******|
2023-06-14 19:29:30 [INFO] +-----------------+----------+---------+
2023-06-14 19:29:30 [INFO] |     Op Type     |  Total   |   INT8  |
2023-06-14 19:29:30 [INFO] +-----------------+----------+---------+
2023-06-14 19:29:30 [INFO] |    Embedding    |    2     |    2    |
2023-06-14 19:29:30 [INFO] |      Linear     |    1     |    1    |
2023-06-14 19:29:30 [INFO] +-----------------+----------+---------+
2023-06-14 19:29:30 [INFO] Pass quantize model elapsed time: 947.95 ms
2023-06-14 19:29:30 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: output, input, code.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:30,  3.19it/s]  3%|▎         | 3/100 [00:01<00:43,  2.25it/s]  4%|▍         | 4/100 [00:01<00:49,  1.95it/s]  5%|▌         | 5/100 [00:02<00:52,  1.81it/s]  6%|▌         | 6/100 [00:03<00:54,  1.73it/s]  7%|▋         | 7/100 [00:03<00:55,  1.68it/s]  8%|▊         | 8/100 [00:04<00:55,  1.65it/s]  9%|▉         | 9/100 [00:05<00:55,  1.63it/s] 10%|█         | 10/100 [00:05<00:55,  1.62it/s] 11%|█         | 11/100 [00:06<00:55,  1.61it/s] 12%|█▏        | 12/100 [00:06<00:54,  1.60it/s] 13%|█▎        | 13/100 [00:07<00:54,  1.60it/s] 14%|█▍        | 14/100 [00:08<00:53,  1.60it/s] 15%|█▌        | 15/100 [00:08<00:53,  1.60it/s] 16%|█▌        | 16/100 [00:09<00:52,  1.59it/s] 17%|█▋        | 17/100 [00:10<00:52,  1.59it/s] 18%|█▊        | 18/100 [00:10<00:51,  1.59it/s] 19%|█▉        | 19/100 [00:11<00:50,  1.59it/s] 20%|██        | 20/100 [00:11<00:50,  1.59it/s] 21%|██        | 21/100 [00:12<00:49,  1.59it/s] 22%|██▏       | 22/100 [00:13<00:49,  1.59it/s] 23%|██▎       | 23/100 [00:13<00:48,  1.59it/s] 24%|██▍       | 24/100 [00:14<00:47,  1.59it/s] 25%|██▌       | 25/100 [00:15<00:47,  1.59it/s] 26%|██▌       | 26/100 [00:15<00:46,  1.59it/s] 27%|██▋       | 27/100 [00:16<00:45,  1.59it/s] 28%|██▊       | 28/100 [00:16<00:45,  1.59it/s] 29%|██▉       | 29/100 [00:17<00:44,  1.59it/s] 30%|███       | 30/100 [00:18<00:43,  1.59it/s] 31%|███       | 31/100 [00:18<00:43,  1.59it/s] 32%|███▏      | 32/100 [00:19<00:42,  1.59it/s] 33%|███▎      | 33/100 [00:20<00:42,  1.59it/s] 34%|███▍      | 34/100 [00:20<00:41,  1.59it/s] 35%|███▌      | 35/100 [00:21<00:40,  1.59it/s] 36%|███▌      | 36/100 [00:22<00:40,  1.59it/s] 37%|███▋      | 37/100 [00:22<00:39,  1.59it/s] 38%|███▊      | 38/100 [00:23<00:38,  1.59it/s] 39%|███▉      | 39/100 [00:23<00:38,  1.59it/s] 40%|████      | 40/100 [00:24<00:37,  1.59it/s] 41%|████      | 41/100 [00:25<00:37,  1.59it/s] 42%|████▏     | 42/100 [00:25<00:36,  1.59it/s] 43%|████▎     | 43/100 [00:26<00:35,  1.59it/s] 44%|████▍     | 44/100 [00:27<00:35,  1.59it/s] 45%|████▌     | 45/100 [00:27<00:34,  1.59it/s] 46%|████▌     | 46/100 [00:28<00:33,  1.59it/s] 47%|████▋     | 47/100 [00:28<00:33,  1.59it/s] 48%|████▊     | 48/100 [00:29<00:33,  1.57it/s] 49%|████▉     | 49/100 [00:30<00:32,  1.57it/s] 50%|█████     | 50/100 [00:30<00:31,  1.58it/s] 51%|█████     | 51/100 [00:31<00:31,  1.58it/s] 52%|█████▏    | 52/100 [00:32<00:30,  1.58it/s] 53%|█████▎    | 53/100 [00:32<00:29,  1.58it/s] 54%|█████▍    | 54/100 [00:33<00:28,  1.59it/s] 55%|█████▌    | 55/100 [00:33<00:28,  1.58it/s] 56%|█████▌    | 56/100 [00:34<00:27,  1.59it/s] 57%|█████▋    | 57/100 [00:35<00:27,  1.59it/s] 58%|█████▊    | 58/100 [00:35<00:26,  1.59it/s] 59%|█████▉    | 59/100 [00:36<00:25,  1.59it/s] 60%|██████    | 60/100 [00:37<00:25,  1.59it/s] 61%|██████    | 61/100 [00:37<00:24,  1.59it/s] 62%|██████▏   | 62/100 [00:38<00:23,  1.59it/s] 63%|██████▎   | 63/100 [00:39<00:23,  1.59it/s] 64%|██████▍   | 64/100 [00:39<00:22,  1.59it/s] 65%|██████▌   | 65/100 [00:40<00:22,  1.59it/s] 66%|██████▌   | 66/100 [00:40<00:21,  1.59it/s] 67%|██████▋   | 67/100 [00:41<00:20,  1.59it/s] 68%|██████▊   | 68/100 [00:42<00:20,  1.59it/s] 69%|██████▉   | 69/100 [00:42<00:19,  1.59it/s] 70%|███████   | 70/100 [00:43<00:18,  1.59it/s] 71%|███████   | 71/100 [00:44<00:18,  1.59it/s] 72%|███████▏  | 72/100 [00:44<00:17,  1.59it/s] 73%|███████▎  | 73/100 [00:45<00:16,  1.59it/s] 74%|███████▍  | 74/100 [00:45<00:16,  1.59it/s] 75%|███████▌  | 75/100 [00:46<00:15,  1.59it/s] 76%|███████▌  | 76/100 [00:47<00:15,  1.59it/s] 77%|███████▋  | 77/100 [00:47<00:14,  1.59it/s] 78%|███████▊  | 78/100 [00:48<00:13,  1.59it/s] 79%|███████▉  | 79/100 [00:49<00:13,  1.59it/s] 80%|████████  | 80/100 [00:49<00:12,  1.59it/s] 81%|████████  | 81/100 [00:50<00:11,  1.59it/s] 82%|████████▏ | 82/100 [00:50<00:11,  1.59it/s] 83%|████████▎ | 83/100 [00:51<00:10,  1.59it/s] 84%|████████▍ | 84/100 [00:52<00:10,  1.59it/s] 85%|████████▌ | 85/100 [00:52<00:09,  1.59it/s] 86%|████████▌ | 86/100 [00:53<00:08,  1.59it/s] 87%|████████▋ | 87/100 [00:54<00:08,  1.59it/s] 88%|████████▊ | 88/100 [00:54<00:07,  1.59it/s] 89%|████████▉ | 89/100 [00:55<00:06,  1.59it/s] 90%|█████████ | 90/100 [00:55<00:06,  1.59it/s] 91%|█████████ | 91/100 [00:56<00:05,  1.59it/s] 92%|█████████▏| 92/100 [00:57<00:05,  1.59it/s] 93%|█████████▎| 93/100 [00:57<00:04,  1.59it/s] 94%|█████████▍| 94/100 [00:58<00:03,  1.59it/s] 95%|█████████▌| 95/100 [00:59<00:03,  1.59it/s] 96%|█████████▌| 96/100 [00:59<00:02,  1.59it/s] 97%|█████████▋| 97/100 [01:00<00:01,  1.59it/s] 98%|█████████▊| 98/100 [01:00<00:01,  1.59it/s] 99%|█████████▉| 99/100 [01:01<00:00,  1.59it/s]100%|██████████| 100/100 [01:02<00:00,  1.59it/s]100%|██████████| 100/100 [01:02<00:00,  1.61it/s]
2023-06-14 19:30:33 [INFO] {
2023-06-14 19:30:33 [INFO]     'eval_loss': 1.1748971939086914,
2023-06-14 19:30:33 [INFO]     'eval_runtime': 62.8812,
2023-06-14 19:30:33 [INFO]     'eval_samples_per_second': 1.59,
2023-06-14 19:30:33 [INFO]     'eval_steps_per_second': 1.59
2023-06-14 19:30:33 [INFO] }
2023-06-14 19:30:33 [INFO] metric: 1.59
2023-06-14 19:30:33 [INFO] Throughput: 1.59 samples/sec
2023-06-14 19:30:33 [INFO] Tune 1 result is: [Accuracy (int8|fp32): 1.5900|1.4140, Duration (seconds) (int8|fp32): 62.8859|70.7175], Best tune result is: [Accuracy: 1.5900, Duration (seconds): 62.8859]
2023-06-14 19:30:33 [INFO] |**********************Tune Result Statistics**********************|
2023-06-14 19:30:33 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:30:33 [INFO] |     Info Type      | Baseline | Tune 1 result | Best tune result |
2023-06-14 19:30:33 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:30:33 [INFO] |      Accuracy      | 1.4140   |    1.5900     |     1.5900       |
2023-06-14 19:30:33 [INFO] | Duration (seconds) | 70.7175  |    62.8859    |     62.8859      |
2023-06-14 19:30:33 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:30:33 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-19-27/./history.snapshot.
2023-06-14 19:30:33 [INFO] Apply all recipes.
2023-06-14 19:30:33 [WARNING] Find evaluated tuning config, skip.
2023-06-14 19:30:33 [INFO] Apply recipe one by one.
2023-06-14 19:30:33 [INFO] Start to fallback op to fp32 one by one.
2023-06-14 19:30:33 [INFO] |******Mixed Precision Statistics******|
2023-06-14 19:30:33 [INFO] +-------------+--------+------+--------+
2023-06-14 19:30:33 [INFO] |   Op Type   | Total  | INT8 |  FP32  |
2023-06-14 19:30:33 [INFO] +-------------+--------+------+--------+
2023-06-14 19:30:33 [INFO] |  Embedding  |   2    |  2   |   0    |
2023-06-14 19:30:33 [INFO] |    Linear   |   1    |  0   |   1    |
2023-06-14 19:30:33 [INFO] +-------------+--------+------+--------+
2023-06-14 19:30:33 [INFO] Pass quantize model elapsed time: 254.19 ms
2023-06-14 19:30:33 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: output, input, code.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:31,  3.10it/s]  3%|▎         | 3/100 [00:01<00:44,  2.18it/s]  4%|▍         | 4/100 [00:01<00:50,  1.89it/s]  5%|▌         | 5/100 [00:02<00:54,  1.75it/s]  6%|▌         | 6/100 [00:03<00:56,  1.68it/s]  7%|▋         | 7/100 [00:03<00:56,  1.63it/s]  8%|▊         | 8/100 [00:04<00:57,  1.60it/s]  9%|▉         | 9/100 [00:05<00:57,  1.59it/s] 10%|█         | 10/100 [00:05<00:57,  1.57it/s] 11%|█         | 11/100 [00:06<00:56,  1.57it/s] 12%|█▏        | 12/100 [00:07<00:56,  1.56it/s] 13%|█▎        | 13/100 [00:07<00:55,  1.55it/s] 14%|█▍        | 14/100 [00:08<00:55,  1.55it/s] 15%|█▌        | 15/100 [00:09<00:54,  1.55it/s] 16%|█▌        | 16/100 [00:09<00:54,  1.55it/s] 17%|█▋        | 17/100 [00:10<00:53,  1.55it/s] 18%|█▊        | 18/100 [00:11<00:53,  1.55it/s] 19%|█▉        | 19/100 [00:11<00:52,  1.55it/s] 20%|██        | 20/100 [00:12<00:51,  1.55it/s] 21%|██        | 21/100 [00:12<00:51,  1.55it/s] 22%|██▏       | 22/100 [00:13<00:50,  1.55it/s] 23%|██▎       | 23/100 [00:14<00:49,  1.55it/s] 24%|██▍       | 24/100 [00:14<00:49,  1.55it/s] 25%|██▌       | 25/100 [00:15<00:48,  1.55it/s] 26%|██▌       | 26/100 [00:16<00:47,  1.55it/s] 27%|██▋       | 27/100 [00:16<00:47,  1.55it/s] 28%|██▊       | 28/100 [00:17<00:46,  1.55it/s] 29%|██▉       | 29/100 [00:18<00:45,  1.54it/s] 30%|███       | 30/100 [00:18<00:45,  1.55it/s] 31%|███       | 31/100 [00:19<00:44,  1.55it/s] 32%|███▏      | 32/100 [00:20<00:44,  1.54it/s] 33%|███▎      | 33/100 [00:20<00:43,  1.54it/s] 34%|███▍      | 34/100 [00:21<00:42,  1.54it/s] 35%|███▌      | 35/100 [00:22<00:42,  1.54it/s] 36%|███▌      | 36/100 [00:22<00:41,  1.54it/s] 37%|███▋      | 37/100 [00:23<00:40,  1.54it/s] 38%|███▊      | 38/100 [00:23<00:40,  1.55it/s] 39%|███▉      | 39/100 [00:24<00:39,  1.55it/s] 40%|████      | 40/100 [00:25<00:38,  1.55it/s] 41%|████      | 41/100 [00:25<00:38,  1.55it/s] 42%|████▏     | 42/100 [00:26<00:37,  1.55it/s] 43%|████▎     | 43/100 [00:27<00:36,  1.54it/s] 44%|████▍     | 44/100 [00:27<00:36,  1.54it/s] 45%|████▌     | 45/100 [00:28<00:35,  1.54it/s] 46%|████▌     | 46/100 [00:29<00:35,  1.54it/s] 47%|████▋     | 47/100 [00:29<00:34,  1.54it/s] 48%|████▊     | 48/100 [00:30<00:33,  1.54it/s] 49%|████▉     | 49/100 [00:31<00:33,  1.54it/s] 50%|█████     | 50/100 [00:31<00:32,  1.54it/s] 51%|█████     | 51/100 [00:32<00:31,  1.54it/s] 52%|█████▏    | 52/100 [00:33<00:31,  1.54it/s] 53%|█████▎    | 53/100 [00:33<00:30,  1.54it/s] 54%|█████▍    | 54/100 [00:34<00:29,  1.55it/s] 55%|█████▌    | 55/100 [00:34<00:29,  1.54it/s] 56%|█████▌    | 56/100 [00:35<00:28,  1.54it/s] 57%|█████▋    | 57/100 [00:36<00:27,  1.55it/s] 58%|█████▊    | 58/100 [00:36<00:27,  1.55it/s] 59%|█████▉    | 59/100 [00:37<00:26,  1.55it/s] 60%|██████    | 60/100 [00:38<00:25,  1.55it/s] 61%|██████    | 61/100 [00:38<00:25,  1.55it/s] 62%|██████▏   | 62/100 [00:39<00:24,  1.54it/s] 63%|██████▎   | 63/100 [00:40<00:23,  1.54it/s] 64%|██████▍   | 64/100 [00:40<00:23,  1.54it/s] 65%|██████▌   | 65/100 [00:41<00:22,  1.54it/s] 66%|██████▌   | 66/100 [00:42<00:21,  1.55it/s] 67%|██████▋   | 67/100 [00:42<00:21,  1.55it/s] 68%|██████▊   | 68/100 [00:43<00:20,  1.55it/s] 69%|██████▉   | 69/100 [00:44<00:20,  1.55it/s] 70%|███████   | 70/100 [00:44<00:19,  1.55it/s] 71%|███████   | 71/100 [00:45<00:18,  1.55it/s] 72%|███████▏  | 72/100 [00:45<00:18,  1.54it/s] 73%|███████▎  | 73/100 [00:46<00:17,  1.55it/s] 74%|███████▍  | 74/100 [00:47<00:16,  1.55it/s] 75%|███████▌  | 75/100 [00:47<00:16,  1.55it/s] 76%|███████▌  | 76/100 [00:48<00:15,  1.55it/s] 77%|███████▋  | 77/100 [00:49<00:14,  1.55it/s] 78%|███████▊  | 78/100 [00:49<00:14,  1.55it/s] 79%|███████▉  | 79/100 [00:50<00:13,  1.54it/s] 80%|████████  | 80/100 [00:51<00:12,  1.55it/s] 81%|████████  | 81/100 [00:51<00:12,  1.55it/s] 82%|████████▏ | 82/100 [00:52<00:11,  1.55it/s] 83%|████████▎ | 83/100 [00:53<00:10,  1.55it/s] 84%|████████▍ | 84/100 [00:53<00:10,  1.55it/s] 85%|████████▌ | 85/100 [00:54<00:09,  1.55it/s] 86%|████████▌ | 86/100 [00:55<00:09,  1.55it/s] 87%|████████▋ | 87/100 [00:55<00:08,  1.55it/s] 88%|████████▊ | 88/100 [00:56<00:07,  1.55it/s] 89%|████████▉ | 89/100 [00:56<00:07,  1.55it/s] 90%|█████████ | 90/100 [00:57<00:06,  1.55it/s] 91%|█████████ | 91/100 [00:58<00:05,  1.54it/s] 92%|█████████▏| 92/100 [00:58<00:05,  1.54it/s] 93%|█████████▎| 93/100 [00:59<00:04,  1.55it/s] 94%|█████████▍| 94/100 [01:00<00:03,  1.55it/s] 95%|█████████▌| 95/100 [01:00<00:03,  1.55it/s] 96%|█████████▌| 96/100 [01:01<00:02,  1.55it/s] 97%|█████████▋| 97/100 [01:02<00:01,  1.55it/s] 98%|█████████▊| 98/100 [01:02<00:01,  1.54it/s] 99%|█████████▉| 99/100 [01:03<00:00,  1.54it/s]100%|██████████| 100/100 [01:04<00:00,  1.55it/s]100%|██████████| 100/100 [01:04<00:00,  1.56it/s]
2023-06-14 19:31:38 [INFO] {
2023-06-14 19:31:38 [INFO]     'eval_loss': 1.1737359762191772,
2023-06-14 19:31:38 [INFO]     'eval_runtime': 64.7278,
2023-06-14 19:31:38 [INFO]     'eval_samples_per_second': 1.545,
2023-06-14 19:31:38 [INFO]     'eval_steps_per_second': 1.545
2023-06-14 19:31:38 [INFO] }
2023-06-14 19:31:38 [INFO] metric: 1.545
2023-06-14 19:31:38 [INFO] Throughput: 1.545 samples/sec
2023-06-14 19:31:38 [INFO] Tune 3 result is: [Accuracy (int8|fp32): 1.5450|1.4140, Duration (seconds) (int8|fp32): 64.7337|70.7175], Best tune result is: [Accuracy: 1.5900, Duration (seconds): 62.8859]
2023-06-14 19:31:38 [INFO] |**********************Tune Result Statistics**********************|
2023-06-14 19:31:38 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:31:38 [INFO] |     Info Type      | Baseline | Tune 3 result | Best tune result |
2023-06-14 19:31:38 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:31:38 [INFO] |      Accuracy      | 1.4140   |    1.5450     |     1.5900       |
2023-06-14 19:31:38 [INFO] | Duration (seconds) | 70.7175  |    64.7337    |     62.8859      |
2023-06-14 19:31:38 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:31:38 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-19-27/./history.snapshot.
2023-06-14 19:31:39 [INFO] |******Mixed Precision Statistics******|
2023-06-14 19:31:39 [INFO] +-------------+--------+------+--------+
2023-06-14 19:31:39 [INFO] |   Op Type   | Total  | INT8 |  FP32  |
2023-06-14 19:31:39 [INFO] +-------------+--------+------+--------+
2023-06-14 19:31:39 [INFO] |  Embedding  |   2    |  1   |   1    |
2023-06-14 19:31:39 [INFO] |    Linear   |   1    |  1   |   0    |
2023-06-14 19:31:39 [INFO] +-------------+--------+------+--------+
2023-06-14 19:31:39 [INFO] Pass quantize model elapsed time: 941.23 ms
2023-06-14 19:31:39 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: output, input, code.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:32,  3.06it/s]  3%|▎         | 3/100 [00:01<00:44,  2.16it/s]  4%|▍         | 4/100 [00:01<00:50,  1.88it/s]  5%|▌         | 5/100 [00:02<00:54,  1.74it/s]  6%|▌         | 6/100 [00:03<00:56,  1.66it/s]  7%|▋         | 7/100 [00:03<00:57,  1.63it/s]  8%|▊         | 8/100 [00:04<00:57,  1.59it/s]  9%|▉         | 9/100 [00:05<00:57,  1.58it/s] 10%|█         | 10/100 [00:05<00:57,  1.56it/s] 11%|█         | 11/100 [00:06<00:56,  1.57it/s] 12%|█▏        | 12/100 [00:07<00:56,  1.56it/s] 13%|█▎        | 13/100 [00:07<00:56,  1.55it/s] 14%|█▍        | 14/100 [00:08<00:55,  1.55it/s] 15%|█▌        | 15/100 [00:09<00:54,  1.56it/s] 16%|█▌        | 16/100 [00:09<00:53,  1.57it/s] 17%|█▋        | 17/100 [00:10<00:53,  1.56it/s] 18%|█▊        | 18/100 [00:10<00:52,  1.56it/s] 19%|█▉        | 19/100 [00:11<00:52,  1.55it/s] 20%|██        | 20/100 [00:12<00:51,  1.54it/s] 21%|██        | 21/100 [00:12<00:51,  1.54it/s] 22%|██▏       | 22/100 [00:13<00:50,  1.54it/s] 23%|██▎       | 23/100 [00:14<00:49,  1.54it/s] 24%|██▍       | 24/100 [00:14<00:49,  1.54it/s] 25%|██▌       | 25/100 [00:15<00:48,  1.53it/s] 26%|██▌       | 26/100 [00:16<00:48,  1.54it/s] 27%|██▋       | 27/100 [00:16<00:47,  1.54it/s] 28%|██▊       | 28/100 [00:17<00:46,  1.55it/s] 29%|██▉       | 29/100 [00:18<00:45,  1.56it/s] 30%|███       | 30/100 [00:18<00:44,  1.57it/s] 31%|███       | 31/100 [00:19<00:44,  1.55it/s] 32%|███▏      | 32/100 [00:20<00:43,  1.55it/s] 33%|███▎      | 33/100 [00:20<00:43,  1.54it/s] 34%|███▍      | 34/100 [00:21<00:43,  1.53it/s] 35%|███▌      | 35/100 [00:22<00:42,  1.55it/s] 36%|███▌      | 36/100 [00:22<00:41,  1.54it/s] 37%|███▋      | 37/100 [00:23<00:40,  1.54it/s] 38%|███▊      | 38/100 [00:23<00:40,  1.53it/s] 39%|███▉      | 39/100 [00:24<00:39,  1.53it/s] 40%|████      | 40/100 [00:25<00:39,  1.53it/s] 41%|████      | 41/100 [00:25<00:38,  1.54it/s] 42%|████▏     | 42/100 [00:26<00:37,  1.55it/s] 43%|████▎     | 43/100 [00:27<00:36,  1.56it/s] 44%|████▍     | 44/100 [00:27<00:35,  1.56it/s] 45%|████▌     | 45/100 [00:28<00:35,  1.57it/s] 46%|████▌     | 46/100 [00:29<00:34,  1.57it/s] 47%|████▋     | 47/100 [00:29<00:33,  1.57it/s] 48%|████▊     | 48/100 [00:30<00:33,  1.56it/s] 49%|████▉     | 49/100 [00:31<00:32,  1.55it/s] 50%|█████     | 50/100 [00:31<00:32,  1.55it/s] 51%|█████     | 51/100 [00:32<00:31,  1.56it/s] 52%|█████▏    | 52/100 [00:32<00:30,  1.57it/s] 53%|█████▎    | 53/100 [00:33<00:30,  1.56it/s] 54%|█████▍    | 54/100 [00:34<00:29,  1.55it/s] 55%|█████▌    | 55/100 [00:34<00:28,  1.56it/s] 56%|█████▌    | 56/100 [00:35<00:28,  1.55it/s] 57%|█████▋    | 57/100 [00:36<00:27,  1.56it/s] 58%|█████▊    | 58/100 [00:36<00:27,  1.55it/s] 59%|█████▉    | 59/100 [00:37<00:26,  1.54it/s] 60%|██████    | 60/100 [00:38<00:25,  1.54it/s] 61%|██████    | 61/100 [00:38<00:25,  1.55it/s] 62%|██████▏   | 62/100 [00:39<00:24,  1.56it/s] 63%|██████▎   | 63/100 [00:40<00:23,  1.55it/s] 64%|██████▍   | 64/100 [00:40<00:23,  1.55it/s] 65%|██████▌   | 65/100 [00:41<00:22,  1.54it/s] 66%|██████▌   | 66/100 [00:42<00:22,  1.53it/s] 67%|██████▋   | 67/100 [00:42<00:21,  1.53it/s] 68%|██████▊   | 68/100 [00:43<00:20,  1.53it/s] 69%|██████▉   | 69/100 [00:43<00:20,  1.55it/s] 70%|███████   | 70/100 [00:44<00:19,  1.56it/s] 71%|███████   | 71/100 [00:45<00:18,  1.56it/s] 72%|███████▏  | 72/100 [00:45<00:17,  1.57it/s] 73%|███████▎  | 73/100 [00:46<00:17,  1.56it/s] 74%|███████▍  | 74/100 [00:47<00:16,  1.57it/s] 75%|███████▌  | 75/100 [00:47<00:15,  1.56it/s] 76%|███████▌  | 76/100 [00:48<00:15,  1.55it/s] 77%|███████▋  | 77/100 [00:49<00:14,  1.55it/s] 78%|███████▊  | 78/100 [00:49<00:14,  1.55it/s] 79%|███████▉  | 79/100 [00:50<00:13,  1.55it/s] 80%|████████  | 80/100 [00:51<00:12,  1.54it/s] 81%|████████  | 81/100 [00:51<00:12,  1.54it/s] 82%|████████▏ | 82/100 [00:52<00:11,  1.54it/s] 83%|████████▎ | 83/100 [00:52<00:11,  1.53it/s] 84%|████████▍ | 84/100 [00:53<00:10,  1.54it/s] 85%|████████▌ | 85/100 [00:54<00:09,  1.54it/s] 86%|████████▌ | 86/100 [00:54<00:09,  1.54it/s] 87%|████████▋ | 87/100 [00:55<00:08,  1.54it/s] 88%|████████▊ | 88/100 [00:56<00:07,  1.54it/s] 89%|████████▉ | 89/100 [00:56<00:07,  1.54it/s] 90%|█████████ | 90/100 [00:57<00:06,  1.54it/s] 91%|█████████ | 91/100 [00:58<00:05,  1.55it/s] 92%|█████████▏| 92/100 [00:58<00:05,  1.56it/s] 93%|█████████▎| 93/100 [00:59<00:04,  1.57it/s] 94%|█████████▍| 94/100 [01:00<00:03,  1.56it/s] 95%|█████████▌| 95/100 [01:00<00:03,  1.55it/s] 96%|█████████▌| 96/100 [01:01<00:02,  1.56it/s] 97%|█████████▋| 97/100 [01:01<00:01,  1.57it/s] 98%|█████████▊| 98/100 [01:02<00:01,  1.56it/s] 99%|█████████▉| 99/100 [01:03<00:00,  1.55it/s]100%|██████████| 100/100 [01:03<00:00,  1.56it/s]100%|██████████| 100/100 [01:03<00:00,  1.56it/s]
2023-06-14 19:32:44 [INFO] {
2023-06-14 19:32:44 [INFO]     'eval_loss': 1.1746976375579834,
2023-06-14 19:32:44 [INFO]     'eval_runtime': 64.5645,
2023-06-14 19:32:44 [INFO]     'eval_samples_per_second': 1.549,
2023-06-14 19:32:44 [INFO]     'eval_steps_per_second': 1.549
2023-06-14 19:32:44 [INFO] }
2023-06-14 19:32:44 [INFO] metric: 1.549
2023-06-14 19:32:44 [INFO] Throughput: 1.549 samples/sec
2023-06-14 19:32:44 [INFO] Tune 4 result is: [Accuracy (int8|fp32): 1.5490|1.4140, Duration (seconds) (int8|fp32): 64.5693|70.7175], Best tune result is: [Accuracy: 1.5900, Duration (seconds): 62.8859]
2023-06-14 19:32:44 [INFO] |**********************Tune Result Statistics**********************|
2023-06-14 19:32:44 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:32:44 [INFO] |     Info Type      | Baseline | Tune 4 result | Best tune result |
2023-06-14 19:32:44 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:32:44 [INFO] |      Accuracy      | 1.4140   |    1.5490     |     1.5900       |
2023-06-14 19:32:44 [INFO] | Duration (seconds) | 70.7175  |    64.5693    |     62.8859      |
2023-06-14 19:32:44 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:32:44 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-19-27/./history.snapshot.
2023-06-14 19:32:45 [INFO] |******Mixed Precision Statistics******|
2023-06-14 19:32:45 [INFO] +-------------+--------+------+--------+
2023-06-14 19:32:45 [INFO] |   Op Type   | Total  | INT8 |  FP32  |
2023-06-14 19:32:45 [INFO] +-------------+--------+------+--------+
2023-06-14 19:32:45 [INFO] |  Embedding  |   2    |  1   |   1    |
2023-06-14 19:32:45 [INFO] |    Linear   |   1    |  1   |   0    |
2023-06-14 19:32:45 [INFO] +-------------+--------+------+--------+
2023-06-14 19:32:45 [INFO] Pass quantize model elapsed time: 826.32 ms
2023-06-14 19:32:45 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: output, input, code.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:31,  3.15it/s]  3%|▎         | 3/100 [00:01<00:43,  2.21it/s]  4%|▍         | 4/100 [00:01<00:49,  1.93it/s]  5%|▌         | 5/100 [00:02<00:53,  1.79it/s]  6%|▌         | 6/100 [00:03<00:54,  1.71it/s]  7%|▋         | 7/100 [00:03<00:55,  1.67it/s]  8%|▊         | 8/100 [00:04<00:56,  1.64it/s]  9%|▉         | 9/100 [00:05<00:56,  1.62it/s] 10%|█         | 10/100 [00:05<00:56,  1.61it/s] 11%|█         | 11/100 [00:06<00:55,  1.60it/s] 12%|█▏        | 12/100 [00:06<00:55,  1.59it/s] 13%|█▎        | 13/100 [00:07<00:54,  1.59it/s] 14%|█▍        | 14/100 [00:08<00:54,  1.59it/s] 15%|█▌        | 15/100 [00:08<00:53,  1.58it/s] 16%|█▌        | 16/100 [00:09<00:53,  1.58it/s] 17%|█▋        | 17/100 [00:10<00:52,  1.58it/s] 18%|█▊        | 18/100 [00:10<00:51,  1.58it/s] 19%|█▉        | 19/100 [00:11<00:51,  1.58it/s] 20%|██        | 20/100 [00:12<00:50,  1.58it/s] 21%|██        | 21/100 [00:12<00:49,  1.58it/s] 22%|██▏       | 22/100 [00:13<00:49,  1.58it/s] 23%|██▎       | 23/100 [00:13<00:48,  1.58it/s] 24%|██▍       | 24/100 [00:14<00:48,  1.58it/s] 25%|██▌       | 25/100 [00:15<00:47,  1.58it/s] 26%|██▌       | 26/100 [00:15<00:46,  1.58it/s] 27%|██▋       | 27/100 [00:16<00:46,  1.58it/s] 28%|██▊       | 28/100 [00:17<00:45,  1.58it/s] 29%|██▉       | 29/100 [00:17<00:44,  1.58it/s] 30%|███       | 30/100 [00:18<00:44,  1.58it/s] 31%|███       | 31/100 [00:19<00:43,  1.58it/s] 32%|███▏      | 32/100 [00:19<00:43,  1.58it/s] 33%|███▎      | 33/100 [00:20<00:42,  1.58it/s] 34%|███▍      | 34/100 [00:20<00:41,  1.58it/s] 35%|███▌      | 35/100 [00:21<00:41,  1.58it/s] 36%|███▌      | 36/100 [00:22<00:40,  1.58it/s] 37%|███▋      | 37/100 [00:22<00:39,  1.58it/s] 38%|███▊      | 38/100 [00:23<00:39,  1.58it/s] 39%|███▉      | 39/100 [00:24<00:38,  1.58it/s] 40%|████      | 40/100 [00:24<00:37,  1.58it/s] 41%|████      | 41/100 [00:25<00:37,  1.58it/s] 42%|████▏     | 42/100 [00:25<00:36,  1.58it/s] 43%|████▎     | 43/100 [00:26<00:36,  1.58it/s] 44%|████▍     | 44/100 [00:27<00:35,  1.58it/s] 45%|████▌     | 45/100 [00:27<00:34,  1.58it/s] 46%|████▌     | 46/100 [00:28<00:34,  1.58it/s] 47%|████▋     | 47/100 [00:29<00:33,  1.58it/s] 48%|████▊     | 48/100 [00:29<00:32,  1.58it/s] 49%|████▉     | 49/100 [00:30<00:32,  1.58it/s] 50%|█████     | 50/100 [00:31<00:31,  1.58it/s] 51%|█████     | 51/100 [00:31<00:31,  1.58it/s] 52%|█████▏    | 52/100 [00:32<00:30,  1.58it/s] 53%|█████▎    | 53/100 [00:32<00:29,  1.57it/s] 54%|█████▍    | 54/100 [00:33<00:29,  1.58it/s] 55%|█████▌    | 55/100 [00:34<00:28,  1.58it/s] 56%|█████▌    | 56/100 [00:34<00:27,  1.58it/s] 57%|█████▋    | 57/100 [00:35<00:27,  1.58it/s] 58%|█████▊    | 58/100 [00:36<00:26,  1.58it/s] 59%|█████▉    | 59/100 [00:36<00:26,  1.58it/s] 60%|██████    | 60/100 [00:37<00:25,  1.58it/s] 61%|██████    | 61/100 [00:38<00:24,  1.58it/s] 62%|██████▏   | 62/100 [00:38<00:24,  1.58it/s] 63%|██████▎   | 63/100 [00:39<00:23,  1.58it/s] 64%|██████▍   | 64/100 [00:39<00:22,  1.58it/s] 65%|██████▌   | 65/100 [00:40<00:22,  1.58it/s] 66%|██████▌   | 66/100 [00:41<00:21,  1.58it/s] 67%|██████▋   | 67/100 [00:41<00:20,  1.58it/s] 68%|██████▊   | 68/100 [00:42<00:20,  1.58it/s] 69%|██████▉   | 69/100 [00:43<00:19,  1.58it/s] 70%|███████   | 70/100 [00:43<00:18,  1.58it/s] 71%|███████   | 71/100 [00:44<00:18,  1.58it/s] 72%|███████▏  | 72/100 [00:44<00:17,  1.58it/s] 73%|███████▎  | 73/100 [00:45<00:17,  1.58it/s] 74%|███████▍  | 74/100 [00:46<00:16,  1.58it/s] 75%|███████▌  | 75/100 [00:46<00:15,  1.58it/s] 76%|███████▌  | 76/100 [00:47<00:15,  1.58it/s] 77%|███████▋  | 77/100 [00:48<00:14,  1.58it/s] 78%|███████▊  | 78/100 [00:48<00:13,  1.58it/s] 79%|███████▉  | 79/100 [00:49<00:13,  1.58it/s] 80%|████████  | 80/100 [00:50<00:12,  1.58it/s] 81%|████████  | 81/100 [00:50<00:12,  1.58it/s] 82%|████████▏ | 82/100 [00:51<00:11,  1.58it/s] 83%|████████▎ | 83/100 [00:51<00:10,  1.58it/s] 84%|████████▍ | 84/100 [00:52<00:10,  1.58it/s] 85%|████████▌ | 85/100 [00:53<00:09,  1.58it/s] 86%|████████▌ | 86/100 [00:53<00:08,  1.57it/s] 87%|████████▋ | 87/100 [00:54<00:08,  1.57it/s] 88%|████████▊ | 88/100 [00:55<00:07,  1.57it/s] 89%|████████▉ | 89/100 [00:55<00:06,  1.58it/s] 90%|█████████ | 90/100 [00:56<00:06,  1.58it/s] 91%|█████████ | 91/100 [00:57<00:05,  1.58it/s] 92%|█████████▏| 92/100 [00:57<00:05,  1.58it/s] 93%|█████████▎| 93/100 [00:58<00:04,  1.58it/s] 94%|█████████▍| 94/100 [00:58<00:03,  1.58it/s] 95%|█████████▌| 95/100 [00:59<00:03,  1.58it/s] 96%|█████████▌| 96/100 [01:00<00:02,  1.58it/s] 97%|█████████▋| 97/100 [01:00<00:01,  1.58it/s] 98%|█████████▊| 98/100 [01:01<00:01,  1.58it/s] 99%|█████████▉| 99/100 [01:02<00:00,  1.58it/s]100%|██████████| 100/100 [01:02<00:00,  1.58it/s]100%|██████████| 100/100 [01:02<00:00,  1.59it/s]
2023-06-14 19:33:48 [INFO] {
2023-06-14 19:33:48 [INFO]     'eval_loss': 1.1748887300491333,
2023-06-14 19:33:48 [INFO]     'eval_runtime': 63.3328,
2023-06-14 19:33:48 [INFO]     'eval_samples_per_second': 1.579,
2023-06-14 19:33:48 [INFO]     'eval_steps_per_second': 1.579
2023-06-14 19:33:48 [INFO] }
2023-06-14 19:33:48 [INFO] metric: 1.579
2023-06-14 19:33:48 [INFO] Throughput: 1.579 samples/sec
2023-06-14 19:33:48 [INFO] Tune 5 result is: [Accuracy (int8|fp32): 1.5790|1.4140, Duration (seconds) (int8|fp32): 63.3388|70.7175], Best tune result is: [Accuracy: 1.5900, Duration (seconds): 62.8859]
2023-06-14 19:33:48 [INFO] |**********************Tune Result Statistics**********************|
2023-06-14 19:33:48 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:33:48 [INFO] |     Info Type      | Baseline | Tune 5 result | Best tune result |
2023-06-14 19:33:48 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:33:48 [INFO] |      Accuracy      | 1.4140   |    1.5790     |     1.5900       |
2023-06-14 19:33:48 [INFO] | Duration (seconds) | 70.7175  |    63.3388    |     62.8859      |
2023-06-14 19:33:48 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:33:48 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-19-27/./history.snapshot.
2023-06-14 19:33:51 [INFO] Start to accumulate fallback to fp32.
2023-06-14 19:33:51 [INFO] |******Mixed Precision Statistics******|
2023-06-14 19:33:51 [INFO] +-------------+--------+------+--------+
2023-06-14 19:33:51 [INFO] |   Op Type   | Total  | INT8 |  FP32  |
2023-06-14 19:33:51 [INFO] +-------------+--------+------+--------+
2023-06-14 19:33:51 [INFO] |  Embedding  |   2    |  0   |   2    |
2023-06-14 19:33:51 [INFO] |    Linear   |   1    |  1   |   0    |
2023-06-14 19:33:51 [INFO] +-------------+--------+------+--------+
2023-06-14 19:33:51 [INFO] Pass quantize model elapsed time: 826.69 ms
2023-06-14 19:33:51 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: output, input, code.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:32,  3.05it/s]  3%|▎         | 3/100 [00:01<00:44,  2.18it/s]  4%|▍         | 4/100 [00:01<00:51,  1.86it/s]  5%|▌         | 5/100 [00:02<00:55,  1.72it/s]  6%|▌         | 6/100 [00:03<00:56,  1.65it/s]  7%|▋         | 7/100 [00:03<00:57,  1.60it/s]  8%|▊         | 8/100 [00:04<00:58,  1.57it/s]  9%|▉         | 9/100 [00:05<00:58,  1.55it/s] 10%|█         | 10/100 [00:05<00:58,  1.55it/s] 11%|█         | 11/100 [00:06<00:57,  1.54it/s] 12%|█▏        | 12/100 [00:07<00:57,  1.53it/s] 13%|█▎        | 13/100 [00:07<00:58,  1.50it/s] 14%|█▍        | 14/100 [00:08<00:57,  1.50it/s] 15%|█▌        | 15/100 [00:09<00:56,  1.51it/s] 16%|█▌        | 16/100 [00:09<00:55,  1.52it/s] 17%|█▋        | 17/100 [00:10<00:54,  1.52it/s] 18%|█▊        | 18/100 [00:11<00:54,  1.52it/s] 19%|█▉        | 19/100 [00:11<00:52,  1.53it/s] 20%|██        | 20/100 [00:12<00:52,  1.52it/s] 21%|██        | 21/100 [00:13<00:51,  1.52it/s] 22%|██▏       | 22/100 [00:13<00:51,  1.52it/s] 23%|██▎       | 23/100 [00:14<00:50,  1.52it/s] 24%|██▍       | 24/100 [00:15<00:49,  1.52it/s] 25%|██▌       | 25/100 [00:15<00:49,  1.52it/s] 26%|██▌       | 26/100 [00:16<00:48,  1.52it/s] 27%|██▋       | 27/100 [00:17<00:47,  1.53it/s] 28%|██▊       | 28/100 [00:17<00:47,  1.53it/s] 29%|██▉       | 29/100 [00:18<00:46,  1.53it/s] 30%|███       | 30/100 [00:19<00:45,  1.53it/s] 31%|███       | 31/100 [00:19<00:44,  1.54it/s] 32%|███▏      | 32/100 [00:20<00:44,  1.54it/s] 33%|███▎      | 33/100 [00:21<00:43,  1.53it/s] 34%|███▍      | 34/100 [00:21<00:42,  1.55it/s] 35%|███▌      | 35/100 [00:22<00:42,  1.54it/s] 36%|███▌      | 36/100 [00:22<00:41,  1.55it/s] 37%|███▋      | 37/100 [00:23<00:40,  1.56it/s] 38%|███▊      | 38/100 [00:24<00:39,  1.56it/s] 39%|███▉      | 39/100 [00:24<00:39,  1.55it/s] 40%|████      | 40/100 [00:25<00:38,  1.56it/s] 41%|████      | 41/100 [00:26<00:37,  1.55it/s] 42%|████▏     | 42/100 [00:26<00:37,  1.54it/s] 43%|████▎     | 43/100 [00:27<00:36,  1.54it/s] 44%|████▍     | 44/100 [00:28<00:36,  1.54it/s] 45%|████▌     | 45/100 [00:28<00:35,  1.55it/s] 46%|████▌     | 46/100 [00:29<00:34,  1.56it/s] 47%|████▋     | 47/100 [00:30<00:34,  1.55it/s] 48%|████▊     | 48/100 [00:30<00:33,  1.54it/s] 49%|████▉     | 49/100 [00:31<00:32,  1.55it/s] 50%|█████     | 50/100 [00:31<00:32,  1.56it/s] 51%|█████     | 51/100 [00:32<00:31,  1.56it/s] 52%|█████▏    | 52/100 [00:33<00:30,  1.55it/s] 53%|█████▎    | 53/100 [00:33<00:30,  1.54it/s] 54%|█████▍    | 54/100 [00:34<00:29,  1.55it/s] 55%|█████▌    | 55/100 [00:35<00:28,  1.56it/s] 56%|█████▌    | 56/100 [00:35<00:28,  1.56it/s] 57%|█████▋    | 57/100 [00:36<00:27,  1.56it/s] 58%|█████▊    | 58/100 [00:37<00:26,  1.57it/s] 59%|█████▉    | 59/100 [00:37<00:26,  1.56it/s] 60%|██████    | 60/100 [00:38<00:25,  1.55it/s] 61%|██████    | 61/100 [00:39<00:25,  1.55it/s] 62%|██████▏   | 62/100 [00:39<00:24,  1.54it/s] 63%|██████▎   | 63/100 [00:40<00:23,  1.55it/s] 64%|██████▍   | 64/100 [00:41<00:23,  1.54it/s] 65%|██████▌   | 65/100 [00:41<00:22,  1.55it/s] 66%|██████▌   | 66/100 [00:42<00:21,  1.55it/s] 67%|██████▋   | 67/100 [00:42<00:21,  1.54it/s] 68%|██████▊   | 68/100 [00:43<00:20,  1.54it/s] 69%|██████▉   | 69/100 [00:44<00:20,  1.54it/s] 70%|███████   | 70/100 [00:44<00:19,  1.54it/s] 71%|███████   | 71/100 [00:45<00:18,  1.53it/s] 72%|███████▏  | 72/100 [00:46<00:18,  1.53it/s] 73%|███████▎  | 73/100 [00:46<00:17,  1.54it/s] 74%|███████▍  | 74/100 [00:47<00:16,  1.55it/s] 75%|███████▌  | 75/100 [00:48<00:16,  1.55it/s] 76%|███████▌  | 76/100 [00:48<00:15,  1.53it/s] 77%|███████▋  | 77/100 [00:49<00:14,  1.55it/s] 78%|███████▊  | 78/100 [00:50<00:14,  1.54it/s] 79%|███████▉  | 79/100 [00:50<00:13,  1.54it/s] 80%|████████  | 80/100 [00:51<00:13,  1.53it/s] 81%|████████  | 81/100 [00:52<00:12,  1.54it/s] 82%|████████▏ | 82/100 [00:52<00:11,  1.54it/s] 83%|████████▎ | 83/100 [00:53<00:11,  1.53it/s] 84%|████████▍ | 84/100 [00:54<00:10,  1.53it/s] 85%|████████▌ | 85/100 [00:54<00:09,  1.53it/s] 86%|████████▌ | 86/100 [00:55<00:09,  1.54it/s] 87%|████████▋ | 87/100 [00:55<00:08,  1.54it/s] 88%|████████▊ | 88/100 [00:56<00:07,  1.55it/s] 89%|████████▉ | 89/100 [00:57<00:07,  1.55it/s] 90%|█████████ | 90/100 [00:57<00:06,  1.55it/s] 91%|█████████ | 91/100 [00:58<00:05,  1.55it/s] 92%|█████████▏| 92/100 [00:59<00:05,  1.54it/s] 93%|█████████▎| 93/100 [00:59<00:04,  1.55it/s] 94%|█████████▍| 94/100 [01:00<00:03,  1.55it/s] 95%|█████████▌| 95/100 [01:01<00:03,  1.55it/s] 96%|█████████▌| 96/100 [01:01<00:02,  1.55it/s] 97%|█████████▋| 97/100 [01:02<00:01,  1.54it/s] 98%|█████████▊| 98/100 [01:03<00:01,  1.53it/s] 99%|█████████▉| 99/100 [01:03<00:00,  1.54it/s]100%|██████████| 100/100 [01:04<00:00,  1.53it/s]100%|██████████| 100/100 [01:04<00:00,  1.55it/s]
2023-06-14 19:34:56 [INFO] {
2023-06-14 19:34:56 [INFO]     'eval_loss': 1.174701452255249,
2023-06-14 19:34:56 [INFO]     'eval_runtime': 65.0434,
2023-06-14 19:34:56 [INFO]     'eval_samples_per_second': 1.537,
2023-06-14 19:34:56 [INFO]     'eval_steps_per_second': 1.537
2023-06-14 19:34:56 [INFO] }
2023-06-14 19:34:56 [INFO] metric: 1.537
2023-06-14 19:34:56 [INFO] Throughput: 1.537 samples/sec
2023-06-14 19:34:56 [INFO] Tune 6 result is: [Accuracy (int8|fp32): 1.5370|1.4140, Duration (seconds) (int8|fp32): 65.0517|70.7175], Best tune result is: [Accuracy: 1.5900, Duration (seconds): 62.8859]
2023-06-14 19:34:56 [INFO] |**********************Tune Result Statistics**********************|
2023-06-14 19:34:56 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:34:56 [INFO] |     Info Type      | Baseline | Tune 6 result | Best tune result |
2023-06-14 19:34:56 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:34:56 [INFO] |      Accuracy      | 1.4140   |    1.5370     |     1.5900       |
2023-06-14 19:34:56 [INFO] | Duration (seconds) | 70.7175  |    65.0517    |     62.8859      |
2023-06-14 19:34:56 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:34:56 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-19-27/./history.snapshot.
2023-06-14 19:34:57 [WARNING] None of the submodule got qconfig applied. Make sure you passed correct configuration through `qconfig_dict` or by assigning the `.qconfig` attribute directly on submodules.
2023-06-14 19:34:57 [INFO] |******Mixed Precision Statistics******|
2023-06-14 19:34:57 [INFO] +-----------------+----------+---------+
2023-06-14 19:34:57 [INFO] |     Op Type     |  Total   |   FP32  |
2023-06-14 19:34:57 [INFO] +-----------------+----------+---------+
2023-06-14 19:34:57 [INFO] |    Embedding    |    2     |    2    |
2023-06-14 19:34:57 [INFO] |      Linear     |    1     |    1    |
2023-06-14 19:34:57 [INFO] +-----------------+----------+---------+
2023-06-14 19:34:57 [INFO] Pass quantize model elapsed time: 133.84 ms
2023-06-14 19:34:57 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: output, input, code.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:32,  2.99it/s]  3%|▎         | 3/100 [00:01<00:46,  2.10it/s]  4%|▍         | 4/100 [00:02<00:52,  1.82it/s]  5%|▌         | 5/100 [00:02<00:56,  1.69it/s]  6%|▌         | 6/100 [00:03<00:58,  1.62it/s]  7%|▋         | 7/100 [00:04<00:59,  1.57it/s]  8%|▊         | 8/100 [00:04<00:59,  1.55it/s]  9%|▉         | 9/100 [00:05<00:59,  1.53it/s] 10%|█         | 10/100 [00:06<00:59,  1.51it/s] 11%|█         | 11/100 [00:06<00:59,  1.51it/s] 12%|█▏        | 12/100 [00:07<00:58,  1.50it/s] 13%|█▎        | 13/100 [00:08<00:58,  1.50it/s] 14%|█▍        | 14/100 [00:08<00:57,  1.49it/s] 15%|█▌        | 15/100 [00:09<00:56,  1.49it/s] 16%|█▌        | 16/100 [00:10<00:56,  1.49it/s] 17%|█▋        | 17/100 [00:10<00:55,  1.49it/s] 18%|█▊        | 18/100 [00:11<00:55,  1.49it/s] 19%|█▉        | 19/100 [00:12<00:54,  1.49it/s] 20%|██        | 20/100 [00:12<00:53,  1.49it/s] 21%|██        | 21/100 [00:13<00:52,  1.49it/s] 22%|██▏       | 22/100 [00:14<00:52,  1.49it/s] 23%|██▎       | 23/100 [00:14<00:51,  1.49it/s] 24%|██▍       | 24/100 [00:15<00:51,  1.49it/s] 25%|██▌       | 25/100 [00:16<00:50,  1.49it/s] 26%|██▌       | 26/100 [00:16<00:49,  1.49it/s] 27%|██▋       | 27/100 [00:17<00:49,  1.49it/s] 28%|██▊       | 28/100 [00:18<00:48,  1.49it/s] 29%|██▉       | 29/100 [00:18<00:47,  1.48it/s] 30%|███       | 30/100 [00:19<00:47,  1.49it/s] 31%|███       | 31/100 [00:20<00:46,  1.49it/s] 32%|███▏      | 32/100 [00:20<00:45,  1.49it/s] 33%|███▎      | 33/100 [00:21<00:45,  1.49it/s] 34%|███▍      | 34/100 [00:22<00:44,  1.49it/s] 35%|███▌      | 35/100 [00:22<00:43,  1.49it/s] 36%|███▌      | 36/100 [00:23<00:42,  1.49it/s] 37%|███▋      | 37/100 [00:24<00:42,  1.49it/s] 38%|███▊      | 38/100 [00:24<00:41,  1.49it/s] 39%|███▉      | 39/100 [00:25<00:40,  1.49it/s] 40%|████      | 40/100 [00:26<00:40,  1.49it/s] 41%|████      | 41/100 [00:26<00:39,  1.49it/s] 42%|████▏     | 42/100 [00:27<00:38,  1.49it/s] 43%|████▎     | 43/100 [00:28<00:38,  1.49it/s] 44%|████▍     | 44/100 [00:28<00:37,  1.49it/s] 45%|████▌     | 45/100 [00:29<00:36,  1.49it/s] 46%|████▌     | 46/100 [00:30<00:36,  1.49it/s] 47%|████▋     | 47/100 [00:30<00:35,  1.49it/s] 48%|████▊     | 48/100 [00:31<00:34,  1.49it/s] 49%|████▉     | 49/100 [00:32<00:34,  1.49it/s] 50%|█████     | 50/100 [00:32<00:33,  1.49it/s] 51%|█████     | 51/100 [00:33<00:32,  1.49it/s] 52%|█████▏    | 52/100 [00:34<00:32,  1.49it/s] 53%|█████▎    | 53/100 [00:34<00:31,  1.49it/s] 54%|█████▍    | 54/100 [00:35<00:30,  1.49it/s] 55%|█████▌    | 55/100 [00:36<00:30,  1.48it/s] 56%|█████▌    | 56/100 [00:36<00:29,  1.49it/s] 57%|█████▋    | 57/100 [00:37<00:28,  1.49it/s] 58%|█████▊    | 58/100 [00:38<00:28,  1.49it/s] 59%|█████▉    | 59/100 [00:38<00:27,  1.49it/s] 60%|██████    | 60/100 [00:39<00:26,  1.49it/s] 61%|██████    | 61/100 [00:40<00:26,  1.49it/s] 62%|██████▏   | 62/100 [00:40<00:25,  1.49it/s] 63%|██████▎   | 63/100 [00:41<00:24,  1.49it/s] 64%|██████▍   | 64/100 [00:42<00:24,  1.49it/s] 65%|██████▌   | 65/100 [00:42<00:23,  1.49it/s] 66%|██████▌   | 66/100 [00:43<00:22,  1.49it/s] 67%|██████▋   | 67/100 [00:44<00:22,  1.49it/s] 68%|██████▊   | 68/100 [00:44<00:21,  1.49it/s] 69%|██████▉   | 69/100 [00:45<00:20,  1.49it/s] 70%|███████   | 70/100 [00:46<00:20,  1.49it/s] 71%|███████   | 71/100 [00:47<00:19,  1.49it/s] 72%|███████▏  | 72/100 [00:47<00:18,  1.49it/s] 73%|███████▎  | 73/100 [00:48<00:18,  1.49it/s] 74%|███████▍  | 74/100 [00:49<00:17,  1.49it/s] 75%|███████▌  | 75/100 [00:49<00:16,  1.49it/s] 76%|███████▌  | 76/100 [00:50<00:16,  1.49it/s] 77%|███████▋  | 77/100 [00:51<00:15,  1.49it/s] 78%|███████▊  | 78/100 [00:51<00:14,  1.49it/s] 79%|███████▉  | 79/100 [00:52<00:14,  1.49it/s] 80%|████████  | 80/100 [00:53<00:13,  1.49it/s] 81%|████████  | 81/100 [00:53<00:12,  1.49it/s] 82%|████████▏ | 82/100 [00:54<00:12,  1.49it/s] 83%|████████▎ | 83/100 [00:55<00:11,  1.49it/s] 84%|████████▍ | 84/100 [00:55<00:10,  1.49it/s] 85%|████████▌ | 85/100 [00:56<00:10,  1.49it/s] 86%|████████▌ | 86/100 [00:57<00:09,  1.49it/s] 87%|████████▋ | 87/100 [00:57<00:08,  1.49it/s] 88%|████████▊ | 88/100 [00:58<00:08,  1.49it/s] 89%|████████▉ | 89/100 [00:59<00:07,  1.49it/s] 90%|█████████ | 90/100 [00:59<00:06,  1.49it/s] 91%|█████████ | 91/100 [01:00<00:06,  1.49it/s] 92%|█████████▏| 92/100 [01:01<00:05,  1.49it/s] 93%|█████████▎| 93/100 [01:01<00:04,  1.49it/s] 94%|█████████▍| 94/100 [01:02<00:04,  1.49it/s] 95%|█████████▌| 95/100 [01:03<00:03,  1.49it/s] 96%|█████████▌| 96/100 [01:03<00:02,  1.49it/s] 97%|█████████▋| 97/100 [01:04<00:02,  1.49it/s] 98%|█████████▊| 98/100 [01:05<00:01,  1.49it/s] 99%|█████████▉| 99/100 [01:05<00:00,  1.49it/s]100%|██████████| 100/100 [01:06<00:00,  1.49it/s]100%|██████████| 100/100 [01:06<00:00,  1.50it/s]
2023-06-14 19:36:04 [INFO] {
2023-06-14 19:36:04 [INFO]     'eval_loss': 1.1736871004104614,
2023-06-14 19:36:04 [INFO]     'eval_runtime': 67.1381,
2023-06-14 19:36:04 [INFO]     'eval_samples_per_second': 1.489,
2023-06-14 19:36:04 [INFO]     'eval_steps_per_second': 1.489
2023-06-14 19:36:04 [INFO] }
2023-06-14 19:36:04 [INFO] metric: 1.489
2023-06-14 19:36:04 [INFO] Throughput: 1.489 samples/sec
2023-06-14 19:36:04 [INFO] Tune 7 result is: [Accuracy (int8|fp32): 1.4890|1.4140, Duration (seconds) (int8|fp32): 67.1430|70.7175], Best tune result is: [Accuracy: 1.5900, Duration (seconds): 62.8859]
2023-06-14 19:36:04 [INFO] |**********************Tune Result Statistics**********************|
2023-06-14 19:36:04 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:36:04 [INFO] |     Info Type      | Baseline | Tune 7 result | Best tune result |
2023-06-14 19:36:04 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:36:04 [INFO] |      Accuracy      | 1.4140   |    1.4890     |     1.5900       |
2023-06-14 19:36:04 [INFO] | Duration (seconds) | 70.7175  |    67.1430    |     62.8859      |
2023-06-14 19:36:04 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:36:04 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-19-27/./history.snapshot.
2023-06-14 19:36:06 [INFO] |******Mixed Precision Statistics******|
2023-06-14 19:36:06 [INFO] +-----------------+----------+---------+
2023-06-14 19:36:06 [INFO] |     Op Type     |  Total   |   INT8  |
2023-06-14 19:36:06 [INFO] +-----------------+----------+---------+
2023-06-14 19:36:06 [INFO] |    Embedding    |    2     |    2    |
2023-06-14 19:36:06 [INFO] |      Linear     |    1     |    1    |
2023-06-14 19:36:06 [INFO] +-----------------+----------+---------+
2023-06-14 19:36:06 [INFO] Pass quantize model elapsed time: 920.57 ms
2023-06-14 19:36:06 [INFO] Specified timeout or max trials is reached! Found a quantized model which meet accuracy goal. Exit.
2023-06-14 19:36:06 [INFO] Save deploy yaml to /scratch/dsochirca/nc_workspace/2023-06-14_19-19-27/deploy.yaml
2023-06-14 19:36:09 [INFO] Saving model checkpoint to ./test_epoch
2023-06-14 19:36:13 [INFO] quantized model and configure file have saved to ./test_epoch
2023-06-14 19:36:21 [INFO] Saving model checkpoint to ./models/CodeGPT-Py150_0.6_sparse_q_only_weights_asym_per_channel
2023-06-14 19:36:24 [INFO] quantized model and configure file have saved to ./models/CodeGPT-Py150_0.6_sparse_q_only_weights_asym_per_channel
2023-06-14 19:36:25 [WARNING] Force convert framework model to neural_compressor model.
2023-06-14 19:36:25 [INFO] Pass query framework capability elapsed time: 1.12 ms
2023-06-14 19:36:25 [INFO] Adaptor has 1 recipes.
2023-06-14 19:36:25 [INFO] 0 recipes specified by user.
2023-06-14 19:36:25 [INFO] 0 recipes require future tuning.
2023-06-14 19:36:25 [INFO] ..............use_distributed_tuning: None
2023-06-14 19:36:25 [INFO] Get FP32 model baseline.
2023-06-14 19:36:25 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: output, input, code.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:34,  2.87it/s]  3%|▎         | 3/100 [00:01<00:47,  2.05it/s]  4%|▍         | 4/100 [00:02<00:55,  1.73it/s]  5%|▌         | 5/100 [00:02<00:59,  1.59it/s]  6%|▌         | 6/100 [00:03<01:00,  1.56it/s]  7%|▋         | 7/100 [00:04<01:00,  1.53it/s]  8%|▊         | 8/100 [00:04<01:00,  1.52it/s]  9%|▉         | 9/100 [00:05<01:00,  1.50it/s] 10%|█         | 10/100 [00:06<01:01,  1.47it/s] 11%|█         | 11/100 [00:06<01:01,  1.46it/s] 12%|█▏        | 12/100 [00:07<01:00,  1.45it/s] 13%|█▎        | 13/100 [00:08<01:01,  1.43it/s] 14%|█▍        | 14/100 [00:09<01:00,  1.43it/s] 15%|█▌        | 15/100 [00:09<00:59,  1.43it/s] 16%|█▌        | 16/100 [00:10<00:57,  1.45it/s] 17%|█▋        | 17/100 [00:11<00:58,  1.43it/s] 18%|█▊        | 18/100 [00:11<00:56,  1.44it/s] 19%|█▉        | 19/100 [00:12<00:56,  1.44it/s] 20%|██        | 20/100 [00:13<00:55,  1.45it/s] 21%|██        | 21/100 [00:13<00:55,  1.42it/s] 22%|██▏       | 22/100 [00:14<00:55,  1.41it/s] 23%|██▎       | 23/100 [00:15<00:54,  1.42it/s] 24%|██▍       | 24/100 [00:16<00:52,  1.44it/s] 25%|██▌       | 25/100 [00:16<00:52,  1.42it/s] 26%|██▌       | 26/100 [00:17<00:51,  1.44it/s] 27%|██▋       | 27/100 [00:18<00:50,  1.45it/s] 28%|██▊       | 28/100 [00:18<00:49,  1.46it/s] 29%|██▉       | 29/100 [00:19<00:49,  1.44it/s] 30%|███       | 30/100 [00:20<00:49,  1.42it/s] 31%|███       | 31/100 [00:20<00:48,  1.41it/s] 32%|███▏      | 32/100 [00:21<00:47,  1.44it/s] 33%|███▎      | 33/100 [00:22<00:45,  1.46it/s] 34%|███▍      | 34/100 [00:22<00:44,  1.47it/s] 35%|███▌      | 35/100 [00:23<00:43,  1.48it/s] 36%|███▌      | 36/100 [00:24<00:44,  1.44it/s] 37%|███▋      | 37/100 [00:25<00:44,  1.42it/s] 38%|███▊      | 38/100 [00:25<00:43,  1.42it/s] 39%|███▉      | 39/100 [00:26<00:43,  1.41it/s] 40%|████      | 40/100 [00:27<00:42,  1.42it/s] 41%|████      | 41/100 [00:27<00:41,  1.42it/s] 42%|████▏     | 42/100 [00:28<00:40,  1.42it/s] 43%|████▎     | 43/100 [00:29<00:40,  1.40it/s] 44%|████▍     | 44/100 [00:30<00:40,  1.39it/s] 45%|████▌     | 45/100 [00:30<00:39,  1.39it/s] 46%|████▌     | 46/100 [00:31<00:38,  1.40it/s] 47%|████▋     | 47/100 [00:32<00:37,  1.41it/s] 48%|████▊     | 48/100 [00:32<00:36,  1.42it/s] 49%|████▉     | 49/100 [00:33<00:35,  1.43it/s] 50%|█████     | 50/100 [00:34<00:35,  1.43it/s] 51%|█████     | 51/100 [00:35<00:34,  1.41it/s] 52%|█████▏    | 52/100 [00:35<00:33,  1.43it/s] 53%|█████▎    | 53/100 [00:36<00:33,  1.41it/s] 54%|█████▍    | 54/100 [00:37<00:32,  1.42it/s] 55%|█████▌    | 55/100 [00:37<00:31,  1.41it/s] 56%|█████▌    | 56/100 [00:38<00:31,  1.41it/s] 57%|█████▋    | 57/100 [00:39<00:30,  1.42it/s] 58%|█████▊    | 58/100 [00:39<00:29,  1.42it/s] 59%|█████▉    | 59/100 [00:40<00:28,  1.42it/s] 60%|██████    | 60/100 [00:41<00:27,  1.44it/s] 61%|██████    | 61/100 [00:42<00:27,  1.44it/s] 62%|██████▏   | 62/100 [00:42<00:26,  1.44it/s] 63%|██████▎   | 63/100 [00:43<00:25,  1.45it/s] 64%|██████▍   | 64/100 [00:44<00:25,  1.44it/s] 65%|██████▌   | 65/100 [00:44<00:24,  1.42it/s] 66%|██████▌   | 66/100 [00:45<00:23,  1.44it/s] 67%|██████▋   | 67/100 [00:46<00:22,  1.46it/s] 68%|██████▊   | 68/100 [00:46<00:22,  1.44it/s] 69%|██████▉   | 69/100 [00:47<00:21,  1.44it/s] 70%|███████   | 70/100 [00:48<00:20,  1.45it/s] 71%|███████   | 71/100 [00:48<00:19,  1.46it/s] 72%|███████▏  | 72/100 [00:49<00:19,  1.47it/s] 73%|███████▎  | 73/100 [00:50<00:18,  1.44it/s] 74%|███████▍  | 74/100 [00:51<00:18,  1.42it/s] 75%|███████▌  | 75/100 [00:51<00:17,  1.42it/s] 76%|███████▌  | 76/100 [00:52<00:17,  1.40it/s] 77%|███████▋  | 77/100 [00:53<00:16,  1.44it/s] 78%|███████▊  | 78/100 [00:53<00:15,  1.44it/s] 79%|███████▉  | 79/100 [00:54<00:14,  1.46it/s] 80%|████████  | 80/100 [00:55<00:13,  1.46it/s] 81%|████████  | 81/100 [00:55<00:12,  1.47it/s] 82%|████████▏ | 82/100 [00:56<00:12,  1.46it/s] 83%|████████▎ | 83/100 [00:57<00:11,  1.47it/s] 84%|████████▍ | 84/100 [00:57<00:10,  1.46it/s] 85%|████████▌ | 85/100 [00:58<00:10,  1.45it/s] 86%|████████▌ | 86/100 [00:59<00:09,  1.45it/s] 87%|████████▋ | 87/100 [00:59<00:08,  1.46it/s] 88%|████████▊ | 88/100 [01:00<00:08,  1.47it/s] 89%|████████▉ | 89/100 [01:01<00:07,  1.45it/s] 90%|█████████ | 90/100 [01:02<00:06,  1.43it/s] 91%|█████████ | 91/100 [01:02<00:06,  1.41it/s] 92%|█████████▏| 92/100 [01:03<00:05,  1.44it/s] 93%|█████████▎| 93/100 [01:04<00:04,  1.46it/s] 94%|█████████▍| 94/100 [01:04<00:04,  1.47it/s] 95%|█████████▌| 95/100 [01:05<00:03,  1.47it/s] 96%|█████████▌| 96/100 [01:06<00:02,  1.43it/s] 97%|█████████▋| 97/100 [01:06<00:02,  1.45it/s] 98%|█████████▊| 98/100 [01:07<00:01,  1.45it/s] 99%|█████████▉| 99/100 [01:08<00:00,  1.43it/s]100%|██████████| 100/100 [01:09<00:00,  1.41it/s]100%|██████████| 100/100 [01:09<00:00,  1.45it/s]
2023-06-14 19:37:35 [INFO] {
2023-06-14 19:37:35 [INFO]     'eval_loss': 1.1736871004104614,
2023-06-14 19:37:35 [INFO]     'eval_runtime': 69.7472,
2023-06-14 19:37:35 [INFO]     'eval_samples_per_second': 1.434,
2023-06-14 19:37:35 [INFO]     'eval_steps_per_second': 1.434
2023-06-14 19:37:35 [INFO] }
2023-06-14 19:37:35 [INFO] metric: 1.434
2023-06-14 19:37:35 [INFO] Throughput: 1.434 samples/sec
2023-06-14 19:37:35 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-19-27/./history.snapshot.
2023-06-14 19:37:35 [INFO] FP32 baseline is: [Accuracy: 1.4340, Duration (seconds): 69.7499]
2023-06-14 19:37:36 [INFO] |******Mixed Precision Statistics******|
2023-06-14 19:37:36 [INFO] +-----------------+----------+---------+
2023-06-14 19:37:36 [INFO] |     Op Type     |  Total   |   INT8  |
2023-06-14 19:37:36 [INFO] +-----------------+----------+---------+
2023-06-14 19:37:36 [INFO] |    Embedding    |    2     |    2    |
2023-06-14 19:37:36 [INFO] |      Linear     |    1     |    1    |
2023-06-14 19:37:36 [INFO] +-----------------+----------+---------+
2023-06-14 19:37:36 [INFO] Pass quantize model elapsed time: 958.74 ms
2023-06-14 19:37:36 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: output, input, code.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:31,  3.12it/s]  3%|▎         | 3/100 [00:01<00:44,  2.20it/s]  4%|▍         | 4/100 [00:01<00:50,  1.91it/s]  5%|▌         | 5/100 [00:02<00:53,  1.76it/s]  6%|▌         | 6/100 [00:03<00:55,  1.69it/s]  7%|▋         | 7/100 [00:03<00:56,  1.64it/s]  8%|▊         | 8/100 [00:04<00:56,  1.62it/s]  9%|▉         | 9/100 [00:05<00:56,  1.60it/s] 10%|█         | 10/100 [00:05<00:56,  1.58it/s] 11%|█         | 11/100 [00:06<00:56,  1.58it/s] 12%|█▏        | 12/100 [00:07<00:56,  1.57it/s] 13%|█▎        | 13/100 [00:07<00:55,  1.57it/s] 14%|█▍        | 14/100 [00:08<00:54,  1.56it/s] 15%|█▌        | 15/100 [00:08<00:54,  1.56it/s] 16%|█▌        | 16/100 [00:09<00:53,  1.56it/s] 17%|█▋        | 17/100 [00:10<00:53,  1.56it/s] 18%|█▊        | 18/100 [00:10<00:52,  1.56it/s] 19%|█▉        | 19/100 [00:11<00:51,  1.56it/s] 20%|██        | 20/100 [00:12<00:51,  1.56it/s] 21%|██        | 21/100 [00:12<00:50,  1.56it/s] 22%|██▏       | 22/100 [00:13<00:50,  1.56it/s] 23%|██▎       | 23/100 [00:14<00:49,  1.56it/s] 24%|██▍       | 24/100 [00:14<00:48,  1.56it/s] 25%|██▌       | 25/100 [00:15<00:48,  1.56it/s] 26%|██▌       | 26/100 [00:16<00:47,  1.56it/s] 27%|██▋       | 27/100 [00:16<00:46,  1.56it/s] 28%|██▊       | 28/100 [00:17<00:46,  1.56it/s] 29%|██▉       | 29/100 [00:17<00:45,  1.56it/s] 30%|███       | 30/100 [00:18<00:44,  1.56it/s] 31%|███       | 31/100 [00:19<00:44,  1.56it/s] 32%|███▏      | 32/100 [00:19<00:43,  1.56it/s] 33%|███▎      | 33/100 [00:20<00:42,  1.56it/s] 34%|███▍      | 34/100 [00:21<00:42,  1.56it/s] 35%|███▌      | 35/100 [00:21<00:41,  1.56it/s] 36%|███▌      | 36/100 [00:22<00:41,  1.56it/s] 37%|███▋      | 37/100 [00:23<00:40,  1.56it/s] 38%|███▊      | 38/100 [00:23<00:39,  1.56it/s] 39%|███▉      | 39/100 [00:24<00:39,  1.56it/s] 40%|████      | 40/100 [00:25<00:38,  1.55it/s] 41%|████      | 41/100 [00:25<00:38,  1.55it/s] 42%|████▏     | 42/100 [00:26<00:37,  1.55it/s] 43%|████▎     | 43/100 [00:26<00:36,  1.55it/s] 44%|████▍     | 44/100 [00:27<00:36,  1.56it/s] 45%|████▌     | 45/100 [00:28<00:35,  1.56it/s] 46%|████▌     | 46/100 [00:28<00:34,  1.56it/s] 47%|████▋     | 47/100 [00:29<00:34,  1.56it/s] 48%|████▊     | 48/100 [00:30<00:33,  1.56it/s] 49%|████▉     | 49/100 [00:30<00:32,  1.56it/s] 50%|█████     | 50/100 [00:31<00:32,  1.56it/s] 51%|█████     | 51/100 [00:32<00:31,  1.56it/s] 52%|█████▏    | 52/100 [00:32<00:30,  1.56it/s] 53%|█████▎    | 53/100 [00:33<00:30,  1.56it/s] 54%|█████▍    | 54/100 [00:34<00:29,  1.56it/s] 55%|█████▌    | 55/100 [00:34<00:28,  1.56it/s] 56%|█████▌    | 56/100 [00:35<00:28,  1.56it/s] 57%|█████▋    | 57/100 [00:35<00:27,  1.56it/s] 58%|█████▊    | 58/100 [00:36<00:26,  1.56it/s] 59%|█████▉    | 59/100 [00:37<00:26,  1.56it/s] 60%|██████    | 60/100 [00:37<00:25,  1.56it/s] 61%|██████    | 61/100 [00:38<00:25,  1.56it/s] 62%|██████▏   | 62/100 [00:39<00:24,  1.56it/s] 63%|██████▎   | 63/100 [00:39<00:23,  1.56it/s] 64%|██████▍   | 64/100 [00:40<00:23,  1.56it/s] 65%|██████▌   | 65/100 [00:41<00:22,  1.56it/s] 66%|██████▌   | 66/100 [00:41<00:21,  1.56it/s] 67%|██████▋   | 67/100 [00:42<00:21,  1.56it/s] 68%|██████▊   | 68/100 [00:43<00:20,  1.56it/s] 69%|██████▉   | 69/100 [00:43<00:19,  1.56it/s] 70%|███████   | 70/100 [00:44<00:19,  1.56it/s] 71%|███████   | 71/100 [00:44<00:18,  1.56it/s] 72%|███████▏  | 72/100 [00:45<00:17,  1.56it/s] 73%|███████▎  | 73/100 [00:46<00:17,  1.56it/s] 74%|███████▍  | 74/100 [00:46<00:16,  1.56it/s] 75%|███████▌  | 75/100 [00:47<00:16,  1.56it/s] 76%|███████▌  | 76/100 [00:48<00:15,  1.56it/s] 77%|███████▋  | 77/100 [00:48<00:14,  1.56it/s] 78%|███████▊  | 78/100 [00:49<00:14,  1.56it/s] 79%|███████▉  | 79/100 [00:50<00:13,  1.56it/s] 80%|████████  | 80/100 [00:50<00:12,  1.56it/s] 81%|████████  | 81/100 [00:51<00:12,  1.56it/s] 82%|████████▏ | 82/100 [00:52<00:11,  1.56it/s] 83%|████████▎ | 83/100 [00:52<00:10,  1.56it/s] 84%|████████▍ | 84/100 [00:53<00:10,  1.56it/s] 85%|████████▌ | 85/100 [00:53<00:09,  1.56it/s] 86%|████████▌ | 86/100 [00:54<00:08,  1.56it/s] 87%|████████▋ | 87/100 [00:55<00:08,  1.56it/s] 88%|████████▊ | 88/100 [00:55<00:07,  1.56it/s] 89%|████████▉ | 89/100 [00:56<00:07,  1.56it/s] 90%|█████████ | 90/100 [00:57<00:06,  1.56it/s] 91%|█████████ | 91/100 [00:57<00:05,  1.56it/s] 92%|█████████▏| 92/100 [00:58<00:05,  1.56it/s] 93%|█████████▎| 93/100 [00:59<00:04,  1.55it/s] 94%|█████████▍| 94/100 [00:59<00:03,  1.55it/s] 95%|█████████▌| 95/100 [01:00<00:03,  1.55it/s] 96%|█████████▌| 96/100 [01:01<00:02,  1.56it/s] 97%|█████████▋| 97/100 [01:01<00:01,  1.56it/s] 98%|█████████▊| 98/100 [01:02<00:01,  1.56it/s] 99%|█████████▉| 99/100 [01:02<00:00,  1.56it/s]100%|██████████| 100/100 [01:03<00:00,  1.56it/s]100%|██████████| 100/100 [01:03<00:00,  1.57it/s]
2023-06-14 19:38:40 [INFO] {
2023-06-14 19:38:40 [INFO]     'eval_loss': 1.1748971939086914,
2023-06-14 19:38:40 [INFO]     'eval_runtime': 64.2109,
2023-06-14 19:38:40 [INFO]     'eval_samples_per_second': 1.557,
2023-06-14 19:38:40 [INFO]     'eval_steps_per_second': 1.557
2023-06-14 19:38:40 [INFO] }
2023-06-14 19:38:40 [INFO] metric: 1.557
2023-06-14 19:38:40 [INFO] Throughput: 1.557 samples/sec
2023-06-14 19:38:40 [INFO] Tune 1 result is: [Accuracy (int8|fp32): 1.5570|1.4340, Duration (seconds) (int8|fp32): 64.2151|69.7499], Best tune result is: [Accuracy: 1.5570, Duration (seconds): 64.2151]
2023-06-14 19:38:40 [INFO] |**********************Tune Result Statistics**********************|
2023-06-14 19:38:40 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:38:40 [INFO] |     Info Type      | Baseline | Tune 1 result | Best tune result |
2023-06-14 19:38:40 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:38:40 [INFO] |      Accuracy      | 1.4340   |    1.5570     |     1.5570       |
2023-06-14 19:38:40 [INFO] | Duration (seconds) | 69.7499  |    64.2151    |     64.2151      |
2023-06-14 19:38:40 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:38:40 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-19-27/./history.snapshot.
2023-06-14 19:38:40 [INFO] Apply all recipes.
2023-06-14 19:38:40 [WARNING] Find evaluated tuning config, skip.
2023-06-14 19:38:40 [INFO] Apply recipe one by one.
2023-06-14 19:38:40 [INFO] Start to fallback op to fp32 one by one.
2023-06-14 19:38:40 [INFO] |******Mixed Precision Statistics******|
2023-06-14 19:38:40 [INFO] +-------------+--------+------+--------+
2023-06-14 19:38:40 [INFO] |   Op Type   | Total  | INT8 |  FP32  |
2023-06-14 19:38:40 [INFO] +-------------+--------+------+--------+
2023-06-14 19:38:40 [INFO] |  Embedding  |   2    |  2   |   0    |
2023-06-14 19:38:40 [INFO] |    Linear   |   1    |  0   |   1    |
2023-06-14 19:38:40 [INFO] +-------------+--------+------+--------+
2023-06-14 19:38:40 [INFO] Pass quantize model elapsed time: 282.82 ms
2023-06-14 19:38:40 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: output, input, code.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:31,  3.09it/s]  3%|▎         | 3/100 [00:01<00:44,  2.18it/s]  4%|▍         | 4/100 [00:01<00:50,  1.89it/s]  5%|▌         | 5/100 [00:02<00:54,  1.75it/s]  6%|▌         | 6/100 [00:03<00:56,  1.67it/s]  7%|▋         | 7/100 [00:03<00:57,  1.63it/s]  8%|▊         | 8/100 [00:04<00:57,  1.60it/s]  9%|▉         | 9/100 [00:05<00:57,  1.58it/s] 10%|█         | 10/100 [00:05<00:57,  1.58it/s] 11%|█         | 11/100 [00:06<00:56,  1.56it/s] 12%|█▏        | 12/100 [00:07<00:56,  1.56it/s] 13%|█▎        | 13/100 [00:07<00:56,  1.55it/s] 14%|█▍        | 14/100 [00:08<00:55,  1.55it/s] 15%|█▌        | 15/100 [00:09<00:54,  1.55it/s] 16%|█▌        | 16/100 [00:09<00:54,  1.54it/s] 17%|█▋        | 17/100 [00:10<00:53,  1.54it/s] 18%|█▊        | 18/100 [00:11<00:53,  1.53it/s] 19%|█▉        | 19/100 [00:11<00:52,  1.53it/s] 20%|██        | 20/100 [00:12<00:52,  1.54it/s] 21%|██        | 21/100 [00:12<00:51,  1.53it/s] 22%|██▏       | 22/100 [00:13<00:50,  1.54it/s] 23%|██▎       | 23/100 [00:14<00:49,  1.54it/s] 24%|██▍       | 24/100 [00:14<00:49,  1.54it/s] 25%|██▌       | 25/100 [00:15<00:48,  1.54it/s] 26%|██▌       | 26/100 [00:16<00:48,  1.54it/s] 27%|██▋       | 27/100 [00:16<00:47,  1.54it/s] 28%|██▊       | 28/100 [00:17<00:46,  1.54it/s] 29%|██▉       | 29/100 [00:18<00:46,  1.54it/s] 30%|███       | 30/100 [00:18<00:45,  1.54it/s] 31%|███       | 31/100 [00:19<00:44,  1.54it/s] 32%|███▏      | 32/100 [00:20<00:44,  1.54it/s] 33%|███▎      | 33/100 [00:20<00:43,  1.55it/s] 34%|███▍      | 34/100 [00:21<00:42,  1.54it/s] 35%|███▌      | 35/100 [00:22<00:42,  1.54it/s] 36%|███▌      | 36/100 [00:22<00:41,  1.54it/s] 37%|███▋      | 37/100 [00:23<00:40,  1.54it/s] 38%|███▊      | 38/100 [00:24<00:40,  1.54it/s] 39%|███▉      | 39/100 [00:24<00:39,  1.54it/s] 40%|████      | 40/100 [00:25<00:38,  1.54it/s] 41%|████      | 41/100 [00:25<00:38,  1.55it/s] 42%|████▏     | 42/100 [00:26<00:37,  1.54it/s] 43%|████▎     | 43/100 [00:27<00:36,  1.54it/s] 44%|████▍     | 44/100 [00:27<00:36,  1.53it/s] 45%|████▌     | 45/100 [00:28<00:35,  1.54it/s] 46%|████▌     | 46/100 [00:29<00:35,  1.54it/s] 47%|████▋     | 47/100 [00:29<00:34,  1.54it/s] 48%|████▊     | 48/100 [00:30<00:33,  1.54it/s] 49%|████▉     | 49/100 [00:31<00:33,  1.54it/s] 50%|█████     | 50/100 [00:31<00:32,  1.54it/s] 51%|█████     | 51/100 [00:32<00:31,  1.54it/s] 52%|█████▏    | 52/100 [00:33<00:31,  1.55it/s] 53%|█████▎    | 53/100 [00:33<00:30,  1.55it/s] 54%|█████▍    | 54/100 [00:34<00:29,  1.54it/s] 55%|█████▌    | 55/100 [00:35<00:29,  1.54it/s] 56%|█████▌    | 56/100 [00:35<00:28,  1.54it/s] 57%|█████▋    | 57/100 [00:36<00:27,  1.54it/s] 58%|█████▊    | 58/100 [00:36<00:27,  1.54it/s] 59%|█████▉    | 59/100 [00:37<00:26,  1.54it/s] 60%|██████    | 60/100 [00:38<00:25,  1.54it/s] 61%|██████    | 61/100 [00:38<00:25,  1.55it/s] 62%|██████▏   | 62/100 [00:39<00:24,  1.55it/s] 63%|██████▎   | 63/100 [00:40<00:23,  1.55it/s] 64%|██████▍   | 64/100 [00:40<00:23,  1.55it/s] 65%|██████▌   | 65/100 [00:41<00:22,  1.55it/s] 66%|██████▌   | 66/100 [00:42<00:21,  1.55it/s] 67%|██████▋   | 67/100 [00:42<00:21,  1.55it/s] 68%|██████▊   | 68/100 [00:43<00:20,  1.55it/s] 69%|██████▉   | 69/100 [00:44<00:20,  1.55it/s] 70%|███████   | 70/100 [00:44<00:19,  1.55it/s] 71%|███████   | 71/100 [00:45<00:18,  1.54it/s] 72%|███████▏  | 72/100 [00:46<00:18,  1.54it/s] 73%|███████▎  | 73/100 [00:46<00:17,  1.55it/s] 74%|███████▍  | 74/100 [00:47<00:16,  1.54it/s] 75%|███████▌  | 75/100 [00:47<00:16,  1.54it/s] 76%|███████▌  | 76/100 [00:48<00:15,  1.54it/s] 77%|███████▋  | 77/100 [00:49<00:14,  1.54it/s] 78%|███████▊  | 78/100 [00:49<00:14,  1.54it/s] 79%|███████▉  | 79/100 [00:50<00:13,  1.54it/s] 80%|████████  | 80/100 [00:51<00:12,  1.54it/s] 81%|████████  | 81/100 [00:51<00:12,  1.54it/s] 82%|████████▏ | 82/100 [00:52<00:11,  1.54it/s] 83%|████████▎ | 83/100 [00:53<00:11,  1.54it/s] 84%|████████▍ | 84/100 [00:53<00:10,  1.54it/s] 85%|████████▌ | 85/100 [00:54<00:09,  1.55it/s] 86%|████████▌ | 86/100 [00:55<00:09,  1.55it/s] 87%|████████▋ | 87/100 [00:55<00:08,  1.55it/s] 88%|████████▊ | 88/100 [00:56<00:07,  1.55it/s] 89%|████████▉ | 89/100 [00:57<00:07,  1.54it/s] 90%|█████████ | 90/100 [00:57<00:06,  1.54it/s] 91%|█████████ | 91/100 [00:58<00:05,  1.54it/s] 92%|█████████▏| 92/100 [00:59<00:05,  1.54it/s] 93%|█████████▎| 93/100 [00:59<00:04,  1.54it/s] 94%|█████████▍| 94/100 [01:00<00:03,  1.54it/s] 95%|█████████▌| 95/100 [01:00<00:03,  1.54it/s] 96%|█████████▌| 96/100 [01:01<00:02,  1.54it/s] 97%|█████████▋| 97/100 [01:02<00:01,  1.54it/s] 98%|█████████▊| 98/100 [01:02<00:01,  1.54it/s] 99%|█████████▉| 99/100 [01:03<00:00,  1.55it/s]100%|██████████| 100/100 [01:04<00:00,  1.55it/s]100%|██████████| 100/100 [01:04<00:00,  1.56it/s]
2023-06-14 19:39:45 [INFO] {
2023-06-14 19:39:45 [INFO]     'eval_loss': 1.1737359762191772,
2023-06-14 19:39:45 [INFO]     'eval_runtime': 64.8306,
2023-06-14 19:39:45 [INFO]     'eval_samples_per_second': 1.542,
2023-06-14 19:39:45 [INFO]     'eval_steps_per_second': 1.542
2023-06-14 19:39:45 [INFO] }
2023-06-14 19:39:45 [INFO] metric: 1.542
2023-06-14 19:39:45 [INFO] Throughput: 1.542 samples/sec
2023-06-14 19:39:45 [INFO] Tune 3 result is: [Accuracy (int8|fp32): 1.5420|1.4340, Duration (seconds) (int8|fp32): 64.8378|69.7499], Best tune result is: [Accuracy: 1.5570, Duration (seconds): 64.2151]
2023-06-14 19:39:45 [INFO] |**********************Tune Result Statistics**********************|
2023-06-14 19:39:45 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:39:45 [INFO] |     Info Type      | Baseline | Tune 3 result | Best tune result |
2023-06-14 19:39:45 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:39:45 [INFO] |      Accuracy      | 1.4340   |    1.5420     |     1.5570       |
2023-06-14 19:39:45 [INFO] | Duration (seconds) | 69.7499  |    64.8378    |     64.2151      |
2023-06-14 19:39:45 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:39:45 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-19-27/./history.snapshot.
2023-06-14 19:39:46 [INFO] |******Mixed Precision Statistics******|
2023-06-14 19:39:46 [INFO] +-------------+--------+------+--------+
2023-06-14 19:39:46 [INFO] |   Op Type   | Total  | INT8 |  FP32  |
2023-06-14 19:39:46 [INFO] +-------------+--------+------+--------+
2023-06-14 19:39:46 [INFO] |  Embedding  |   2    |  1   |   1    |
2023-06-14 19:39:46 [INFO] |    Linear   |   1    |  1   |   0    |
2023-06-14 19:39:46 [INFO] +-------------+--------+------+--------+
2023-06-14 19:39:46 [INFO] Pass quantize model elapsed time: 962.06 ms
2023-06-14 19:39:46 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: output, input, code.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:31,  3.15it/s]  3%|▎         | 3/100 [00:01<00:43,  2.22it/s]  4%|▍         | 4/100 [00:01<00:49,  1.92it/s]  5%|▌         | 5/100 [00:02<00:53,  1.79it/s]  6%|▌         | 6/100 [00:03<00:54,  1.71it/s]  7%|▋         | 7/100 [00:03<00:55,  1.66it/s]  8%|▊         | 8/100 [00:04<00:56,  1.63it/s]  9%|▉         | 9/100 [00:05<00:56,  1.62it/s] 10%|█         | 10/100 [00:05<00:56,  1.60it/s] 11%|█         | 11/100 [00:06<00:55,  1.60it/s] 12%|█▏        | 12/100 [00:06<00:55,  1.59it/s] 13%|█▎        | 13/100 [00:07<00:54,  1.59it/s] 14%|█▍        | 14/100 [00:08<00:54,  1.58it/s] 15%|█▌        | 15/100 [00:08<00:53,  1.58it/s] 16%|█▌        | 16/100 [00:09<00:53,  1.58it/s] 17%|█▋        | 17/100 [00:10<00:52,  1.58it/s] 18%|█▊        | 18/100 [00:10<00:51,  1.58it/s] 19%|█▉        | 19/100 [00:11<00:51,  1.58it/s] 20%|██        | 20/100 [00:12<00:50,  1.58it/s] 21%|██        | 21/100 [00:12<00:50,  1.58it/s] 22%|██▏       | 22/100 [00:13<00:49,  1.57it/s] 23%|██▎       | 23/100 [00:13<00:49,  1.57it/s] 24%|██▍       | 24/100 [00:14<00:48,  1.57it/s] 25%|██▌       | 25/100 [00:15<00:47,  1.57it/s] 26%|██▌       | 26/100 [00:15<00:47,  1.57it/s] 27%|██▋       | 27/100 [00:16<00:46,  1.57it/s] 28%|██▊       | 28/100 [00:17<00:45,  1.57it/s] 29%|██▉       | 29/100 [00:17<00:45,  1.57it/s] 30%|███       | 30/100 [00:18<00:44,  1.57it/s] 31%|███       | 31/100 [00:19<00:43,  1.57it/s] 32%|███▏      | 32/100 [00:19<00:43,  1.57it/s] 33%|███▎      | 33/100 [00:20<00:42,  1.57it/s] 34%|███▍      | 34/100 [00:20<00:41,  1.57it/s] 35%|███▌      | 35/100 [00:21<00:41,  1.57it/s] 36%|███▌      | 36/100 [00:22<00:40,  1.57it/s] 37%|███▋      | 37/100 [00:22<00:40,  1.57it/s] 38%|███▊      | 38/100 [00:23<00:39,  1.57it/s] 39%|███▉      | 39/100 [00:24<00:38,  1.57it/s] 40%|████      | 40/100 [00:24<00:38,  1.57it/s] 41%|████      | 41/100 [00:25<00:37,  1.57it/s] 42%|████▏     | 42/100 [00:26<00:36,  1.57it/s] 43%|████▎     | 43/100 [00:26<00:36,  1.57it/s] 44%|████▍     | 44/100 [00:27<00:35,  1.57it/s] 45%|████▌     | 45/100 [00:27<00:34,  1.57it/s] 46%|████▌     | 46/100 [00:28<00:34,  1.57it/s] 47%|████▋     | 47/100 [00:29<00:33,  1.57it/s] 48%|████▊     | 48/100 [00:29<00:33,  1.57it/s] 49%|████▉     | 49/100 [00:30<00:32,  1.58it/s] 50%|█████     | 50/100 [00:31<00:31,  1.57it/s] 51%|█████     | 51/100 [00:31<00:31,  1.57it/s] 52%|█████▏    | 52/100 [00:32<00:30,  1.57it/s] 53%|█████▎    | 53/100 [00:33<00:29,  1.57it/s] 54%|█████▍    | 54/100 [00:33<00:29,  1.57it/s] 55%|█████▌    | 55/100 [00:34<00:28,  1.57it/s] 56%|█████▌    | 56/100 [00:34<00:28,  1.57it/s] 57%|█████▋    | 57/100 [00:35<00:27,  1.57it/s] 58%|█████▊    | 58/100 [00:36<00:26,  1.57it/s] 59%|█████▉    | 59/100 [00:36<00:26,  1.57it/s] 60%|██████    | 60/100 [00:37<00:25,  1.57it/s] 61%|██████    | 61/100 [00:38<00:24,  1.57it/s] 62%|██████▏   | 62/100 [00:38<00:24,  1.57it/s] 63%|██████▎   | 63/100 [00:39<00:23,  1.57it/s] 64%|██████▍   | 64/100 [00:40<00:22,  1.57it/s] 65%|██████▌   | 65/100 [00:40<00:22,  1.57it/s] 66%|██████▌   | 66/100 [00:41<00:21,  1.57it/s] 67%|██████▋   | 67/100 [00:41<00:21,  1.57it/s] 68%|██████▊   | 68/100 [00:42<00:20,  1.57it/s] 69%|██████▉   | 69/100 [00:43<00:19,  1.57it/s] 70%|███████   | 70/100 [00:43<00:19,  1.57it/s] 71%|███████   | 71/100 [00:44<00:18,  1.57it/s] 72%|███████▏  | 72/100 [00:45<00:17,  1.57it/s] 73%|███████▎  | 73/100 [00:45<00:17,  1.57it/s] 74%|███████▍  | 74/100 [00:46<00:16,  1.57it/s] 75%|███████▌  | 75/100 [00:47<00:15,  1.57it/s] 76%|███████▌  | 76/100 [00:47<00:15,  1.57it/s] 77%|███████▋  | 77/100 [00:48<00:14,  1.57it/s] 78%|███████▊  | 78/100 [00:48<00:14,  1.57it/s] 79%|███████▉  | 79/100 [00:49<00:13,  1.57it/s] 80%|████████  | 80/100 [00:50<00:12,  1.57it/s] 81%|████████  | 81/100 [00:50<00:12,  1.57it/s] 82%|████████▏ | 82/100 [00:51<00:11,  1.57it/s] 83%|████████▎ | 83/100 [00:52<00:10,  1.57it/s] 84%|████████▍ | 84/100 [00:52<00:10,  1.57it/s] 85%|████████▌ | 85/100 [00:53<00:09,  1.57it/s] 86%|████████▌ | 86/100 [00:54<00:08,  1.57it/s] 87%|████████▋ | 87/100 [00:54<00:08,  1.57it/s] 88%|████████▊ | 88/100 [00:55<00:07,  1.57it/s] 89%|████████▉ | 89/100 [00:55<00:06,  1.57it/s] 90%|█████████ | 90/100 [00:56<00:06,  1.57it/s] 91%|█████████ | 91/100 [00:57<00:05,  1.57it/s] 92%|█████████▏| 92/100 [00:57<00:05,  1.57it/s] 93%|█████████▎| 93/100 [00:58<00:04,  1.57it/s] 94%|█████████▍| 94/100 [00:59<00:03,  1.57it/s] 95%|█████████▌| 95/100 [00:59<00:03,  1.57it/s] 96%|█████████▌| 96/100 [01:00<00:02,  1.57it/s] 97%|█████████▋| 97/100 [01:01<00:01,  1.57it/s] 98%|█████████▊| 98/100 [01:01<00:01,  1.57it/s] 99%|█████████▉| 99/100 [01:02<00:00,  1.57it/s]100%|██████████| 100/100 [01:02<00:00,  1.57it/s]100%|██████████| 100/100 [01:02<00:00,  1.59it/s]
2023-06-14 19:40:50 [INFO] {
2023-06-14 19:40:50 [INFO]     'eval_loss': 1.1746976375579834,
2023-06-14 19:40:50 [INFO]     'eval_runtime': 63.6152,
2023-06-14 19:40:50 [INFO]     'eval_samples_per_second': 1.572,
2023-06-14 19:40:50 [INFO]     'eval_steps_per_second': 1.572
2023-06-14 19:40:50 [INFO] }
2023-06-14 19:40:50 [INFO] metric: 1.572
2023-06-14 19:40:50 [INFO] Throughput: 1.572 samples/sec
2023-06-14 19:40:50 [INFO] Tune 4 result is: [Accuracy (int8|fp32): 1.5720|1.4340, Duration (seconds) (int8|fp32): 63.6209|69.7499], Best tune result is: [Accuracy: 1.5720, Duration (seconds): 63.6209]
2023-06-14 19:40:50 [INFO] |**********************Tune Result Statistics**********************|
2023-06-14 19:40:50 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:40:50 [INFO] |     Info Type      | Baseline | Tune 4 result | Best tune result |
2023-06-14 19:40:50 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:40:50 [INFO] |      Accuracy      | 1.4340   |    1.5720     |     1.5720       |
2023-06-14 19:40:50 [INFO] | Duration (seconds) | 69.7499  |    63.6209    |     63.6209      |
2023-06-14 19:40:50 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:40:50 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-19-27/./history.snapshot.
2023-06-14 19:40:51 [INFO] |******Mixed Precision Statistics******|
2023-06-14 19:40:51 [INFO] +-------------+--------+------+--------+
2023-06-14 19:40:51 [INFO] |   Op Type   | Total  | INT8 |  FP32  |
2023-06-14 19:40:51 [INFO] +-------------+--------+------+--------+
2023-06-14 19:40:51 [INFO] |  Embedding  |   2    |  1   |   1    |
2023-06-14 19:40:51 [INFO] |    Linear   |   1    |  1   |   0    |
2023-06-14 19:40:51 [INFO] +-------------+--------+------+--------+
2023-06-14 19:40:51 [INFO] Pass quantize model elapsed time: 858.6 ms
2023-06-14 19:40:51 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: output, input, code.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:31,  3.12it/s]  3%|▎         | 3/100 [00:01<00:43,  2.21it/s]  4%|▍         | 4/100 [00:01<00:50,  1.92it/s]  5%|▌         | 5/100 [00:02<00:53,  1.78it/s]  6%|▌         | 6/100 [00:03<00:55,  1.70it/s]  7%|▋         | 7/100 [00:03<00:56,  1.66it/s]  8%|▊         | 8/100 [00:04<00:56,  1.63it/s]  9%|▉         | 9/100 [00:05<00:56,  1.61it/s] 10%|█         | 10/100 [00:05<00:56,  1.59it/s] 11%|█         | 11/100 [00:06<00:56,  1.59it/s] 12%|█▏        | 12/100 [00:07<00:55,  1.58it/s] 13%|█▎        | 13/100 [00:07<00:55,  1.57it/s] 14%|█▍        | 14/100 [00:08<00:54,  1.57it/s] 15%|█▌        | 15/100 [00:08<00:54,  1.57it/s] 16%|█▌        | 16/100 [00:09<00:53,  1.57it/s] 17%|█▋        | 17/100 [00:10<00:52,  1.57it/s] 18%|█▊        | 18/100 [00:10<00:52,  1.57it/s] 19%|█▉        | 19/100 [00:11<00:51,  1.57it/s] 20%|██        | 20/100 [00:12<00:51,  1.57it/s] 21%|██        | 21/100 [00:12<00:50,  1.57it/s] 22%|██▏       | 22/100 [00:13<00:49,  1.57it/s] 23%|██▎       | 23/100 [00:14<00:49,  1.57it/s] 24%|██▍       | 24/100 [00:14<00:48,  1.57it/s] 25%|██▌       | 25/100 [00:15<00:47,  1.57it/s] 26%|██▌       | 26/100 [00:15<00:47,  1.57it/s] 27%|██▋       | 27/100 [00:16<00:46,  1.56it/s] 28%|██▊       | 28/100 [00:17<00:46,  1.56it/s] 29%|██▉       | 29/100 [00:17<00:45,  1.57it/s] 30%|███       | 30/100 [00:18<00:44,  1.57it/s] 31%|███       | 31/100 [00:19<00:44,  1.57it/s] 32%|███▏      | 32/100 [00:19<00:43,  1.57it/s] 33%|███▎      | 33/100 [00:20<00:42,  1.57it/s] 34%|███▍      | 34/100 [00:21<00:42,  1.56it/s] 35%|███▌      | 35/100 [00:21<00:41,  1.56it/s] 36%|███▌      | 36/100 [00:22<00:40,  1.57it/s] 37%|███▋      | 37/100 [00:22<00:40,  1.57it/s] 38%|███▊      | 38/100 [00:23<00:39,  1.57it/s] 39%|███▉      | 39/100 [00:24<00:38,  1.57it/s] 40%|████      | 40/100 [00:24<00:38,  1.57it/s] 41%|████      | 41/100 [00:25<00:37,  1.56it/s] 42%|████▏     | 42/100 [00:26<00:37,  1.56it/s] 43%|████▎     | 43/100 [00:26<00:36,  1.56it/s] 44%|████▍     | 44/100 [00:27<00:35,  1.57it/s] 45%|████▌     | 45/100 [00:28<00:35,  1.57it/s] 46%|████▌     | 46/100 [00:28<00:34,  1.56it/s] 47%|████▋     | 47/100 [00:29<00:33,  1.56it/s] 48%|████▊     | 48/100 [00:30<00:33,  1.56it/s] 49%|████▉     | 49/100 [00:30<00:32,  1.56it/s] 50%|█████     | 50/100 [00:31<00:31,  1.56it/s] 51%|█████     | 51/100 [00:31<00:31,  1.56it/s] 52%|█████▏    | 52/100 [00:32<00:30,  1.56it/s] 53%|█████▎    | 53/100 [00:33<00:30,  1.56it/s] 54%|█████▍    | 54/100 [00:33<00:29,  1.56it/s] 55%|█████▌    | 55/100 [00:34<00:28,  1.56it/s] 56%|█████▌    | 56/100 [00:35<00:28,  1.56it/s] 57%|█████▋    | 57/100 [00:35<00:27,  1.56it/s] 58%|█████▊    | 58/100 [00:36<00:26,  1.56it/s] 59%|█████▉    | 59/100 [00:37<00:26,  1.57it/s] 60%|██████    | 60/100 [00:37<00:25,  1.56it/s] 61%|██████    | 61/100 [00:38<00:24,  1.56it/s] 62%|██████▏   | 62/100 [00:38<00:24,  1.57it/s] 63%|██████▎   | 63/100 [00:39<00:23,  1.57it/s] 64%|██████▍   | 64/100 [00:40<00:23,  1.56it/s] 65%|██████▌   | 65/100 [00:40<00:22,  1.56it/s] 66%|██████▌   | 66/100 [00:41<00:21,  1.56it/s] 67%|██████▋   | 67/100 [00:42<00:21,  1.56it/s] 68%|██████▊   | 68/100 [00:42<00:20,  1.56it/s] 69%|██████▉   | 69/100 [00:43<00:19,  1.56it/s] 70%|███████   | 70/100 [00:44<00:19,  1.56it/s] 71%|███████   | 71/100 [00:44<00:18,  1.56it/s] 72%|███████▏  | 72/100 [00:45<00:17,  1.56it/s] 73%|███████▎  | 73/100 [00:46<00:17,  1.56it/s] 74%|███████▍  | 74/100 [00:46<00:16,  1.56it/s] 75%|███████▌  | 75/100 [00:47<00:15,  1.56it/s] 76%|███████▌  | 76/100 [00:47<00:15,  1.56it/s] 77%|███████▋  | 77/100 [00:48<00:14,  1.56it/s] 78%|███████▊  | 78/100 [00:49<00:14,  1.56it/s] 79%|███████▉  | 79/100 [00:49<00:13,  1.56it/s] 80%|████████  | 80/100 [00:50<00:12,  1.56it/s] 81%|████████  | 81/100 [00:51<00:12,  1.57it/s] 82%|████████▏ | 82/100 [00:51<00:11,  1.56it/s] 83%|████████▎ | 83/100 [00:52<00:10,  1.56it/s] 84%|████████▍ | 84/100 [00:53<00:10,  1.56it/s] 85%|████████▌ | 85/100 [00:53<00:09,  1.56it/s] 86%|████████▌ | 86/100 [00:54<00:08,  1.56it/s] 87%|████████▋ | 87/100 [00:54<00:08,  1.56it/s] 88%|████████▊ | 88/100 [00:55<00:07,  1.57it/s] 89%|████████▉ | 89/100 [00:56<00:07,  1.57it/s] 90%|█████████ | 90/100 [00:56<00:06,  1.57it/s] 91%|█████████ | 91/100 [00:57<00:05,  1.57it/s] 92%|█████████▏| 92/100 [00:58<00:05,  1.57it/s] 93%|█████████▎| 93/100 [00:58<00:04,  1.57it/s] 94%|█████████▍| 94/100 [00:59<00:03,  1.57it/s] 95%|█████████▌| 95/100 [01:00<00:03,  1.57it/s] 96%|█████████▌| 96/100 [01:00<00:02,  1.57it/s] 97%|█████████▋| 97/100 [01:01<00:01,  1.57it/s] 98%|█████████▊| 98/100 [01:01<00:01,  1.57it/s] 99%|█████████▉| 99/100 [01:02<00:00,  1.57it/s]100%|██████████| 100/100 [01:03<00:00,  1.57it/s]100%|██████████| 100/100 [01:03<00:00,  1.58it/s]
2023-06-14 19:41:55 [INFO] {
2023-06-14 19:41:55 [INFO]     'eval_loss': 1.1748887300491333,
2023-06-14 19:41:55 [INFO]     'eval_runtime': 63.9014,
2023-06-14 19:41:55 [INFO]     'eval_samples_per_second': 1.565,
2023-06-14 19:41:55 [INFO]     'eval_steps_per_second': 1.565
2023-06-14 19:41:55 [INFO] }
2023-06-14 19:41:55 [INFO] metric: 1.565
2023-06-14 19:41:55 [INFO] Throughput: 1.565 samples/sec
2023-06-14 19:41:55 [INFO] Tune 5 result is: [Accuracy (int8|fp32): 1.5650|1.4340, Duration (seconds) (int8|fp32): 63.9070|69.7499], Best tune result is: [Accuracy: 1.5720, Duration (seconds): 63.6209]
2023-06-14 19:41:55 [INFO] |**********************Tune Result Statistics**********************|
2023-06-14 19:41:55 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:41:55 [INFO] |     Info Type      | Baseline | Tune 5 result | Best tune result |
2023-06-14 19:41:55 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:41:55 [INFO] |      Accuracy      | 1.4340   |    1.5650     |     1.5720       |
2023-06-14 19:41:55 [INFO] | Duration (seconds) | 69.7499  |    63.9070    |     63.6209      |
2023-06-14 19:41:55 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:41:55 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-19-27/./history.snapshot.
2023-06-14 19:41:55 [INFO] Start to accumulate fallback to fp32.
2023-06-14 19:41:56 [INFO] |******Mixed Precision Statistics******|
2023-06-14 19:41:56 [INFO] +-------------+--------+------+--------+
2023-06-14 19:41:56 [INFO] |   Op Type   | Total  | INT8 |  FP32  |
2023-06-14 19:41:56 [INFO] +-------------+--------+------+--------+
2023-06-14 19:41:56 [INFO] |  Embedding  |   2    |  0   |   2    |
2023-06-14 19:41:56 [INFO] |    Linear   |   1    |  1   |   0    |
2023-06-14 19:41:56 [INFO] +-------------+--------+------+--------+
2023-06-14 19:41:56 [INFO] Pass quantize model elapsed time: 800.09 ms
2023-06-14 19:41:56 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: output, input, code.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:32,  3.06it/s]  3%|▎         | 3/100 [00:01<00:44,  2.16it/s]  4%|▍         | 4/100 [00:01<00:51,  1.87it/s]  5%|▌         | 5/100 [00:02<00:54,  1.74it/s]  6%|▌         | 6/100 [00:03<00:56,  1.66it/s]  7%|▋         | 7/100 [00:03<00:57,  1.62it/s]  8%|▊         | 8/100 [00:04<00:58,  1.58it/s]  9%|▉         | 9/100 [00:05<00:58,  1.56it/s] 10%|█         | 10/100 [00:05<00:58,  1.55it/s] 11%|█         | 11/100 [00:06<00:57,  1.54it/s] 12%|█▏        | 12/100 [00:07<00:57,  1.53it/s] 13%|█▎        | 13/100 [00:07<00:56,  1.53it/s] 14%|█▍        | 14/100 [00:08<00:56,  1.53it/s] 15%|█▌        | 15/100 [00:09<00:55,  1.53it/s] 16%|█▌        | 16/100 [00:09<00:54,  1.53it/s] 17%|█▋        | 17/100 [00:10<00:54,  1.53it/s] 18%|█▊        | 18/100 [00:11<00:53,  1.53it/s] 19%|█▉        | 19/100 [00:11<00:52,  1.53it/s] 20%|██        | 20/100 [00:12<00:52,  1.53it/s] 21%|██        | 21/100 [00:13<00:51,  1.53it/s] 22%|██▏       | 22/100 [00:13<00:50,  1.53it/s] 23%|██▎       | 23/100 [00:14<00:50,  1.53it/s] 24%|██▍       | 24/100 [00:15<00:49,  1.53it/s] 25%|██▌       | 25/100 [00:15<00:48,  1.53it/s] 26%|██▌       | 26/100 [00:16<00:48,  1.53it/s] 27%|██▋       | 27/100 [00:17<00:47,  1.53it/s] 28%|██▊       | 28/100 [00:17<00:46,  1.53it/s] 29%|██▉       | 29/100 [00:18<00:46,  1.53it/s] 30%|███       | 30/100 [00:18<00:45,  1.53it/s] 31%|███       | 31/100 [00:19<00:45,  1.53it/s] 32%|███▏      | 32/100 [00:20<00:44,  1.53it/s] 33%|███▎      | 33/100 [00:20<00:43,  1.53it/s] 34%|███▍      | 34/100 [00:21<00:43,  1.53it/s] 35%|███▌      | 35/100 [00:22<00:42,  1.53it/s] 36%|███▌      | 36/100 [00:22<00:41,  1.53it/s] 37%|███▋      | 37/100 [00:23<00:41,  1.53it/s] 38%|███▊      | 38/100 [00:24<00:40,  1.53it/s] 39%|███▉      | 39/100 [00:24<00:39,  1.53it/s] 40%|████      | 40/100 [00:25<00:39,  1.53it/s] 41%|████      | 41/100 [00:26<00:38,  1.53it/s] 42%|████▏     | 42/100 [00:26<00:37,  1.53it/s] 43%|████▎     | 43/100 [00:27<00:37,  1.53it/s] 44%|████▍     | 44/100 [00:28<00:36,  1.52it/s] 45%|████▌     | 45/100 [00:28<00:36,  1.52it/s] 46%|████▌     | 46/100 [00:29<00:35,  1.53it/s] 47%|████▋     | 47/100 [00:30<00:34,  1.53it/s] 48%|████▊     | 48/100 [00:30<00:34,  1.53it/s] 49%|████▉     | 49/100 [00:31<00:33,  1.53it/s] 50%|█████     | 50/100 [00:32<00:32,  1.53it/s] 51%|█████     | 51/100 [00:32<00:32,  1.53it/s] 52%|█████▏    | 52/100 [00:33<00:31,  1.53it/s] 53%|█████▎    | 53/100 [00:34<00:30,  1.53it/s] 54%|█████▍    | 54/100 [00:34<00:30,  1.53it/s] 55%|█████▌    | 55/100 [00:35<00:29,  1.53it/s] 56%|█████▌    | 56/100 [00:35<00:28,  1.53it/s] 57%|█████▋    | 57/100 [00:36<00:28,  1.53it/s] 58%|█████▊    | 58/100 [00:37<00:27,  1.53it/s] 59%|█████▉    | 59/100 [00:37<00:26,  1.53it/s] 60%|██████    | 60/100 [00:38<00:26,  1.53it/s] 61%|██████    | 61/100 [00:39<00:25,  1.53it/s] 62%|██████▏   | 62/100 [00:39<00:25,  1.51it/s] 63%|██████▎   | 63/100 [00:40<00:24,  1.52it/s] 64%|██████▍   | 64/100 [00:41<00:23,  1.52it/s] 65%|██████▌   | 65/100 [00:41<00:22,  1.52it/s] 66%|██████▌   | 66/100 [00:42<00:22,  1.52it/s] 67%|██████▋   | 67/100 [00:43<00:21,  1.53it/s] 68%|██████▊   | 68/100 [00:43<00:20,  1.53it/s] 69%|██████▉   | 69/100 [00:44<00:20,  1.53it/s] 70%|███████   | 70/100 [00:45<00:19,  1.53it/s] 71%|███████   | 71/100 [00:45<00:19,  1.53it/s] 72%|███████▏  | 72/100 [00:46<00:18,  1.53it/s] 73%|███████▎  | 73/100 [00:47<00:17,  1.53it/s] 74%|███████▍  | 74/100 [00:47<00:17,  1.53it/s] 75%|███████▌  | 75/100 [00:48<00:16,  1.53it/s] 76%|███████▌  | 76/100 [00:49<00:15,  1.53it/s] 77%|███████▋  | 77/100 [00:49<00:15,  1.53it/s] 78%|███████▊  | 78/100 [00:50<00:14,  1.53it/s] 79%|███████▉  | 79/100 [00:51<00:13,  1.53it/s] 80%|████████  | 80/100 [00:51<00:13,  1.52it/s] 81%|████████  | 81/100 [00:52<00:12,  1.53it/s] 82%|████████▏ | 82/100 [00:53<00:11,  1.53it/s] 83%|████████▎ | 83/100 [00:53<00:11,  1.53it/s] 84%|████████▍ | 84/100 [00:54<00:10,  1.53it/s] 85%|████████▌ | 85/100 [00:54<00:09,  1.52it/s] 86%|████████▌ | 86/100 [00:55<00:09,  1.53it/s] 87%|████████▋ | 87/100 [00:56<00:08,  1.53it/s] 88%|████████▊ | 88/100 [00:56<00:07,  1.53it/s] 89%|████████▉ | 89/100 [00:57<00:07,  1.53it/s] 90%|█████████ | 90/100 [00:58<00:06,  1.53it/s] 91%|█████████ | 91/100 [00:58<00:05,  1.53it/s] 92%|█████████▏| 92/100 [00:59<00:05,  1.53it/s] 93%|█████████▎| 93/100 [01:00<00:04,  1.53it/s] 94%|█████████▍| 94/100 [01:00<00:03,  1.53it/s] 95%|█████████▌| 95/100 [01:01<00:03,  1.53it/s] 96%|█████████▌| 96/100 [01:02<00:02,  1.53it/s] 97%|█████████▋| 97/100 [01:02<00:01,  1.53it/s] 98%|█████████▊| 98/100 [01:03<00:01,  1.53it/s] 99%|█████████▉| 99/100 [01:04<00:00,  1.53it/s]100%|██████████| 100/100 [01:04<00:00,  1.53it/s]100%|██████████| 100/100 [01:04<00:00,  1.54it/s]
2023-06-14 19:43:01 [INFO] {
2023-06-14 19:43:01 [INFO]     'eval_loss': 1.174701452255249,
2023-06-14 19:43:01 [INFO]     'eval_runtime': 65.4579,
2023-06-14 19:43:01 [INFO]     'eval_samples_per_second': 1.528,
2023-06-14 19:43:01 [INFO]     'eval_steps_per_second': 1.528
2023-06-14 19:43:01 [INFO] }
2023-06-14 19:43:01 [INFO] metric: 1.528
2023-06-14 19:43:01 [INFO] Throughput: 1.528 samples/sec
2023-06-14 19:43:01 [INFO] Tune 6 result is: [Accuracy (int8|fp32): 1.5280|1.4340, Duration (seconds) (int8|fp32): 65.4632|69.7499], Best tune result is: [Accuracy: 1.5720, Duration (seconds): 63.6209]
2023-06-14 19:43:01 [INFO] |**********************Tune Result Statistics**********************|
2023-06-14 19:43:01 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:43:01 [INFO] |     Info Type      | Baseline | Tune 6 result | Best tune result |
2023-06-14 19:43:01 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:43:01 [INFO] |      Accuracy      | 1.4340   |    1.5280     |     1.5720       |
2023-06-14 19:43:01 [INFO] | Duration (seconds) | 69.7499  |    65.4632    |     63.6209      |
2023-06-14 19:43:01 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:43:01 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-19-27/./history.snapshot.
2023-06-14 19:43:02 [WARNING] None of the submodule got qconfig applied. Make sure you passed correct configuration through `qconfig_dict` or by assigning the `.qconfig` attribute directly on submodules.
2023-06-14 19:43:02 [INFO] |******Mixed Precision Statistics******|
2023-06-14 19:43:02 [INFO] +-----------------+----------+---------+
2023-06-14 19:43:02 [INFO] |     Op Type     |  Total   |   FP32  |
2023-06-14 19:43:02 [INFO] +-----------------+----------+---------+
2023-06-14 19:43:02 [INFO] |    Embedding    |    2     |    2    |
2023-06-14 19:43:02 [INFO] |      Linear     |    1     |    1    |
2023-06-14 19:43:02 [INFO] +-----------------+----------+---------+
2023-06-14 19:43:02 [INFO] Pass quantize model elapsed time: 162.17 ms
2023-06-14 19:43:02 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: output, input, code.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:31,  3.12it/s]  3%|▎         | 3/100 [00:01<00:44,  2.19it/s]  4%|▍         | 4/100 [00:01<00:50,  1.89it/s]  5%|▌         | 5/100 [00:02<00:54,  1.75it/s]  6%|▌         | 6/100 [00:03<00:55,  1.68it/s]  7%|▋         | 7/100 [00:03<00:56,  1.64it/s]  8%|▊         | 8/100 [00:04<00:57,  1.59it/s]  9%|▉         | 9/100 [00:05<00:58,  1.57it/s] 10%|█         | 10/100 [00:05<00:58,  1.54it/s] 11%|█         | 11/100 [00:06<00:57,  1.54it/s] 12%|█▏        | 12/100 [00:07<00:57,  1.53it/s] 13%|█▎        | 13/100 [00:07<00:56,  1.53it/s] 14%|█▍        | 14/100 [00:08<00:56,  1.53it/s] 15%|█▌        | 15/100 [00:09<00:55,  1.52it/s] 16%|█▌        | 16/100 [00:09<00:55,  1.52it/s] 17%|█▋        | 17/100 [00:10<00:54,  1.53it/s] 18%|█▊        | 18/100 [00:11<00:53,  1.53it/s] 19%|█▉        | 19/100 [00:11<00:52,  1.53it/s] 20%|██        | 20/100 [00:12<00:52,  1.53it/s] 21%|██        | 21/100 [00:13<00:51,  1.53it/s] 22%|██▏       | 22/100 [00:13<00:51,  1.53it/s] 23%|██▎       | 23/100 [00:14<00:50,  1.53it/s] 24%|██▍       | 24/100 [00:15<00:49,  1.54it/s] 25%|██▌       | 25/100 [00:15<00:48,  1.54it/s] 26%|██▌       | 26/100 [00:16<00:48,  1.54it/s] 27%|██▋       | 27/100 [00:16<00:47,  1.53it/s] 28%|██▊       | 28/100 [00:17<00:46,  1.53it/s] 29%|██▉       | 29/100 [00:18<00:46,  1.54it/s] 30%|███       | 30/100 [00:18<00:45,  1.54it/s] 31%|███       | 31/100 [00:19<00:44,  1.54it/s] 32%|███▏      | 32/100 [00:20<00:44,  1.54it/s] 33%|███▎      | 33/100 [00:20<00:43,  1.52it/s] 34%|███▍      | 34/100 [00:21<00:43,  1.53it/s] 35%|███▌      | 35/100 [00:22<00:42,  1.53it/s] 36%|███▌      | 36/100 [00:22<00:41,  1.53it/s] 37%|███▋      | 37/100 [00:23<00:41,  1.53it/s] 38%|███▊      | 38/100 [00:24<00:40,  1.53it/s] 39%|███▉      | 39/100 [00:24<00:40,  1.52it/s] 40%|████      | 40/100 [00:25<00:39,  1.52it/s] 41%|████      | 41/100 [00:26<00:38,  1.53it/s] 42%|████▏     | 42/100 [00:26<00:38,  1.52it/s] 43%|████▎     | 43/100 [00:27<00:37,  1.53it/s] 44%|████▍     | 44/100 [00:28<00:36,  1.53it/s] 45%|████▌     | 45/100 [00:28<00:36,  1.52it/s] 46%|████▌     | 46/100 [00:29<00:35,  1.52it/s] 47%|████▋     | 47/100 [00:30<00:34,  1.52it/s] 48%|████▊     | 48/100 [00:30<00:33,  1.53it/s] 49%|████▉     | 49/100 [00:31<00:33,  1.53it/s] 50%|█████     | 50/100 [00:32<00:32,  1.53it/s] 51%|█████     | 51/100 [00:32<00:31,  1.53it/s] 52%|█████▏    | 52/100 [00:33<00:31,  1.54it/s] 53%|█████▎    | 53/100 [00:33<00:30,  1.54it/s] 54%|█████▍    | 54/100 [00:34<00:29,  1.53it/s] 55%|█████▌    | 55/100 [00:35<00:29,  1.54it/s] 56%|█████▌    | 56/100 [00:35<00:28,  1.54it/s] 57%|█████▋    | 57/100 [00:36<00:27,  1.54it/s] 58%|█████▊    | 58/100 [00:37<00:27,  1.53it/s] 59%|█████▉    | 59/100 [00:37<00:26,  1.53it/s] 60%|██████    | 60/100 [00:38<00:26,  1.52it/s] 61%|██████    | 61/100 [00:39<00:25,  1.52it/s] 62%|██████▏   | 62/100 [00:39<00:24,  1.53it/s] 63%|██████▎   | 63/100 [00:40<00:24,  1.52it/s] 64%|██████▍   | 64/100 [00:41<00:23,  1.53it/s] 65%|██████▌   | 65/100 [00:41<00:22,  1.52it/s] 66%|██████▌   | 66/100 [00:42<00:22,  1.53it/s] 67%|██████▋   | 67/100 [00:43<00:21,  1.54it/s] 68%|██████▊   | 68/100 [00:43<00:20,  1.54it/s] 69%|██████▉   | 69/100 [00:44<00:20,  1.54it/s] 70%|███████   | 70/100 [00:45<00:19,  1.54it/s] 71%|███████   | 71/100 [00:45<00:18,  1.54it/s] 72%|███████▏  | 72/100 [00:46<00:18,  1.53it/s] 73%|███████▎  | 73/100 [00:47<00:17,  1.53it/s] 74%|███████▍  | 74/100 [00:47<00:17,  1.53it/s] 75%|███████▌  | 75/100 [00:48<00:16,  1.53it/s] 76%|███████▌  | 76/100 [00:49<00:15,  1.53it/s] 77%|███████▋  | 77/100 [00:49<00:14,  1.53it/s] 78%|███████▊  | 78/100 [00:50<00:14,  1.53it/s] 79%|███████▉  | 79/100 [00:50<00:13,  1.52it/s] 80%|████████  | 80/100 [00:51<00:13,  1.52it/s] 81%|████████  | 81/100 [00:52<00:12,  1.52it/s] 82%|████████▏ | 82/100 [00:52<00:11,  1.52it/s] 83%|████████▎ | 83/100 [00:53<00:11,  1.52it/s] 84%|████████▍ | 84/100 [00:54<00:10,  1.53it/s] 85%|████████▌ | 85/100 [00:54<00:09,  1.52it/s] 86%|████████▌ | 86/100 [00:55<00:09,  1.52it/s] 87%|████████▋ | 87/100 [00:56<00:08,  1.51it/s] 88%|████████▊ | 88/100 [00:56<00:07,  1.50it/s] 89%|████████▉ | 89/100 [00:57<00:07,  1.47it/s] 90%|█████████ | 90/100 [00:58<00:06,  1.49it/s] 91%|█████████ | 91/100 [00:58<00:05,  1.51it/s] 92%|█████████▏| 92/100 [00:59<00:05,  1.50it/s] 93%|█████████▎| 93/100 [01:00<00:04,  1.50it/s] 94%|█████████▍| 94/100 [01:00<00:03,  1.50it/s] 95%|█████████▌| 95/100 [01:01<00:03,  1.50it/s] 96%|█████████▌| 96/100 [01:02<00:02,  1.51it/s] 97%|█████████▋| 97/100 [01:02<00:01,  1.52it/s] 98%|█████████▊| 98/100 [01:03<00:01,  1.51it/s] 99%|█████████▉| 99/100 [01:04<00:00,  1.52it/s]100%|██████████| 100/100 [01:04<00:00,  1.52it/s]100%|██████████| 100/100 [01:04<00:00,  1.54it/s]
2023-06-14 19:44:07 [INFO] {
2023-06-14 19:44:07 [INFO]     'eval_loss': 1.1736871004104614,
2023-06-14 19:44:07 [INFO]     'eval_runtime': 65.5244,
2023-06-14 19:44:07 [INFO]     'eval_samples_per_second': 1.526,
2023-06-14 19:44:07 [INFO]     'eval_steps_per_second': 1.526
2023-06-14 19:44:07 [INFO] }
2023-06-14 19:44:07 [INFO] metric: 1.526
2023-06-14 19:44:07 [INFO] Throughput: 1.526 samples/sec
2023-06-14 19:44:07 [INFO] Tune 7 result is: [Accuracy (int8|fp32): 1.5260|1.4340, Duration (seconds) (int8|fp32): 65.5295|69.7499], Best tune result is: [Accuracy: 1.5720, Duration (seconds): 63.6209]
2023-06-14 19:44:07 [INFO] |**********************Tune Result Statistics**********************|
2023-06-14 19:44:07 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:44:07 [INFO] |     Info Type      | Baseline | Tune 7 result | Best tune result |
2023-06-14 19:44:07 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:44:07 [INFO] |      Accuracy      | 1.4340   |    1.5260     |     1.5720       |
2023-06-14 19:44:07 [INFO] | Duration (seconds) | 69.7499  |    65.5295    |     63.6209      |
2023-06-14 19:44:07 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:44:07 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-19-27/./history.snapshot.
2023-06-14 19:44:08 [INFO] |******Mixed Precision Statistics******|
2023-06-14 19:44:08 [INFO] +-------------+--------+------+--------+
2023-06-14 19:44:08 [INFO] |   Op Type   | Total  | INT8 |  FP32  |
2023-06-14 19:44:08 [INFO] +-------------+--------+------+--------+
2023-06-14 19:44:08 [INFO] |  Embedding  |   2    |  1   |   1    |
2023-06-14 19:44:08 [INFO] |    Linear   |   1    |  1   |   0    |
2023-06-14 19:44:08 [INFO] +-------------+--------+------+--------+
2023-06-14 19:44:08 [INFO] Pass quantize model elapsed time: 881.25 ms
2023-06-14 19:44:08 [INFO] Specified timeout or max trials is reached! Found a quantized model which meet accuracy goal. Exit.
2023-06-14 19:44:09 [INFO] Save deploy yaml to /scratch/dsochirca/nc_workspace/2023-06-14_19-19-27/deploy.yaml
2023-06-14 19:44:09 [INFO] Saving model checkpoint to ./test_epoch
2023-06-14 19:44:15 [INFO] quantized model and configure file have saved to ./test_epoch
2023-06-14 19:44:17 [INFO] Saving model checkpoint to ./models/CodeGPT-Py150_0.6_sparse_q_only_weights_asym_per_tensor
2023-06-14 19:44:31 [INFO] quantized model and configure file have saved to ./models/CodeGPT-Py150_0.6_sparse_q_only_weights_asym_per_tensor
2023-06-14 19:44:32 [WARNING] Force convert framework model to neural_compressor model.
2023-06-14 19:44:32 [INFO] Pass query framework capability elapsed time: 1.11 ms
2023-06-14 19:44:32 [INFO] Adaptor has 1 recipes.
2023-06-14 19:44:32 [INFO] 0 recipes specified by user.
2023-06-14 19:44:32 [INFO] 0 recipes require future tuning.
2023-06-14 19:44:32 [INFO] ..............use_distributed_tuning: None
2023-06-14 19:44:32 [INFO] Get FP32 model baseline.
2023-06-14 19:44:32 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: output, input, code.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:34,  2.82it/s]  3%|▎         | 3/100 [00:01<00:48,  2.01it/s]  4%|▍         | 4/100 [00:02<00:54,  1.75it/s]  5%|▌         | 5/100 [00:02<00:58,  1.62it/s]  6%|▌         | 6/100 [00:03<01:00,  1.55it/s]  7%|▋         | 7/100 [00:04<01:01,  1.52it/s]  8%|▊         | 8/100 [00:04<01:01,  1.49it/s]  9%|▉         | 9/100 [00:05<01:01,  1.48it/s] 10%|█         | 10/100 [00:06<01:02,  1.45it/s] 11%|█         | 11/100 [00:06<01:00,  1.46it/s] 12%|█▏        | 12/100 [00:07<01:00,  1.45it/s] 13%|█▎        | 13/100 [00:08<00:59,  1.45it/s] 14%|█▍        | 14/100 [00:09<00:59,  1.43it/s] 15%|█▌        | 15/100 [00:09<00:58,  1.44it/s] 16%|█▌        | 16/100 [00:10<00:57,  1.46it/s] 17%|█▋        | 17/100 [00:11<00:56,  1.46it/s] 18%|█▊        | 18/100 [00:11<00:57,  1.43it/s] 19%|█▉        | 19/100 [00:12<00:56,  1.44it/s] 20%|██        | 20/100 [00:13<00:55,  1.44it/s] 21%|██        | 21/100 [00:13<00:54,  1.44it/s] 22%|██▏       | 22/100 [00:14<00:55,  1.41it/s] 23%|██▎       | 23/100 [00:15<00:53,  1.43it/s] 24%|██▍       | 24/100 [00:16<00:53,  1.43it/s] 25%|██▌       | 25/100 [00:16<00:52,  1.43it/s] 26%|██▌       | 26/100 [00:17<00:51,  1.43it/s] 27%|██▋       | 27/100 [00:18<00:51,  1.41it/s] 28%|██▊       | 28/100 [00:18<00:50,  1.43it/s] 29%|██▉       | 29/100 [00:19<00:49,  1.45it/s] 30%|███       | 30/100 [00:20<00:47,  1.46it/s] 31%|███       | 31/100 [00:20<00:47,  1.44it/s] 32%|███▏      | 32/100 [00:21<00:47,  1.43it/s] 33%|███▎      | 33/100 [00:22<00:46,  1.44it/s] 34%|███▍      | 34/100 [00:22<00:45,  1.45it/s] 35%|███▌      | 35/100 [00:23<00:44,  1.44it/s] 36%|███▌      | 36/100 [00:24<00:45,  1.42it/s] 37%|███▋      | 37/100 [00:25<00:44,  1.43it/s] 38%|███▊      | 38/100 [00:25<00:44,  1.40it/s] 39%|███▉      | 39/100 [00:26<00:43,  1.40it/s] 40%|████      | 40/100 [00:27<00:42,  1.41it/s] 41%|████      | 41/100 [00:27<00:41,  1.42it/s] 42%|████▏     | 42/100 [00:28<00:40,  1.42it/s] 43%|████▎     | 43/100 [00:29<00:40,  1.41it/s] 44%|████▍     | 44/100 [00:30<00:39,  1.42it/s] 45%|████▌     | 45/100 [00:30<00:38,  1.41it/s] 46%|████▌     | 46/100 [00:31<00:37,  1.43it/s] 47%|████▋     | 47/100 [00:32<00:36,  1.44it/s] 48%|████▊     | 48/100 [00:32<00:36,  1.42it/s] 49%|████▉     | 49/100 [00:33<00:36,  1.42it/s] 50%|█████     | 50/100 [00:34<00:35,  1.40it/s] 51%|█████     | 51/100 [00:34<00:34,  1.43it/s] 52%|█████▏    | 52/100 [00:35<00:33,  1.43it/s] 53%|█████▎    | 53/100 [00:36<00:32,  1.44it/s] 54%|█████▍    | 54/100 [00:37<00:32,  1.42it/s] 55%|█████▌    | 55/100 [00:37<00:32,  1.40it/s] 56%|█████▌    | 56/100 [00:38<00:30,  1.42it/s] 57%|█████▋    | 57/100 [00:39<00:30,  1.43it/s] 58%|█████▊    | 58/100 [00:39<00:29,  1.42it/s] 59%|█████▉    | 59/100 [00:40<00:29,  1.40it/s] 60%|██████    | 60/100 [00:41<00:28,  1.39it/s] 61%|██████    | 61/100 [00:42<00:28,  1.38it/s] 62%|██████▏   | 62/100 [00:42<00:27,  1.38it/s] 63%|██████▎   | 63/100 [00:43<00:26,  1.38it/s] 64%|██████▍   | 64/100 [00:44<00:25,  1.39it/s] 65%|██████▌   | 65/100 [00:44<00:25,  1.40it/s] 66%|██████▌   | 66/100 [00:45<00:24,  1.40it/s] 67%|██████▋   | 67/100 [00:46<00:23,  1.40it/s] 68%|██████▊   | 68/100 [00:47<00:22,  1.42it/s] 69%|██████▉   | 69/100 [00:47<00:21,  1.43it/s] 70%|███████   | 70/100 [00:48<00:21,  1.42it/s] 71%|███████   | 71/100 [00:49<00:20,  1.39it/s] 72%|███████▏  | 72/100 [00:49<00:20,  1.38it/s] 73%|███████▎  | 73/100 [00:50<00:19,  1.37it/s] 74%|███████▍  | 74/100 [00:51<00:18,  1.39it/s] 75%|███████▌  | 75/100 [00:52<00:17,  1.40it/s] 76%|███████▌  | 76/100 [00:52<00:17,  1.41it/s] 77%|███████▋  | 77/100 [00:53<00:16,  1.41it/s] 78%|███████▊  | 78/100 [00:54<00:15,  1.42it/s] 79%|███████▉  | 79/100 [00:54<00:14,  1.43it/s] 80%|████████  | 80/100 [00:55<00:13,  1.43it/s] 81%|████████  | 81/100 [00:56<00:13,  1.44it/s] 82%|████████▏ | 82/100 [00:56<00:12,  1.44it/s] 83%|████████▎ | 83/100 [00:57<00:11,  1.44it/s] 84%|████████▍ | 84/100 [00:58<00:11,  1.45it/s] 85%|████████▌ | 85/100 [00:59<00:10,  1.45it/s] 86%|████████▌ | 86/100 [00:59<00:09,  1.44it/s] 87%|████████▋ | 87/100 [01:00<00:09,  1.43it/s] 88%|████████▊ | 88/100 [01:01<00:08,  1.41it/s] 89%|████████▉ | 89/100 [01:01<00:07,  1.41it/s] 90%|█████████ | 90/100 [01:02<00:07,  1.42it/s] 91%|█████████ | 91/100 [01:03<00:06,  1.43it/s] 92%|█████████▏| 92/100 [01:04<00:05,  1.42it/s] 93%|█████████▎| 93/100 [01:04<00:05,  1.39it/s] 94%|█████████▍| 94/100 [01:05<00:04,  1.40it/s] 95%|█████████▌| 95/100 [01:06<00:03,  1.41it/s] 96%|█████████▌| 96/100 [01:06<00:02,  1.40it/s] 97%|█████████▋| 97/100 [01:07<00:02,  1.42it/s] 98%|█████████▊| 98/100 [01:08<00:01,  1.43it/s] 99%|█████████▉| 99/100 [01:09<00:00,  1.40it/s]100%|██████████| 100/100 [01:09<00:00,  1.43it/s]100%|██████████| 100/100 [01:09<00:00,  1.44it/s]
2023-06-14 19:45:42 [INFO] {
2023-06-14 19:45:42 [INFO]     'eval_loss': 1.1736871004104614,
2023-06-14 19:45:42 [INFO]     'eval_runtime': 70.4175,
2023-06-14 19:45:42 [INFO]     'eval_samples_per_second': 1.42,
2023-06-14 19:45:42 [INFO]     'eval_steps_per_second': 1.42
2023-06-14 19:45:42 [INFO] }
2023-06-14 19:45:42 [INFO] metric: 1.42
2023-06-14 19:45:42 [INFO] Throughput: 1.42 samples/sec
2023-06-14 19:45:42 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-19-27/./history.snapshot.
2023-06-14 19:45:42 [INFO] FP32 baseline is: [Accuracy: 1.4200, Duration (seconds): 70.4203]
2023-06-14 19:45:43 [INFO] |******Mixed Precision Statistics******|
2023-06-14 19:45:43 [INFO] +-----------------+----------+---------+
2023-06-14 19:45:43 [INFO] |     Op Type     |  Total   |   INT8  |
2023-06-14 19:45:43 [INFO] +-----------------+----------+---------+
2023-06-14 19:45:43 [INFO] |    Embedding    |    2     |    2    |
2023-06-14 19:45:43 [INFO] |      Linear     |    1     |    1    |
2023-06-14 19:45:43 [INFO] +-----------------+----------+---------+
2023-06-14 19:45:43 [INFO] Pass quantize model elapsed time: 957.33 ms
2023-06-14 19:45:43 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: output, input, code.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:35,  2.78it/s]  3%|▎         | 3/100 [00:01<00:49,  1.96it/s]  4%|▍         | 4/100 [00:02<00:56,  1.70it/s]  5%|▌         | 5/100 [00:02<01:00,  1.58it/s]  6%|▌         | 6/100 [00:03<01:02,  1.51it/s]  7%|▋         | 7/100 [00:04<01:03,  1.46it/s]  8%|▊         | 8/100 [00:05<01:03,  1.44it/s]  9%|▉         | 9/100 [00:05<01:03,  1.42it/s] 10%|█         | 10/100 [00:06<01:03,  1.41it/s] 11%|█         | 11/100 [00:07<01:03,  1.41it/s] 12%|█▏        | 12/100 [00:07<01:02,  1.40it/s] 13%|█▎        | 13/100 [00:08<01:02,  1.40it/s] 14%|█▍        | 14/100 [00:09<01:01,  1.40it/s] 15%|█▌        | 15/100 [00:10<01:01,  1.39it/s] 16%|█▌        | 16/100 [00:10<01:00,  1.39it/s] 17%|█▋        | 17/100 [00:11<00:59,  1.39it/s] 18%|█▊        | 18/100 [00:12<00:59,  1.39it/s] 19%|█▉        | 19/100 [00:12<00:58,  1.39it/s] 20%|██        | 20/100 [00:13<00:57,  1.39it/s] 21%|██        | 21/100 [00:14<00:56,  1.39it/s] 22%|██▏       | 22/100 [00:15<00:56,  1.39it/s] 23%|██▎       | 23/100 [00:15<00:57,  1.35it/s] 24%|██▍       | 24/100 [00:16<00:55,  1.36it/s] 25%|██▌       | 25/100 [00:17<00:54,  1.37it/s] 26%|██▌       | 26/100 [00:18<00:53,  1.37it/s] 27%|██▋       | 27/100 [00:18<00:53,  1.38it/s] 28%|██▊       | 28/100 [00:19<00:52,  1.38it/s] 29%|██▉       | 29/100 [00:20<00:51,  1.38it/s] 30%|███       | 30/100 [00:20<00:50,  1.38it/s] 31%|███       | 31/100 [00:21<00:49,  1.38it/s] 32%|███▏      | 32/100 [00:22<00:49,  1.39it/s] 33%|███▎      | 33/100 [00:23<00:48,  1.39it/s] 34%|███▍      | 34/100 [00:23<00:47,  1.39it/s] 35%|███▌      | 35/100 [00:24<00:46,  1.39it/s] 36%|███▌      | 36/100 [00:25<00:46,  1.39it/s] 37%|███▋      | 37/100 [00:26<00:45,  1.39it/s] 38%|███▊      | 38/100 [00:26<00:44,  1.39it/s] 39%|███▉      | 39/100 [00:27<00:43,  1.39it/s] 40%|████      | 40/100 [00:28<00:43,  1.39it/s] 41%|████      | 41/100 [00:28<00:42,  1.39it/s] 42%|████▏     | 42/100 [00:29<00:41,  1.39it/s] 43%|████▎     | 43/100 [00:30<00:41,  1.39it/s] 44%|████▍     | 44/100 [00:31<00:40,  1.39it/s] 45%|████▌     | 45/100 [00:31<00:39,  1.39it/s] 46%|████▌     | 46/100 [00:32<00:38,  1.39it/s] 47%|████▋     | 47/100 [00:33<00:38,  1.39it/s] 48%|████▊     | 48/100 [00:33<00:37,  1.39it/s] 49%|████▉     | 49/100 [00:34<00:36,  1.39it/s] 50%|█████     | 50/100 [00:35<00:35,  1.39it/s] 51%|█████     | 51/100 [00:36<00:35,  1.39it/s] 52%|█████▏    | 52/100 [00:36<00:34,  1.39it/s] 53%|█████▎    | 53/100 [00:37<00:33,  1.39it/s] 54%|█████▍    | 54/100 [00:38<00:33,  1.39it/s] 55%|█████▌    | 55/100 [00:38<00:32,  1.39it/s] 56%|█████▌    | 56/100 [00:39<00:31,  1.39it/s] 57%|█████▋    | 57/100 [00:40<00:31,  1.39it/s] 58%|█████▊    | 58/100 [00:41<00:30,  1.39it/s] 59%|█████▉    | 59/100 [00:41<00:29,  1.39it/s] 60%|██████    | 60/100 [00:42<00:28,  1.39it/s] 61%|██████    | 61/100 [00:43<00:28,  1.39it/s] 62%|██████▏   | 62/100 [00:44<00:27,  1.39it/s] 63%|██████▎   | 63/100 [00:44<00:26,  1.39it/s] 64%|██████▍   | 64/100 [00:45<00:25,  1.39it/s] 65%|██████▌   | 65/100 [00:46<00:25,  1.39it/s] 66%|██████▌   | 66/100 [00:46<00:24,  1.39it/s] 67%|██████▋   | 67/100 [00:47<00:23,  1.39it/s] 68%|██████▊   | 68/100 [00:48<00:22,  1.39it/s] 69%|██████▉   | 69/100 [00:49<00:22,  1.39it/s] 70%|███████   | 70/100 [00:49<00:21,  1.39it/s] 71%|███████   | 71/100 [00:50<00:20,  1.39it/s] 72%|███████▏  | 72/100 [00:51<00:20,  1.39it/s] 73%|███████▎  | 73/100 [00:51<00:19,  1.39it/s] 74%|███████▍  | 74/100 [00:52<00:18,  1.39it/s] 75%|███████▌  | 75/100 [00:53<00:17,  1.39it/s] 76%|███████▌  | 76/100 [00:54<00:17,  1.39it/s] 77%|███████▋  | 77/100 [00:54<00:16,  1.39it/s] 78%|███████▊  | 78/100 [00:55<00:15,  1.39it/s] 79%|███████▉  | 79/100 [00:56<00:15,  1.38it/s] 80%|████████  | 80/100 [00:56<00:14,  1.39it/s] 81%|████████  | 81/100 [00:57<00:13,  1.38it/s] 82%|████████▏ | 82/100 [00:58<00:13,  1.38it/s] 83%|████████▎ | 83/100 [00:59<00:12,  1.39it/s] 84%|████████▍ | 84/100 [00:59<00:11,  1.39it/s] 85%|████████▌ | 85/100 [01:00<00:10,  1.39it/s] 86%|████████▌ | 86/100 [01:01<00:10,  1.39it/s] 87%|████████▋ | 87/100 [01:02<00:09,  1.39it/s] 88%|████████▊ | 88/100 [01:02<00:08,  1.39it/s] 89%|████████▉ | 89/100 [01:03<00:07,  1.39it/s] 90%|█████████ | 90/100 [01:04<00:07,  1.39it/s] 91%|█████████ | 91/100 [01:04<00:06,  1.39it/s] 92%|█████████▏| 92/100 [01:05<00:05,  1.39it/s] 93%|█████████▎| 93/100 [01:06<00:05,  1.40it/s] 94%|█████████▍| 94/100 [01:07<00:04,  1.40it/s] 95%|█████████▌| 95/100 [01:07<00:03,  1.39it/s] 96%|█████████▌| 96/100 [01:08<00:02,  1.39it/s] 97%|█████████▋| 97/100 [01:09<00:02,  1.39it/s] 98%|█████████▊| 98/100 [01:09<00:01,  1.39it/s] 99%|█████████▉| 99/100 [01:10<00:00,  1.39it/s]100%|██████████| 100/100 [01:11<00:00,  1.39it/s]100%|██████████| 100/100 [01:11<00:00,  1.40it/s]
2023-06-14 19:46:55 [INFO] {
2023-06-14 19:46:55 [INFO]     'eval_loss': 1.1748971939086914,
2023-06-14 19:46:55 [INFO]     'eval_runtime': 72.0876,
2023-06-14 19:46:55 [INFO]     'eval_samples_per_second': 1.387,
2023-06-14 19:46:55 [INFO]     'eval_steps_per_second': 1.387
2023-06-14 19:46:55 [INFO] }
2023-06-14 19:46:55 [INFO] metric: 1.387
2023-06-14 19:46:55 [INFO] Throughput: 1.387 samples/sec
2023-06-14 19:46:55 [INFO] Tune 1 result is: [Accuracy (int8|fp32): 1.3870|1.4200, Duration (seconds) (int8|fp32): 72.0923|70.4203], Best tune result is: n/a
2023-06-14 19:46:55 [INFO] |**********************Tune Result Statistics**********************|
2023-06-14 19:46:55 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:46:55 [INFO] |     Info Type      | Baseline | Tune 1 result | Best tune result |
2023-06-14 19:46:55 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:46:55 [INFO] |      Accuracy      | 1.4200   |    1.3870     |       n/a        |
2023-06-14 19:46:55 [INFO] | Duration (seconds) | 70.4203  |    72.0923    |       n/a        |
2023-06-14 19:46:55 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:46:55 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-19-27/./history.snapshot.
2023-06-14 19:46:56 [INFO] Apply all recipes.
2023-06-14 19:46:56 [WARNING] Find evaluated tuning config, skip.
2023-06-14 19:46:56 [INFO] Apply recipe one by one.
2023-06-14 19:46:56 [INFO] Start to fallback op to fp32 one by one.
2023-06-14 19:46:56 [INFO] |******Mixed Precision Statistics******|
2023-06-14 19:46:56 [INFO] +-------------+--------+------+--------+
2023-06-14 19:46:56 [INFO] |   Op Type   | Total  | INT8 |  FP32  |
2023-06-14 19:46:56 [INFO] +-------------+--------+------+--------+
2023-06-14 19:46:56 [INFO] |  Embedding  |   2    |  2   |   0    |
2023-06-14 19:46:56 [INFO] |    Linear   |   1    |  0   |   1    |
2023-06-14 19:46:56 [INFO] +-------------+--------+------+--------+
2023-06-14 19:46:56 [INFO] Pass quantize model elapsed time: 284.37 ms
2023-06-14 19:46:56 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: output, input, code.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:32,  3.01it/s]  3%|▎         | 3/100 [00:01<00:45,  2.12it/s]  4%|▍         | 4/100 [00:01<00:52,  1.84it/s]  5%|▌         | 5/100 [00:02<00:55,  1.71it/s]  6%|▌         | 6/100 [00:03<00:57,  1.64it/s]  7%|▋         | 7/100 [00:03<00:58,  1.60it/s]  8%|▊         | 8/100 [00:04<00:58,  1.57it/s]  9%|▉         | 9/100 [00:05<00:58,  1.56it/s] 10%|█         | 10/100 [00:05<00:57,  1.56it/s] 11%|█         | 11/100 [00:06<00:57,  1.56it/s] 12%|█▏        | 12/100 [00:07<00:56,  1.56it/s] 13%|█▎        | 13/100 [00:07<00:55,  1.56it/s] 14%|█▍        | 14/100 [00:08<00:55,  1.55it/s] 15%|█▌        | 15/100 [00:09<00:54,  1.55it/s] 16%|█▌        | 16/100 [00:09<00:54,  1.55it/s] 17%|█▋        | 17/100 [00:10<00:53,  1.55it/s] 18%|█▊        | 18/100 [00:11<00:52,  1.55it/s] 19%|█▉        | 19/100 [00:11<00:52,  1.55it/s] 20%|██        | 20/100 [00:12<00:51,  1.55it/s] 21%|██        | 21/100 [00:13<00:50,  1.55it/s] 22%|██▏       | 22/100 [00:13<00:50,  1.55it/s] 23%|██▎       | 23/100 [00:14<00:49,  1.55it/s] 24%|██▍       | 24/100 [00:14<00:49,  1.55it/s] 25%|██▌       | 25/100 [00:15<00:48,  1.55it/s] 26%|██▌       | 26/100 [00:16<00:47,  1.55it/s] 27%|██▋       | 27/100 [00:16<00:47,  1.55it/s] 28%|██▊       | 28/100 [00:17<00:46,  1.54it/s] 29%|██▉       | 29/100 [00:18<00:46,  1.53it/s] 30%|███       | 30/100 [00:18<00:45,  1.54it/s] 31%|███       | 31/100 [00:19<00:44,  1.54it/s] 32%|███▏      | 32/100 [00:20<00:44,  1.54it/s] 33%|███▎      | 33/100 [00:20<00:43,  1.55it/s] 34%|███▍      | 34/100 [00:21<00:42,  1.55it/s] 35%|███▌      | 35/100 [00:22<00:41,  1.55it/s] 36%|███▌      | 36/100 [00:22<00:41,  1.55it/s] 37%|███▋      | 37/100 [00:23<00:40,  1.55it/s] 38%|███▊      | 38/100 [00:24<00:39,  1.55it/s] 39%|███▉      | 39/100 [00:24<00:39,  1.54it/s] 40%|████      | 40/100 [00:25<00:38,  1.54it/s] 41%|████      | 41/100 [00:25<00:38,  1.54it/s] 42%|████▏     | 42/100 [00:26<00:37,  1.53it/s] 43%|████▎     | 43/100 [00:27<00:37,  1.54it/s] 44%|████▍     | 44/100 [00:27<00:36,  1.54it/s] 45%|████▌     | 45/100 [00:28<00:35,  1.54it/s] 46%|████▌     | 46/100 [00:29<00:34,  1.54it/s] 47%|████▋     | 47/100 [00:29<00:34,  1.53it/s] 48%|████▊     | 48/100 [00:30<00:34,  1.52it/s] 49%|████▉     | 49/100 [00:31<00:33,  1.53it/s] 50%|█████     | 50/100 [00:31<00:32,  1.53it/s] 51%|█████     | 51/100 [00:32<00:32,  1.52it/s] 52%|█████▏    | 52/100 [00:33<00:31,  1.53it/s] 53%|█████▎    | 53/100 [00:33<00:30,  1.53it/s] 54%|█████▍    | 54/100 [00:34<00:29,  1.54it/s] 55%|█████▌    | 55/100 [00:35<00:29,  1.54it/s] 56%|█████▌    | 56/100 [00:35<00:28,  1.55it/s] 57%|█████▋    | 57/100 [00:36<00:27,  1.55it/s] 58%|█████▊    | 58/100 [00:37<00:27,  1.53it/s] 59%|█████▉    | 59/100 [00:37<00:26,  1.53it/s] 60%|██████    | 60/100 [00:38<00:26,  1.54it/s] 61%|██████    | 61/100 [00:38<00:25,  1.54it/s] 62%|██████▏   | 62/100 [00:39<00:24,  1.55it/s] 63%|██████▎   | 63/100 [00:40<00:23,  1.55it/s] 64%|██████▍   | 64/100 [00:40<00:23,  1.55it/s] 65%|██████▌   | 65/100 [00:41<00:22,  1.55it/s] 66%|██████▌   | 66/100 [00:42<00:22,  1.54it/s] 67%|██████▋   | 67/100 [00:42<00:21,  1.54it/s] 68%|██████▊   | 68/100 [00:43<00:20,  1.52it/s] 69%|██████▉   | 69/100 [00:44<00:20,  1.52it/s] 70%|███████   | 70/100 [00:44<00:19,  1.53it/s] 71%|███████   | 71/100 [00:45<00:19,  1.52it/s] 72%|███████▏  | 72/100 [00:46<00:18,  1.53it/s] 73%|███████▎  | 73/100 [00:46<00:17,  1.54it/s] 74%|███████▍  | 74/100 [00:47<00:16,  1.54it/s] 75%|███████▌  | 75/100 [00:48<00:16,  1.55it/s] 76%|███████▌  | 76/100 [00:48<00:15,  1.55it/s] 77%|███████▋  | 77/100 [00:49<00:14,  1.55it/s] 78%|███████▊  | 78/100 [00:50<00:14,  1.55it/s] 79%|███████▉  | 79/100 [00:50<00:13,  1.55it/s] 80%|████████  | 80/100 [00:51<00:13,  1.54it/s] 81%|████████  | 81/100 [00:51<00:12,  1.54it/s] 82%|████████▏ | 82/100 [00:52<00:11,  1.53it/s] 83%|████████▎ | 83/100 [00:53<00:11,  1.52it/s] 84%|████████▍ | 84/100 [00:53<00:10,  1.52it/s] 85%|████████▌ | 85/100 [00:54<00:09,  1.51it/s] 86%|████████▌ | 86/100 [00:55<00:09,  1.52it/s] 87%|████████▋ | 87/100 [00:55<00:08,  1.53it/s] 88%|████████▊ | 88/100 [00:56<00:07,  1.52it/s] 89%|████████▉ | 89/100 [00:57<00:07,  1.52it/s] 90%|█████████ | 90/100 [00:57<00:06,  1.52it/s] 91%|█████████ | 91/100 [00:58<00:05,  1.52it/s] 92%|█████████▏| 92/100 [00:59<00:05,  1.51it/s] 93%|█████████▎| 93/100 [00:59<00:04,  1.52it/s] 94%|█████████▍| 94/100 [01:00<00:03,  1.53it/s] 95%|█████████▌| 95/100 [01:01<00:03,  1.54it/s] 96%|█████████▌| 96/100 [01:01<00:02,  1.54it/s] 97%|█████████▋| 97/100 [01:02<00:01,  1.54it/s] 98%|█████████▊| 98/100 [01:03<00:01,  1.54it/s] 99%|█████████▉| 99/100 [01:03<00:00,  1.54it/s]100%|██████████| 100/100 [01:04<00:00,  1.55it/s]100%|██████████| 100/100 [01:04<00:00,  1.55it/s]
2023-06-14 19:48:01 [INFO] {
2023-06-14 19:48:01 [INFO]     'eval_loss': 1.1737359762191772,
2023-06-14 19:48:01 [INFO]     'eval_runtime': 65.0816,
2023-06-14 19:48:01 [INFO]     'eval_samples_per_second': 1.537,
2023-06-14 19:48:01 [INFO]     'eval_steps_per_second': 1.537
2023-06-14 19:48:01 [INFO] }
2023-06-14 19:48:01 [INFO] metric: 1.537
2023-06-14 19:48:01 [INFO] Throughput: 1.537 samples/sec
2023-06-14 19:48:01 [INFO] Tune 3 result is: [Accuracy (int8|fp32): 1.5370|1.4200, Duration (seconds) (int8|fp32): 65.0891|70.4203], Best tune result is: [Accuracy: 1.5370, Duration (seconds): 65.0891]
2023-06-14 19:48:01 [INFO] |**********************Tune Result Statistics**********************|
2023-06-14 19:48:01 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:48:01 [INFO] |     Info Type      | Baseline | Tune 3 result | Best tune result |
2023-06-14 19:48:01 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:48:01 [INFO] |      Accuracy      | 1.4200   |    1.5370     |     1.5370       |
2023-06-14 19:48:01 [INFO] | Duration (seconds) | 70.4203  |    65.0891    |     65.0891      |
2023-06-14 19:48:01 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:48:01 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-19-27/./history.snapshot.
2023-06-14 19:48:02 [INFO] |******Mixed Precision Statistics******|
2023-06-14 19:48:02 [INFO] +-------------+--------+------+--------+
2023-06-14 19:48:02 [INFO] |   Op Type   | Total  | INT8 |  FP32  |
2023-06-14 19:48:02 [INFO] +-------------+--------+------+--------+
2023-06-14 19:48:02 [INFO] |  Embedding  |   2    |  1   |   1    |
2023-06-14 19:48:02 [INFO] |    Linear   |   1    |  1   |   0    |
2023-06-14 19:48:02 [INFO] +-------------+--------+------+--------+
2023-06-14 19:48:02 [INFO] Pass quantize model elapsed time: 885.51 ms
2023-06-14 19:48:02 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: output, input, code.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:35,  2.77it/s]  3%|▎         | 3/100 [00:01<00:49,  1.96it/s]  4%|▍         | 4/100 [00:02<00:56,  1.69it/s]  5%|▌         | 5/100 [00:02<01:00,  1.57it/s]  6%|▌         | 6/100 [00:03<01:02,  1.50it/s]  7%|▋         | 7/100 [00:04<01:03,  1.46it/s]  8%|▊         | 8/100 [00:05<01:03,  1.44it/s]  9%|▉         | 9/100 [00:05<01:04,  1.42it/s] 10%|█         | 10/100 [00:06<01:03,  1.41it/s] 11%|█         | 11/100 [00:07<01:03,  1.40it/s] 12%|█▏        | 12/100 [00:07<01:03,  1.39it/s] 13%|█▎        | 13/100 [00:08<01:02,  1.39it/s] 14%|█▍        | 14/100 [00:09<01:01,  1.39it/s] 15%|█▌        | 15/100 [00:10<01:01,  1.39it/s] 16%|█▌        | 16/100 [00:10<01:00,  1.39it/s] 17%|█▋        | 17/100 [00:11<00:59,  1.39it/s] 18%|█▊        | 18/100 [00:12<00:58,  1.39it/s] 19%|█▉        | 19/100 [00:12<00:58,  1.39it/s] 20%|██        | 20/100 [00:13<00:57,  1.39it/s] 21%|██        | 21/100 [00:14<00:56,  1.39it/s] 22%|██▏       | 22/100 [00:15<00:56,  1.39it/s] 23%|██▎       | 23/100 [00:15<00:55,  1.39it/s] 24%|██▍       | 24/100 [00:16<00:54,  1.39it/s] 25%|██▌       | 25/100 [00:17<00:53,  1.39it/s] 26%|██▌       | 26/100 [00:18<00:53,  1.39it/s] 27%|██▋       | 27/100 [00:18<00:52,  1.39it/s] 28%|██▊       | 28/100 [00:19<00:51,  1.39it/s] 29%|██▉       | 29/100 [00:20<00:51,  1.39it/s] 30%|███       | 30/100 [00:20<00:50,  1.39it/s] 31%|███       | 31/100 [00:21<00:49,  1.39it/s] 32%|███▏      | 32/100 [00:22<00:48,  1.39it/s] 33%|███▎      | 33/100 [00:23<00:48,  1.39it/s] 34%|███▍      | 34/100 [00:23<00:47,  1.39it/s] 35%|███▌      | 35/100 [00:24<00:46,  1.39it/s] 36%|███▌      | 36/100 [00:25<00:46,  1.39it/s] 37%|███▋      | 37/100 [00:25<00:45,  1.39it/s] 38%|███▊      | 38/100 [00:26<00:44,  1.39it/s] 39%|███▉      | 39/100 [00:27<00:43,  1.39it/s] 40%|████      | 40/100 [00:28<00:43,  1.39it/s] 41%|████      | 41/100 [00:28<00:42,  1.39it/s] 42%|████▏     | 42/100 [00:29<00:41,  1.39it/s] 43%|████▎     | 43/100 [00:30<00:41,  1.39it/s] 44%|████▍     | 44/100 [00:30<00:40,  1.39it/s] 45%|████▌     | 45/100 [00:31<00:39,  1.39it/s] 46%|████▌     | 46/100 [00:32<00:38,  1.39it/s] 47%|████▋     | 47/100 [00:33<00:38,  1.39it/s] 48%|████▊     | 48/100 [00:33<00:37,  1.38it/s] 49%|████▉     | 49/100 [00:34<00:36,  1.39it/s] 50%|█████     | 50/100 [00:35<00:36,  1.39it/s] 51%|█████     | 51/100 [00:36<00:35,  1.39it/s] 52%|█████▏    | 52/100 [00:36<00:34,  1.39it/s] 53%|█████▎    | 53/100 [00:37<00:33,  1.39it/s] 54%|█████▍    | 54/100 [00:38<00:33,  1.39it/s] 55%|█████▌    | 55/100 [00:38<00:32,  1.39it/s] 56%|█████▌    | 56/100 [00:39<00:31,  1.39it/s] 57%|█████▋    | 57/100 [00:40<00:30,  1.39it/s] 58%|█████▊    | 58/100 [00:41<00:30,  1.39it/s] 59%|█████▉    | 59/100 [00:41<00:29,  1.39it/s] 60%|██████    | 60/100 [00:42<00:28,  1.39it/s] 61%|██████    | 61/100 [00:43<00:28,  1.39it/s] 62%|██████▏   | 62/100 [00:43<00:27,  1.39it/s] 63%|██████▎   | 63/100 [00:44<00:26,  1.39it/s] 64%|██████▍   | 64/100 [00:45<00:25,  1.39it/s] 65%|██████▌   | 65/100 [00:46<00:25,  1.39it/s] 66%|██████▌   | 66/100 [00:46<00:24,  1.39it/s] 67%|██████▋   | 67/100 [00:47<00:23,  1.39it/s] 68%|██████▊   | 68/100 [00:48<00:22,  1.39it/s] 69%|██████▉   | 69/100 [00:48<00:22,  1.39it/s] 70%|███████   | 70/100 [00:49<00:21,  1.39it/s] 71%|███████   | 71/100 [00:50<00:20,  1.39it/s] 72%|███████▏  | 72/100 [00:51<00:20,  1.39it/s] 73%|███████▎  | 73/100 [00:51<00:19,  1.39it/s] 74%|███████▍  | 74/100 [00:52<00:18,  1.39it/s] 75%|███████▌  | 75/100 [00:53<00:17,  1.39it/s] 76%|███████▌  | 76/100 [00:54<00:17,  1.39it/s] 77%|███████▋  | 77/100 [00:54<00:16,  1.39it/s] 78%|███████▊  | 78/100 [00:55<00:15,  1.39it/s] 79%|███████▉  | 79/100 [00:56<00:15,  1.39it/s] 80%|████████  | 80/100 [00:56<00:14,  1.39it/s] 81%|████████  | 81/100 [00:57<00:13,  1.39it/s] 82%|████████▏ | 82/100 [00:58<00:12,  1.39it/s] 83%|████████▎ | 83/100 [00:59<00:12,  1.39it/s] 84%|████████▍ | 84/100 [00:59<00:11,  1.39it/s] 85%|████████▌ | 85/100 [01:00<00:10,  1.39it/s] 86%|████████▌ | 86/100 [01:01<00:10,  1.39it/s] 87%|████████▋ | 87/100 [01:01<00:09,  1.39it/s] 88%|████████▊ | 88/100 [01:02<00:08,  1.39it/s] 89%|████████▉ | 89/100 [01:03<00:07,  1.39it/s] 90%|█████████ | 90/100 [01:04<00:07,  1.39it/s] 91%|█████████ | 91/100 [01:04<00:06,  1.39it/s] 92%|█████████▏| 92/100 [01:05<00:05,  1.39it/s] 93%|█████████▎| 93/100 [01:06<00:05,  1.39it/s] 94%|█████████▍| 94/100 [01:06<00:04,  1.39it/s] 95%|█████████▌| 95/100 [01:07<00:03,  1.39it/s] 96%|█████████▌| 96/100 [01:08<00:02,  1.39it/s] 97%|█████████▋| 97/100 [01:09<00:02,  1.39it/s] 98%|█████████▊| 98/100 [01:09<00:01,  1.39it/s] 99%|█████████▉| 99/100 [01:10<00:00,  1.39it/s]100%|██████████| 100/100 [01:11<00:00,  1.39it/s]100%|██████████| 100/100 [01:11<00:00,  1.40it/s]
2023-06-14 19:49:14 [INFO] {
2023-06-14 19:49:14 [INFO]     'eval_loss': 1.1746976375579834,
2023-06-14 19:49:14 [INFO]     'eval_runtime': 71.9566,
2023-06-14 19:49:14 [INFO]     'eval_samples_per_second': 1.39,
2023-06-14 19:49:14 [INFO]     'eval_steps_per_second': 1.39
2023-06-14 19:49:14 [INFO] }
2023-06-14 19:49:14 [INFO] metric: 1.39
2023-06-14 19:49:14 [INFO] Throughput: 1.39 samples/sec
2023-06-14 19:49:14 [INFO] Tune 4 result is: [Accuracy (int8|fp32): 1.3900|1.4200, Duration (seconds) (int8|fp32): 71.9618|70.4203], Best tune result is: [Accuracy: 1.5370, Duration (seconds): 65.0891]
2023-06-14 19:49:14 [INFO] |**********************Tune Result Statistics**********************|
2023-06-14 19:49:14 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:49:14 [INFO] |     Info Type      | Baseline | Tune 4 result | Best tune result |
2023-06-14 19:49:14 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:49:14 [INFO] |      Accuracy      | 1.4200   |    1.3900     |     1.5370       |
2023-06-14 19:49:14 [INFO] | Duration (seconds) | 70.4203  |    71.9618    |     65.0891      |
2023-06-14 19:49:14 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:49:14 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-19-27/./history.snapshot.
2023-06-14 19:49:15 [INFO] |******Mixed Precision Statistics******|
2023-06-14 19:49:15 [INFO] +-------------+--------+------+--------+
2023-06-14 19:49:15 [INFO] |   Op Type   | Total  | INT8 |  FP32  |
2023-06-14 19:49:15 [INFO] +-------------+--------+------+--------+
2023-06-14 19:49:15 [INFO] |  Embedding  |   2    |  1   |   1    |
2023-06-14 19:49:15 [INFO] |    Linear   |   1    |  1   |   0    |
2023-06-14 19:49:15 [INFO] +-------------+--------+------+--------+
2023-06-14 19:49:15 [INFO] Pass quantize model elapsed time: 767.19 ms
2023-06-14 19:49:15 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: output, input, code.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:30,  3.18it/s]  3%|▎         | 3/100 [00:01<00:43,  2.24it/s]  4%|▍         | 4/100 [00:01<00:49,  1.94it/s]  5%|▌         | 5/100 [00:02<00:52,  1.80it/s]  6%|▌         | 6/100 [00:03<00:54,  1.72it/s]  7%|▋         | 7/100 [00:03<00:55,  1.68it/s]  8%|▊         | 8/100 [00:04<00:55,  1.65it/s]  9%|▉         | 9/100 [00:05<00:55,  1.63it/s] 10%|█         | 10/100 [00:05<00:55,  1.62it/s] 11%|█         | 11/100 [00:06<00:55,  1.61it/s] 12%|█▏        | 12/100 [00:06<00:54,  1.60it/s] 13%|█▎        | 13/100 [00:07<00:54,  1.60it/s] 14%|█▍        | 14/100 [00:08<00:53,  1.59it/s] 15%|█▌        | 15/100 [00:08<00:53,  1.59it/s] 16%|█▌        | 16/100 [00:09<00:52,  1.59it/s] 17%|█▋        | 17/100 [00:10<00:52,  1.59it/s] 18%|█▊        | 18/100 [00:10<00:51,  1.59it/s] 19%|█▉        | 19/100 [00:11<00:50,  1.59it/s] 20%|██        | 20/100 [00:11<00:50,  1.59it/s] 21%|██        | 21/100 [00:12<00:49,  1.59it/s] 22%|██▏       | 22/100 [00:13<00:49,  1.59it/s] 23%|██▎       | 23/100 [00:13<00:48,  1.59it/s] 24%|██▍       | 24/100 [00:14<00:47,  1.58it/s] 25%|██▌       | 25/100 [00:15<00:47,  1.59it/s] 26%|██▌       | 26/100 [00:15<00:46,  1.59it/s] 27%|██▋       | 27/100 [00:16<00:45,  1.59it/s] 28%|██▊       | 28/100 [00:17<00:45,  1.59it/s] 29%|██▉       | 29/100 [00:17<00:44,  1.59it/s] 30%|███       | 30/100 [00:18<00:44,  1.59it/s] 31%|███       | 31/100 [00:18<00:43,  1.59it/s] 32%|███▏      | 32/100 [00:19<00:42,  1.59it/s] 33%|███▎      | 33/100 [00:20<00:42,  1.59it/s] 34%|███▍      | 34/100 [00:20<00:41,  1.59it/s] 35%|███▌      | 35/100 [00:21<00:40,  1.59it/s] 36%|███▌      | 36/100 [00:22<00:40,  1.59it/s] 37%|███▋      | 37/100 [00:22<00:39,  1.59it/s] 38%|███▊      | 38/100 [00:23<00:39,  1.59it/s] 39%|███▉      | 39/100 [00:23<00:38,  1.59it/s] 40%|████      | 40/100 [00:24<00:37,  1.59it/s] 41%|████      | 41/100 [00:25<00:37,  1.59it/s] 42%|████▏     | 42/100 [00:25<00:36,  1.59it/s] 43%|████▎     | 43/100 [00:26<00:35,  1.59it/s] 44%|████▍     | 44/100 [00:27<00:35,  1.59it/s] 45%|████▌     | 45/100 [00:27<00:34,  1.59it/s] 46%|████▌     | 46/100 [00:28<00:33,  1.59it/s] 47%|████▋     | 47/100 [00:28<00:33,  1.59it/s] 48%|████▊     | 48/100 [00:29<00:32,  1.59it/s] 49%|████▉     | 49/100 [00:30<00:32,  1.59it/s] 50%|█████     | 50/100 [00:30<00:31,  1.59it/s] 51%|█████     | 51/100 [00:31<00:30,  1.59it/s] 52%|█████▏    | 52/100 [00:32<00:30,  1.59it/s] 53%|█████▎    | 53/100 [00:32<00:29,  1.59it/s] 54%|█████▍    | 54/100 [00:33<00:28,  1.59it/s] 55%|█████▌    | 55/100 [00:34<00:28,  1.59it/s] 56%|█████▌    | 56/100 [00:34<00:27,  1.59it/s] 57%|█████▋    | 57/100 [00:35<00:27,  1.59it/s] 58%|█████▊    | 58/100 [00:35<00:26,  1.58it/s] 59%|█████▉    | 59/100 [00:36<00:25,  1.59it/s] 60%|██████    | 60/100 [00:37<00:25,  1.59it/s] 61%|██████    | 61/100 [00:37<00:24,  1.59it/s] 62%|██████▏   | 62/100 [00:38<00:23,  1.59it/s] 63%|██████▎   | 63/100 [00:39<00:23,  1.59it/s] 64%|██████▍   | 64/100 [00:39<00:22,  1.59it/s] 65%|██████▌   | 65/100 [00:40<00:22,  1.59it/s] 66%|██████▌   | 66/100 [00:40<00:21,  1.59it/s] 67%|██████▋   | 67/100 [00:41<00:20,  1.59it/s] 68%|██████▊   | 68/100 [00:42<00:20,  1.59it/s] 69%|██████▉   | 69/100 [00:42<00:19,  1.59it/s] 70%|███████   | 70/100 [00:43<00:18,  1.59it/s] 71%|███████   | 71/100 [00:44<00:18,  1.58it/s] 72%|███████▏  | 72/100 [00:44<00:17,  1.57it/s] 73%|███████▎  | 73/100 [00:45<00:17,  1.57it/s] 74%|███████▍  | 74/100 [00:46<00:16,  1.57it/s] 75%|███████▌  | 75/100 [00:46<00:15,  1.58it/s] 76%|███████▌  | 76/100 [00:47<00:15,  1.58it/s] 77%|███████▋  | 77/100 [00:47<00:14,  1.58it/s] 78%|███████▊  | 78/100 [00:48<00:13,  1.58it/s] 79%|███████▉  | 79/100 [00:49<00:13,  1.58it/s] 80%|████████  | 80/100 [00:49<00:12,  1.58it/s] 81%|████████  | 81/100 [00:50<00:12,  1.58it/s] 82%|████████▏ | 82/100 [00:51<00:11,  1.58it/s] 83%|████████▎ | 83/100 [00:51<00:10,  1.58it/s] 84%|████████▍ | 84/100 [00:52<00:10,  1.58it/s] 85%|████████▌ | 85/100 [00:52<00:09,  1.58it/s] 86%|████████▌ | 86/100 [00:53<00:08,  1.58it/s] 87%|████████▋ | 87/100 [00:54<00:08,  1.58it/s] 88%|████████▊ | 88/100 [00:54<00:07,  1.58it/s] 89%|████████▉ | 89/100 [00:55<00:06,  1.58it/s] 90%|█████████ | 90/100 [00:56<00:06,  1.58it/s] 91%|█████████ | 91/100 [00:56<00:05,  1.58it/s] 92%|█████████▏| 92/100 [00:57<00:05,  1.58it/s] 93%|█████████▎| 93/100 [00:58<00:04,  1.58it/s] 94%|█████████▍| 94/100 [00:58<00:03,  1.58it/s] 95%|█████████▌| 95/100 [00:59<00:03,  1.58it/s] 96%|█████████▌| 96/100 [00:59<00:02,  1.58it/s] 97%|█████████▋| 97/100 [01:00<00:01,  1.58it/s] 98%|█████████▊| 98/100 [01:01<00:01,  1.58it/s] 99%|█████████▉| 99/100 [01:01<00:00,  1.58it/s]100%|██████████| 100/100 [01:02<00:00,  1.58it/s]100%|██████████| 100/100 [01:02<00:00,  1.60it/s]
2023-06-14 19:50:18 [INFO] {
2023-06-14 19:50:18 [INFO]     'eval_loss': 1.1748887300491333,
2023-06-14 19:50:18 [INFO]     'eval_runtime': 63.0761,
2023-06-14 19:50:18 [INFO]     'eval_samples_per_second': 1.585,
2023-06-14 19:50:18 [INFO]     'eval_steps_per_second': 1.585
2023-06-14 19:50:18 [INFO] }
2023-06-14 19:50:18 [INFO] metric: 1.585
2023-06-14 19:50:18 [INFO] Throughput: 1.585 samples/sec
2023-06-14 19:50:18 [INFO] Tune 5 result is: [Accuracy (int8|fp32): 1.5850|1.4200, Duration (seconds) (int8|fp32): 63.0810|70.4203], Best tune result is: [Accuracy: 1.5850, Duration (seconds): 63.0810]
2023-06-14 19:50:18 [INFO] |**********************Tune Result Statistics**********************|
2023-06-14 19:50:18 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:50:18 [INFO] |     Info Type      | Baseline | Tune 5 result | Best tune result |
2023-06-14 19:50:18 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:50:18 [INFO] |      Accuracy      | 1.4200   |    1.5850     |     1.5850       |
2023-06-14 19:50:18 [INFO] | Duration (seconds) | 70.4203  |    63.0810    |     63.0810      |
2023-06-14 19:50:18 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:50:18 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-19-27/./history.snapshot.
2023-06-14 19:50:19 [INFO] Start to accumulate fallback to fp32.
2023-06-14 19:50:19 [INFO] |******Mixed Precision Statistics******|
2023-06-14 19:50:19 [INFO] +-------------+--------+------+--------+
2023-06-14 19:50:19 [INFO] |   Op Type   | Total  | INT8 |  FP32  |
2023-06-14 19:50:19 [INFO] +-------------+--------+------+--------+
2023-06-14 19:50:19 [INFO] |  Embedding  |   2    |  1   |   1    |
2023-06-14 19:50:19 [INFO] |    Linear   |   1    |  0   |   1    |
2023-06-14 19:50:19 [INFO] +-------------+--------+------+--------+
2023-06-14 19:50:19 [INFO] Pass quantize model elapsed time: 165.04 ms
2023-06-14 19:50:19 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: output, input, code.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:32,  2.99it/s]  3%|▎         | 3/100 [00:01<00:45,  2.11it/s]  4%|▍         | 4/100 [00:02<00:52,  1.83it/s]  5%|▌         | 5/100 [00:02<00:55,  1.70it/s]  6%|▌         | 6/100 [00:03<00:57,  1.63it/s]  7%|▋         | 7/100 [00:04<00:58,  1.58it/s]  8%|▊         | 8/100 [00:04<00:59,  1.55it/s]  9%|▉         | 9/100 [00:05<00:59,  1.54it/s] 10%|█         | 10/100 [00:06<00:59,  1.52it/s] 11%|█         | 11/100 [00:06<00:58,  1.51it/s] 12%|█▏        | 12/100 [00:07<00:58,  1.51it/s] 13%|█▎        | 13/100 [00:08<00:57,  1.50it/s] 14%|█▍        | 14/100 [00:08<00:57,  1.50it/s] 15%|█▌        | 15/100 [00:09<00:56,  1.50it/s] 16%|█▌        | 16/100 [00:10<00:56,  1.50it/s] 17%|█▋        | 17/100 [00:10<00:55,  1.49it/s] 18%|█▊        | 18/100 [00:11<00:54,  1.49it/s] 19%|█▉        | 19/100 [00:12<00:54,  1.49it/s] 20%|██        | 20/100 [00:12<00:53,  1.50it/s] 21%|██        | 21/100 [00:13<00:52,  1.50it/s] 22%|██▏       | 22/100 [00:14<00:52,  1.50it/s] 23%|██▎       | 23/100 [00:14<00:51,  1.50it/s] 24%|██▍       | 24/100 [00:15<00:50,  1.50it/s] 25%|██▌       | 25/100 [00:16<00:50,  1.50it/s] 26%|██▌       | 26/100 [00:16<00:49,  1.50it/s] 27%|██▋       | 27/100 [00:17<00:48,  1.50it/s] 28%|██▊       | 28/100 [00:18<00:48,  1.50it/s] 29%|██▉       | 29/100 [00:18<00:47,  1.50it/s] 30%|███       | 30/100 [00:19<00:46,  1.50it/s] 31%|███       | 31/100 [00:20<00:46,  1.50it/s] 32%|███▏      | 32/100 [00:20<00:45,  1.50it/s] 33%|███▎      | 33/100 [00:21<00:44,  1.50it/s] 34%|███▍      | 34/100 [00:22<00:44,  1.50it/s] 35%|███▌      | 35/100 [00:22<00:43,  1.49it/s] 36%|███▌      | 36/100 [00:23<00:42,  1.50it/s] 37%|███▋      | 37/100 [00:24<00:42,  1.49it/s] 38%|███▊      | 38/100 [00:24<00:41,  1.50it/s] 39%|███▉      | 39/100 [00:25<00:40,  1.50it/s] 40%|████      | 40/100 [00:26<00:40,  1.50it/s] 41%|████      | 41/100 [00:26<00:39,  1.50it/s] 42%|████▏     | 42/100 [00:27<00:38,  1.50it/s] 43%|████▎     | 43/100 [00:28<00:38,  1.49it/s] 44%|████▍     | 44/100 [00:28<00:37,  1.49it/s] 45%|████▌     | 45/100 [00:29<00:36,  1.49it/s] 46%|████▌     | 46/100 [00:30<00:36,  1.49it/s] 47%|████▋     | 47/100 [00:30<00:35,  1.49it/s] 48%|████▊     | 48/100 [00:31<00:34,  1.49it/s] 49%|████▉     | 49/100 [00:32<00:34,  1.49it/s] 50%|█████     | 50/100 [00:32<00:33,  1.49it/s] 51%|█████     | 51/100 [00:33<00:32,  1.49it/s] 52%|█████▏    | 52/100 [00:34<00:32,  1.49it/s] 53%|█████▎    | 53/100 [00:34<00:31,  1.50it/s] 54%|█████▍    | 54/100 [00:35<00:30,  1.50it/s] 55%|█████▌    | 55/100 [00:36<00:30,  1.50it/s] 56%|█████▌    | 56/100 [00:36<00:29,  1.50it/s] 57%|█████▋    | 57/100 [00:37<00:28,  1.50it/s] 58%|█████▊    | 58/100 [00:38<00:28,  1.50it/s] 59%|█████▉    | 59/100 [00:38<00:27,  1.50it/s] 60%|██████    | 60/100 [00:39<00:26,  1.49it/s] 61%|██████    | 61/100 [00:40<00:26,  1.49it/s] 62%|██████▏   | 62/100 [00:40<00:25,  1.50it/s] 63%|██████▎   | 63/100 [00:41<00:24,  1.50it/s] 64%|██████▍   | 64/100 [00:42<00:24,  1.50it/s] 65%|██████▌   | 65/100 [00:42<00:23,  1.50it/s] 66%|██████▌   | 66/100 [00:43<00:22,  1.50it/s] 67%|██████▋   | 67/100 [00:44<00:22,  1.50it/s] 68%|██████▊   | 68/100 [00:44<00:21,  1.50it/s] 69%|██████▉   | 69/100 [00:45<00:20,  1.50it/s] 70%|███████   | 70/100 [00:46<00:20,  1.50it/s] 71%|███████   | 71/100 [00:46<00:19,  1.50it/s] 72%|███████▏  | 72/100 [00:47<00:18,  1.50it/s] 73%|███████▎  | 73/100 [00:48<00:18,  1.50it/s] 74%|███████▍  | 74/100 [00:48<00:17,  1.50it/s] 75%|███████▌  | 75/100 [00:49<00:16,  1.50it/s] 76%|███████▌  | 76/100 [00:50<00:16,  1.50it/s] 77%|███████▋  | 77/100 [00:50<00:15,  1.50it/s] 78%|███████▊  | 78/100 [00:51<00:14,  1.50it/s] 79%|███████▉  | 79/100 [00:52<00:14,  1.50it/s] 80%|████████  | 80/100 [00:52<00:13,  1.50it/s] 81%|████████  | 81/100 [00:53<00:12,  1.50it/s] 82%|████████▏ | 82/100 [00:54<00:12,  1.50it/s] 83%|████████▎ | 83/100 [00:54<00:11,  1.50it/s] 84%|████████▍ | 84/100 [00:55<00:10,  1.49it/s] 85%|████████▌ | 85/100 [00:56<00:10,  1.49it/s] 86%|████████▌ | 86/100 [00:56<00:09,  1.49it/s] 87%|████████▋ | 87/100 [00:57<00:08,  1.49it/s] 88%|████████▊ | 88/100 [00:58<00:08,  1.49it/s] 89%|████████▉ | 89/100 [00:58<00:07,  1.49it/s] 90%|█████████ | 90/100 [00:59<00:06,  1.49it/s] 91%|█████████ | 91/100 [01:00<00:06,  1.49it/s] 92%|█████████▏| 92/100 [01:00<00:05,  1.49it/s] 93%|█████████▎| 93/100 [01:01<00:04,  1.49it/s] 94%|█████████▍| 94/100 [01:02<00:04,  1.49it/s] 95%|█████████▌| 95/100 [01:02<00:03,  1.50it/s] 96%|█████████▌| 96/100 [01:03<00:02,  1.50it/s] 97%|█████████▋| 97/100 [01:04<00:02,  1.50it/s] 98%|█████████▊| 98/100 [01:04<00:01,  1.50it/s] 99%|█████████▉| 99/100 [01:05<00:00,  1.50it/s]100%|██████████| 100/100 [01:06<00:00,  1.50it/s]100%|██████████| 100/100 [01:06<00:00,  1.51it/s]
2023-06-14 19:51:26 [INFO] {
2023-06-14 19:51:26 [INFO]     'eval_loss': 1.173761248588562,
2023-06-14 19:51:26 [INFO]     'eval_runtime': 66.8531,
2023-06-14 19:51:26 [INFO]     'eval_samples_per_second': 1.496,
2023-06-14 19:51:26 [INFO]     'eval_steps_per_second': 1.496
2023-06-14 19:51:26 [INFO] }
2023-06-14 19:51:26 [INFO] metric: 1.496
2023-06-14 19:51:26 [INFO] Throughput: 1.496 samples/sec
2023-06-14 19:51:26 [INFO] Tune 6 result is: [Accuracy (int8|fp32): 1.4960|1.4200, Duration (seconds) (int8|fp32): 66.8581|70.4203], Best tune result is: [Accuracy: 1.5850, Duration (seconds): 63.0810]
2023-06-14 19:51:26 [INFO] |**********************Tune Result Statistics**********************|
2023-06-14 19:51:26 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:51:26 [INFO] |     Info Type      | Baseline | Tune 6 result | Best tune result |
2023-06-14 19:51:26 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:51:26 [INFO] |      Accuracy      | 1.4200   |    1.4960     |     1.5850       |
2023-06-14 19:51:26 [INFO] | Duration (seconds) | 70.4203  |    66.8581    |     63.0810      |
2023-06-14 19:51:26 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:51:26 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-19-27/./history.snapshot.
2023-06-14 19:51:26 [WARNING] None of the submodule got qconfig applied. Make sure you passed correct configuration through `qconfig_dict` or by assigning the `.qconfig` attribute directly on submodules.
2023-06-14 19:51:26 [INFO] |******Mixed Precision Statistics******|
2023-06-14 19:51:26 [INFO] +-----------------+----------+---------+
2023-06-14 19:51:26 [INFO] |     Op Type     |  Total   |   FP32  |
2023-06-14 19:51:26 [INFO] +-----------------+----------+---------+
2023-06-14 19:51:26 [INFO] |    Embedding    |    2     |    2    |
2023-06-14 19:51:26 [INFO] |      Linear     |    1     |    1    |
2023-06-14 19:51:26 [INFO] +-----------------+----------+---------+
2023-06-14 19:51:26 [INFO] Pass quantize model elapsed time: 134.62 ms
2023-06-14 19:51:26 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `GPT2LMHeadModel.forward` and have been ignored: output, input, code.
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:31,  3.13it/s]  3%|▎         | 3/100 [00:01<00:43,  2.21it/s]  4%|▍         | 4/100 [00:01<00:50,  1.91it/s]  5%|▌         | 5/100 [00:02<00:53,  1.78it/s]  6%|▌         | 6/100 [00:03<00:55,  1.70it/s]  7%|▋         | 7/100 [00:03<00:56,  1.65it/s]  8%|▊         | 8/100 [00:04<00:56,  1.62it/s]  9%|▉         | 9/100 [00:05<00:56,  1.60it/s] 10%|█         | 10/100 [00:05<00:56,  1.59it/s] 11%|█         | 11/100 [00:06<00:56,  1.58it/s] 12%|█▏        | 12/100 [00:07<00:55,  1.58it/s] 13%|█▎        | 13/100 [00:07<00:55,  1.57it/s] 14%|█▍        | 14/100 [00:08<00:54,  1.57it/s] 15%|█▌        | 15/100 [00:08<00:54,  1.57it/s] 16%|█▌        | 16/100 [00:09<00:53,  1.57it/s] 17%|█▋        | 17/100 [00:10<00:53,  1.56it/s] 18%|█▊        | 18/100 [00:10<00:52,  1.56it/s] 19%|█▉        | 19/100 [00:11<00:51,  1.56it/s] 20%|██        | 20/100 [00:12<00:51,  1.56it/s] 21%|██        | 21/100 [00:12<00:50,  1.56it/s] 22%|██▏       | 22/100 [00:13<00:49,  1.56it/s] 23%|██▎       | 23/100 [00:14<00:49,  1.56it/s] 24%|██▍       | 24/100 [00:14<00:48,  1.56it/s] 25%|██▌       | 25/100 [00:15<00:48,  1.56it/s] 26%|██▌       | 26/100 [00:16<00:47,  1.56it/s] 27%|██▋       | 27/100 [00:16<00:46,  1.56it/s] 28%|██▊       | 28/100 [00:17<00:46,  1.56it/s] 29%|██▉       | 29/100 [00:17<00:45,  1.56it/s] 30%|███       | 30/100 [00:18<00:44,  1.57it/s] 31%|███       | 31/100 [00:19<00:44,  1.57it/s] 32%|███▏      | 32/100 [00:19<00:43,  1.57it/s] 33%|███▎      | 33/100 [00:20<00:42,  1.57it/s] 34%|███▍      | 34/100 [00:21<00:42,  1.56it/s] 35%|███▌      | 35/100 [00:21<00:41,  1.56it/s] 36%|███▌      | 36/100 [00:22<00:41,  1.56it/s] 37%|███▋      | 37/100 [00:23<00:40,  1.56it/s] 38%|███▊      | 38/100 [00:23<00:39,  1.56it/s] 39%|███▉      | 39/100 [00:24<00:39,  1.56it/s] 40%|████      | 40/100 [00:24<00:38,  1.56it/s] 41%|████      | 41/100 [00:25<00:37,  1.56it/s] 42%|████▏     | 42/100 [00:26<00:37,  1.56it/s] 43%|████▎     | 43/100 [00:26<00:36,  1.56it/s] 44%|████▍     | 44/100 [00:27<00:35,  1.56it/s] 45%|████▌     | 45/100 [00:28<00:35,  1.56it/s] 46%|████▌     | 46/100 [00:28<00:34,  1.56it/s] 47%|████▋     | 47/100 [00:29<00:33,  1.56it/s] 48%|████▊     | 48/100 [00:30<00:33,  1.56it/s] 49%|████▉     | 49/100 [00:30<00:32,  1.56it/s] 50%|█████     | 50/100 [00:31<00:32,  1.56it/s] 51%|█████     | 51/100 [00:32<00:31,  1.56it/s] 52%|█████▏    | 52/100 [00:32<00:31,  1.52it/s] 53%|█████▎    | 53/100 [00:33<00:30,  1.54it/s] 54%|█████▍    | 54/100 [00:33<00:29,  1.54it/s] 55%|█████▌    | 55/100 [00:34<00:29,  1.55it/s] 56%|█████▌    | 56/100 [00:35<00:28,  1.55it/s] 57%|█████▋    | 57/100 [00:35<00:27,  1.56it/s] 58%|█████▊    | 58/100 [00:36<00:26,  1.56it/s] 59%|█████▉    | 59/100 [00:37<00:26,  1.56it/s] 60%|██████    | 60/100 [00:37<00:25,  1.56it/s] 61%|██████    | 61/100 [00:38<00:24,  1.56it/s] 62%|██████▏   | 62/100 [00:39<00:24,  1.56it/s] 63%|██████▎   | 63/100 [00:39<00:23,  1.56it/s] 64%|██████▍   | 64/100 [00:40<00:23,  1.56it/s] 65%|██████▌   | 65/100 [00:41<00:22,  1.56it/s] 66%|██████▌   | 66/100 [00:41<00:21,  1.57it/s] 67%|██████▋   | 67/100 [00:42<00:21,  1.57it/s] 68%|██████▊   | 68/100 [00:42<00:20,  1.57it/s] 69%|██████▉   | 69/100 [00:43<00:19,  1.57it/s] 70%|███████   | 70/100 [00:44<00:19,  1.57it/s] 71%|███████   | 71/100 [00:44<00:18,  1.56it/s] 72%|███████▏  | 72/100 [00:45<00:17,  1.56it/s] 73%|███████▎  | 73/100 [00:46<00:17,  1.56it/s] 74%|███████▍  | 74/100 [00:46<00:16,  1.56it/s] 75%|███████▌  | 75/100 [00:47<00:15,  1.57it/s] 76%|███████▌  | 76/100 [00:48<00:15,  1.57it/s] 77%|███████▋  | 77/100 [00:48<00:14,  1.57it/s] 78%|███████▊  | 78/100 [00:49<00:14,  1.56it/s] 79%|███████▉  | 79/100 [00:49<00:13,  1.56it/s] 80%|████████  | 80/100 [00:50<00:12,  1.56it/s] 81%|████████  | 81/100 [00:51<00:12,  1.56it/s] 82%|████████▏ | 82/100 [00:51<00:11,  1.56it/s] 83%|████████▎ | 83/100 [00:52<00:10,  1.56it/s] 84%|████████▍ | 84/100 [00:53<00:10,  1.56it/s] 85%|████████▌ | 85/100 [00:53<00:09,  1.56it/s] 86%|████████▌ | 86/100 [00:54<00:08,  1.56it/s] 87%|████████▋ | 87/100 [00:55<00:08,  1.56it/s] 88%|████████▊ | 88/100 [00:55<00:07,  1.56it/s] 89%|████████▉ | 89/100 [00:56<00:07,  1.56it/s] 90%|█████████ | 90/100 [00:56<00:06,  1.56it/s] 91%|█████████ | 91/100 [00:57<00:05,  1.56it/s] 92%|█████████▏| 92/100 [00:58<00:05,  1.56it/s] 93%|█████████▎| 93/100 [00:58<00:04,  1.57it/s] 94%|█████████▍| 94/100 [00:59<00:03,  1.56it/s] 95%|█████████▌| 95/100 [01:00<00:03,  1.56it/s] 96%|█████████▌| 96/100 [01:00<00:02,  1.56it/s] 97%|█████████▋| 97/100 [01:01<00:01,  1.56it/s] 98%|█████████▊| 98/100 [01:02<00:01,  1.57it/s] 99%|█████████▉| 99/100 [01:02<00:00,  1.57it/s]100%|██████████| 100/100 [01:03<00:00,  1.57it/s]100%|██████████| 100/100 [01:03<00:00,  1.58it/s]
2023-06-14 19:52:31 [INFO] {
2023-06-14 19:52:31 [INFO]     'eval_loss': 1.1736871004104614,
2023-06-14 19:52:31 [INFO]     'eval_runtime': 64.0214,
2023-06-14 19:52:31 [INFO]     'eval_samples_per_second': 1.562,
2023-06-14 19:52:31 [INFO]     'eval_steps_per_second': 1.562
2023-06-14 19:52:31 [INFO] }
2023-06-14 19:52:31 [INFO] metric: 1.562
2023-06-14 19:52:31 [INFO] Throughput: 1.562 samples/sec
2023-06-14 19:52:31 [INFO] Tune 7 result is: [Accuracy (int8|fp32): 1.5620|1.4200, Duration (seconds) (int8|fp32): 64.0261|70.4203], Best tune result is: [Accuracy: 1.5850, Duration (seconds): 63.0810]
2023-06-14 19:52:31 [INFO] |**********************Tune Result Statistics**********************|
2023-06-14 19:52:31 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:52:31 [INFO] |     Info Type      | Baseline | Tune 7 result | Best tune result |
2023-06-14 19:52:31 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:52:31 [INFO] |      Accuracy      | 1.4200   |    1.5620     |     1.5850       |
2023-06-14 19:52:31 [INFO] | Duration (seconds) | 70.4203  |    64.0261    |     63.0810      |
2023-06-14 19:52:31 [INFO] +--------------------+----------+---------------+------------------+
2023-06-14 19:52:31 [INFO] Save tuning history to /scratch/dsochirca/nc_workspace/2023-06-14_19-19-27/./history.snapshot.
2023-06-14 19:52:35 [INFO] |******Mixed Precision Statistics******|
2023-06-14 19:52:35 [INFO] +-------------+--------+------+--------+
2023-06-14 19:52:35 [INFO] |   Op Type   | Total  | INT8 |  FP32  |
2023-06-14 19:52:35 [INFO] +-------------+--------+------+--------+
2023-06-14 19:52:35 [INFO] |  Embedding  |   2    |  1   |   1    |
2023-06-14 19:52:35 [INFO] |    Linear   |   1    |  1   |   0    |
2023-06-14 19:52:35 [INFO] +-------------+--------+------+--------+
2023-06-14 19:52:35 [INFO] Pass quantize model elapsed time: 769.63 ms
2023-06-14 19:52:35 [INFO] Specified timeout or max trials is reached! Found a quantized model which meet accuracy goal. Exit.
2023-06-14 19:52:35 [INFO] Save deploy yaml to /scratch/dsochirca/nc_workspace/2023-06-14_19-19-27/deploy.yaml
2023-06-14 19:52:35 [INFO] Saving model checkpoint to ./test_epoch
2023-06-14 19:52:46 [INFO] quantized model and configure file have saved to ./test_epoch
2023-06-14 19:52:49 [INFO] Saving model checkpoint to ./models/CodeGPT-Py150_0.6_sparse_q_only_weights_sym_per_tensor
2023-06-14 19:53:08 [INFO] quantized model and configure file have saved to ./models/CodeGPT-Py150_0.6_sparse_q_only_weights_sym_per_tensor
